{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"themes/matery/source/css/bb.css","path":"css/bb.css","modified":0,"renderable":1},{"_id":"themes/matery/source/css/gitment.css","path":"css/gitment.css","modified":0,"renderable":1},{"_id":"themes/matery/source/css/matery.css","path":"css/matery.css","modified":0,"renderable":1},{"_id":"themes/matery/source/css/my-gitalk.css","path":"css/my-gitalk.css","modified":0,"renderable":1},{"_id":"themes/matery/source/css/my.css","path":"css/my.css","modified":0,"renderable":1},{"_id":"themes/matery/source/js/matery.js","path":"js/matery.js","modified":0,"renderable":1},{"_id":"themes/matery/source/js/search.js","path":"js/search.js","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/avatar.jpg","path":"medias/avatar.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/comment_bg.png","path":"medias/comment_bg.png","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/favicon.png","path":"medias/favicon.png","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/icp.png","path":"medias/icp.png","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/logo.png","path":"medias/logo.png","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/animate/animate.min.css","path":"libs/animate/animate.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/aos/aos.css","path":"libs/aos/aos.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/aos/aos.js","path":"libs/aos/aos.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/aplayer/APlayer.min.css","path":"libs/aplayer/APlayer.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/aplayer/APlayer.min.js","path":"libs/aplayer/APlayer.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/background/canvas-nest.js","path":"libs/background/canvas-nest.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/background/ribbon-dynamic.js","path":"libs/background/ribbon-dynamic.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/background/ribbon-refresh.min.js","path":"libs/background/ribbon-refresh.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/background/ribbon.min.js","path":"libs/background/ribbon.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/codeBlock/codeBlockFuction.js","path":"libs/codeBlock/codeBlockFuction.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/codeBlock/codeCopy.js","path":"libs/codeBlock/codeCopy.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/codeBlock/codeLang.js","path":"libs/codeBlock/codeLang.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/codeBlock/codeShrink.js","path":"libs/codeBlock/codeShrink.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/cryptojs/crypto-js.min.js","path":"libs/cryptojs/crypto-js.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/dplayer/DPlayer.min.css","path":"libs/dplayer/DPlayer.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/dplayer/DPlayer.min.js","path":"libs/dplayer/DPlayer.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/echarts/echarts.min.js","path":"libs/echarts/echarts.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/gitalk/gitalk.css","path":"libs/gitalk/gitalk.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/gitalk/gitalk.min.js","path":"libs/gitalk/gitalk.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/gitment/gitment-default.css","path":"libs/gitment/gitment-default.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/gitment/gitment.js","path":"libs/gitment/gitment.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/instantpage/instantpage.js","path":"libs/instantpage/instantpage.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/jqcloud/jqcloud-1.0.4.min.js","path":"libs/jqcloud/jqcloud-1.0.4.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/jqcloud/jqcloud.css","path":"libs/jqcloud/jqcloud.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/jquery/jquery.min.js","path":"libs/jquery/jquery.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/masonry/masonry.pkgd.min.js","path":"libs/masonry/masonry.pkgd.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/materialize/materialize.min.css","path":"libs/materialize/materialize.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/materialize/materialize.min.js","path":"libs/materialize/materialize.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/minivaline/MiniValine.js","path":"libs/minivaline/MiniValine.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/others/busuanzi.pure.mini.js","path":"libs/others/busuanzi.pure.mini.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/others/clicklove.js","path":"libs/others/clicklove.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/prism/prism.css","path":"libs/prism/prism.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/scrollprogress/scrollProgress.min.js","path":"libs/scrollprogress/scrollProgress.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/tocbot/tocbot.css","path":"libs/tocbot/tocbot.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/tocbot/tocbot.min.js","path":"libs/tocbot/tocbot.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/twikoo/twikoo.all.min.js","path":"libs/twikoo/twikoo.all.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/twikoo/twikoo.all.min.js.LICENSE.txt","path":"libs/twikoo/twikoo.all.min.js.LICENSE.txt","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/valine/Valine.min.js","path":"libs/valine/Valine.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/valine/av-min.js","path":"libs/valine/av-min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/0.jpg","path":"medias/banner/0.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/1.jpg","path":"medias/banner/1.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/2.jpg","path":"medias/banner/2.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/3.jpg","path":"medias/banner/3.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/4.jpg","path":"medias/banner/4.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/5.jpg","path":"medias/banner/5.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/banner/6.jpg","path":"medias/banner/6.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/0.jpg","path":"medias/featureimages/0.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/1.jpg","path":"medias/featureimages/1.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/10.jpg","path":"medias/featureimages/10.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/11.jpg","path":"medias/featureimages/11.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/12.jpg","path":"medias/featureimages/12.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/13.jpg","path":"medias/featureimages/13.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/14.jpg","path":"medias/featureimages/14.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/15.jpg","path":"medias/featureimages/15.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/16.jpg","path":"medias/featureimages/16.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/17.jpg","path":"medias/featureimages/17.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/18.jpg","path":"medias/featureimages/18.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/19.jpg","path":"medias/featureimages/19.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/2.jpg","path":"medias/featureimages/2.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/20.jpg","path":"medias/featureimages/20.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/21.jpg","path":"medias/featureimages/21.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/22.jpg","path":"medias/featureimages/22.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/23.jpg","path":"medias/featureimages/23.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/3.jpg","path":"medias/featureimages/3.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/4.jpg","path":"medias/featureimages/4.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/5.jpg","path":"medias/featureimages/5.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/6.jpg","path":"medias/featureimages/6.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/7.jpg","path":"medias/featureimages/7.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/8.jpg","path":"medias/featureimages/8.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/featureimages/9.jpg","path":"medias/featureimages/9.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/reward/alipay.jpg","path":"medias/reward/alipay.jpg","modified":0,"renderable":1},{"_id":"themes/matery/source/medias/reward/wechat.png","path":"medias/reward/wechat.png","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-brands-400.svg","path":"libs/awesome/webfonts/fa-brands-400.svg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-brands-400.eot","path":"libs/awesome/webfonts/fa-brands-400.eot","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/css/all.css","path":"libs/awesome/css/all.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-brands-400.ttf","path":"libs/awesome/webfonts/fa-brands-400.ttf","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-brands-400.woff","path":"libs/awesome/webfonts/fa-brands-400.woff","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-brands-400.woff2","path":"libs/awesome/webfonts/fa-brands-400.woff2","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-regular-400.eot","path":"libs/awesome/webfonts/fa-regular-400.eot","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-regular-400.woff","path":"libs/awesome/webfonts/fa-regular-400.woff","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-regular-400.ttf","path":"libs/awesome/webfonts/fa-regular-400.ttf","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-regular-400.svg","path":"libs/awesome/webfonts/fa-regular-400.svg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-regular-400.woff2","path":"libs/awesome/webfonts/fa-regular-400.woff2","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-solid-900.eot","path":"libs/awesome/webfonts/fa-solid-900.eot","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-solid-900.svg","path":"libs/awesome/webfonts/fa-solid-900.svg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-solid-900.ttf","path":"libs/awesome/webfonts/fa-solid-900.ttf","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-solid-900.woff","path":"libs/awesome/webfonts/fa-solid-900.woff","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/css/lightgallery.min.css","path":"libs/lightGallery/css/lightgallery.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.eot","path":"libs/lightGallery/fonts/lg.eot","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.ttf","path":"libs/lightGallery/fonts/lg.ttf","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.svg","path":"libs/lightGallery/fonts/lg.svg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.woff","path":"libs/lightGallery/fonts/lg.woff","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-solid-900.woff2","path":"libs/awesome/webfonts/fa-solid-900.woff2","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/img/loading.gif","path":"libs/lightGallery/img/loading.gif","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/img/video-play.png","path":"libs/lightGallery/img/video-play.png","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/img/vimeo-play.png","path":"libs/lightGallery/img/vimeo-play.png","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/img/youtube-play.png","path":"libs/lightGallery/img/youtube-play.png","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/lightGallery/js/lightgallery-all.min.js","path":"libs/lightGallery/js/lightgallery-all.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/fonts/iconfont.svg","path":"libs/share/fonts/iconfont.svg","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/fonts/iconfont.eot","path":"libs/share/fonts/iconfont.eot","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/css/share.min.css","path":"libs/share/css/share.min.css","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/fonts/iconfont.ttf","path":"libs/share/fonts/iconfont.ttf","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/fonts/iconfont.woff","path":"libs/share/fonts/iconfont.woff","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/js/social-share.min.js","path":"libs/share/js/social-share.min.js","modified":0,"renderable":1},{"_id":"themes/matery/source/libs/share/js/jquery.share.min.js","path":"libs/share/js/jquery.share.min.js","modified":0,"renderable":1}],"Cache":[{"_id":"source/CNAME","hash":"7257c0821e59bd23023d2e5755357a5befc85f13","modified":1616497878575},{"_id":"source/404.md","hash":"754e404779d42f185145006a4e04242d9308a693","modified":1616497878575},{"_id":"source/_data/friends.json","hash":"d429f7d50dc611c094cb14a3f22c3d47509b6492","modified":1616497878575},{"_id":"source/_posts/Browse-and-save-files-that-require-root-permissions-in-neovim.md","hash":"c7d65ceaf802124e2572bd7ad439fbf7a5082e8b","modified":1616497878575},{"_id":"source/about/index.md","hash":"9eb95bb8923fb4785f4044b575d286e380f906f6","modified":1616497878585},{"_id":"source/_posts/better-highlight-for-go-files-in-vim.md","hash":"d36a9fd912d93094d97c912e02154d3bc27ab6aa","modified":1619619216125},{"_id":"source/_posts/build-aarch64-cross-toolchain-on-gentoo-with-crossdev.md","hash":"6698c553d185a6f603accc99022d76e583973d0a","modified":1616497878575},{"_id":"source/_posts/create-tauri-project-with-vue-typescript-less-vite.md","hash":"74faf6051911e14e7e748dccdff330166f9968a1","modified":1622790332074},{"_id":"source/_posts/better-use-of-rust-on-gentoo.md","hash":"bf7a51b957b6087fa0bf13f80a8a018ebe093593","modified":1619272046895},{"_id":"source/_posts/advanced-tutorial-of-vue-vite-typescript.md","hash":"e232e6540a857ed0558dfaf7ac8229e2f43ef52a","modified":1622966797654},{"_id":"source/_posts/basic-tutorial-of-vue-vite-typescript.md","hash":"877b4fbdaf2bb736fe6e2f317ccdf06a9395e354","modified":1621262298993},{"_id":"source/_posts/create-vue3-project.md","hash":"f6fa558499cd735444d0918a67f5460be66deca8","modified":1621424452113},{"_id":"source/_posts/debug-msp430g2-project-on-linux.md","hash":"240d881d34cd87952754e4f0273d8e8d6bacb179","modified":1622450034186},{"_id":"source/_posts/gentoo-compile-error-handling.md","hash":"e00fe9e9ab8a27751a4b132245322a7a815213cb","modified":1616497878579},{"_id":"source/_posts/gentoo-kool-desktop-environment-installation.md","hash":"aeede0ab66d6041a1c32de6da0c98be5527cac05","modified":1616497878579},{"_id":"source/_posts/develop-stm32-project-with-rust.md","hash":"7663aaa72695382f232a05f06c5692e9296d8c23","modified":1622450050063},{"_id":"source/_posts/gentoo-compiler-selection.md","hash":"8e4d446629f5eb2e95a11159be64b2267ea498bc","modified":1616497878579},{"_id":"source/_posts/gentoo-preface.md","hash":"3da08b2b9dd02a23389cb0af0bcd0829bf290a15","modified":1616497878579},{"_id":"source/_posts/gentoo-tutorials-directory.md","hash":"7566f9978346d4c3c807120d95891b18c0ae41a3","modified":1616497878582},{"_id":"source/_posts/gentoo-basic-system-installation.md","hash":"f34b23612624a9eb87b18ce914dd9f66ad22fd32","modified":1616497878575},{"_id":"source/_posts/gentoo-package-management.md","hash":"dc54a5055f44f069d0a3a7a6d04f454f7c1060b9","modified":1616497878579},{"_id":"source/_posts/install-oracle-jdk-and-jre-on-gentoo.md","hash":"9729cff5f2c86a9e7f5fd9e702c5ae15faae6418","modified":1616497878585},{"_id":"source/_posts/gentoo-system-further-improvement.md","hash":"1f0e471b613cf0a091b185b1ae53dca6991f5823","modified":1616497878582},{"_id":"source/_posts/install-manjaro-on-rpi4.md","hash":"317c13634e5cec931e7abaa7d06b33348c8f181f","modified":1621087359093},{"_id":"source/_posts/install-rpm-deb-packages-on-gentoo.md","hash":"67a0d6d9d31b05d973d9cfbda3d338cc601e3489","modified":1616497878585},{"_id":"source/_posts/rust-tauri-hello-world.md","hash":"3c9d3a805246e29a9202a4ea5f609292a47cb894","modified":1620743132263},{"_id":"source/_posts/use-custom-snippets-in-vim.md","hash":"b7586a0e6cc75a911b72869d9b87f970e8e12b9f","modified":1622904363605},{"_id":"source/_posts/use-realvnc-on-manjaro-on-rpi4.md","hash":"9d8b4147102fc2af7dcb7985c1b25dba6be77fb2","modified":1621087347842},{"_id":"source/_posts/spartan-edge-accelerator-board-tutorial.md","hash":"d108d6023ba51af90e7e65a2c59a008911bd35cc","modified":1622731325565},{"_id":"source/_posts/use-vim-as-the-editor-of-systemverilog.md","hash":"f94080a6cf3a4723e31d3978de6f8b90a9f33796","modified":1622904477235},{"_id":"source/_posts/vim-clipboard-history-plugin.md","hash":"34b2a6b732468b797542ccea301c6f90179978ed","modified":1616497878585},{"_id":"source/_posts/vim-file-encoding.md","hash":"648b08e3d9d2f270157e1e81e8aafd9570e43b20","modified":1618734080464},{"_id":"source/_posts/vim-file-tree.md","hash":"765264c1a840fea88f5184d3e979aba54ac8a199","modified":1616497878585},{"_id":"source/_posts/vim-automatic-completion.md","hash":"47bb249edf66433763b5c4591b0627db578e2256","modified":1618558308059},{"_id":"source/_posts/vim-fuzzy-search-plugin.md","hash":"3e35748b7fbdf24e32ce0557dc77d39f871b8a98","modified":1616500791648},{"_id":"source/_posts/vim-debugging-scheme.md","hash":"a7df627ca73a49de0bd11c46f7193a72099c23e1","modified":1616497878585},{"_id":"source/_posts/vim-markdown-preview-plugin.md","hash":"bb1097231e3d619d41879c6005fd5f86661162a6","modified":1616497878585},{"_id":"source/_posts/vim-plugin-management.md","hash":"0e16f2e1ad59afbb7a740fe86eae0a6f3782a561","modified":1616497878585},{"_id":"source/_posts/vim-preface.md","hash":"fe89b24b76b199309a535adb0252729baa3456a8","modified":1616497878585},{"_id":"source/_posts/vim-markdown-latex.md","hash":"6199b363895af65c1e8f89e96810f22c8e06c283","modified":1616497878585},{"_id":"source/_posts/vim-tagbar.md","hash":"39367961545221cfbad3876ec936b04a5c3dd8a1","modified":1616497878585},{"_id":"source/_posts/vim-shortcut-key-management.md","hash":"18dcf1cc6d232cff0a8e5209dd089b2fae0424c0","modified":1616497878585},{"_id":"source/categories/index.md","hash":"f736ce49c5efcd4246dca56cb98b976d513f32bd","modified":1616497878585},{"_id":"source/friends/index.md","hash":"671d9afceed403490c583fd1befbda92f6ae3909","modified":1616497878585},{"_id":"source/_posts/vim-quickfix.md","hash":"40c6847089260ffdb4d89bf3c6fd94044896dc55","modified":1620630866102},{"_id":"source/tags/index.md","hash":"a0f3e579c8e2c9020a34ba83028fb57801d76d80","modified":1616497878585},{"_id":"source/_posts/gentoo-basic-system-installation/2.png","hash":"effb90b8e9f83398724e8a3a415b319f7adda409","modified":1616497878579},{"_id":"source/_posts/gentoo-basic-system-installation/1.png","hash":"9876d487b6f6926159cc894531d71c6e0890aa20","modified":1616497878575},{"_id":"source/_posts/gentoo-basic-system-installation/3.png","hash":"030a4e86fde14342cfe3009b4379fc7052258fbe","modified":1616497878579},{"_id":"source/contact/index.md","hash":"6bc00b43cab557af1be7644505fd8561d8be2468","modified":1616497878585},{"_id":"source/_posts/gentoo-package-management/2.png","hash":"7191ab865c25c8c104f650177ab6fd864a9cea4a","modified":1616497878579},{"_id":"source/_posts/install-manjaro-on-rpi4/3.png","hash":"16c5e82436a9cced715a8fc7b66bb193ae5b2525","modified":1621087058780},{"_id":"source/_posts/vim-shortcut-key-management/1.png","hash":"3c890a163cc47885bce9c3fee5d4a9076e530cc2","modified":1616497878585},{"_id":"source/_posts/basic-tutorial-of-vue-vite-typescript/1.png","hash":"25c27d87e0bf086c56f194ff8a10751f038ea518","modified":1620828118912},{"_id":"source/_posts/gentoo-package-management/1.png","hash":"ed96f4c4d92572f15403cc9be75252932be93812","modified":1616497878579},{"_id":"source/_posts/gentoo-preface/1.png","hash":"87d58781f1eccfda78711055543de2f613ed99af","modified":1616497878582},{"_id":"source/_posts/gentoo-package-management/3.png","hash":"fc7ad697702568ba3df4e7875545c24b28052aef","modified":1616497878579},{"_id":"source/_posts/install-manjaro-on-rpi4/2.png","hash":"afea3fbe78c9e5df281215c7ec67153281dc4ff5","modified":1621087042149},{"_id":"source/_posts/install-manjaro-on-rpi4/1.png","hash":"b67018d5dd3a0e1ee69efa424e8592a9bb5e36f6","modified":1621086961162},{"_id":"themes/matery/.gitignore","hash":"727607929a51db7ea10968f547c26041eee9cfff","modified":1616498072635},{"_id":"themes/matery/LICENSE","hash":"7df059597099bb7dcf25d2a9aedfaf4465f72d8d","modified":1616498072635},{"_id":"themes/matery/CHANGELOG.md","hash":"084ec8b110a20170d08a0aa5fd8accf601051835","modified":1616498072635},{"_id":"themes/matery/README.md","hash":"a57adad34e9f6efe25aee84e5043b923201dd456","modified":1616498072635},{"_id":"themes/matery/README_CN.md","hash":"02f92396b41f7deea24d590ab11b5e079ceb39ef","modified":1616498072635},{"_id":"themes/matery/_config.yml","hash":"0f8a830bc360b97d2962d1b5cd3869ae95199538","modified":1621175749119},{"_id":"themes/matery/languages/zh-CN.yml","hash":"a957b05f70265a86a87d922e18488571809d2472","modified":1616498072635},{"_id":"themes/matery/languages/default.yml","hash":"75dfe9de9e126abb09e6c4cb78a95bba854e84c7","modified":1616498072635},{"_id":"themes/matery/languages/zh-HK.yml","hash":"ae34ac0e175c3037675722e436637efbceea32f0","modified":1616498072635},{"_id":"themes/matery/layout/404.ejs","hash":"9c8ca67377211e5d60fdde272a975faa9a91a22a","modified":1616498072635},{"_id":"themes/matery/layout/about.ejs","hash":"99a74316aed478efb0db823c4460ee2e660f101c","modified":1616498072639},{"_id":"themes/matery/layout/bb.ejs","hash":"21959d702f17a3d98b716daf44c8b5eecd59c7c5","modified":1616498072639},{"_id":"themes/matery/layout/categories.ejs","hash":"8e54665cc25d7c333da7d9f312987190be6215da","modified":1616498072639},{"_id":"themes/matery/layout/archive.ejs","hash":"cdac701de8370f9f3794a0eed4165983993a1ca7","modified":1616498072639},{"_id":"themes/matery/layout/category.ejs","hash":"00019bca11fb46477f22017cb1f5ad8444da0580","modified":1616498072639},{"_id":"themes/matery/layout/contact.ejs","hash":"cff60f87f69155707f3a33731c7fac945cf7cd93","modified":1616498072639},{"_id":"themes/matery/layout/friends.ejs","hash":"51e5369ec6b017cc702a8d957fc052c59dd4c3d7","modified":1616498072639},{"_id":"themes/matery/layout/layout.ejs","hash":"4bfb9e946a90724fc8a902efe404c7b20549a38c","modified":1616498072639},{"_id":"themes/matery/layout/index.ejs","hash":"4dc6f08e7709cc04e886be72dbf0d06469f0effc","modified":1616498072639},{"_id":"themes/matery/layout/tag.ejs","hash":"85a4b05bd8a6ad0f17ff2e97dae56949b379c204","modified":1616498072639},{"_id":"themes/matery/layout/tags.ejs","hash":"cf9517aa6a0111355121f44615d6923e312283c7","modified":1616498072639},{"_id":"themes/matery/layout/post.ejs","hash":"90b5a4c1f70e4756db569c15a7c6cad0c77c4500","modified":1616498072639},{"_id":"themes/matery/layout/_partial/background.ejs","hash":"aef6edeeb11209831a11d8c7f5d59992e2573335","modified":1616498072635},{"_id":"themes/matery/layout/_partial/back-top.ejs","hash":"47ee36a042bb6d52bbe1d0f329637e8ffcf1d0aa","modified":1616498072635},{"_id":"themes/matery/layout/_partial/bg-cover-content.ejs","hash":"c35e4254ff0738878f65251a657b4fdcafc4b270","modified":1616498072635},{"_id":"themes/matery/layout/_partial/baidu-analytics.ejs","hash":"3bbcdb474ca1dcad514bdc4b7763e17c55df04fd","modified":1616498072635},{"_id":"themes/matery/layout/_partial/baidu-push.ejs","hash":"2cebcc5ea3614d7f76ec36670e68050cbe611202","modified":1616498072635},{"_id":"themes/matery/layout/_partial/changyan.ejs","hash":"cd919d31564e118c2ee8d5cbfb7d51ee6da15d82","modified":1616498072635},{"_id":"themes/matery/layout/_partial/bg-cover.ejs","hash":"02191109712f61c0e487b8f0b8466597181a9004","modified":1616498072635},{"_id":"themes/matery/layout/_partial/gitalk.ejs","hash":"2aa8fbb04b046fa7679092a48372d7e036835dff","modified":1616498072635},{"_id":"themes/matery/layout/_partial/disqus.ejs","hash":"b2dc2c8b5ed56815e55cc2ea54a6dc4eeba2375d","modified":1616498072635},{"_id":"themes/matery/layout/_partial/github-link.ejs","hash":"3aeb581bd78ab8e15b858e4c44c03bcf92f20b9e","modified":1616498072635},{"_id":"themes/matery/layout/_partial/gitment.ejs","hash":"90f6218512ef2eab63ada7ad2fc766ae635a2297","modified":1616498072635},{"_id":"themes/matery/layout/_partial/google-analytics.ejs","hash":"5f4992205617da5f8cc5863c62b5ec46e414e2fb","modified":1616498072635},{"_id":"themes/matery/layout/_partial/header.ejs","hash":"59e38c70f3d8e7165e686e5e84a627835f4321b0","modified":1616498072635},{"_id":"themes/matery/layout/_partial/head.ejs","hash":"f8438ac80df005934a330b029de292d26f0b6ecb","modified":1616498072635},{"_id":"themes/matery/layout/_partial/livere.ejs","hash":"9c3401b42ea7f26410a5593bae93ada7e57b43be","modified":1616498072635},{"_id":"themes/matery/layout/_partial/mobile-nav.ejs","hash":"cb0cb452be1cd1857ba600f04025b506f3b6fc79","modified":1616498072635},{"_id":"themes/matery/layout/_partial/footer.ejs","hash":"3be24e4c370671eda53bdfd99fb748f4a22948ba","modified":1616498072635},{"_id":"themes/matery/layout/_partial/minivaline.ejs","hash":"738b83cd90fe1b26971d803fc89c56193323da1e","modified":1616498072635},{"_id":"themes/matery/layout/_partial/navigation.ejs","hash":"78b70ff24b3039c871331ebec114b936c1756cc8","modified":1616498072635},{"_id":"themes/matery/layout/_partial/index-cover.ejs","hash":"85f0ef1c390694a1661e77f44a3ed76555099385","modified":1616498072635},{"_id":"themes/matery/layout/_partial/paging.ejs","hash":"e2df12cf92a82b1a7a7add2eac1db1d954bc5511","modified":1616498072635},{"_id":"themes/matery/layout/_partial/post-cover.ejs","hash":"d1c873c5de54498c722e155aadb8c0ec39485dfa","modified":1616498072635},{"_id":"themes/matery/layout/_partial/post-statis.ejs","hash":"04889f9031743c6b081d02fa4027b0dbfcc45ecf","modified":1616498072635},{"_id":"themes/matery/layout/_partial/post-detail-toc.ejs","hash":"3ff94aff01936242a9f4e1f31adb9b43bfab8d53","modified":1616498072635},{"_id":"themes/matery/layout/_partial/reward.ejs","hash":"ffc55bc7e73bc698bfc58d8e3780c336b83282cf","modified":1616498072635},{"_id":"themes/matery/layout/_partial/post-detail.ejs","hash":"7933979c2092654a9c1038ff30495505d7d88f2d","modified":1616498072635},{"_id":"themes/matery/layout/_partial/search.ejs","hash":"150529c9fb9aa8ddb42ec3e02645d301faa2503b","modified":1616498072639},{"_id":"themes/matery/layout/_partial/social-link.ejs","hash":"6f871bd3a70f720e4e451f1f4f625cbc6d8994a4","modified":1616498072639},{"_id":"themes/matery/layout/_partial/share.ejs","hash":"c941730a2471d6aab367cbb6e09ed08b56c83143","modified":1616498072639},{"_id":"themes/matery/layout/_partial/twikoo.ejs","hash":"f9cb8c82b9d2a7cdb644e10718f1cdeb9400414c","modified":1616498072639},{"_id":"themes/matery/layout/_widget/artitalk.ejs","hash":"b14e486f12b9ac42a273b80e4d785fcb94cf04b2","modified":1616498072639},{"_id":"themes/matery/layout/_widget/category-cloud.ejs","hash":"1b3df1009234c0112424b497b18b4ad8240b3bc7","modified":1616498072639},{"_id":"themes/matery/layout/_partial/prev-next.ejs","hash":"c76b78782ea82340104fccc089417572e0adece4","modified":1616498072635},{"_id":"themes/matery/layout/_partial/valine.ejs","hash":"045f3aaade1dc6749a1f824b0405b5fdb9e041e4","modified":1616498072639},{"_id":"themes/matery/layout/_partial/reprint-statement.ejs","hash":"0ce3f9361f558b99cc2f059c5e50b0e2a152ae38","modified":1616498072635},{"_id":"themes/matery/layout/_widget/category-radar.ejs","hash":"1d8747fda89a0b2ca3c7008867cbfeecad0578a6","modified":1616498072639},{"_id":"themes/matery/layout/_widget/my-projects.ejs","hash":"ef60b64021fa349b0048425d858dfcf6c906fede","modified":1616498072639},{"_id":"themes/matery/layout/_widget/music.ejs","hash":"e9e3e327d5de9d7aeadbde32e1d558652d9e9195","modified":1616498072639},{"_id":"themes/matery/layout/_widget/dream.ejs","hash":"9a472ad5591100cdb65d0df9d01034163bd6dd9d","modified":1616498072639},{"_id":"themes/matery/layout/_widget/my-gallery.ejs","hash":"65a2d2f9722f84c7fd98f6bdf79087a14848ebd8","modified":1616498072639},{"_id":"themes/matery/layout/_widget/my-skills.ejs","hash":"89a0092df72d23093128f2fbbdc8ca7f83ebcfd9","modified":1616498072639},{"_id":"themes/matery/layout/_widget/post-calendar.ejs","hash":"48821e644bc73553d7c5c56d2e8ee111a70cd776","modified":1616498072639},{"_id":"themes/matery/layout/_widget/tag-wordcloud.ejs","hash":"487aacb2454d6bf0d21cdb07ddd1fd5ddbca9038","modified":1616498072639},{"_id":"themes/matery/layout/_widget/tag-cloud.ejs","hash":"fc42b72cddc231f7485cdc1fd6852b66be6add26","modified":1616498072639},{"_id":"themes/matery/layout/_widget/video.ejs","hash":"a0e002377af2a7f7e4da6d9a644de97adb035925","modified":1616498072639},{"_id":"themes/matery/layout/_widget/recommend.ejs","hash":"8551137e94ca4e2e3b8b63d5626255884cb60cb5","modified":1616498072639},{"_id":"themes/matery/source/css/bb.css","hash":"aa15633888c7cf9baea8bb48d796c68b57cf14bf","modified":1616498072639},{"_id":"themes/matery/layout/_widget/post-charts.ejs","hash":"ab5f986f428215941aeaa0c88aefd440c47d3bcf","modified":1616498072639},{"_id":"themes/matery/source/css/my.css","hash":"497e50351f7838f8546cac76850a42e7e380a110","modified":1616498072639},{"_id":"themes/matery/source/css/gitment.css","hash":"2bd15cc17dca35ac3ecc0acf167a23a1dd362acd","modified":1616498072639},{"_id":"themes/matery/source/css/my-gitalk.css","hash":"af18dd29e58642c18bab9b89541767b494c468dd","modified":1616498072639},{"_id":"themes/matery/source/js/search.js","hash":"e1482406c58ea2a0eb178d7e4efb2c879cdddc80","modified":1616498072639},{"_id":"themes/matery/source/js/matery.js","hash":"b86de5fe3e9766b7ff80df12ea41c3a9e30825f7","modified":1616498072639},{"_id":"themes/matery/source/css/matery.css","hash":"a630f6e8643904073dce9eada57b5c16c4dba5e2","modified":1616498072639},{"_id":"themes/matery/source/medias/icp.png","hash":"27a96f31f7d0413c6ade6f40e06f021f501151c7","modified":1616498756996},{"_id":"themes/matery/source/medias/comment_bg.png","hash":"dfc93d24081884fbc58cab0f8fd19e77d31d6123","modified":1616498756992},{"_id":"themes/matery/source/medias/logo.png","hash":"16334e905b89a98d17d7fe65b9cfc11d3f487525","modified":1616498756996},{"_id":"themes/matery/source/medias/favicon.png","hash":"634a88eb94f5abcffc8569a1e9ddcfd4cf351c64","modified":1616498756996},{"_id":"themes/matery/source/medias/avatar.jpg","hash":"6262562f49af87ee516f69d8272819090b6e77e8","modified":1616498766259},{"_id":"themes/matery/source/libs/aos/aos.css","hash":"191a3705a8f63e589a50a0ff2f2c5559f1a1b6b2","modified":1616498072639},{"_id":"themes/matery/source/libs/aos/aos.js","hash":"02bfb40b0c4b6e9b0b4081218357145cbb327d74","modified":1616498072639},{"_id":"themes/matery/source/libs/background/canvas-nest.js","hash":"65333d0dbb9c1173a1b13031b230161fc42c8b2f","modified":1616498072655},{"_id":"themes/matery/source/libs/aplayer/APlayer.min.css","hash":"07372a2ba507388d0fed166d761b1c2c2a659dce","modified":1616498072639},{"_id":"themes/matery/source/libs/background/ribbon-refresh.min.js","hash":"6d98692b2cad8c746a562db18b170b35c24402f4","modified":1616498072655},{"_id":"themes/matery/source/libs/background/ribbon.min.js","hash":"6a99d494c030388f96f6086a7aaa0f03f3fe532e","modified":1616498072655},{"_id":"themes/matery/source/libs/codeBlock/codeBlockFuction.js","hash":"c7ab06d27a525b15b1eb69027135269e9b9132fb","modified":1616498072655},{"_id":"themes/matery/source/libs/codeBlock/codeCopy.js","hash":"6d39a766af62e625f177c4d5cf3adc35eed71e61","modified":1616498072655},{"_id":"themes/matery/source/libs/codeBlock/codeLang.js","hash":"bac88b4d4e3679732d29bd037c34f089cf27cf05","modified":1616498072655},{"_id":"themes/matery/source/libs/background/ribbon-dynamic.js","hash":"052b80c29e6bc585aa28d4504b743bdbac220a88","modified":1616498072655},{"_id":"themes/matery/source/libs/animate/animate.min.css","hash":"97afa151569f046b2e01f27c1871646e9cd87caf","modified":1616498072639},{"_id":"themes/matery/source/libs/codeBlock/codeShrink.js","hash":"201e8cd761b4be557247bdaf1ebc7c11c83194f6","modified":1616498072655},{"_id":"themes/matery/source/libs/aplayer/APlayer.min.js","hash":"22caa28ff6b41a16ff40f15d38f1739e22359478","modified":1616498072642},{"_id":"themes/matery/source/libs/dplayer/DPlayer.min.css","hash":"f7d19655f873b813ffba5d1a17145c91f82631b8","modified":1616498072655},{"_id":"themes/matery/source/libs/gitalk/gitalk.css","hash":"940ded3ea12c2fe1ab0820d2831ec405f3f1fe9f","modified":1616498072659},{"_id":"themes/matery/source/libs/cryptojs/crypto-js.min.js","hash":"5989527a378b55011a59522f41eeb3981518325c","modified":1616498072655},{"_id":"themes/matery/source/libs/jqcloud/jqcloud.css","hash":"20d9f11a19d95c70e27cb922e0d6dccbec4eae89","modified":1616498072662},{"_id":"themes/matery/source/libs/gitment/gitment-default.css","hash":"2903c59ee06b965bef32e937bd69f5b0b2190717","modified":1616498072662},{"_id":"themes/matery/source/libs/jqcloud/jqcloud-1.0.4.min.js","hash":"257eaae3020599e4939f50d5008a743827f25b8c","modified":1616498072662},{"_id":"themes/matery/source/libs/instantpage/instantpage.js","hash":"83ce8919b1a69b2f1809ffaf99b52a8627e650e9","modified":1616498072662},{"_id":"themes/matery/source/libs/masonry/masonry.pkgd.min.js","hash":"ff940b4ea68368ca0e4d5560cbb79fb147dfc3c5","modified":1616498072662},{"_id":"themes/matery/source/libs/minivaline/MiniValine.js","hash":"f7f6cdc1b22297e02334e304444e9a8351acb455","modified":1616498072662},{"_id":"themes/matery/source/libs/others/clicklove.js","hash":"6a39b8c683ba5dcd92f70c6ab45d1cfac3213e8e","modified":1616498072662},{"_id":"themes/matery/source/libs/prism/prism.css","hash":"62e5474893dece076534352f564ceabd6e088a5a","modified":1616498072662},{"_id":"themes/matery/source/libs/scrollprogress/scrollProgress.min.js","hash":"777ffe5d07e85a14fbe97d846f45ffc0087251cc","modified":1616498072665},{"_id":"themes/matery/source/libs/tocbot/tocbot.css","hash":"9ab8ef576c9a57115194152e79cca79b0a41dd70","modified":1616498072665},{"_id":"themes/matery/source/libs/tocbot/tocbot.min.js","hash":"5ec27317f0270b8cf6b884c6f12025700b9a565c","modified":1616498072665},{"_id":"themes/matery/source/libs/others/busuanzi.pure.mini.js","hash":"6e41f31100ae7eb3a6f23f2c168f6dd56e7f7a9a","modified":1616498072662},{"_id":"themes/matery/source/libs/twikoo/twikoo.all.min.js.LICENSE.txt","hash":"1e286a31ef472fb864fe2b9502e87df9242df56b","modified":1616498072665},{"_id":"themes/matery/source/medias/featureimages/10.jpg","hash":"98e7f6fd9c97d4de9044b6871ca08ebf14db11b9","modified":1616498072672},{"_id":"themes/matery/source/medias/featureimages/16.jpg","hash":"97a829c4bc94f9d2929b20a1a9b798c57b9f7205","modified":1616498072672},{"_id":"themes/matery/source/medias/featureimages/13.jpg","hash":"35a320174f8e316e3eadaec658024276b651c6e9","modified":1616498072672},{"_id":"themes/matery/source/medias/featureimages/15.jpg","hash":"da0fbee3b7bde1607eace377ddf834c0be99edfe","modified":1616498072672},{"_id":"themes/matery/source/medias/featureimages/2.jpg","hash":"4bba691cf71a517ecaeaf42afd3e8f8b31e346c1","modified":1616498072675},{"_id":"themes/matery/source/medias/featureimages/22.jpg","hash":"754579747a3e99747d890fca3162f370b96a7941","modified":1616498072675},{"_id":"themes/matery/source/medias/featureimages/21.jpg","hash":"b26edb128bb0bf58b23fd2f014e9555e89a2ca3b","modified":1616498072675},{"_id":"themes/matery/source/medias/featureimages/23.jpg","hash":"7d7f37da3fa7128343adac23866449eb2c6a549a","modified":1616498072675},{"_id":"themes/matery/source/medias/featureimages/3.jpg","hash":"6ec646c2a70f5f11edacf225c1477f2200a37a96","modified":1616498072675},{"_id":"themes/matery/source/medias/featureimages/7.jpg","hash":"7975141cd64e875122c0ea33daaca1a06bf00b8e","modified":1616498072675},{"_id":"themes/matery/source/medias/featureimages/5.jpg","hash":"41ca20129a37fedc573eec28dd7d7b9e5b09228a","modified":1616498072675},{"_id":"themes/matery/source/medias/reward/alipay.jpg","hash":"1abc719b95d1b26f1f898e6b0a9b7609146e332f","modified":1616498072675},{"_id":"themes/matery/source/medias/featureimages/8.jpg","hash":"8e4b7186352085483ca1174c7c0800114c48df8b","modified":1616498072675},{"_id":"themes/matery/source/medias/reward/wechat.png","hash":"fe93385aa92fe328e01c8221a80b039be9e4e140","modified":1616498072675},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-regular-400.woff","hash":"59439d3ad31d856d78ec3e2bd9f1eafa2c7a581c","modified":1616498072649},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-regular-400.eot","hash":"439c8afd3373acb4a73135a34e220464a89cd5e2","modified":1616498072645},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-regular-400.woff2","hash":"f6f653b4ea8fc487bdb590d39d5a726258a55f40","modified":1616498072649},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-regular-400.ttf","hash":"0f4bd02942a54a6b3200d9078adff88c2812e751","modified":1616498072649},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.ttf","hash":"f6421c0c397311ae09f9257aa58bcd5e9720f493","modified":1616498072662},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.woff","hash":"3048de344dd5cad4624e0127e58eaae4b576f574","modified":1616498072662},{"_id":"themes/matery/source/libs/lightGallery/css/lightgallery.min.css","hash":"1b7227237f9785c66062a4811508916518e4132c","modified":1616498072662},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.svg","hash":"9c6632aeec67d3e84a1434884aa801514ff8103b","modified":1616498072662},{"_id":"themes/matery/source/libs/lightGallery/fonts/lg.eot","hash":"54caf05a81e33d7bf04f2e420736ce6f1de5f936","modified":1616498072662},{"_id":"themes/matery/source/libs/lightGallery/img/youtube-play.png","hash":"f8d11384d33b7a79ee2ba8d522844f14d5067a80","modified":1616498072662},{"_id":"themes/matery/source/libs/lightGallery/img/loading.gif","hash":"15a76af2739482d8de7354abc6d8dc4fca8d145e","modified":1616498072662},{"_id":"themes/matery/source/libs/lightGallery/js/lightgallery-all.min.js","hash":"9f5ef4bc8a0a3c746ca4f3c3e6d64493b1a977d8","modified":1616498072662},{"_id":"themes/matery/source/libs/lightGallery/img/vimeo-play.png","hash":"9b72fc0f86a01467ed0b68c9cc4d604ec316d517","modified":1616498072662},{"_id":"themes/matery/source/libs/lightGallery/img/video-play.png","hash":"2962e03ddbe04d7e201a5acccac531a2bbccddfc","modified":1616498072662},{"_id":"themes/matery/source/libs/share/fonts/iconfont.svg","hash":"1d56c9d5db0273f07c43cc1397e440f98ba7827a","modified":1616498072665},{"_id":"themes/matery/source/libs/share/fonts/iconfont.eot","hash":"00ff749c8e202401190cc98d56087cdda716abe4","modified":1616498072665},{"_id":"themes/matery/source/libs/share/js/social-share.min.js","hash":"a3090a02786dcd4efc6355c1c1dc978add8d6827","modified":1616498072665},{"_id":"themes/matery/source/libs/share/fonts/iconfont.woff","hash":"2e3fce1dcfbd6e2114e7bfbeaf72d3c62e15a1bd","modified":1616498072665},{"_id":"themes/matery/source/libs/share/css/share.min.css","hash":"8a778a86f3ce9a042df6be63a9f1039631e351a5","modified":1616498072665},{"_id":"themes/matery/source/libs/share/fonts/iconfont.ttf","hash":"afd898f59d363887418669520b24d175f966a083","modified":1616498072665},{"_id":"themes/matery/source/libs/share/js/jquery.share.min.js","hash":"41367dcb857e02e3c417ebe68a554ce1d4430806","modified":1616498072665},{"_id":"source/_posts/vim-quickfix/1.png","hash":"57090f4b91bf5bb179a6b8b8a87d3485401938a7","modified":1618658523047},{"_id":"themes/matery/source/libs/dplayer/DPlayer.min.js","hash":"c3bad7b265574fab0ae4d45867422ea1cb9d6599","modified":1616498072655},{"_id":"themes/matery/source/libs/gitment/gitment.js","hash":"28c02c45ce568e084cd1041dc493f83f9c6c88c6","modified":1616498072662},{"_id":"themes/matery/source/libs/jquery/jquery.min.js","hash":"2115753ca5fb7032aec498db7bb5dca624dbe6be","modified":1616498072662},{"_id":"themes/matery/source/libs/valine/Valine.min.js","hash":"6cbdbf91e1f046dd41267a5ff0691a1fccba99df","modified":1616498072665},{"_id":"themes/matery/source/medias/banner/0.jpg","hash":"69ec96cd9b4bc3aa631adc9da61353f50c39f031","modified":1616498072669},{"_id":"themes/matery/source/medias/banner/2.jpg","hash":"39fb2535460ce66cc0b34e07ffb9411db1405f09","modified":1616498072669},{"_id":"themes/matery/source/medias/banner/3.jpg","hash":"4ac047e92d0363b1a61ab756aca6dac13fb77494","modified":1616498072669},{"_id":"themes/matery/source/medias/featureimages/0.jpg","hash":"1c3300f029fc85d6dda6fa4f1d699551034cdaf7","modified":1616498072672},{"_id":"themes/matery/source/medias/featureimages/11.jpg","hash":"f55972ce7175684f2b11c3c9fc2b5b14bccbfae8","modified":1616498072672},{"_id":"themes/matery/source/medias/featureimages/1.jpg","hash":"684ae89de8cb7acefae19f5aee6c612037c46393","modified":1616498072672},{"_id":"themes/matery/source/medias/featureimages/12.jpg","hash":"8a4b2e7d92ae95c3b0c921db23c35aa9a41a7d58","modified":1616498072672},{"_id":"themes/matery/source/medias/featureimages/14.jpg","hash":"38e11221406785bcd93aa9cd23e568e164630ef1","modified":1616498072672},{"_id":"themes/matery/source/medias/featureimages/17.jpg","hash":"42d47903551ee81885c1386022982cae165841c5","modified":1616498072672},{"_id":"themes/matery/source/medias/featureimages/18.jpg","hash":"64829272ec85bb819d55ff89e5b5fd6f64aa436b","modified":1616498072672},{"_id":"themes/matery/source/medias/featureimages/19.jpg","hash":"eb250906fdbc0c408f42ae9933725bc1a05d79fb","modified":1616498072675},{"_id":"themes/matery/source/medias/featureimages/20.jpg","hash":"3b11f9b461168d907073f793190865fe621a8573","modified":1616498072675},{"_id":"themes/matery/source/medias/featureimages/6.jpg","hash":"c8f2aa4bbb041158b4e73733a341e6a77c8583f7","modified":1616498072675},{"_id":"themes/matery/source/medias/featureimages/4.jpg","hash":"e06c47de27619984be9d5d02947f8370a432dfea","modified":1616498072675},{"_id":"themes/matery/source/medias/featureimages/9.jpg","hash":"b956a2291a04b2132366b53666cf34858b8bdb1f","modified":1616498072675},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-brands-400.eot","hash":"22f9e7d5226408eb2d0a11e118257a3ca22b8670","modified":1616498072642},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-brands-400.ttf","hash":"91cbeeaceb644a971241c08362898599d6d968ce","modified":1616498072645},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-brands-400.woff2","hash":"a46bd47ff0a90b812aafafda587d095cdb844271","modified":1616498072645},{"_id":"themes/matery/source/libs/awesome/css/all.css","hash":"ecc41e32ad2696877a1656749841f3b5543bbe3d","modified":1616498072642},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-brands-400.woff","hash":"18838f5260317da3c5ed29bf844ac8a4f7ad0529","modified":1616498072645},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-solid-900.woff","hash":"92803b8753ceda573c6906774677c5a7081d2fbb","modified":1616498072655},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-solid-900.woff2","hash":"9c081b88b106c6c04ecb895ba7ba7d3dcb3b55ac","modified":1616498072655},{"_id":"source/_posts/spartan-edge-accelerator-board-tutorial/1.png","hash":"5e17abc272a5440e033a882207382e473e9aa00d","modified":1622710825141},{"_id":"themes/matery/source/libs/gitalk/gitalk.min.js","hash":"8fefe38f28804f90116bdcb74a0875c9de9f3b7d","modified":1616498072659},{"_id":"themes/matery/source/libs/materialize/materialize.min.css","hash":"a69d456e3345e7f59cd0d47d1b3e70fd4a496a05","modified":1616498072662},{"_id":"themes/matery/source/libs/materialize/materialize.min.js","hash":"c8b4c65651921d888cf5f27430dfe2ad190d35bf","modified":1616498072662},{"_id":"themes/matery/source/libs/valine/av-min.js","hash":"541efb9edc1ce425cbe3897cfc25803211fe6a05","modified":1616498072669},{"_id":"themes/matery/source/medias/banner/1.jpg","hash":"ab122a36998a4f62a61e61a4fc5e00248113413b","modified":1616498072669},{"_id":"themes/matery/source/medias/banner/5.jpg","hash":"852418f4f09e796e12bc3bab7a1488d3f37d6486","modified":1616498072672},{"_id":"themes/matery/source/medias/banner/6.jpg","hash":"d4957ff7cc5e88555cd840f2956ab0561e6f1ccf","modified":1616498766259},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-solid-900.eot","hash":"cab8e84ae5682d1d556e234df9c790985888def8","modified":1616498072649},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-regular-400.svg","hash":"3d3a49445343d80f3b553e3e3425b9a7bd49acaf","modified":1616498072649},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-solid-900.ttf","hash":"9521ed12274c2cbc910cea77657116fcf6545da3","modified":1616498072655},{"_id":"themes/matery/source/medias/banner/4.jpg","hash":"e5ac5033678afa9d69edffe9a61004f836cb5734","modified":1616498072669},{"_id":"themes/matery/source/libs/twikoo/twikoo.all.min.js","hash":"c3f5f0a69b7864e7ef5bbf99fc774bec37947d7c","modified":1616498072665},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-brands-400.svg","hash":"5e2d2a159294576bea69cc3360efb5ffe110ab2d","modified":1616498072645},{"_id":"themes/matery/source/libs/echarts/echarts.min.js","hash":"9496f386a0da4601cad22c479cc5543913a4d67f","modified":1616498072659},{"_id":"themes/matery/source/libs/awesome/webfonts/fa-solid-900.svg","hash":"7da88b19e1486f8c968d3cf5ab3f194f01ea17fd","modified":1616498072652},{"_id":"public/baidusitemap.xml","hash":"98319f3fbc33bd48a9db6cae1ba0e16e12afeeb1","modified":1622967293464},{"_id":"public/atom.xml","hash":"17286ced4b513f8fd59bb0e90a864272e61cba4d","modified":1622967293464},{"_id":"public/search.xml","hash":"2b51f0855d9c1ef63d91f94baefb50774857e834","modified":1622967293464},{"_id":"public/sitemap.xml","hash":"b38b1899c4e096ab8c271fd3a8de7ce33c88dd5b","modified":1622967293464},{"_id":"public/404.html","hash":"8e303879fc449372b9d00be5bfa0558b4888dc6c","modified":1622967293464},{"_id":"public/about/index.html","hash":"58a6cfb49e07e2f9a2bb6d7ceef7308cfc64bed6","modified":1622967293464},{"_id":"public/contact/index.html","hash":"fa8f69e36570ffb5f2197625a6c492d360c8f33f","modified":1622967293464},{"_id":"public/categories/index.html","hash":"9aa93200eb55d0a038a9f93f42af7a78ee65f523","modified":1622967293464},{"_id":"public/friends/index.html","hash":"6fcf7f03cae0352f5f89da3d9f1bafb96f4f7c09","modified":1622967293464},{"_id":"public/tags/index.html","hash":"c8bd3610707db06d203490105d9048bc55c08c5b","modified":1622967293464},{"_id":"public/2021/06/06/advanced-tutorial-of-vue-vite-typescript/index.html","hash":"d8d70eebb8bedc028099a18893a049a37f0a71ae","modified":1622967293464},{"_id":"public/2021/06/05/use-custom-snippets-in-vim/index.html","hash":"1f65337130fd34a8ae534697aceb6e220aa1c829","modified":1622967293464},{"_id":"public/2021/06/04/create-tauri-project-with-vue-typescript-less-vite/index.html","hash":"5f42675c34eab5e0480e212a886db4e14d0f1474","modified":1622967293464},{"_id":"public/2021/06/03/spartan-edge-accelerator-board-tutorial/index.html","hash":"8f59764ca36fe794358519b6f5306b72f576d1bb","modified":1622967293464},{"_id":"public/2021/05/17/basic-tutorial-of-vue-vite-typescript/index.html","hash":"9da02596f1a644f71a9eeb1760471328a0c4be61","modified":1622967293464},{"_id":"public/2021/05/15/create-vue3-project/index.html","hash":"1ddedf89f9d1b478a7ead5daf65daf1c4c174307","modified":1622967293464},{"_id":"public/2021/05/15/use-realvnc-on-manjaro-on-rpi4/index.html","hash":"06ffdebd02ab286df3a316e74403f2e461f6d28e","modified":1622967293464},{"_id":"public/2021/05/15/install-manjaro-on-rpi4/index.html","hash":"6fd18a02151015ea987caab3dc64a32573fbad2f","modified":1622967293464},{"_id":"public/2021/05/11/rust-tauri-hello-world/index.html","hash":"55e1632f57a86678d5c2ea6e82b68994327fc0e4","modified":1622967293464},{"_id":"public/2021/04/28/better-highlight-for-go-files-in-vim/index.html","hash":"02262356810391b14260811ce8b947e190f522b1","modified":1622967293464},{"_id":"public/2021/04/24/better-use-of-rust-on-gentoo/index.html","hash":"fef6153a99475963613fc400bc2167a967514ebd","modified":1622967293464},{"_id":"public/2021/04/18/vim-file-encoding/index.html","hash":"99fb69189d55eb74ae24d55f6f1028eae0fea800","modified":1622967293464},{"_id":"public/2021/04/17/vim-quickfix/index.html","hash":"3e41b02664a074bf912cda22675bf8b5d2d9158a","modified":1622967293464},{"_id":"public/2021/03/23/install-rpm-deb-packages-on-gentoo/index.html","hash":"af76b13860dc33b9e5d040c7f483db99868aa5fa","modified":1622967293464},{"_id":"public/2021/03/23/debug-msp430g2-project-on-linux/index.html","hash":"10f3daad65ab588a4a1449754d46e5c395f642c3","modified":1622967293464},{"_id":"public/2021/03/23/build-aarch64-cross-toolchain-on-gentoo-with-crossdev/index.html","hash":"bbd9399ef1ed1ac2f6c90d25997c93c553c59b3a","modified":1622967293464},{"_id":"public/2021/03/23/develop-stm32-project-with-rust/index.html","hash":"d3d1c645582421790ec1808bbc7016431ea75357","modified":1622967293464},{"_id":"public/2021/03/23/install-oracle-jdk-and-jre-on-gentoo/index.html","hash":"5b41102d557814bca37ebe4e764ee6750ab8941f","modified":1622967293464},{"_id":"public/2021/03/23/vim-fuzzy-search-plugin/index.html","hash":"820d364365d9b80643b7d018e876cf6c41e5a6b1","modified":1622967293464},{"_id":"public/2021/03/23/vim-clipboard-history-plugin/index.html","hash":"a76081a3160344ae3d4ada5e274d3c2c6e621c60","modified":1622967293464},{"_id":"public/2021/03/23/vim-markdown-preview-plugin/index.html","hash":"4352dd6744874ab335e4f04f5798081ad43582fc","modified":1622967293464},{"_id":"public/2021/03/23/use-vim-as-the-editor-of-systemverilog/index.html","hash":"96c36b5e3d4cf18b196493822aaa3c3012cca91b","modified":1622967293464},{"_id":"public/2020/10/20/vim-debugging-scheme/index.html","hash":"f3e4d5e595b4dc696df348d55002ca11718f7434","modified":1622967293464},{"_id":"public/2020/10/19/vim-shortcut-key-management/index.html","hash":"e4208013d25f9fd8df599dc5b33fb3354dfc7a67","modified":1622967293464},{"_id":"public/2020/10/19/vim-plugin-management/index.html","hash":"1c00c2f8fce995e93bc95b67433c34309746fb8d","modified":1622967293464},{"_id":"public/2020/10/19/vim-tagbar/index.html","hash":"d071e3e0a4b243112ab96d0dd0b96b95436234af","modified":1622967293464},{"_id":"public/2020/10/19/vim-file-tree/index.html","hash":"dfd774f8327418907ac9e0344997cac295102c80","modified":1622967293464},{"_id":"public/2020/10/19/vim-automatic-completion/index.html","hash":"090c2cb78ef9cbb40b7d5715a8e2919fdaeeb807","modified":1622967293464},{"_id":"public/2020/10/18/browse-and-save-files-that-require-root-permissions-in-neovim/index.html","hash":"9d2b0f46315a65ca6054df5999d9dc178815f150","modified":1622967293464},{"_id":"public/2020/08/08/gentoo-system-further-improvement/index.html","hash":"2dc5824e2fdcd5921318ba3dea8368ca1dd07642","modified":1622967293464},{"_id":"public/2020/08/08/gentoo-kool-desktop-environment-installation/index.html","hash":"93b2bb9b978e0c047fca1514d9174bb60a61f73c","modified":1622967293464},{"_id":"public/2020/08/07/gentoo-basic-system-installation/index.html","hash":"ca766bf4ff3ec7b10fb32a43d5800a0e49441586","modified":1622967293464},{"_id":"public/2020/08/06/gentoo-tutorials-directory/index.html","hash":"29b2f2fb96ca24b0aceb0f69497348112bacd688","modified":1622967293464},{"_id":"public/2020/08/06/vim-preface/index.html","hash":"a0c2153adc76fbc1dc73803971df2c93683e483c","modified":1622967293464},{"_id":"public/2020/08/06/gentoo-compile-error-handling/index.html","hash":"c244423872a7e442c2feab10b50edc5d5a44f9d7","modified":1622967293464},{"_id":"public/2020/08/05/gentoo-compiler-selection/index.html","hash":"d45537c12ba067b34aff22fd69734c1bf69f6d1e","modified":1622967293464},{"_id":"public/2020/08/05/gentoo-package-management/index.html","hash":"cc9a1ee8b74f2d05edee8e4e136820a33a430ca8","modified":1622967293464},{"_id":"public/2020/08/04/vim-markdown-latex/index.html","hash":"37075b8e9c1d578053c5f15366a8478b8765a8a6","modified":1622967293464},{"_id":"public/2020/08/04/gentoo-preface/index.html","hash":"bcbce4ce9de8b72021f8971ed20b7191d535341c","modified":1622967293464},{"_id":"public/archives/index.html","hash":"c1084d42757f633091e8c9ea740a5cea443429a6","modified":1622967293464},{"_id":"public/archives/page/2/index.html","hash":"f71c2e6166b82e01c626f4196662301999669595","modified":1622967293464},{"_id":"public/archives/page/3/index.html","hash":"ec229743b2cbe7bddfaf6f6ebe9fcb5b69b5ce74","modified":1622967293464},{"_id":"public/archives/page/4/index.html","hash":"9e3c18608e64a41604d142da31343ca46a31833d","modified":1622967293464},{"_id":"public/archives/2020/index.html","hash":"cf35172fca98e384ac0c6ecd25d302bbc3a21350","modified":1622967293464},{"_id":"public/archives/2020/page/2/index.html","hash":"032a3aea997883594b690bdc3d2305071fd21126","modified":1622967293464},{"_id":"public/archives/2020/08/index.html","hash":"defae58dd580777a26882db1c2e65cb699eebba3","modified":1622967293464},{"_id":"public/archives/2020/10/index.html","hash":"ded89e883ed165c2b0e263d90b789ae79183dbef","modified":1622967293464},{"_id":"public/archives/2021/index.html","hash":"0d1b83b2d4289f9e6d502f31e69eaaa3bd2d86b6","modified":1622967293464},{"_id":"public/archives/2021/page/2/index.html","hash":"6d06bc3539b45013a338b8ec14d18cf98e32168b","modified":1622967293464},{"_id":"public/archives/2021/03/index.html","hash":"8be4f3195ad32a144fce29aed44262fb767049c9","modified":1622967293464},{"_id":"public/archives/2021/04/index.html","hash":"6e9c4afe3a730cb1a4382cb2ebc1ed0903726503","modified":1622967293464},{"_id":"public/archives/2021/05/index.html","hash":"d74ce2558d8b159d90fb801c8c48ef48f3f82f87","modified":1622967293464},{"_id":"public/archives/2021/06/index.html","hash":"707ab9d1bf64ab819b37bc61654b85505167a494","modified":1622967293464},{"_id":"public/categories/Vim/index.html","hash":"4eb9d95db4bc4d14947416265a5e209609d0d828","modified":1622967293464},{"_id":"public/categories/Vim/page/2/index.html","hash":"6c23dfbf1b29c63f1b288826eee7563774badb8c","modified":1622967293464},{"_id":"public/categories/Vue/index.html","hash":"b184a20a18fdac26344424ae3dc0a01ab4771c76","modified":1622967293464},{"_id":"public/categories/Gentoo/index.html","hash":"dd302bf3b3c3b04561e320a0df44cf4748c73777","modified":1622967293464},{"_id":"public/categories/Rust/index.html","hash":"6a6879ee0593a941d74de1a357ef8bc6acc9791b","modified":1622967293464},{"_id":"public/categories/Embedded/index.html","hash":"53bd35a4d7a61492d7353de89b5e6e27dbe568a3","modified":1622967293464},{"_id":"public/categories/Raspberry-Pi/index.html","hash":"93a1a579fe6b9b8753ca190e864b30824e8550ac","modified":1622967293464},{"_id":"public/index.html","hash":"302da8e59c54bf5438eb952df5cf1b2bd88a11f9","modified":1622967293464},{"_id":"public/page/2/index.html","hash":"26bb7ab7ba9fd4a2504f308aced77168a8a031c8","modified":1622967293464},{"_id":"public/page/3/index.html","hash":"78738351a050e9a99983e70c8a2f49bd59512614","modified":1622967293464},{"_id":"public/page/4/index.html","hash":"567d989e9144734a7b725f15e9af6566f78d68cd","modified":1622967293464},{"_id":"public/tags/Vim/index.html","hash":"20cfbf60133bbeba9ff94880ec1935aa2360ea29","modified":1622967293464},{"_id":"public/tags/Vim/page/2/index.html","hash":"4b00676ca87e52c2966fa9b57204ceb4f5b36568","modified":1622967293464},{"_id":"public/tags/Vue/index.html","hash":"4870ba7d1529387fb96ff95c4cf93c744b0dd831","modified":1622967293464},{"_id":"public/tags/Vite/index.html","hash":"b5e92b5e0641bb2b18c8093ba13a839856a976fb","modified":1622967293464},{"_id":"public/tags/Typescript/index.html","hash":"09979cf9b4fb9aa7d9f726c825e91fda91300cc2","modified":1622967293464},{"_id":"public/tags/Gentoo/index.html","hash":"02c7487412d47af58a8108f411bc5c4c97f4e148","modified":1622967293464},{"_id":"public/tags/Tauri/index.html","hash":"deb0119d709cd4e16a7e609f513a88f8e2641b21","modified":1622967293464},{"_id":"public/tags/Less/index.html","hash":"e57171bbca77279e4cfb2d39000b937aa47f574e","modified":1622967293464},{"_id":"public/tags/MSP430G2/index.html","hash":"99d3bfa999f38eb8548f89dddf8a50ee5eab35fa","modified":1622967293464},{"_id":"public/tags/Linux/index.html","hash":"b376f7eac5dc819b4aca4350341c2c09e3ff2a4a","modified":1622967293464},{"_id":"public/tags/Rust/index.html","hash":"43250f9d5aeafd5d110fef521a81be1fbdafaa22","modified":1622967293464},{"_id":"public/tags/Stm32/index.html","hash":"e32427fc2f65af4abeb1d5478a6c78184272b2d5","modified":1622967293464},{"_id":"public/tags/Raspberry-Pi/index.html","hash":"8e073e0feafb1112d63865b991e3ed077178d292","modified":1622967293464},{"_id":"public/tags/Manjaro/index.html","hash":"7db6244221db0ce3dda7a63cbea4db7f039d4131","modified":1622967293464},{"_id":"public/tags/Java/index.html","hash":"257fab8be86f3ee00970d94c3ddd7d78dcf3b852","modified":1622967293464},{"_id":"public/tags/Oracle/index.html","hash":"559c18ce94de047b3346a3d32eaf339e8eff3b43","modified":1622967293464},{"_id":"public/tags/FPGA/index.html","hash":"621a725f25b1c0b77e2e8f185ba4c6d5c4a22465","modified":1622967293464},{"_id":"public/tags/Arduino/index.html","hash":"876897d71d95f77d8fa104c18467767f3a6dc2c4","modified":1622967293464},{"_id":"public/tags/Realvnc/index.html","hash":"6bb3806075e07c2f53e5bdcb163eb425ce718472","modified":1622967293464},{"_id":"public/tags/Latex/index.html","hash":"aac5bf29f21e3fc51fbb54415cf6e219f33f73ed","modified":1622967293464},{"_id":"public/tags/Markdown/index.html","hash":"3a5c5ac79df8bb47b7a973d85b1a7ac9fe41213d","modified":1622967293464},{"_id":"public/CNAME","hash":"7257c0821e59bd23023d2e5755357a5befc85f13","modified":1622967293464},{"_id":"public/medias/avatar.jpg","hash":"6262562f49af87ee516f69d8272819090b6e77e8","modified":1622967293464},{"_id":"public/medias/comment_bg.png","hash":"dfc93d24081884fbc58cab0f8fd19e77d31d6123","modified":1622967293464},{"_id":"public/medias/icp.png","hash":"27a96f31f7d0413c6ade6f40e06f021f501151c7","modified":1622967293464},{"_id":"public/medias/favicon.png","hash":"634a88eb94f5abcffc8569a1e9ddcfd4cf351c64","modified":1622967293464},{"_id":"public/medias/logo.png","hash":"16334e905b89a98d17d7fe65b9cfc11d3f487525","modified":1622967293464},{"_id":"public/libs/twikoo/twikoo.all.min.js.LICENSE.txt","hash":"1e286a31ef472fb864fe2b9502e87df9242df56b","modified":1622967293464},{"_id":"public/medias/featureimages/10.jpg","hash":"98e7f6fd9c97d4de9044b6871ca08ebf14db11b9","modified":1622967293464},{"_id":"public/medias/featureimages/13.jpg","hash":"35a320174f8e316e3eadaec658024276b651c6e9","modified":1622967293464},{"_id":"public/medias/featureimages/15.jpg","hash":"da0fbee3b7bde1607eace377ddf834c0be99edfe","modified":1622967293464},{"_id":"public/medias/featureimages/16.jpg","hash":"97a829c4bc94f9d2929b20a1a9b798c57b9f7205","modified":1622967293464},{"_id":"public/medias/featureimages/2.jpg","hash":"4bba691cf71a517ecaeaf42afd3e8f8b31e346c1","modified":1622967293464},{"_id":"public/medias/featureimages/21.jpg","hash":"b26edb128bb0bf58b23fd2f014e9555e89a2ca3b","modified":1622967293464},{"_id":"public/medias/featureimages/22.jpg","hash":"754579747a3e99747d890fca3162f370b96a7941","modified":1622967293464},{"_id":"public/medias/featureimages/23.jpg","hash":"7d7f37da3fa7128343adac23866449eb2c6a549a","modified":1622967293464},{"_id":"public/medias/featureimages/3.jpg","hash":"6ec646c2a70f5f11edacf225c1477f2200a37a96","modified":1622967293464},{"_id":"public/medias/featureimages/5.jpg","hash":"41ca20129a37fedc573eec28dd7d7b9e5b09228a","modified":1622967293464},{"_id":"public/medias/featureimages/7.jpg","hash":"7975141cd64e875122c0ea33daaca1a06bf00b8e","modified":1622967293464},{"_id":"public/medias/featureimages/8.jpg","hash":"8e4b7186352085483ca1174c7c0800114c48df8b","modified":1622967293464},{"_id":"public/medias/reward/alipay.jpg","hash":"1abc719b95d1b26f1f898e6b0a9b7609146e332f","modified":1622967293464},{"_id":"public/medias/reward/wechat.png","hash":"fe93385aa92fe328e01c8221a80b039be9e4e140","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-regular-400.eot","hash":"439c8afd3373acb4a73135a34e220464a89cd5e2","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-regular-400.ttf","hash":"0f4bd02942a54a6b3200d9078adff88c2812e751","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-regular-400.woff","hash":"59439d3ad31d856d78ec3e2bd9f1eafa2c7a581c","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-regular-400.woff2","hash":"f6f653b4ea8fc487bdb590d39d5a726258a55f40","modified":1622967293464},{"_id":"public/libs/lightGallery/fonts/lg.eot","hash":"54caf05a81e33d7bf04f2e420736ce6f1de5f936","modified":1622967293464},{"_id":"public/libs/lightGallery/fonts/lg.ttf","hash":"f6421c0c397311ae09f9257aa58bcd5e9720f493","modified":1622967293464},{"_id":"public/libs/lightGallery/fonts/lg.svg","hash":"9c6632aeec67d3e84a1434884aa801514ff8103b","modified":1622967293464},{"_id":"public/libs/lightGallery/fonts/lg.woff","hash":"3048de344dd5cad4624e0127e58eaae4b576f574","modified":1622967293464},{"_id":"public/libs/lightGallery/img/loading.gif","hash":"15a76af2739482d8de7354abc6d8dc4fca8d145e","modified":1622967293464},{"_id":"public/libs/lightGallery/img/video-play.png","hash":"2962e03ddbe04d7e201a5acccac531a2bbccddfc","modified":1622967293464},{"_id":"public/libs/lightGallery/img/vimeo-play.png","hash":"9b72fc0f86a01467ed0b68c9cc4d604ec316d517","modified":1622967293464},{"_id":"public/libs/lightGallery/img/youtube-play.png","hash":"f8d11384d33b7a79ee2ba8d522844f14d5067a80","modified":1622967293464},{"_id":"public/libs/share/fonts/iconfont.svg","hash":"1d56c9d5db0273f07c43cc1397e440f98ba7827a","modified":1622967293464},{"_id":"public/libs/share/fonts/iconfont.eot","hash":"00ff749c8e202401190cc98d56087cdda716abe4","modified":1622967293464},{"_id":"public/libs/share/fonts/iconfont.ttf","hash":"afd898f59d363887418669520b24d175f966a083","modified":1622967293464},{"_id":"public/libs/share/fonts/iconfont.woff","hash":"2e3fce1dcfbd6e2114e7bfbeaf72d3c62e15a1bd","modified":1622967293464},{"_id":"public/2020/08/07/gentoo-basic-system-installation/1.png","hash":"9876d487b6f6926159cc894531d71c6e0890aa20","modified":1622967293464},{"_id":"public/2020/08/07/gentoo-basic-system-installation/2.png","hash":"effb90b8e9f83398724e8a3a415b319f7adda409","modified":1622967293464},{"_id":"public/2020/08/07/gentoo-basic-system-installation/3.png","hash":"030a4e86fde14342cfe3009b4379fc7052258fbe","modified":1622967293464},{"_id":"public/2020/08/05/gentoo-package-management/2.png","hash":"7191ab865c25c8c104f650177ab6fd864a9cea4a","modified":1622967293464},{"_id":"public/2021/05/15/install-manjaro-on-rpi4/3.png","hash":"16c5e82436a9cced715a8fc7b66bb193ae5b2525","modified":1622967293464},{"_id":"public/2020/10/19/vim-shortcut-key-management/1.png","hash":"3c890a163cc47885bce9c3fee5d4a9076e530cc2","modified":1622967293464},{"_id":"public/medias/banner/0.jpg","hash":"69ec96cd9b4bc3aa631adc9da61353f50c39f031","modified":1622967293464},{"_id":"public/medias/banner/2.jpg","hash":"39fb2535460ce66cc0b34e07ffb9411db1405f09","modified":1622967293464},{"_id":"public/medias/banner/3.jpg","hash":"4ac047e92d0363b1a61ab756aca6dac13fb77494","modified":1622967293464},{"_id":"public/medias/featureimages/0.jpg","hash":"1c3300f029fc85d6dda6fa4f1d699551034cdaf7","modified":1622967293464},{"_id":"public/medias/featureimages/1.jpg","hash":"684ae89de8cb7acefae19f5aee6c612037c46393","modified":1622967293464},{"_id":"public/medias/featureimages/11.jpg","hash":"f55972ce7175684f2b11c3c9fc2b5b14bccbfae8","modified":1622967293464},{"_id":"public/medias/featureimages/12.jpg","hash":"8a4b2e7d92ae95c3b0c921db23c35aa9a41a7d58","modified":1622967293464},{"_id":"public/medias/featureimages/14.jpg","hash":"38e11221406785bcd93aa9cd23e568e164630ef1","modified":1622967293464},{"_id":"public/medias/featureimages/17.jpg","hash":"42d47903551ee81885c1386022982cae165841c5","modified":1622967293464},{"_id":"public/medias/featureimages/18.jpg","hash":"64829272ec85bb819d55ff89e5b5fd6f64aa436b","modified":1622967293464},{"_id":"public/medias/featureimages/19.jpg","hash":"eb250906fdbc0c408f42ae9933725bc1a05d79fb","modified":1622967293464},{"_id":"public/medias/featureimages/20.jpg","hash":"3b11f9b461168d907073f793190865fe621a8573","modified":1622967293464},{"_id":"public/medias/featureimages/4.jpg","hash":"e06c47de27619984be9d5d02947f8370a432dfea","modified":1622967293464},{"_id":"public/medias/featureimages/6.jpg","hash":"c8f2aa4bbb041158b4e73733a341e6a77c8583f7","modified":1622967293464},{"_id":"public/medias/featureimages/9.jpg","hash":"b956a2291a04b2132366b53666cf34858b8bdb1f","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-brands-400.eot","hash":"22f9e7d5226408eb2d0a11e118257a3ca22b8670","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-brands-400.ttf","hash":"91cbeeaceb644a971241c08362898599d6d968ce","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-brands-400.woff","hash":"18838f5260317da3c5ed29bf844ac8a4f7ad0529","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-brands-400.woff2","hash":"a46bd47ff0a90b812aafafda587d095cdb844271","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-solid-900.woff","hash":"92803b8753ceda573c6906774677c5a7081d2fbb","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-solid-900.woff2","hash":"9c081b88b106c6c04ecb895ba7ba7d3dcb3b55ac","modified":1622967293464},{"_id":"public/2021/05/17/basic-tutorial-of-vue-vite-typescript/1.png","hash":"25c27d87e0bf086c56f194ff8a10751f038ea518","modified":1622967293464},{"_id":"public/2020/08/05/gentoo-package-management/1.png","hash":"ed96f4c4d92572f15403cc9be75252932be93812","modified":1622967293464},{"_id":"public/2020/08/05/gentoo-package-management/3.png","hash":"fc7ad697702568ba3df4e7875545c24b28052aef","modified":1622967293464},{"_id":"public/2020/08/04/gentoo-preface/1.png","hash":"87d58781f1eccfda78711055543de2f613ed99af","modified":1622967293464},{"_id":"public/css/bb.css","hash":"aa15633888c7cf9baea8bb48d796c68b57cf14bf","modified":1622967293464},{"_id":"public/css/gitment.css","hash":"2bd15cc17dca35ac3ecc0acf167a23a1dd362acd","modified":1622967293464},{"_id":"public/css/my-gitalk.css","hash":"af18dd29e58642c18bab9b89541767b494c468dd","modified":1622967293464},{"_id":"public/css/my.css","hash":"497e50351f7838f8546cac76850a42e7e380a110","modified":1622967293464},{"_id":"public/js/matery.js","hash":"b86de5fe3e9766b7ff80df12ea41c3a9e30825f7","modified":1622967293464},{"_id":"public/js/search.js","hash":"e1482406c58ea2a0eb178d7e4efb2c879cdddc80","modified":1622967293464},{"_id":"public/libs/aos/aos.js","hash":"02bfb40b0c4b6e9b0b4081218357145cbb327d74","modified":1622967293464},{"_id":"public/libs/aplayer/APlayer.min.css","hash":"07372a2ba507388d0fed166d761b1c2c2a659dce","modified":1622967293464},{"_id":"public/libs/background/canvas-nest.js","hash":"65333d0dbb9c1173a1b13031b230161fc42c8b2f","modified":1622967293464},{"_id":"public/libs/background/ribbon-dynamic.js","hash":"052b80c29e6bc585aa28d4504b743bdbac220a88","modified":1622967293464},{"_id":"public/libs/background/ribbon-refresh.min.js","hash":"6d98692b2cad8c746a562db18b170b35c24402f4","modified":1622967293464},{"_id":"public/libs/background/ribbon.min.js","hash":"6a99d494c030388f96f6086a7aaa0f03f3fe532e","modified":1622967293464},{"_id":"public/libs/codeBlock/codeBlockFuction.js","hash":"c7ab06d27a525b15b1eb69027135269e9b9132fb","modified":1622967293464},{"_id":"public/libs/codeBlock/codeCopy.js","hash":"6d39a766af62e625f177c4d5cf3adc35eed71e61","modified":1622967293464},{"_id":"public/libs/codeBlock/codeLang.js","hash":"bac88b4d4e3679732d29bd037c34f089cf27cf05","modified":1622967293464},{"_id":"public/libs/codeBlock/codeShrink.js","hash":"201e8cd761b4be557247bdaf1ebc7c11c83194f6","modified":1622967293464},{"_id":"public/libs/instantpage/instantpage.js","hash":"83ce8919b1a69b2f1809ffaf99b52a8627e650e9","modified":1622967293464},{"_id":"public/libs/jqcloud/jqcloud-1.0.4.min.js","hash":"257eaae3020599e4939f50d5008a743827f25b8c","modified":1622967293464},{"_id":"public/libs/jqcloud/jqcloud.css","hash":"20d9f11a19d95c70e27cb922e0d6dccbec4eae89","modified":1622967293464},{"_id":"public/libs/minivaline/MiniValine.js","hash":"f7f6cdc1b22297e02334e304444e9a8351acb455","modified":1622967293464},{"_id":"public/libs/others/busuanzi.pure.mini.js","hash":"6e41f31100ae7eb3a6f23f2c168f6dd56e7f7a9a","modified":1622967293464},{"_id":"public/libs/others/clicklove.js","hash":"6a39b8c683ba5dcd92f70c6ab45d1cfac3213e8e","modified":1622967293464},{"_id":"public/libs/prism/prism.css","hash":"62e5474893dece076534352f564ceabd6e088a5a","modified":1622967293464},{"_id":"public/libs/scrollprogress/scrollProgress.min.js","hash":"777ffe5d07e85a14fbe97d846f45ffc0087251cc","modified":1622967293464},{"_id":"public/libs/tocbot/tocbot.css","hash":"9ab8ef576c9a57115194152e79cca79b0a41dd70","modified":1622967293464},{"_id":"public/libs/tocbot/tocbot.min.js","hash":"5ec27317f0270b8cf6b884c6f12025700b9a565c","modified":1622967293464},{"_id":"public/libs/share/css/share.min.css","hash":"8a778a86f3ce9a042df6be63a9f1039631e351a5","modified":1622967293464},{"_id":"public/css/matery.css","hash":"a630f6e8643904073dce9eada57b5c16c4dba5e2","modified":1622967293464},{"_id":"public/libs/animate/animate.min.css","hash":"97afa151569f046b2e01f27c1871646e9cd87caf","modified":1622967293464},{"_id":"public/libs/aos/aos.css","hash":"191a3705a8f63e589a50a0ff2f2c5559f1a1b6b2","modified":1622967293464},{"_id":"public/libs/aplayer/APlayer.min.js","hash":"22caa28ff6b41a16ff40f15d38f1739e22359478","modified":1622967293464},{"_id":"public/libs/cryptojs/crypto-js.min.js","hash":"5989527a378b55011a59522f41eeb3981518325c","modified":1622967293464},{"_id":"public/libs/gitalk/gitalk.css","hash":"940ded3ea12c2fe1ab0820d2831ec405f3f1fe9f","modified":1622967293464},{"_id":"public/libs/dplayer/DPlayer.min.css","hash":"f7d19655f873b813ffba5d1a17145c91f82631b8","modified":1622967293464},{"_id":"public/libs/gitment/gitment-default.css","hash":"2903c59ee06b965bef32e937bd69f5b0b2190717","modified":1622967293464},{"_id":"public/libs/gitment/gitment.js","hash":"28c02c45ce568e084cd1041dc493f83f9c6c88c6","modified":1622967293464},{"_id":"public/libs/dplayer/DPlayer.min.js","hash":"c3bad7b265574fab0ae4d45867422ea1cb9d6599","modified":1622967293464},{"_id":"public/libs/masonry/masonry.pkgd.min.js","hash":"ff940b4ea68368ca0e4d5560cbb79fb147dfc3c5","modified":1622967293464},{"_id":"public/libs/jquery/jquery.min.js","hash":"2115753ca5fb7032aec498db7bb5dca624dbe6be","modified":1622967293464},{"_id":"public/libs/gitalk/gitalk.min.js","hash":"8fefe38f28804f90116bdcb74a0875c9de9f3b7d","modified":1622967293464},{"_id":"public/libs/materialize/materialize.min.css","hash":"a69d456e3345e7f59cd0d47d1b3e70fd4a496a05","modified":1622967293464},{"_id":"public/libs/valine/Valine.min.js","hash":"6cbdbf91e1f046dd41267a5ff0691a1fccba99df","modified":1622967293464},{"_id":"public/libs/materialize/materialize.min.js","hash":"c8b4c65651921d888cf5f27430dfe2ad190d35bf","modified":1622967293464},{"_id":"public/libs/valine/av-min.js","hash":"541efb9edc1ce425cbe3897cfc25803211fe6a05","modified":1622967293464},{"_id":"public/libs/lightGallery/css/lightgallery.min.css","hash":"1b7227237f9785c66062a4811508916518e4132c","modified":1622967293464},{"_id":"public/libs/lightGallery/js/lightgallery-all.min.js","hash":"9f5ef4bc8a0a3c746ca4f3c3e6d64493b1a977d8","modified":1622967293464},{"_id":"public/libs/awesome/css/all.css","hash":"ecc41e32ad2696877a1656749841f3b5543bbe3d","modified":1622967293464},{"_id":"public/libs/share/js/social-share.min.js","hash":"a3090a02786dcd4efc6355c1c1dc978add8d6827","modified":1622967293464},{"_id":"public/libs/share/js/jquery.share.min.js","hash":"41367dcb857e02e3c417ebe68a554ce1d4430806","modified":1622967293464},{"_id":"public/libs/twikoo/twikoo.all.min.js","hash":"c3f5f0a69b7864e7ef5bbf99fc774bec37947d7c","modified":1622967293464},{"_id":"public/medias/banner/1.jpg","hash":"ab122a36998a4f62a61e61a4fc5e00248113413b","modified":1622967293464},{"_id":"public/medias/banner/5.jpg","hash":"852418f4f09e796e12bc3bab7a1488d3f37d6486","modified":1622967293464},{"_id":"public/medias/banner/6.jpg","hash":"d4957ff7cc5e88555cd840f2956ab0561e6f1ccf","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-regular-400.svg","hash":"3d3a49445343d80f3b553e3e3425b9a7bd49acaf","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-solid-900.eot","hash":"cab8e84ae5682d1d556e234df9c790985888def8","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-solid-900.ttf","hash":"9521ed12274c2cbc910cea77657116fcf6545da3","modified":1622967293464},{"_id":"public/2021/05/15/install-manjaro-on-rpi4/2.png","hash":"afea3fbe78c9e5df281215c7ec67153281dc4ff5","modified":1622967293464},{"_id":"public/libs/echarts/echarts.min.js","hash":"9496f386a0da4601cad22c479cc5543913a4d67f","modified":1622967293464},{"_id":"public/2021/05/15/install-manjaro-on-rpi4/1.png","hash":"b67018d5dd3a0e1ee69efa424e8592a9bb5e36f6","modified":1622967293464},{"_id":"public/medias/banner/4.jpg","hash":"e5ac5033678afa9d69edffe9a61004f836cb5734","modified":1622967293464},{"_id":"public/2021/04/17/vim-quickfix/1.png","hash":"57090f4b91bf5bb179a6b8b8a87d3485401938a7","modified":1622967293464},{"_id":"public/2021/06/03/spartan-edge-accelerator-board-tutorial/1.png","hash":"5e17abc272a5440e033a882207382e473e9aa00d","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-brands-400.svg","hash":"5e2d2a159294576bea69cc3360efb5ffe110ab2d","modified":1622967293464},{"_id":"public/libs/awesome/webfonts/fa-solid-900.svg","hash":"7da88b19e1486f8c968d3cf5ab3f194f01ea17fd","modified":1622967293464}],"Category":[{"name":"Vim","_id":"ckpkwtmr50004rriz3unk4x3f"},{"name":"Vue","_id":"ckpkwtmrc000crriz27ho3xfk"},{"name":"Gentoo","_id":"ckpkwtmrk000prrizfobx8q3y"},{"name":"Rust","_id":"ckpkwtmrq0011rriz6ol6bdra"},{"name":"Embedded","_id":"ckpkwtmrv001arriz5yfca8to"},{"name":"Raspberry Pi","_id":"ckpkwtms4001srriz33r3fy74"}],"Data":[{"_id":"friends","data":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}],"Page":[{"title":"404","date":"2020-05-14T02:45:11.000Z","type":"404","layout":"404","description":"你来到了没有知识的荒原 ","_content":"","source":"404.md","raw":"---\ntitle: 404\ndate: 2020-05-14 10:45:11\ntype: \"404\"\nlayout: \"404\"\ndescription: \"你来到了没有知识的荒原 \"\n---\n","updated":"2021-03-23T11:11:18.575Z","path":"404.html","comments":1,"_id":"ckpkwtmqu0000rrizhnlr6za9","content":"","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":""},{"title":"about","date":"2020-08-04T01:35:33.000Z","type":"about","layout":"about","_content":"","source":"about/index.md","raw":"---\ntitle: about\ndate: 2020-08-04 09:35:33\ntype: \"about\"\nlayout: \"about\"\n---\n","updated":"2021-03-23T11:11:18.585Z","path":"about/index.html","comments":1,"_id":"ckpkwtmr30002rriz5oehgane","content":"","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":""},{"title":"contact","date":"2020-08-06T06:13:21.000Z","type":"contact","layout":"contact","_content":"","source":"contact/index.md","raw":"---\ntitle: contact\ndate: 2020-08-06 14:13:21\ntype: \"contact\"\nlayout: \"contact\"\n---\n","updated":"2021-03-23T11:11:18.585Z","path":"contact/index.html","comments":1,"_id":"ckpkwtmr70006rrizft5x1etd","content":"","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":""},{"title":"categories","date":"2020-08-04T01:33:49.000Z","type":"categories","layout":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2020-08-04 09:33:49\ntype: \"categories\"\nlayout: \"categories\"\n---\n","updated":"2021-03-23T11:11:18.585Z","path":"categories/index.html","comments":1,"_id":"ckpkwtmr90008rrizgjzx7ela","content":"","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":""},{"title":"friends","date":"2020-08-06T06:32:26.000Z","type":"friends","layout":"friends","_content":"","source":"friends/index.md","raw":"---\ntitle: friends\ndate: 2020-08-06 14:32:26\ntype: \"friends\"\nlayout: \"friends\"\n---\n","updated":"2021-03-23T11:11:18.585Z","path":"friends/index.html","comments":1,"_id":"ckpkwtmrb000arriz3w96h5hp","content":"","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":""},{"title":"tags","date":"2020-08-06T06:31:28.000Z","type":"tags","layout":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2020-08-06 14:31:28\ntype: \"tags\"\nlayout: \"tags\"\n---\n","updated":"2021-03-23T11:11:18.585Z","path":"tags/index.html","comments":1,"_id":"ckpkwtmrd000frrizhpez5tcc","content":"","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":""}],"Post":[{"title":"Browse and Save Files that Require Root Permissions In Neovim","date":"2020-10-18T13:14:07.000Z","_content":"\n# Neovim浏览及保存需要root权限的文件\n\n## vim保存时获取root权限\n\nvim可以在保存文件时使用`:w !  sudo  tee  %`获取权限。但neovim暂不支持该命令，或者说无法输入密码。\n\n## 解决方案\n\n安装[`suda.vim`插件](https://github.com/lambdalisue/suda.vim)。\n\n接着在`init.vim`设置`let g:suda_smart_edit = 1`即可。插件会自动检测文件权限。当保存需要权限时，会自动提示输入密码。\n","source":"_posts/Browse-and-save-files-that-require-root-permissions-in-neovim.md","raw":"---\ntitle: Browse and Save Files that Require Root Permissions In Neovim\ndate: 2020-10-18 21:14:07\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# Neovim浏览及保存需要root权限的文件\n\n## vim保存时获取root权限\n\nvim可以在保存文件时使用`:w !  sudo  tee  %`获取权限。但neovim暂不支持该命令，或者说无法输入密码。\n\n## 解决方案\n\n安装[`suda.vim`插件](https://github.com/lambdalisue/suda.vim)。\n\n接着在`init.vim`设置`let g:suda_smart_edit = 1`即可。插件会自动检测文件权限。当保存需要权限时，会自动提示输入密码。\n","slug":"Browse-and-save-files-that-require-root-permissions-in-neovim","published":1,"updated":"2021-03-23T11:11:18.575Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmqy0001rriz0t6na5tz","content":"<h1 id=\"Neovim浏览及保存需要root权限的文件\"><a href=\"#Neovim浏览及保存需要root权限的文件\" class=\"headerlink\" title=\"Neovim浏览及保存需要root权限的文件\"></a>Neovim浏览及保存需要root权限的文件</h1><h2 id=\"vim保存时获取root权限\"><a href=\"#vim保存时获取root权限\" class=\"headerlink\" title=\"vim保存时获取root权限\"></a>vim保存时获取root权限</h2><p>vim可以在保存文件时使用<code>:w !  sudo  tee  %</code>获取权限。但neovim暂不支持该命令，或者说无法输入密码。</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>安装<a href=\"https://github.com/lambdalisue/suda.vim\"><code>suda.vim</code>插件</a>。</p>\n<p>接着在<code>init.vim</code>设置<code>let g:suda_smart_edit = 1</code>即可。插件会自动检测文件权限。当保存需要权限时，会自动提示输入密码。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"Neovim浏览及保存需要root权限的文件\"><a href=\"#Neovim浏览及保存需要root权限的文件\" class=\"headerlink\" title=\"Neovim浏览及保存需要root权限的文件\"></a>Neovim浏览及保存需要root权限的文件</h1><h2 id=\"vim保存时获取root权限\"><a href=\"#vim保存时获取root权限\" class=\"headerlink\" title=\"vim保存时获取root权限\"></a>vim保存时获取root权限</h2><p>vim可以在保存文件时使用<code>:w !  sudo  tee  %</code>获取权限。但neovim暂不支持该命令，或者说无法输入密码。</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>安装<a href=\"https://github.com/lambdalisue/suda.vim\"><code>suda.vim</code>插件</a>。</p>\n<p>接着在<code>init.vim</code>设置<code>let g:suda_smart_edit = 1</code>即可。插件会自动检测文件权限。当保存需要权限时，会自动提示输入密码。</p>\n"},{"title":"Advanced Tutorial of Vue-Vite-Typescript","date":"2021-06-06T08:04:22.000Z","_content":"\n# Advanced Tutorial of Vue-Vite-Typescript\n\nThe following are the notes I took when I studied vue with reference to the official tutorial. The biggest difference between my notes and official tutorial is that I use typescript while the tutorial uses javascript. I suggest you learn vue following the official tutorial , but I firmly believe that you need to know some of the differences in the use of ts and js.\n\nAnd please forgive my stiff English, I was just too lazy to switch input methods.\n\n## Component\n\nThe default root component is `src/App.vue`. The custom components should be placed in `src/components`.\n\nAll components would be mounted in `src/main.ts`.\n\nNext you will learn the process of defining and using custom components\n\n### Define and use custom components\n\nFirst, we will create a new file in `src/components`. The content should look like this.\n\n```vue\n<template>\n  {{ msg }}\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nexport default defineComponent({\n  name: \"HelloWorld\",\n  data() {\n    return {\n      msg: \"hello\",\n    };\n  },\n});\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nNow we have defined a component named `HelloWorld`.\n\nNext, we need to import it in `src/main.ts`.\n\n```typescript\nimport { createApp } from \"vue\";\nimport HelloWorld from \"./components/HelloWorld.vue\";\n// import HelloWorld\n// `HelloWorld` is not necessary to be the name of the component\n```\n\nThen, you can declare a mount point in `index.html`.\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <link rel=\"icon\" href=\"/favicon.ico\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>Vite App</title>\n  </head>\n  <body>\n    <!-- the mount point is declared here -->\n    <div id=\"test\"></div>\n    <script type=\"module\" src=\"/src/main.ts\"></script>\n  </body>\n</html>\n```\n\nFinally, you need to mount the component to the mount point. Continue to write in `src/main.ts`.\n\n```typescript\ncreateApp(HelloWorld).mount(\"#test\");\n```\n\nThe components can also be defined and used in a simple way. For example, the code may look like this.\n\n```typescript\nconst app = Vue.createApp({})\napp.component('button-counter', {\n  data() {\n    return {\n      count: 0\n    }\n  },\n  template: `\n    <button @click=\"count++\">\n      You clicked me {{ count }} times.\n    </button>`t\n})\n```\n\nAnd you can simply reuse the components by add labels like this.\n\n```html\n<div id=\"components-demo\">\n  <button-counter></button-counter>\n</div>\n```\n\nThe `div` with id `components-demo` contains a pair of labels with a name which is the same as the component.\n\n### Component registration\n\nComponents registered like this can be used globally. That means all components, including root component and child components can use these components.\n\n```typescript\nconst app = Vue.createApp({});\n\napp.component(\"component-a\", {\n  /* ... */\n});\napp.component(\"component-b\", {\n  /* ... */\n});\napp.component(\"component-c\", {\n  /* ... */\n});\n\napp.mount(\"#app\");\n```\n\n```html\n<div id=\"app\">\n  <component-a></component-a>\n  <component-b></component-b>\n  <component-c></component-c>\n</div>\n```\n\nComponents registered like this can only be used locally. That means only the root component can use these components.\n\n```typescript\nimport ComponentA from \"./ComponentA.vue\";\nimport ComponentB from \"./ComponentB.vue\";\nconst app = Vue.createApp({\n  components: {\n    \"component-a\": ComponentA,\n    \"component-b\": ComponentB,\n  },\n});\n```\n\nThe code below is the same.\n\n```typescript\nimport ComponentA from \"./ComponentA.vue\";\nimport ComponentB from \"./ComponentB.vue\";\nconst app = Vue.createApp({});\napp.component(\"component-a\", ComponentA);\napp.component(\"component-b\", ComponentB);\n```\n\nIf you want to use ComponentA in ComponentB. You need to do like this.\n\n```typescript\nComponentB.component(\"component-a\", ComponentA);\n```\n\n### Interact with child components\n\n#### Passing data to child components\n\nIn order to pass data to child components, we need to modify `src/components/HelloWorld.vue` like this.\n\n```vue\n<template>\n  {{ msg }}\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nexport default defineComponent({\n  name: \"HelloWorld\",\n  props: [\"msg\"],\n});\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nIn the above code, we use `props` instead of `data`. Any value passed to a prop attribute will become a property on that component instance. And after a property is registered, we can pass data to it as a custom html attribute like this.\n\n```html\n<div id=\"test\">\n  <HelloWorld msg=\"hello world\"></HelloWorld>\n</div>\n```\n\nNow, you can launch the project and watch the result in a broswer. But soon, you will find there is nothing displaying on the broswer. The reason is that our component has an uppercase name. We difined an uppercase name in our project but something changed it to a lowercase name when it finally arrived at broswer. So use a lowercase name is enough to fix the error.\n\nNow, our code looks like this.\n\n```vue\n<template>\n  {{ msg }}\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nexport default defineComponent({\n  name: \"hello-world\",\n  props: [\"msg\"],\n});\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\n```html\n<div id=\"test\">\n  <hello-world msg=\"hello world\"></hello-world>\n</div>\n```\n\n```typescript\nimport { createApp } from \"vue\";\nimport HelloWorld from \"./components/HelloWorld.vue\";\n\nconst app = createApp({});\napp.component(\"hello-world\", HelloWorld);\napp.mount(\"#test\");\n```\n\nThen we can try a more complicated demo.\n\n```typescript\nimport { createApp } from \"vue\";\nconst App = {\n  data() {\n    return {\n      posts: [\n        { id: 1, title: \"My journey with Vue\" },\n        { id: 2, title: \"Blogging with Vue\" },\n        { id: 3, title: \"Why Vue is so fun\" },\n      ],\n    };\n  },\n};\n\nconst app = createApp(App);\n\napp.component(\"blog-post\", {\n  props: [\"title\"],\n  template: `<h4>{{ title }}</h4>`,\n});\n\napp.mount(\"#blog-posts-demo\");\n```\n\n```html\n<div id=\"blog-posts-demo\">\n  <blog-post\n    v-for=\"post in posts\"\n    :key=\"post.id\"\n    :title=\"post.title\"\n  ></blog-post>\n</div>\n```\n\nThere is still something which you need to notice. For an instance, see the code below.\n\n```vue\n<!-- src/components/Demo.vue -->\n<template>\n  {{ msg }}\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"demo\",\n  props: [\"msg\"],\n});\n</script>\n```\n\n```typescript\n/* src/main.ts */\nimport { createApp } from \"vue\";\nimport App from \"./App.vue\";\nimport EnlargeText from \"./components/EnlargeText.vue\";\n\nconst app = createApp(App);\napp.component(\"enlarge-text\", EnlargeText);\napp.mount(\"#app\");\n```\n\n```vue\n<!-- src/App.vue -->\n<template>\n  <div>hello</div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"App\",\n});\n</script>\n\n<style lang=\"less\"></style>\n```\n\n```\n<!-- index.html -->\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <title>Vite App</title>\n  </head>\n  <body>\n    <div id=\"app\">\n      <demo msg=\"world\"></demo>\n    </div>\n    <script type=\"module\" src=\"/src/main.ts\"></script>\n  </body>\n</html>\n```\n\nIn this example, we define templates in both main component and child component. And we try to display them in `index.html` together. But something would happen to the template of the child component. It is covered by the template of the main component. Take care of this problem. And if you really want to show them together, you can move `<demo msg=\"world\"></demo>` from `index.html` to main component's template.\n\n#### Listening to the events of child components\n\nLet's ceate a new file named `Demo.vue` in `src/components`.\n\nFirst, we modify `src/components/Demo.vue` like this.\n\n```vue\n<template>\n  <div>\n    <h4>\n      {{ title }}\n    </h4>\n    <button @click=\"$emit('enlargeText')\">Enlarge text</button>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"demo\",\n  props: [\"title\"],\n  emits: [\"enlargeText\"],\n});\n</script>\n```\n\nIn this file, we define an event of child component called `enlargeText` with `emits`. And we bind this to the button click event. Once the button is clicked, the super component will receive this event.\n\nThen, we modify `src/App.vue` like this.\n\n```vue\n<template>\n  <div>\n    <demo\n      :style=\"{ fontSize: postFontSize + 'em' }\"\n      @enlarge-text=\"postFontSize += 0.1\"\n      title=\"hello\"\n    ></demo>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport Demo from \"./components/Demo.vue\";\n\nexport default defineComponent({\n  data() {\n    return {\n      postFontSize: 1,\n    };\n  },\n  components: { Demo },\n});\n</script>\n```\n\nIn this file, we define the mount point of the child component `Demo`. And we set its style with a variable `postFontSize`. Also, we define the response function for `enlarge-text` event. And finally, we import `Demo` from `Demo.vue` and register it as a clild component.\n\nBe careful that `enlarge-text` is different from the event we defined in the child component called `enlargeText`. Although, `enlargeText` is also worked here, the broswer will interpret any uppercase characters as lowercase. So you'd better use `enlarge-text`.\n\nSince we have imported the child component in `src/App.vue`, the `src/main.ts` becomes more simple.\n\n```typescript\nimport { createApp } from \"vue\";\nimport App from \"./App.vue\";\n\nconst app = createApp(App);\napp.mount(\"#app\");\n```\n\nNow you can run your project and check the result in your broswer.\n\nIf you are careful enough, you would find that `emits` is similar to `props`. `props` passes data to super component and `emits` passes event to super component.\n\n##### Emit a value with an event\n\nTo go futher, I will introduce you how to emit a value with an event.\n\nThe code would look like this.\n\n```vue\n<button @click=\"$emit('enlargeText', 0.1)\">\n  Enlarge text\n</button>\n```\n\nThen you can get the value with `$event`.\n\n```vue\n<demo\n  :style=\"{ fontSize: postFontSize + 'em' }\"\n  @enlarge-text=\"postFontSize += $event\"\n  title=\"hello\"\n></demo>\n```\n\nAnd if the event handler is a method, the value will be passed as the first parameter.\n\n```vue\n<demo\n  :style=\"{ fontSize: postFontSize + 'em' }\"\n  @enlarge-text=\"onEnlargeText\"\n  title=\"hello\"\n></demo>\n```\n\n```vue\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport Demo from \"./components/Demo.vue\";\n\nexport default defineComponent({\n  data() {\n    return {\n      postFontSize: 1,\n    };\n  },\n  components: { Demo },\n  methods: {\n    onEnlargeText(enlargeText: any) {\n      this.postFontSize += enlargeText;\n    },\n  },\n});\n</script>\n```\n\n##### Use v-model on components\n\n`src/App.vue`\n\n```vue\n<template>\n  <div>\n    <demo v-model=\"searchText\"></demo>\n    <!-- it's the same as the code below -->\n    <!-- <demo -->\n    <!-- :model-value=\"searchText\" -->\n    <!-- @update:model-value=\"searchText = $event\" -->\n    <!-- ></demo> -->\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport Demo from \"./components/Demo.vue\";\n\nexport default defineComponent({\n  components: { Demo },\n});\n</script>\n```\n\n`src/components/Demo.vue`\n\n```vue\n<template>\n  <div>\n    <input\n      :value=\"modelValue\"\n      @input=\"$emit('update:modelValue', $event.target.value)\"\n    />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"demo\",\n  props: [\"modelValue\"],\n  emits: [\"update:modelValue\"],\n});\n</script>\n```\n\nWith the code above, we have implemented a simple input function. We use `<demo v-model=\"searchText\"></demo>` to simply our code in this example. The key point is you need to bind some properties in child components before using `v-model`.\n\nThere is another way to define child components.\n\n```vue\n<template>\n  <div>\n    <input v-model=\"value\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"demo\",\n  props: [\"modelValue\"],\n  emits: [\"update:modelValue\"],\n  computed: {\n    value: {\n      get(): any {\n        return this.modelValue;\n      },\n      set(value: any) {\n        this.$emit(\"update:modelValue\", value);\n      },\n    },\n  },\n});\n</script>\n```\n\n### Content Distribution with slots\n\nThe name of the feature may be confusing, but the work is quite simple.\n\nThis feature means pass html content to a component. We have used this feature before.\n\n```vue\napp.component('alert-box', { template: `\n<div class=\"demo-alert-box\">\n      <strong>Error!</strong>\n      <slot></slot>\n    </div>\n` })\n```\n\n### Dynamic components\n\nIt's a feature to change components dynamicly when you swith to different tabs or other similar things, so that you can see different content.\n\nThe code is also simple. `<component :is=\"currentTabComponent\"></component>` is all you need. What you need to do is changing `currentTabComponent` when needed.\n\n### DOM template parsing caveats\n\nSome HTML elements, such as `<ul>`, `<ol>`, `<table>` and `<select>` have restrictions on what elements can appear inside them, and some elements such as `<li>`, `<tr>`, and `<option>` can only appear inside certain other elements.\n\nFor example:\n\n```html\n<table>\n  <demo></demo>\n</table>\n```\n\nThe custom component `<demo>` cannot be inside a pair of `<table>` label. To fix the error, you can use `v-is` with a allowed label instead.\n\n```html\n<table>\n  <tr v-is=\"'demo'\"></tr>\n</table>\n```\n\nAlso, HTML attribute names are case-insensitive, so browsers will interpret any uppercase characters as lowercase. That means when you’re using in-DOM templates, camelCased prop names and event handler parameters need to use their kebab-cased (hyphen-delimited) equivalents. This has been mentioned before.\n\nIt should be noted that these limitations do not apply if you are using string templates from one of the following sources:\n\n- String templates (e.g. `template: '...'`)\n- Single-file (`.vue`) components\n- `<script type=\"text/x-template\">`\n\n## Summary\n\nThe most basic part of vue ends here, you are already be able to build some simple vue applications with this knowladge. To go futher, you can continue to learn more syntactic sugar following the [official tutorial](https://v3.vuejs.org/guide/installation.html). It won't be difficult for you.\n","source":"_posts/advanced-tutorial-of-vue-vite-typescript.md","raw":"---\ntitle: Advanced Tutorial of Vue-Vite-Typescript\ndate: 2021-06-06 16:04:22\ntags:\n  - Vue\n  - Vite\n  - Typescript\ncategories:\n  - Vue\n---\n\n# Advanced Tutorial of Vue-Vite-Typescript\n\nThe following are the notes I took when I studied vue with reference to the official tutorial. The biggest difference between my notes and official tutorial is that I use typescript while the tutorial uses javascript. I suggest you learn vue following the official tutorial , but I firmly believe that you need to know some of the differences in the use of ts and js.\n\nAnd please forgive my stiff English, I was just too lazy to switch input methods.\n\n## Component\n\nThe default root component is `src/App.vue`. The custom components should be placed in `src/components`.\n\nAll components would be mounted in `src/main.ts`.\n\nNext you will learn the process of defining and using custom components\n\n### Define and use custom components\n\nFirst, we will create a new file in `src/components`. The content should look like this.\n\n```vue\n<template>\n  {{ msg }}\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nexport default defineComponent({\n  name: \"HelloWorld\",\n  data() {\n    return {\n      msg: \"hello\",\n    };\n  },\n});\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nNow we have defined a component named `HelloWorld`.\n\nNext, we need to import it in `src/main.ts`.\n\n```typescript\nimport { createApp } from \"vue\";\nimport HelloWorld from \"./components/HelloWorld.vue\";\n// import HelloWorld\n// `HelloWorld` is not necessary to be the name of the component\n```\n\nThen, you can declare a mount point in `index.html`.\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <link rel=\"icon\" href=\"/favicon.ico\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>Vite App</title>\n  </head>\n  <body>\n    <!-- the mount point is declared here -->\n    <div id=\"test\"></div>\n    <script type=\"module\" src=\"/src/main.ts\"></script>\n  </body>\n</html>\n```\n\nFinally, you need to mount the component to the mount point. Continue to write in `src/main.ts`.\n\n```typescript\ncreateApp(HelloWorld).mount(\"#test\");\n```\n\nThe components can also be defined and used in a simple way. For example, the code may look like this.\n\n```typescript\nconst app = Vue.createApp({})\napp.component('button-counter', {\n  data() {\n    return {\n      count: 0\n    }\n  },\n  template: `\n    <button @click=\"count++\">\n      You clicked me {{ count }} times.\n    </button>`t\n})\n```\n\nAnd you can simply reuse the components by add labels like this.\n\n```html\n<div id=\"components-demo\">\n  <button-counter></button-counter>\n</div>\n```\n\nThe `div` with id `components-demo` contains a pair of labels with a name which is the same as the component.\n\n### Component registration\n\nComponents registered like this can be used globally. That means all components, including root component and child components can use these components.\n\n```typescript\nconst app = Vue.createApp({});\n\napp.component(\"component-a\", {\n  /* ... */\n});\napp.component(\"component-b\", {\n  /* ... */\n});\napp.component(\"component-c\", {\n  /* ... */\n});\n\napp.mount(\"#app\");\n```\n\n```html\n<div id=\"app\">\n  <component-a></component-a>\n  <component-b></component-b>\n  <component-c></component-c>\n</div>\n```\n\nComponents registered like this can only be used locally. That means only the root component can use these components.\n\n```typescript\nimport ComponentA from \"./ComponentA.vue\";\nimport ComponentB from \"./ComponentB.vue\";\nconst app = Vue.createApp({\n  components: {\n    \"component-a\": ComponentA,\n    \"component-b\": ComponentB,\n  },\n});\n```\n\nThe code below is the same.\n\n```typescript\nimport ComponentA from \"./ComponentA.vue\";\nimport ComponentB from \"./ComponentB.vue\";\nconst app = Vue.createApp({});\napp.component(\"component-a\", ComponentA);\napp.component(\"component-b\", ComponentB);\n```\n\nIf you want to use ComponentA in ComponentB. You need to do like this.\n\n```typescript\nComponentB.component(\"component-a\", ComponentA);\n```\n\n### Interact with child components\n\n#### Passing data to child components\n\nIn order to pass data to child components, we need to modify `src/components/HelloWorld.vue` like this.\n\n```vue\n<template>\n  {{ msg }}\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nexport default defineComponent({\n  name: \"HelloWorld\",\n  props: [\"msg\"],\n});\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nIn the above code, we use `props` instead of `data`. Any value passed to a prop attribute will become a property on that component instance. And after a property is registered, we can pass data to it as a custom html attribute like this.\n\n```html\n<div id=\"test\">\n  <HelloWorld msg=\"hello world\"></HelloWorld>\n</div>\n```\n\nNow, you can launch the project and watch the result in a broswer. But soon, you will find there is nothing displaying on the broswer. The reason is that our component has an uppercase name. We difined an uppercase name in our project but something changed it to a lowercase name when it finally arrived at broswer. So use a lowercase name is enough to fix the error.\n\nNow, our code looks like this.\n\n```vue\n<template>\n  {{ msg }}\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nexport default defineComponent({\n  name: \"hello-world\",\n  props: [\"msg\"],\n});\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\n```html\n<div id=\"test\">\n  <hello-world msg=\"hello world\"></hello-world>\n</div>\n```\n\n```typescript\nimport { createApp } from \"vue\";\nimport HelloWorld from \"./components/HelloWorld.vue\";\n\nconst app = createApp({});\napp.component(\"hello-world\", HelloWorld);\napp.mount(\"#test\");\n```\n\nThen we can try a more complicated demo.\n\n```typescript\nimport { createApp } from \"vue\";\nconst App = {\n  data() {\n    return {\n      posts: [\n        { id: 1, title: \"My journey with Vue\" },\n        { id: 2, title: \"Blogging with Vue\" },\n        { id: 3, title: \"Why Vue is so fun\" },\n      ],\n    };\n  },\n};\n\nconst app = createApp(App);\n\napp.component(\"blog-post\", {\n  props: [\"title\"],\n  template: `<h4>{{ title }}</h4>`,\n});\n\napp.mount(\"#blog-posts-demo\");\n```\n\n```html\n<div id=\"blog-posts-demo\">\n  <blog-post\n    v-for=\"post in posts\"\n    :key=\"post.id\"\n    :title=\"post.title\"\n  ></blog-post>\n</div>\n```\n\nThere is still something which you need to notice. For an instance, see the code below.\n\n```vue\n<!-- src/components/Demo.vue -->\n<template>\n  {{ msg }}\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"demo\",\n  props: [\"msg\"],\n});\n</script>\n```\n\n```typescript\n/* src/main.ts */\nimport { createApp } from \"vue\";\nimport App from \"./App.vue\";\nimport EnlargeText from \"./components/EnlargeText.vue\";\n\nconst app = createApp(App);\napp.component(\"enlarge-text\", EnlargeText);\napp.mount(\"#app\");\n```\n\n```vue\n<!-- src/App.vue -->\n<template>\n  <div>hello</div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"App\",\n});\n</script>\n\n<style lang=\"less\"></style>\n```\n\n```\n<!-- index.html -->\n<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <title>Vite App</title>\n  </head>\n  <body>\n    <div id=\"app\">\n      <demo msg=\"world\"></demo>\n    </div>\n    <script type=\"module\" src=\"/src/main.ts\"></script>\n  </body>\n</html>\n```\n\nIn this example, we define templates in both main component and child component. And we try to display them in `index.html` together. But something would happen to the template of the child component. It is covered by the template of the main component. Take care of this problem. And if you really want to show them together, you can move `<demo msg=\"world\"></demo>` from `index.html` to main component's template.\n\n#### Listening to the events of child components\n\nLet's ceate a new file named `Demo.vue` in `src/components`.\n\nFirst, we modify `src/components/Demo.vue` like this.\n\n```vue\n<template>\n  <div>\n    <h4>\n      {{ title }}\n    </h4>\n    <button @click=\"$emit('enlargeText')\">Enlarge text</button>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"demo\",\n  props: [\"title\"],\n  emits: [\"enlargeText\"],\n});\n</script>\n```\n\nIn this file, we define an event of child component called `enlargeText` with `emits`. And we bind this to the button click event. Once the button is clicked, the super component will receive this event.\n\nThen, we modify `src/App.vue` like this.\n\n```vue\n<template>\n  <div>\n    <demo\n      :style=\"{ fontSize: postFontSize + 'em' }\"\n      @enlarge-text=\"postFontSize += 0.1\"\n      title=\"hello\"\n    ></demo>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport Demo from \"./components/Demo.vue\";\n\nexport default defineComponent({\n  data() {\n    return {\n      postFontSize: 1,\n    };\n  },\n  components: { Demo },\n});\n</script>\n```\n\nIn this file, we define the mount point of the child component `Demo`. And we set its style with a variable `postFontSize`. Also, we define the response function for `enlarge-text` event. And finally, we import `Demo` from `Demo.vue` and register it as a clild component.\n\nBe careful that `enlarge-text` is different from the event we defined in the child component called `enlargeText`. Although, `enlargeText` is also worked here, the broswer will interpret any uppercase characters as lowercase. So you'd better use `enlarge-text`.\n\nSince we have imported the child component in `src/App.vue`, the `src/main.ts` becomes more simple.\n\n```typescript\nimport { createApp } from \"vue\";\nimport App from \"./App.vue\";\n\nconst app = createApp(App);\napp.mount(\"#app\");\n```\n\nNow you can run your project and check the result in your broswer.\n\nIf you are careful enough, you would find that `emits` is similar to `props`. `props` passes data to super component and `emits` passes event to super component.\n\n##### Emit a value with an event\n\nTo go futher, I will introduce you how to emit a value with an event.\n\nThe code would look like this.\n\n```vue\n<button @click=\"$emit('enlargeText', 0.1)\">\n  Enlarge text\n</button>\n```\n\nThen you can get the value with `$event`.\n\n```vue\n<demo\n  :style=\"{ fontSize: postFontSize + 'em' }\"\n  @enlarge-text=\"postFontSize += $event\"\n  title=\"hello\"\n></demo>\n```\n\nAnd if the event handler is a method, the value will be passed as the first parameter.\n\n```vue\n<demo\n  :style=\"{ fontSize: postFontSize + 'em' }\"\n  @enlarge-text=\"onEnlargeText\"\n  title=\"hello\"\n></demo>\n```\n\n```vue\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport Demo from \"./components/Demo.vue\";\n\nexport default defineComponent({\n  data() {\n    return {\n      postFontSize: 1,\n    };\n  },\n  components: { Demo },\n  methods: {\n    onEnlargeText(enlargeText: any) {\n      this.postFontSize += enlargeText;\n    },\n  },\n});\n</script>\n```\n\n##### Use v-model on components\n\n`src/App.vue`\n\n```vue\n<template>\n  <div>\n    <demo v-model=\"searchText\"></demo>\n    <!-- it's the same as the code below -->\n    <!-- <demo -->\n    <!-- :model-value=\"searchText\" -->\n    <!-- @update:model-value=\"searchText = $event\" -->\n    <!-- ></demo> -->\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport Demo from \"./components/Demo.vue\";\n\nexport default defineComponent({\n  components: { Demo },\n});\n</script>\n```\n\n`src/components/Demo.vue`\n\n```vue\n<template>\n  <div>\n    <input\n      :value=\"modelValue\"\n      @input=\"$emit('update:modelValue', $event.target.value)\"\n    />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"demo\",\n  props: [\"modelValue\"],\n  emits: [\"update:modelValue\"],\n});\n</script>\n```\n\nWith the code above, we have implemented a simple input function. We use `<demo v-model=\"searchText\"></demo>` to simply our code in this example. The key point is you need to bind some properties in child components before using `v-model`.\n\nThere is another way to define child components.\n\n```vue\n<template>\n  <div>\n    <input v-model=\"value\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\n\nexport default defineComponent({\n  name: \"demo\",\n  props: [\"modelValue\"],\n  emits: [\"update:modelValue\"],\n  computed: {\n    value: {\n      get(): any {\n        return this.modelValue;\n      },\n      set(value: any) {\n        this.$emit(\"update:modelValue\", value);\n      },\n    },\n  },\n});\n</script>\n```\n\n### Content Distribution with slots\n\nThe name of the feature may be confusing, but the work is quite simple.\n\nThis feature means pass html content to a component. We have used this feature before.\n\n```vue\napp.component('alert-box', { template: `\n<div class=\"demo-alert-box\">\n      <strong>Error!</strong>\n      <slot></slot>\n    </div>\n` })\n```\n\n### Dynamic components\n\nIt's a feature to change components dynamicly when you swith to different tabs or other similar things, so that you can see different content.\n\nThe code is also simple. `<component :is=\"currentTabComponent\"></component>` is all you need. What you need to do is changing `currentTabComponent` when needed.\n\n### DOM template parsing caveats\n\nSome HTML elements, such as `<ul>`, `<ol>`, `<table>` and `<select>` have restrictions on what elements can appear inside them, and some elements such as `<li>`, `<tr>`, and `<option>` can only appear inside certain other elements.\n\nFor example:\n\n```html\n<table>\n  <demo></demo>\n</table>\n```\n\nThe custom component `<demo>` cannot be inside a pair of `<table>` label. To fix the error, you can use `v-is` with a allowed label instead.\n\n```html\n<table>\n  <tr v-is=\"'demo'\"></tr>\n</table>\n```\n\nAlso, HTML attribute names are case-insensitive, so browsers will interpret any uppercase characters as lowercase. That means when you’re using in-DOM templates, camelCased prop names and event handler parameters need to use their kebab-cased (hyphen-delimited) equivalents. This has been mentioned before.\n\nIt should be noted that these limitations do not apply if you are using string templates from one of the following sources:\n\n- String templates (e.g. `template: '...'`)\n- Single-file (`.vue`) components\n- `<script type=\"text/x-template\">`\n\n## Summary\n\nThe most basic part of vue ends here, you are already be able to build some simple vue applications with this knowladge. To go futher, you can continue to learn more syntactic sugar following the [official tutorial](https://v3.vuejs.org/guide/installation.html). It won't be difficult for you.\n","slug":"advanced-tutorial-of-vue-vite-typescript","published":1,"updated":"2021-06-06T08:06:37.654Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmr40003rrizcig78ws7","content":"<h1 id=\"Advanced-Tutorial-of-Vue-Vite-Typescript\"><a href=\"#Advanced-Tutorial-of-Vue-Vite-Typescript\" class=\"headerlink\" title=\"Advanced Tutorial of Vue-Vite-Typescript\"></a>Advanced Tutorial of Vue-Vite-Typescript</h1><p>The following are the notes I took when I studied vue with reference to the official tutorial. The biggest difference between my notes and official tutorial is that I use typescript while the tutorial uses javascript. I suggest you learn vue following the official tutorial , but I firmly believe that you need to know some of the differences in the use of ts and js.</p>\n<p>And please forgive my stiff English, I was just too lazy to switch input methods.</p>\n<h2 id=\"Component\"><a href=\"#Component\" class=\"headerlink\" title=\"Component\"></a>Component</h2><p>The default root component is <code>src/App.vue</code>. The custom components should be placed in <code>src/components</code>.</p>\n<p>All components would be mounted in <code>src/main.ts</code>.</p>\n<p>Next you will learn the process of defining and using custom components</p>\n<h3 id=\"Define-and-use-custom-components\"><a href=\"#Define-and-use-custom-components\" class=\"headerlink\" title=\"Define and use custom components\"></a>Define and use custom components</h3><p>First, we will create a new file in <code>src/components</code>. The content should look like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; msg &#125;&#125;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nexport default defineComponent(&#123;\n  name: &quot;HelloWorld&quot;,\n  data() &#123;\n    return &#123;\n      msg: &quot;hello&quot;,\n    &#125;;\n  &#125;,\n&#125;);\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Now we have defined a component named <code>HelloWorld</code>.</p>\n<p>Next, we need to import it in <code>src/main.ts</code>.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> HelloWorld <span class=\"token keyword\">from</span> <span class=\"token string\">\"./components/HelloWorld.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// import HelloWorld</span>\n<span class=\"token comment\">// `HelloWorld` is not necessary to be the name of the component</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Then, you can declare a mount point in <code>index.html</code>.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>icon<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/favicon.ico<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1.0<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Vite App<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token comment\">&lt;!-- the mount point is declared here --></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>module<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/src/main.ts<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Finally, you need to mount the component to the mount point. Continue to write in <code>src/main.ts</code>.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span>HelloWorld<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>The components can also be defined and used in a simple way. For example, the code may look like this.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button-counter'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span>\n      count<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  template<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    &lt;button @click=\"count++\">\n      You clicked me &#123;&#123; count &#125;&#125; times.\n    &lt;/button></span><span class=\"token template-punctuation string\">`</span></span>t\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>And you can simply reuse the components by add labels like this.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>components-demo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button-counter</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button-counter</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>The <code>div</code> with id <code>components-demo</code> contains a pair of labels with a name which is the same as the component.</p>\n<h3 id=\"Component-registration\"><a href=\"#Component-registration\" class=\"headerlink\" title=\"Component registration\"></a>Component registration</h3><p>Components registered like this can be used globally. That means all components, including root component and child components can use these components.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-a\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token comment\">/* ... */</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-b\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token comment\">/* ... */</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-c\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token comment\">/* ... */</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>app<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>component-a</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>component-a</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>component-b</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>component-b</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>component-c</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>component-c</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Components registered like this can only be used locally. That means only the root component can use these components.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> ComponentA <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ComponentA.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ComponentB <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ComponentB.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  components<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token string\">\"component-a\"</span><span class=\"token operator\">:</span> ComponentA<span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"component-b\"</span><span class=\"token operator\">:</span> ComponentB<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>The code below is the same.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> ComponentA <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ComponentA.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ComponentB <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ComponentB.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-a\"</span><span class=\"token punctuation\">,</span> ComponentA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-b\"</span><span class=\"token punctuation\">,</span> ComponentB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>If you want to use ComponentA in ComponentB. You need to do like this.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">ComponentB<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-a\"</span><span class=\"token punctuation\">,</span> ComponentA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"Interact-with-child-components\"><a href=\"#Interact-with-child-components\" class=\"headerlink\" title=\"Interact with child components\"></a>Interact with child components</h3><h4 id=\"Passing-data-to-child-components\"><a href=\"#Passing-data-to-child-components\" class=\"headerlink\" title=\"Passing data to child components\"></a>Passing data to child components</h4><p>In order to pass data to child components, we need to modify <code>src/components/HelloWorld.vue</code> like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; msg &#125;&#125;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nexport default defineComponent(&#123;\n  name: &quot;HelloWorld&quot;,\n  props: [&quot;msg&quot;],\n&#125;);\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>In the above code, we use <code>props</code> instead of <code>data</code>. Any value passed to a prop attribute will become a property on that component instance. And after a property is registered, we can pass data to it as a custom html attribute like this.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>HelloWorld</span> <span class=\"token attr-name\">msg</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hello world<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>HelloWorld</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>Now, you can launch the project and watch the result in a broswer. But soon, you will find there is nothing displaying on the broswer. The reason is that our component has an uppercase name. We difined an uppercase name in our project but something changed it to a lowercase name when it finally arrived at broswer. So use a lowercase name is enough to fix the error.</p>\n<p>Now, our code looks like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; msg &#125;&#125;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nexport default defineComponent(&#123;\n  name: &quot;hello-world&quot;,\n  props: [&quot;msg&quot;],\n&#125;);\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hello-world</span> <span class=\"token attr-name\">msg</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hello world<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>hello-world</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> HelloWorld <span class=\"token keyword\">from</span> <span class=\"token string\">\"./components/HelloWorld.vue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello-world\"</span><span class=\"token punctuation\">,</span> HelloWorld<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Then we can try a more complicated demo.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> App <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span>\n      posts<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">&#123;</span> id<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">:</span> <span class=\"token string\">\"My journey with Vue\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#123;</span> id<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">:</span> <span class=\"token string\">\"Blogging with Vue\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#123;</span> id<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">:</span> <span class=\"token string\">\"Why Vue is so fun\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span>App<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"blog-post\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  props<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  template<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;h4>&#123;&#123; title &#125;&#125;&lt;/h4></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#blog-posts-demo\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blog-posts-demo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>blog-post</span>\n    <span class=\"token attr-name\">v-for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post in posts<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">:key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post.id<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">:title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post.title<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>blog-post</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>There is still something which you need to notice. For an instance, see the code below.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;!-- src&#x2F;components&#x2F;Demo.vue --&gt;\n&lt;template&gt;\n  &#123;&#123; msg &#125;&#125;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\n\nexport default defineComponent(&#123;\n  name: &quot;demo&quot;,\n  props: [&quot;msg&quot;],\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token comment\">/* src/main.ts */</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">\"./App.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> EnlargeText <span class=\"token keyword\">from</span> <span class=\"token string\">\"./components/EnlargeText.vue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span>App<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"enlarge-text\"</span><span class=\"token punctuation\">,</span> EnlargeText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;!-- src&#x2F;App.vue --&gt;\n&lt;template&gt;\n  &lt;div&gt;hello&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\n\nexport default defineComponent(&#123;\n  name: &quot;App&quot;,\n&#125;);\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot;&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;!-- index.html --&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html lang&#x3D;&quot;en&quot;&gt;\n  &lt;head&gt;\n    &lt;meta charset&#x3D;&quot;UTF-8&quot; &#x2F;&gt;\n    &lt;title&gt;Vite App&lt;&#x2F;title&gt;\n  &lt;&#x2F;head&gt;\n  &lt;body&gt;\n    &lt;div id&#x3D;&quot;app&quot;&gt;\n      &lt;demo msg&#x3D;&quot;world&quot;&gt;&lt;&#x2F;demo&gt;\n    &lt;&#x2F;div&gt;\n    &lt;script type&#x3D;&quot;module&quot; src&#x3D;&quot;&#x2F;src&#x2F;main.ts&quot;&gt;&lt;&#x2F;script&gt;\n  &lt;&#x2F;body&gt;\n&lt;&#x2F;html&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>In this example, we define templates in both main component and child component. And we try to display them in <code>index.html</code> together. But something would happen to the template of the child component. It is covered by the template of the main component. Take care of this problem. And if you really want to show them together, you can move <code>&lt;demo msg=&quot;world&quot;&gt;&lt;/demo&gt;</code> from <code>index.html</code> to main component’s template.</p>\n<h4 id=\"Listening-to-the-events-of-child-components\"><a href=\"#Listening-to-the-events-of-child-components\" class=\"headerlink\" title=\"Listening to the events of child components\"></a>Listening to the events of child components</h4><p>Let’s ceate a new file named <code>Demo.vue</code> in <code>src/components</code>.</p>\n<p>First, we modify <code>src/components/Demo.vue</code> like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;h4&gt;\n      &#123;&#123; title &#125;&#125;\n    &lt;&#x2F;h4&gt;\n    &lt;button @click&#x3D;&quot;$emit(&#39;enlargeText&#39;)&quot;&gt;Enlarge text&lt;&#x2F;button&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\n\nexport default defineComponent(&#123;\n  name: &quot;demo&quot;,\n  props: [&quot;title&quot;],\n  emits: [&quot;enlargeText&quot;],\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>In this file, we define an event of child component called <code>enlargeText</code> with <code>emits</code>. And we bind this to the button click event. Once the button is clicked, the super component will receive this event.</p>\n<p>Then, we modify <code>src/App.vue</code> like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;demo\n      :style&#x3D;&quot;&#123; fontSize: postFontSize + &#39;em&#39; &#125;&quot;\n      @enlarge-text&#x3D;&quot;postFontSize +&#x3D; 0.1&quot;\n      title&#x3D;&quot;hello&quot;\n    &gt;&lt;&#x2F;demo&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nimport Demo from &quot;.&#x2F;components&#x2F;Demo.vue&quot;;\n\nexport default defineComponent(&#123;\n  data() &#123;\n    return &#123;\n      postFontSize: 1,\n    &#125;;\n  &#125;,\n  components: &#123; Demo &#125;,\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>In this file, we define the mount point of the child component <code>Demo</code>. And we set its style with a variable <code>postFontSize</code>. Also, we define the response function for <code>enlarge-text</code> event. And finally, we import <code>Demo</code> from <code>Demo.vue</code> and register it as a clild component.</p>\n<p>Be careful that <code>enlarge-text</code> is different from the event we defined in the child component called <code>enlargeText</code>. Although, <code>enlargeText</code> is also worked here, the broswer will interpret any uppercase characters as lowercase. So you’d better use <code>enlarge-text</code>.</p>\n<p>Since we have imported the child component in <code>src/App.vue</code>, the <code>src/main.ts</code> becomes more simple.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">\"./App.vue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span>App<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Now you can run your project and check the result in your broswer.</p>\n<p>If you are careful enough, you would find that <code>emits</code> is similar to <code>props</code>. <code>props</code> passes data to super component and <code>emits</code> passes event to super component.</p>\n<h5 id=\"Emit-a-value-with-an-event\"><a href=\"#Emit-a-value-with-an-event\" class=\"headerlink\" title=\"Emit a value with an event\"></a>Emit a value with an event</h5><p>To go futher, I will introduce you how to emit a value with an event.</p>\n<p>The code would look like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;button @click&#x3D;&quot;$emit(&#39;enlargeText&#39;, 0.1)&quot;&gt;\n  Enlarge text\n&lt;&#x2F;button&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>Then you can get the value with <code>$event</code>.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;demo\n  :style&#x3D;&quot;&#123; fontSize: postFontSize + &#39;em&#39; &#125;&quot;\n  @enlarge-text&#x3D;&quot;postFontSize +&#x3D; $event&quot;\n  title&#x3D;&quot;hello&quot;\n&gt;&lt;&#x2F;demo&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>And if the event handler is a method, the value will be passed as the first parameter.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;demo\n  :style&#x3D;&quot;&#123; fontSize: postFontSize + &#39;em&#39; &#125;&quot;\n  @enlarge-text&#x3D;&quot;onEnlargeText&quot;\n  title&#x3D;&quot;hello&quot;\n&gt;&lt;&#x2F;demo&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nimport Demo from &quot;.&#x2F;components&#x2F;Demo.vue&quot;;\n\nexport default defineComponent(&#123;\n  data() &#123;\n    return &#123;\n      postFontSize: 1,\n    &#125;;\n  &#125;,\n  components: &#123; Demo &#125;,\n  methods: &#123;\n    onEnlargeText(enlargeText: any) &#123;\n      this.postFontSize +&#x3D; enlargeText;\n    &#125;,\n  &#125;,\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"Use-v-model-on-components\"><a href=\"#Use-v-model-on-components\" class=\"headerlink\" title=\"Use v-model on components\"></a>Use v-model on components</h5><p><code>src/App.vue</code></p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;demo v-model&#x3D;&quot;searchText&quot;&gt;&lt;&#x2F;demo&gt;\n    &lt;!-- it&#39;s the same as the code below --&gt;\n    &lt;!-- &lt;demo --&gt;\n    &lt;!-- :model-value&#x3D;&quot;searchText&quot; --&gt;\n    &lt;!-- @update:model-value&#x3D;&quot;searchText &#x3D; $event&quot; --&gt;\n    &lt;!-- &gt;&lt;&#x2F;demo&gt; --&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nimport Demo from &quot;.&#x2F;components&#x2F;Demo.vue&quot;;\n\nexport default defineComponent(&#123;\n  components: &#123; Demo &#125;,\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>src/components/Demo.vue</code></p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;input\n      :value&#x3D;&quot;modelValue&quot;\n      @input&#x3D;&quot;$emit(&#39;update:modelValue&#39;, $event.target.value)&quot;\n    &#x2F;&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\n\nexport default defineComponent(&#123;\n  name: &quot;demo&quot;,\n  props: [&quot;modelValue&quot;],\n  emits: [&quot;update:modelValue&quot;],\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>With the code above, we have implemented a simple input function. We use <code>&lt;demo v-model=&quot;searchText&quot;&gt;&lt;/demo&gt;</code> to simply our code in this example. The key point is you need to bind some properties in child components before using <code>v-model</code>.</p>\n<p>There is another way to define child components.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;input v-model&#x3D;&quot;value&quot; &#x2F;&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\n\nexport default defineComponent(&#123;\n  name: &quot;demo&quot;,\n  props: [&quot;modelValue&quot;],\n  emits: [&quot;update:modelValue&quot;],\n  computed: &#123;\n    value: &#123;\n      get(): any &#123;\n        return this.modelValue;\n      &#125;,\n      set(value: any) &#123;\n        this.$emit(&quot;update:modelValue&quot;, value);\n      &#125;,\n    &#125;,\n  &#125;,\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Content-Distribution-with-slots\"><a href=\"#Content-Distribution-with-slots\" class=\"headerlink\" title=\"Content Distribution with slots\"></a>Content Distribution with slots</h3><p>The name of the feature may be confusing, but the work is quite simple.</p>\n<p>This feature means pass html content to a component. We have used this feature before.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">app.component(&#39;alert-box&#39;, &#123; template: &#96;\n&lt;div class&#x3D;&quot;demo-alert-box&quot;&gt;\n      &lt;strong&gt;Error!&lt;&#x2F;strong&gt;\n      &lt;slot&gt;&lt;&#x2F;slot&gt;\n    &lt;&#x2F;div&gt;\n&#96; &#125;)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Dynamic-components\"><a href=\"#Dynamic-components\" class=\"headerlink\" title=\"Dynamic components\"></a>Dynamic components</h3><p>It’s a feature to change components dynamicly when you swith to different tabs or other similar things, so that you can see different content.</p>\n<p>The code is also simple. <code>&lt;component :is=&quot;currentTabComponent&quot;&gt;&lt;/component&gt;</code> is all you need. What you need to do is changing <code>currentTabComponent</code> when needed.</p>\n<h3 id=\"DOM-template-parsing-caveats\"><a href=\"#DOM-template-parsing-caveats\" class=\"headerlink\" title=\"DOM template parsing caveats\"></a>DOM template parsing caveats</h3><p>Some HTML elements, such as <code>&lt;ul&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;table&gt;</code> and <code>&lt;select&gt;</code> have restrictions on what elements can appear inside them, and some elements such as <code>&lt;li&gt;</code>, <code>&lt;tr&gt;</code>, and <code>&lt;option&gt;</code> can only appear inside certain other elements.</p>\n<p>For example:</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>demo</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>demo</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>The custom component <code>&lt;demo&gt;</code> cannot be inside a pair of <code>&lt;table&gt;</code> label. To fix the error, you can use <code>v-is</code> with a allowed label instead.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span> <span class=\"token attr-name\">v-is</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">'</span>demo<span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>Also, HTML attribute names are case-insensitive, so browsers will interpret any uppercase characters as lowercase. That means when you’re using in-DOM templates, camelCased prop names and event handler parameters need to use their kebab-cased (hyphen-delimited) equivalents. This has been mentioned before.</p>\n<p>It should be noted that these limitations do not apply if you are using string templates from one of the following sources:</p>\n<ul>\n<li>String templates (e.g. <code>template: &#39;...&#39;</code>)</li>\n<li>Single-file (<code>.vue</code>) components</li>\n<li><code>&lt;script type=&quot;text/x-template&quot;&gt;</code></li>\n</ul>\n<h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>The most basic part of vue ends here, you are already be able to build some simple vue applications with this knowladge. To go futher, you can continue to learn more syntactic sugar following the <a href=\"https://v3.vuejs.org/guide/installation.html\">official tutorial</a>. It won’t be difficult for you.</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"Advanced-Tutorial-of-Vue-Vite-Typescript\"><a href=\"#Advanced-Tutorial-of-Vue-Vite-Typescript\" class=\"headerlink\" title=\"Advanced Tutorial of Vue-Vite-Typescript\"></a>Advanced Tutorial of Vue-Vite-Typescript</h1><p>The following are the notes I took when I studied vue with reference to the official tutorial. The biggest difference between my notes and official tutorial is that I use typescript while the tutorial uses javascript. I suggest you learn vue following the official tutorial , but I firmly believe that you need to know some of the differences in the use of ts and js.</p>\n<p>And please forgive my stiff English, I was just too lazy to switch input methods.</p>\n<h2 id=\"Component\"><a href=\"#Component\" class=\"headerlink\" title=\"Component\"></a>Component</h2><p>The default root component is <code>src/App.vue</code>. The custom components should be placed in <code>src/components</code>.</p>\n<p>All components would be mounted in <code>src/main.ts</code>.</p>\n<p>Next you will learn the process of defining and using custom components</p>\n<h3 id=\"Define-and-use-custom-components\"><a href=\"#Define-and-use-custom-components\" class=\"headerlink\" title=\"Define and use custom components\"></a>Define and use custom components</h3><p>First, we will create a new file in <code>src/components</code>. The content should look like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; msg &#125;&#125;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nexport default defineComponent(&#123;\n  name: &quot;HelloWorld&quot;,\n  data() &#123;\n    return &#123;\n      msg: &quot;hello&quot;,\n    &#125;;\n  &#125;,\n&#125;);\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Now we have defined a component named <code>HelloWorld</code>.</p>\n<p>Next, we need to import it in <code>src/main.ts</code>.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> HelloWorld <span class=\"token keyword\">from</span> <span class=\"token string\">\"./components/HelloWorld.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// import HelloWorld</span>\n<span class=\"token comment\">// `HelloWorld` is not necessary to be the name of the component</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Then, you can declare a mount point in <code>index.html</code>.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>icon<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/favicon.ico<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1.0<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Vite App<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token comment\">&lt;!-- the mount point is declared here --></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>module<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/src/main.ts<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Finally, you need to mount the component to the mount point. Continue to write in <code>src/main.ts</code>.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span>HelloWorld<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>The components can also be defined and used in a simple way. For example, the code may look like this.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button-counter'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span>\n      count<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  template<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    &lt;button @click=\"count++\">\n      You clicked me &#123;&#123; count &#125;&#125; times.\n    &lt;/button></span><span class=\"token template-punctuation string\">`</span></span>t\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>And you can simply reuse the components by add labels like this.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>components-demo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button-counter</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button-counter</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>The <code>div</code> with id <code>components-demo</code> contains a pair of labels with a name which is the same as the component.</p>\n<h3 id=\"Component-registration\"><a href=\"#Component-registration\" class=\"headerlink\" title=\"Component registration\"></a>Component registration</h3><p>Components registered like this can be used globally. That means all components, including root component and child components can use these components.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-a\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token comment\">/* ... */</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-b\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token comment\">/* ... */</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-c\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token comment\">/* ... */</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>app<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>component-a</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>component-a</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>component-b</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>component-b</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>component-c</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>component-c</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Components registered like this can only be used locally. That means only the root component can use these components.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> ComponentA <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ComponentA.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ComponentB <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ComponentB.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  components<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token string\">\"component-a\"</span><span class=\"token operator\">:</span> ComponentA<span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"component-b\"</span><span class=\"token operator\">:</span> ComponentB<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>The code below is the same.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> ComponentA <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ComponentA.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ComponentB <span class=\"token keyword\">from</span> <span class=\"token string\">\"./ComponentB.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-a\"</span><span class=\"token punctuation\">,</span> ComponentA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-b\"</span><span class=\"token punctuation\">,</span> ComponentB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>If you want to use ComponentA in ComponentB. You need to do like this.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">ComponentB<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"component-a\"</span><span class=\"token punctuation\">,</span> ComponentA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"Interact-with-child-components\"><a href=\"#Interact-with-child-components\" class=\"headerlink\" title=\"Interact with child components\"></a>Interact with child components</h3><h4 id=\"Passing-data-to-child-components\"><a href=\"#Passing-data-to-child-components\" class=\"headerlink\" title=\"Passing data to child components\"></a>Passing data to child components</h4><p>In order to pass data to child components, we need to modify <code>src/components/HelloWorld.vue</code> like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; msg &#125;&#125;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nexport default defineComponent(&#123;\n  name: &quot;HelloWorld&quot;,\n  props: [&quot;msg&quot;],\n&#125;);\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>In the above code, we use <code>props</code> instead of <code>data</code>. Any value passed to a prop attribute will become a property on that component instance. And after a property is registered, we can pass data to it as a custom html attribute like this.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>HelloWorld</span> <span class=\"token attr-name\">msg</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hello world<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>HelloWorld</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>Now, you can launch the project and watch the result in a broswer. But soon, you will find there is nothing displaying on the broswer. The reason is that our component has an uppercase name. We difined an uppercase name in our project but something changed it to a lowercase name when it finally arrived at broswer. So use a lowercase name is enough to fix the error.</p>\n<p>Now, our code looks like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; msg &#125;&#125;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nexport default defineComponent(&#123;\n  name: &quot;hello-world&quot;,\n  props: [&quot;msg&quot;],\n&#125;);\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>test<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hello-world</span> <span class=\"token attr-name\">msg</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hello world<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>hello-world</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> HelloWorld <span class=\"token keyword\">from</span> <span class=\"token string\">\"./components/HelloWorld.vue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello-world\"</span><span class=\"token punctuation\">,</span> HelloWorld<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Then we can try a more complicated demo.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> App <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span>\n      posts<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">&#123;</span> id<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">:</span> <span class=\"token string\">\"My journey with Vue\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#123;</span> id<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">:</span> <span class=\"token string\">\"Blogging with Vue\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">&#123;</span> id<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">:</span> <span class=\"token string\">\"Why Vue is so fun\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span>App<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"blog-post\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  props<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  template<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;h4>&#123;&#123; title &#125;&#125;&lt;/h4></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#blog-posts-demo\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blog-posts-demo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>blog-post</span>\n    <span class=\"token attr-name\">v-for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post in posts<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">:key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post.id<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">:title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post.title<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>blog-post</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>There is still something which you need to notice. For an instance, see the code below.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;!-- src&#x2F;components&#x2F;Demo.vue --&gt;\n&lt;template&gt;\n  &#123;&#123; msg &#125;&#125;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\n\nexport default defineComponent(&#123;\n  name: &quot;demo&quot;,\n  props: [&quot;msg&quot;],\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token comment\">/* src/main.ts */</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">\"./App.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> EnlargeText <span class=\"token keyword\">from</span> <span class=\"token string\">\"./components/EnlargeText.vue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span>App<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"enlarge-text\"</span><span class=\"token punctuation\">,</span> EnlargeText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;!-- src&#x2F;App.vue --&gt;\n&lt;template&gt;\n  &lt;div&gt;hello&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\n\nexport default defineComponent(&#123;\n  name: &quot;App&quot;,\n&#125;);\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot;&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;!-- index.html --&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html lang&#x3D;&quot;en&quot;&gt;\n  &lt;head&gt;\n    &lt;meta charset&#x3D;&quot;UTF-8&quot; &#x2F;&gt;\n    &lt;title&gt;Vite App&lt;&#x2F;title&gt;\n  &lt;&#x2F;head&gt;\n  &lt;body&gt;\n    &lt;div id&#x3D;&quot;app&quot;&gt;\n      &lt;demo msg&#x3D;&quot;world&quot;&gt;&lt;&#x2F;demo&gt;\n    &lt;&#x2F;div&gt;\n    &lt;script type&#x3D;&quot;module&quot; src&#x3D;&quot;&#x2F;src&#x2F;main.ts&quot;&gt;&lt;&#x2F;script&gt;\n  &lt;&#x2F;body&gt;\n&lt;&#x2F;html&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>In this example, we define templates in both main component and child component. And we try to display them in <code>index.html</code> together. But something would happen to the template of the child component. It is covered by the template of the main component. Take care of this problem. And if you really want to show them together, you can move <code>&lt;demo msg=&quot;world&quot;&gt;&lt;/demo&gt;</code> from <code>index.html</code> to main component’s template.</p>\n<h4 id=\"Listening-to-the-events-of-child-components\"><a href=\"#Listening-to-the-events-of-child-components\" class=\"headerlink\" title=\"Listening to the events of child components\"></a>Listening to the events of child components</h4><p>Let’s ceate a new file named <code>Demo.vue</code> in <code>src/components</code>.</p>\n<p>First, we modify <code>src/components/Demo.vue</code> like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;h4&gt;\n      &#123;&#123; title &#125;&#125;\n    &lt;&#x2F;h4&gt;\n    &lt;button @click&#x3D;&quot;$emit(&#39;enlargeText&#39;)&quot;&gt;Enlarge text&lt;&#x2F;button&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\n\nexport default defineComponent(&#123;\n  name: &quot;demo&quot;,\n  props: [&quot;title&quot;],\n  emits: [&quot;enlargeText&quot;],\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>In this file, we define an event of child component called <code>enlargeText</code> with <code>emits</code>. And we bind this to the button click event. Once the button is clicked, the super component will receive this event.</p>\n<p>Then, we modify <code>src/App.vue</code> like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;demo\n      :style&#x3D;&quot;&#123; fontSize: postFontSize + &#39;em&#39; &#125;&quot;\n      @enlarge-text&#x3D;&quot;postFontSize +&#x3D; 0.1&quot;\n      title&#x3D;&quot;hello&quot;\n    &gt;&lt;&#x2F;demo&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nimport Demo from &quot;.&#x2F;components&#x2F;Demo.vue&quot;;\n\nexport default defineComponent(&#123;\n  data() &#123;\n    return &#123;\n      postFontSize: 1,\n    &#125;;\n  &#125;,\n  components: &#123; Demo &#125;,\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>In this file, we define the mount point of the child component <code>Demo</code>. And we set its style with a variable <code>postFontSize</code>. Also, we define the response function for <code>enlarge-text</code> event. And finally, we import <code>Demo</code> from <code>Demo.vue</code> and register it as a clild component.</p>\n<p>Be careful that <code>enlarge-text</code> is different from the event we defined in the child component called <code>enlargeText</code>. Although, <code>enlargeText</code> is also worked here, the broswer will interpret any uppercase characters as lowercase. So you’d better use <code>enlarge-text</code>.</p>\n<p>Since we have imported the child component in <code>src/App.vue</code>, the <code>src/main.ts</code> becomes more simple.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">\"./App.vue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span>App<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Now you can run your project and check the result in your broswer.</p>\n<p>If you are careful enough, you would find that <code>emits</code> is similar to <code>props</code>. <code>props</code> passes data to super component and <code>emits</code> passes event to super component.</p>\n<h5 id=\"Emit-a-value-with-an-event\"><a href=\"#Emit-a-value-with-an-event\" class=\"headerlink\" title=\"Emit a value with an event\"></a>Emit a value with an event</h5><p>To go futher, I will introduce you how to emit a value with an event.</p>\n<p>The code would look like this.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;button @click&#x3D;&quot;$emit(&#39;enlargeText&#39;, 0.1)&quot;&gt;\n  Enlarge text\n&lt;&#x2F;button&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>Then you can get the value with <code>$event</code>.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;demo\n  :style&#x3D;&quot;&#123; fontSize: postFontSize + &#39;em&#39; &#125;&quot;\n  @enlarge-text&#x3D;&quot;postFontSize +&#x3D; $event&quot;\n  title&#x3D;&quot;hello&quot;\n&gt;&lt;&#x2F;demo&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>And if the event handler is a method, the value will be passed as the first parameter.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;demo\n  :style&#x3D;&quot;&#123; fontSize: postFontSize + &#39;em&#39; &#125;&quot;\n  @enlarge-text&#x3D;&quot;onEnlargeText&quot;\n  title&#x3D;&quot;hello&quot;\n&gt;&lt;&#x2F;demo&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nimport Demo from &quot;.&#x2F;components&#x2F;Demo.vue&quot;;\n\nexport default defineComponent(&#123;\n  data() &#123;\n    return &#123;\n      postFontSize: 1,\n    &#125;;\n  &#125;,\n  components: &#123; Demo &#125;,\n  methods: &#123;\n    onEnlargeText(enlargeText: any) &#123;\n      this.postFontSize +&#x3D; enlargeText;\n    &#125;,\n  &#125;,\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"Use-v-model-on-components\"><a href=\"#Use-v-model-on-components\" class=\"headerlink\" title=\"Use v-model on components\"></a>Use v-model on components</h5><p><code>src/App.vue</code></p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;demo v-model&#x3D;&quot;searchText&quot;&gt;&lt;&#x2F;demo&gt;\n    &lt;!-- it&#39;s the same as the code below --&gt;\n    &lt;!-- &lt;demo --&gt;\n    &lt;!-- :model-value&#x3D;&quot;searchText&quot; --&gt;\n    &lt;!-- @update:model-value&#x3D;&quot;searchText &#x3D; $event&quot; --&gt;\n    &lt;!-- &gt;&lt;&#x2F;demo&gt; --&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\nimport Demo from &quot;.&#x2F;components&#x2F;Demo.vue&quot;;\n\nexport default defineComponent(&#123;\n  components: &#123; Demo &#125;,\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>src/components/Demo.vue</code></p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;input\n      :value&#x3D;&quot;modelValue&quot;\n      @input&#x3D;&quot;$emit(&#39;update:modelValue&#39;, $event.target.value)&quot;\n    &#x2F;&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\n\nexport default defineComponent(&#123;\n  name: &quot;demo&quot;,\n  props: [&quot;modelValue&quot;],\n  emits: [&quot;update:modelValue&quot;],\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>With the code above, we have implemented a simple input function. We use <code>&lt;demo v-model=&quot;searchText&quot;&gt;&lt;/demo&gt;</code> to simply our code in this example. The key point is you need to bind some properties in child components before using <code>v-model</code>.</p>\n<p>There is another way to define child components.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;input v-model&#x3D;&quot;value&quot; &#x2F;&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nimport &#123; defineComponent &#125; from &quot;vue&quot;;\n\nexport default defineComponent(&#123;\n  name: &quot;demo&quot;,\n  props: [&quot;modelValue&quot;],\n  emits: [&quot;update:modelValue&quot;],\n  computed: &#123;\n    value: &#123;\n      get(): any &#123;\n        return this.modelValue;\n      &#125;,\n      set(value: any) &#123;\n        this.$emit(&quot;update:modelValue&quot;, value);\n      &#125;,\n    &#125;,\n  &#125;,\n&#125;);\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Content-Distribution-with-slots\"><a href=\"#Content-Distribution-with-slots\" class=\"headerlink\" title=\"Content Distribution with slots\"></a>Content Distribution with slots</h3><p>The name of the feature may be confusing, but the work is quite simple.</p>\n<p>This feature means pass html content to a component. We have used this feature before.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">app.component(&#39;alert-box&#39;, &#123; template: &#96;\n&lt;div class&#x3D;&quot;demo-alert-box&quot;&gt;\n      &lt;strong&gt;Error!&lt;&#x2F;strong&gt;\n      &lt;slot&gt;&lt;&#x2F;slot&gt;\n    &lt;&#x2F;div&gt;\n&#96; &#125;)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Dynamic-components\"><a href=\"#Dynamic-components\" class=\"headerlink\" title=\"Dynamic components\"></a>Dynamic components</h3><p>It’s a feature to change components dynamicly when you swith to different tabs or other similar things, so that you can see different content.</p>\n<p>The code is also simple. <code>&lt;component :is=&quot;currentTabComponent&quot;&gt;&lt;/component&gt;</code> is all you need. What you need to do is changing <code>currentTabComponent</code> when needed.</p>\n<h3 id=\"DOM-template-parsing-caveats\"><a href=\"#DOM-template-parsing-caveats\" class=\"headerlink\" title=\"DOM template parsing caveats\"></a>DOM template parsing caveats</h3><p>Some HTML elements, such as <code>&lt;ul&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;table&gt;</code> and <code>&lt;select&gt;</code> have restrictions on what elements can appear inside them, and some elements such as <code>&lt;li&gt;</code>, <code>&lt;tr&gt;</code>, and <code>&lt;option&gt;</code> can only appear inside certain other elements.</p>\n<p>For example:</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>demo</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>demo</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>The custom component <code>&lt;demo&gt;</code> cannot be inside a pair of <code>&lt;table&gt;</code> label. To fix the error, you can use <code>v-is</code> with a allowed label instead.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>table</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>tr</span> <span class=\"token attr-name\">v-is</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">'</span>demo<span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>tr</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>table</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>Also, HTML attribute names are case-insensitive, so browsers will interpret any uppercase characters as lowercase. That means when you’re using in-DOM templates, camelCased prop names and event handler parameters need to use their kebab-cased (hyphen-delimited) equivalents. This has been mentioned before.</p>\n<p>It should be noted that these limitations do not apply if you are using string templates from one of the following sources:</p>\n<ul>\n<li>String templates (e.g. <code>template: &#39;...&#39;</code>)</li>\n<li>Single-file (<code>.vue</code>) components</li>\n<li><code>&lt;script type=&quot;text/x-template&quot;&gt;</code></li>\n</ul>\n<h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><p>The most basic part of vue ends here, you are already be able to build some simple vue applications with this knowladge. To go futher, you can continue to learn more syntactic sugar following the <a href=\"https://v3.vuejs.org/guide/installation.html\">official tutorial</a>. It won’t be difficult for you.</p>\n"},{"title":"Basic Tutorial of Vue-Vite-Typescript","date":"2021-05-17T14:08:07.000Z","_content":"\n# Basic Tutorial of Vue-Vite-Typescript\n\nThe following are the notes I took when I studied vue with reference to the official tutorial. The biggest difference between my notes and official tutorial is that I use typescript while the tutorial uses javascript. I suggest you learn vue following the official tutorial , but I firmly believe that you need to know some of the differences in the use of ts and js.\n\nAnd please forgive my stiff English, I was just too lazy to switch input methods.\n\n## Init a vue project\n\nCreate the project\n\n```\nnpm init @vitejs/app appName -- --template vue-ts\ncd appName\nnpm install\nnpm install less -D\nnpm install eslint eslint-plugin-vue -D\nnpm install @vuedx/typescript-plugin-vue -D\nnode node_modules/esbuild/install.js\n```\n\nModify `coc-settings.json`\n\n```\n  \"vetur.useWorkspaceDependencies\": true\n```\n\nAdd the content below to `tsconfig.json`\n\n```json\n    \"plugins\": [\n      {\n        \"name\": \"@vuedx/typescript-plugin-vue\"\n      }\n    ],\n```\n\nModify `vite.config.ts` which is located in the root path of the project.\n\n```typescript\nimport { defineConfig } from \"vite\";\nimport vue from \"@vitejs/plugin-vue\";\n\nexport default defineConfig({\n  plugins: [vue()],\n  resolve: {\n    alias: { vue: \"vue/dist/vue.esm-bundler.js\" },\n  },\n});\n```\n\n## Directory structure of the project\n\n![directory structure](1.png)\n\n1. public : public resource directory\n2. src/assets : static resource directory\n3. src/components : custom components\n4. src/App.vue : root component\n5. src/main.ts : root entry\n6. index.css : root css\n7. index.html : page entry\n\n## Run project\n\nUse `yarn dev` to run the project. And then you can check your page at browser.\n\n## Content of the vue file\n\n```vue\n# src/App.vue # html part\n<template>\n  <h1>{{ msg }}</h1>\n</template>\n\n# typescript part\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n      msg: \"hello vue\",\n    };\n  },\n};\n</script>\n\n# css part\n<style type=\"text/css\" media=\"screen\">\nh1 {\n  text-align: center;\n  color: red;\n}\n</style>\n```\n\n## Commentary\n\nIn html part (inside of template lable), the commentary looks like this. `<!-- annotation -->`\n\nIn css part (inside of style lable), the commentary looks like this. `/* annotation */`\n\nIn typescript part (inside of script lable), the commentary looks like this. `// annotation` or `/* annotation */`\n\nThe content outside of the label does not effect.\n\n## Create an application instance\n\nEach vue application is created by function `createApp`. For example, you can create an application like this.\n\n```typescript\nimport { createApp } from \"vue\";\nimport App from \"./App.vue\";\nconst app = createApp(App);\napp.mount(\"#app\");\n```\n\nIn the above code, `app` is our root component. We use method `mount` to mount `app` to `#app`.\n\n`#app` represents a html label whose id is app. And by default, `#app` is declared in `index.html`. For example, `<div id=\"app\"></div>`.\n\nThe method `mount` returns an instance of the root component. You can get the properties of the component through its instance.\n\n```typescript\nconst app = Vue.createApp({\n  data() {\n    return { count: 4 };\n  },\n});\n\nconst vm = app.mount(\"#app\");\n\nconsole.log(vm.count);\n```\n\nA component contains custom properties and inner properties. You can also get inner properties through the instance of the component using `$`. For example, `$attrs`.\n\n## lifecycle hook\n\nLifetime hook is a function which would be called automatically in different stages of the program runtime.\n\nFor instance, you can use `created` hook to execute your code after an instance has been created.\n\n```typescript\nVue.createApp({\n  data() {\n    return { count: 1 };\n  },\n  created() {\n    /* `this` point to the instance of the component */\n    console.log(\"count is: \" + this.count);\n  },\n});\n```\n\nDo not use arrow function in properties. For example, `created: () => console.log(\"hello\")`.\n\n## Template syntax\n\n### Variable binding\n\nYou can bind typescript variables to html part.\n\n1. Usually the syntax is `{{ variable }}`.\n\n2. But if you want to bind a html label, the code needs to be changed.\n\n```vue\n<template>\n  <div>\n    <p>\n      <!-- failed to bind -->\n      {{ msg }}\n    </p>\n    <!-- successfully bind to html -->\n    <p>bind html label : <span v-html=\"msg\"></span></p>\n  </div>\n</template>\n\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n      msg: \"<h2> hello </h2>\",\n    };\n  },\n};\n</script>\n```\n\n3. In order to bind attributes, the syntax will look like this.\n\n```vue\n<template>\n  <div>\n    <img v-bind:src=\"imgPath\" alt=\"\" />\n    <!-- or -->\n    <img :src=\"imgPath\" alt=\"\" />\n  </div>\n</template>\n\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n\t\timgPath=\"imgPath\"\n    };\n  },\n};\n</script>\n```\n\n4. To bind dynamic attributes.\n\n```vue\n<template>\n  <div>\n    <!-- cause an error due to the static url -->\n    <a v-bind:[attributeName]=\"http://www.url.com\" target=\"_blank\"\n      >Anchor Text</a\n    >\n    <!-- you can fix the error in this way -->\n    <a v-bind:[attributeName]=\"'http://www.url.com'\" target=\"_blank\"\n      >Anchor Text</a\n    >\n    <!-- or you can also bind the url -->\n    <a v-bind:[attributeName]=\"link\" target=\"_blank\">Anchor Text</a>\n  </div>\n</template>\n\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n      attributeName: \"href\",\n      link: \"http://www.url.com\",\n    };\n  },\n};\n</script>\n```\n\n5. Loop traversal\n\n```vue\n<template>\n  <div>\n    <ul>\n      <!-- :key is necessary, and each key must be unique -->\n      <li v-for=\"(item, index) in list\" :key=\"index\">\n        {{ index }}--{{ item }}\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n      list: [\"hello\", \"world\"],\n    };\n  },\n};\n</script>\n```\n\n`v-for` with a range.\n\n```html\n<div id=\"range\" class=\"demo\">\n  <span v-for=\"n in 10\" :key=\"n\">{{ n }} </span>\n</div>\n```\n\n6. Only bind once\n\n```vue\n<template>\n  <!-- this would never change -->\n  <span v-once>{{ msg }}</span>\n</template>\n```\n\n7. Bind js expressions\n\n```vue\n<template>\n  {{ msg + 1 }}\n</template>\n```\n\n### Method, class and style binding\n\n1. Bind method\n\n```vue\n<template>\n  <div>\n    {{ msg }}\n    <button @click=\"setMsg\">set msg</button>\n    <button @click=\"getMsg\">get msg</button>\n  </div>\n</template>\n\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n      msg: \"hello\",\n    };\n  },\n  methods: {\n    setMsg() {\n      this.msg = \"changed msg\";\n      /* you can call methods with `this` */\n      this.getMsg();\n    },\n    getMsg() {\n      alert(this.msg);\n    },\n  },\n};\n</script>\n```\n\n```vue\n<template>\n  {{ counter }}\n  <br />\n  <!-- You can call a method directly in the template. It will be called multiple -->\n  <!-- times in the rendering stage of the template. So the value of counter is not -->\n  <!-- sure. -->\n  {{ count() }}\n  <button @click=\"count\">click here to count</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      counter: 1,\n    };\n  },\n  methods: {\n    count() {\n      this.$data.counter++;\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nBind method with paramaters.\n\n```vue\n<template>\n  <button @click=\"getMessage($event)\">click here</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    getMessage(e: any) {\n      e.target.style.background = \"red\";\n      alert(e);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nYou can also bind methods with mutiple paramaters, like this. Note that event must be the last paramater.\n\n```vue\n<template>\n  <button @click=\"getMessage('hello', $event)\">click here</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    getMessage(str: string, e: any) {\n      e.target.style.background = \"red\";\n      console.log(str);\n      alert(e);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nBind mutiple methods.\n\n```\n<template>\n  <button @click=\"hello1($event), hello2($event)\">click here</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    hello1(e: any) {\n      e.target.style.background = \"red\";\n    },\n    hello2(e: any) {\n      alert(e);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n</style>\n```\n\nUse event modifiers.\n\n```html\n<a @click.stop=\"doSomething\"></a>\n<!-- the modifiers provided by vue is listed below -->\n<!-- 1. .stop -->\n<!-- 2. .prevent -->\n<!-- 3. .capture -->\n<!-- 4. .self -->\n<!-- 5. .once -->\n<!-- 6. .passive -->\n```\n\nThere are also key modifiers, such as `<input @keyup.enter = \"submit\" />`.\n\nYou can use key aliases, such as `.enter`, `.tab`, `.delete`, `.esc`, `.space`, `.up`, `.down`, `.left`, `.right`, instead of key modifiers.\n\nSystem modifier keys such as `.ctrl`, `.alt`, `.shift`, `.meta` are also useful.\n\n2. Bind class\n\n```vue\n<template>\n  <div class=\"custom\"></div>\n</template>\n\n<style lang=\"less\" scoped>\n.custom {\n  background: red;\n  height: 100px;\n  width: 100px;\n}\n</style>\n```\n\nYou can also bind classes dynamically.\n\n```vue\n<template>\n  <div :class=\"myClass\"></div>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      myClass: \"custom\",\n    };\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.custom {\n  background: red;\n  height: 100px;\n  width: 100px;\n}\n</style>\n```\n\nOptionally bind classes and bind more than one class at one time.\n\n```vue\n<template>\n  <!-- bind class `active` and `error` optionally and also bind class `custom` -->\n  <div class=\"custom\" :class=\"{ active: isActive, error: isError }\"></div>\n\n  <!-- bind class `active` or `error` -->\n  <div class=\"{isActive ? active : error}\"></div>\n\n  <!-- bind class `custom` and `active` -->\n  <div :class=\"['active', 'custom']\"></div>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      isActive: true,\n      isError: false,\n    };\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.custom {\n  margin: 10px;\n}\n.active {\n  background: yellowgreen;\n  height: 100px;\n  width: 100px;\n}\n.error {\n  background: red;\n  height: 100px;\n  width: 100px;\n}\n</style>\n```\n\n3. Bind style\n\n```vue\n<template>\n  <div :style=\"{ color: myColor, fontSize: myFontSize }\">hello</div>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      myColor: \"red\",\n      myFontSize: \"190px\",\n    };\n  },\n};\n</script>\n```\n\nYou can also bind styles optionally or in a form of array like the class binding.\n\n#### Instance : monitor an input box\n\n1. The first option\n\n```vue\n<template>\n  <!-- key up event will be triggered when your keyboard pops up. -->\n  <input type=\"text\" @keyup=\"doSearch($event)\" />\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    doSearch(e: any) {\n      console.log(e.keyCode);\n      /* check the input to confirm whether `enter` is pressed. */\n      if (e.keyCode == 13) {\n        alert(\"enter key is pressed\");\n        /* do search */\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\n2. The second option\n\n```vue\n<template>\n  <!-- key up event will be triggered when your keyboard pops up. -->\n  <!-- keyup.enter will be triggered when you input a `enter` -->\n  <input type=\"text\" @keyup.enter=\"doSearch($event)\" />\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    doSearch(e: any) {\n      /* no need to check the input */\n      console.log(e.keyCode);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\n### DOM\n\n```vue\n<template>\n  <ul>\n    <li>name : <input type=\"text\" id=\"username\" /></li>\n    <li>age : <input type=\"text\" ref=\"age\" /></li>\n  </ul>\n  <button @click=\"doSubmit()\" class=\"submit\">get content</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    doSubmit() {\n      var username = document.querySelector(\"#username\");\n      if (username != null) {\n        console.log(username);\n      }\n      console.log(this.$refs.age);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\n### Two-way binding\n\nDOM consumes a lot of resources. We use the way of two-way binding to get values instead.\n\n```vue\n<template>\n  <ul>\n    <!-- two-way binding -->\n    <li>name : <input type=\"text\" id=\"username\" v-model=\"username\" /></li>\n  </ul>\n  <button @click=\"doSubmit()\" class=\"submit\">get content</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      /* two-way binding */\n      username: \"jack\",\n    };\n  },\n  methods: {\n    doSubmit() {\n      console.log(this.username);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nThere are some modifiers for `v-model` binding, suck as `.lazy`, `.number`, `.trim`.\n\n### If else\n\n```vue\n<template>\n  {{ num == 1 ? \"num=1\" : \"num!=1\" }}\n  <div v-if=\"num == 1\">hello div</div>\n  <!-- this is invaild and will not take effect -->\n  <span vi-else>hello span</span>\n\n  <!-- this is the correct code -->\n  <div v-if=\"num == 1\">hello div</div>\n  <!-- if num != 1, the label will be deleted by DOM -->\n  <div v-else>goodbye div</div>\n\n  <!-- if num != 1, the label will be hidden by css -->\n  <div v-show=\"num == 1\">hello div</div>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      num: 2,\n    };\n  },\n};\n</script>\n```\n\n### Compute\n\nThe function declared in `computed` will be called when variables changed.\n\n```vue\n<template>\n  {{ calculateNum }}\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return { message: \"hello\" };\n  },\n  computed: {\n    calculateNum: function () {\n      let self = this as any;\n      return self.message.split(\"\").reverse().join(\"\");\n      /* The lsp will report an error when using the code below. But it will not cause error during the runtime.*/\n      /* return this.message.split(\"\").reverse().join(\"\"); */\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nThe error in above code is caused by the static type checking of typescript lsp. Once you meet this error, and feel confused about the solution. You can fix it by transforming the type to `any`.\n\n### Watcher\n\n```vue\n<template>\n  {{ counter }}\n  {{ count }}\n  <button @click=\"counter++\">click me</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return { counter: 1, count: 0 };\n  },\n  watch: {\n    /* the name of the function must be the same as the variable you want to watch */\n    counter: function (value) {\n      this.count = value * 2;\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\n### Less\n\n```vue\n<template>\n  <div class=\"todolist\">\n    <h3>TodoList</h3>\n  </div>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {},\n};\n</script>\n\n<style lang=\"less\" scoped>\n.todolist {\n  width: 500px;\n  height: 500px;\n  background-color: green;\n  h3 {\n    color: red;\n  }\n}\n</style>\n```\n\n### Debouncing and Throttling\n\nYou can implement debouncing and throttling by using libraries such as `Lodash`.\n\n```html\n<script src=\"https://unpkg.com/lodash@4.17.20/lodash.min.js\"></script>\n<script>\n  Vue.createApp({\n    methods: {\n      // Debouncing with Lodash\n      click: _.debounce(function () {\n        // ... respond to click ...\n      }, 500),\n    },\n  }).mount(\"#app\");\n</script>\n```\n\nIf you want to keep the component instance independently, you can add the debounced function in the created lifecycle hook.\n\n```typescript\napp.component(\"save-button\", {\n  created() {\n    // Debouncing with Lodash\n    this.debouncedClick = _.debounce(this.click, 500);\n  },\n  unmounted() {\n    // Cancel the timer when the component is removed\n    this.debouncedClick.cancel();\n  },\n  methods: {\n    click() {\n      // ... respond to click ...\n    },\n  },\n  template: `\n    <button @click=\"debouncedClick\">\n      Save\n    </button>\n  `,\n});\n```\n\nI will continue to make notes on the advanced usage of vue, so please stay tuned.\n","source":"_posts/basic-tutorial-of-vue-vite-typescript.md","raw":"---\ntitle: Basic Tutorial of Vue-Vite-Typescript\ndate: 2021-05-17 22:08:07\ntags:\n  - Vue\n  - Vite\n  - Typescript\ncategories:\n  - Vue\n---\n\n# Basic Tutorial of Vue-Vite-Typescript\n\nThe following are the notes I took when I studied vue with reference to the official tutorial. The biggest difference between my notes and official tutorial is that I use typescript while the tutorial uses javascript. I suggest you learn vue following the official tutorial , but I firmly believe that you need to know some of the differences in the use of ts and js.\n\nAnd please forgive my stiff English, I was just too lazy to switch input methods.\n\n## Init a vue project\n\nCreate the project\n\n```\nnpm init @vitejs/app appName -- --template vue-ts\ncd appName\nnpm install\nnpm install less -D\nnpm install eslint eslint-plugin-vue -D\nnpm install @vuedx/typescript-plugin-vue -D\nnode node_modules/esbuild/install.js\n```\n\nModify `coc-settings.json`\n\n```\n  \"vetur.useWorkspaceDependencies\": true\n```\n\nAdd the content below to `tsconfig.json`\n\n```json\n    \"plugins\": [\n      {\n        \"name\": \"@vuedx/typescript-plugin-vue\"\n      }\n    ],\n```\n\nModify `vite.config.ts` which is located in the root path of the project.\n\n```typescript\nimport { defineConfig } from \"vite\";\nimport vue from \"@vitejs/plugin-vue\";\n\nexport default defineConfig({\n  plugins: [vue()],\n  resolve: {\n    alias: { vue: \"vue/dist/vue.esm-bundler.js\" },\n  },\n});\n```\n\n## Directory structure of the project\n\n![directory structure](1.png)\n\n1. public : public resource directory\n2. src/assets : static resource directory\n3. src/components : custom components\n4. src/App.vue : root component\n5. src/main.ts : root entry\n6. index.css : root css\n7. index.html : page entry\n\n## Run project\n\nUse `yarn dev` to run the project. And then you can check your page at browser.\n\n## Content of the vue file\n\n```vue\n# src/App.vue # html part\n<template>\n  <h1>{{ msg }}</h1>\n</template>\n\n# typescript part\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n      msg: \"hello vue\",\n    };\n  },\n};\n</script>\n\n# css part\n<style type=\"text/css\" media=\"screen\">\nh1 {\n  text-align: center;\n  color: red;\n}\n</style>\n```\n\n## Commentary\n\nIn html part (inside of template lable), the commentary looks like this. `<!-- annotation -->`\n\nIn css part (inside of style lable), the commentary looks like this. `/* annotation */`\n\nIn typescript part (inside of script lable), the commentary looks like this. `// annotation` or `/* annotation */`\n\nThe content outside of the label does not effect.\n\n## Create an application instance\n\nEach vue application is created by function `createApp`. For example, you can create an application like this.\n\n```typescript\nimport { createApp } from \"vue\";\nimport App from \"./App.vue\";\nconst app = createApp(App);\napp.mount(\"#app\");\n```\n\nIn the above code, `app` is our root component. We use method `mount` to mount `app` to `#app`.\n\n`#app` represents a html label whose id is app. And by default, `#app` is declared in `index.html`. For example, `<div id=\"app\"></div>`.\n\nThe method `mount` returns an instance of the root component. You can get the properties of the component through its instance.\n\n```typescript\nconst app = Vue.createApp({\n  data() {\n    return { count: 4 };\n  },\n});\n\nconst vm = app.mount(\"#app\");\n\nconsole.log(vm.count);\n```\n\nA component contains custom properties and inner properties. You can also get inner properties through the instance of the component using `$`. For example, `$attrs`.\n\n## lifecycle hook\n\nLifetime hook is a function which would be called automatically in different stages of the program runtime.\n\nFor instance, you can use `created` hook to execute your code after an instance has been created.\n\n```typescript\nVue.createApp({\n  data() {\n    return { count: 1 };\n  },\n  created() {\n    /* `this` point to the instance of the component */\n    console.log(\"count is: \" + this.count);\n  },\n});\n```\n\nDo not use arrow function in properties. For example, `created: () => console.log(\"hello\")`.\n\n## Template syntax\n\n### Variable binding\n\nYou can bind typescript variables to html part.\n\n1. Usually the syntax is `{{ variable }}`.\n\n2. But if you want to bind a html label, the code needs to be changed.\n\n```vue\n<template>\n  <div>\n    <p>\n      <!-- failed to bind -->\n      {{ msg }}\n    </p>\n    <!-- successfully bind to html -->\n    <p>bind html label : <span v-html=\"msg\"></span></p>\n  </div>\n</template>\n\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n      msg: \"<h2> hello </h2>\",\n    };\n  },\n};\n</script>\n```\n\n3. In order to bind attributes, the syntax will look like this.\n\n```vue\n<template>\n  <div>\n    <img v-bind:src=\"imgPath\" alt=\"\" />\n    <!-- or -->\n    <img :src=\"imgPath\" alt=\"\" />\n  </div>\n</template>\n\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n\t\timgPath=\"imgPath\"\n    };\n  },\n};\n</script>\n```\n\n4. To bind dynamic attributes.\n\n```vue\n<template>\n  <div>\n    <!-- cause an error due to the static url -->\n    <a v-bind:[attributeName]=\"http://www.url.com\" target=\"_blank\"\n      >Anchor Text</a\n    >\n    <!-- you can fix the error in this way -->\n    <a v-bind:[attributeName]=\"'http://www.url.com'\" target=\"_blank\"\n      >Anchor Text</a\n    >\n    <!-- or you can also bind the url -->\n    <a v-bind:[attributeName]=\"link\" target=\"_blank\">Anchor Text</a>\n  </div>\n</template>\n\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n      attributeName: \"href\",\n      link: \"http://www.url.com\",\n    };\n  },\n};\n</script>\n```\n\n5. Loop traversal\n\n```vue\n<template>\n  <div>\n    <ul>\n      <!-- :key is necessary, and each key must be unique -->\n      <li v-for=\"(item, index) in list\" :key=\"index\">\n        {{ index }}--{{ item }}\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n      list: [\"hello\", \"world\"],\n    };\n  },\n};\n</script>\n```\n\n`v-for` with a range.\n\n```html\n<div id=\"range\" class=\"demo\">\n  <span v-for=\"n in 10\" :key=\"n\">{{ n }} </span>\n</div>\n```\n\n6. Only bind once\n\n```vue\n<template>\n  <!-- this would never change -->\n  <span v-once>{{ msg }}</span>\n</template>\n```\n\n7. Bind js expressions\n\n```vue\n<template>\n  {{ msg + 1 }}\n</template>\n```\n\n### Method, class and style binding\n\n1. Bind method\n\n```vue\n<template>\n  <div>\n    {{ msg }}\n    <button @click=\"setMsg\">set msg</button>\n    <button @click=\"getMsg\">get msg</button>\n  </div>\n</template>\n\n<script charset=\"utf-8\">\nexport default {\n  data() {\n    return {\n      msg: \"hello\",\n    };\n  },\n  methods: {\n    setMsg() {\n      this.msg = \"changed msg\";\n      /* you can call methods with `this` */\n      this.getMsg();\n    },\n    getMsg() {\n      alert(this.msg);\n    },\n  },\n};\n</script>\n```\n\n```vue\n<template>\n  {{ counter }}\n  <br />\n  <!-- You can call a method directly in the template. It will be called multiple -->\n  <!-- times in the rendering stage of the template. So the value of counter is not -->\n  <!-- sure. -->\n  {{ count() }}\n  <button @click=\"count\">click here to count</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      counter: 1,\n    };\n  },\n  methods: {\n    count() {\n      this.$data.counter++;\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nBind method with paramaters.\n\n```vue\n<template>\n  <button @click=\"getMessage($event)\">click here</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    getMessage(e: any) {\n      e.target.style.background = \"red\";\n      alert(e);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nYou can also bind methods with mutiple paramaters, like this. Note that event must be the last paramater.\n\n```vue\n<template>\n  <button @click=\"getMessage('hello', $event)\">click here</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    getMessage(str: string, e: any) {\n      e.target.style.background = \"red\";\n      console.log(str);\n      alert(e);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nBind mutiple methods.\n\n```\n<template>\n  <button @click=\"hello1($event), hello2($event)\">click here</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    hello1(e: any) {\n      e.target.style.background = \"red\";\n    },\n    hello2(e: any) {\n      alert(e);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n</style>\n```\n\nUse event modifiers.\n\n```html\n<a @click.stop=\"doSomething\"></a>\n<!-- the modifiers provided by vue is listed below -->\n<!-- 1. .stop -->\n<!-- 2. .prevent -->\n<!-- 3. .capture -->\n<!-- 4. .self -->\n<!-- 5. .once -->\n<!-- 6. .passive -->\n```\n\nThere are also key modifiers, such as `<input @keyup.enter = \"submit\" />`.\n\nYou can use key aliases, such as `.enter`, `.tab`, `.delete`, `.esc`, `.space`, `.up`, `.down`, `.left`, `.right`, instead of key modifiers.\n\nSystem modifier keys such as `.ctrl`, `.alt`, `.shift`, `.meta` are also useful.\n\n2. Bind class\n\n```vue\n<template>\n  <div class=\"custom\"></div>\n</template>\n\n<style lang=\"less\" scoped>\n.custom {\n  background: red;\n  height: 100px;\n  width: 100px;\n}\n</style>\n```\n\nYou can also bind classes dynamically.\n\n```vue\n<template>\n  <div :class=\"myClass\"></div>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      myClass: \"custom\",\n    };\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.custom {\n  background: red;\n  height: 100px;\n  width: 100px;\n}\n</style>\n```\n\nOptionally bind classes and bind more than one class at one time.\n\n```vue\n<template>\n  <!-- bind class `active` and `error` optionally and also bind class `custom` -->\n  <div class=\"custom\" :class=\"{ active: isActive, error: isError }\"></div>\n\n  <!-- bind class `active` or `error` -->\n  <div class=\"{isActive ? active : error}\"></div>\n\n  <!-- bind class `custom` and `active` -->\n  <div :class=\"['active', 'custom']\"></div>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      isActive: true,\n      isError: false,\n    };\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.custom {\n  margin: 10px;\n}\n.active {\n  background: yellowgreen;\n  height: 100px;\n  width: 100px;\n}\n.error {\n  background: red;\n  height: 100px;\n  width: 100px;\n}\n</style>\n```\n\n3. Bind style\n\n```vue\n<template>\n  <div :style=\"{ color: myColor, fontSize: myFontSize }\">hello</div>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      myColor: \"red\",\n      myFontSize: \"190px\",\n    };\n  },\n};\n</script>\n```\n\nYou can also bind styles optionally or in a form of array like the class binding.\n\n#### Instance : monitor an input box\n\n1. The first option\n\n```vue\n<template>\n  <!-- key up event will be triggered when your keyboard pops up. -->\n  <input type=\"text\" @keyup=\"doSearch($event)\" />\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    doSearch(e: any) {\n      console.log(e.keyCode);\n      /* check the input to confirm whether `enter` is pressed. */\n      if (e.keyCode == 13) {\n        alert(\"enter key is pressed\");\n        /* do search */\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\n2. The second option\n\n```vue\n<template>\n  <!-- key up event will be triggered when your keyboard pops up. -->\n  <!-- keyup.enter will be triggered when you input a `enter` -->\n  <input type=\"text\" @keyup.enter=\"doSearch($event)\" />\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    doSearch(e: any) {\n      /* no need to check the input */\n      console.log(e.keyCode);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\n### DOM\n\n```vue\n<template>\n  <ul>\n    <li>name : <input type=\"text\" id=\"username\" /></li>\n    <li>age : <input type=\"text\" ref=\"age\" /></li>\n  </ul>\n  <button @click=\"doSubmit()\" class=\"submit\">get content</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {};\n  },\n  methods: {\n    doSubmit() {\n      var username = document.querySelector(\"#username\");\n      if (username != null) {\n        console.log(username);\n      }\n      console.log(this.$refs.age);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\n### Two-way binding\n\nDOM consumes a lot of resources. We use the way of two-way binding to get values instead.\n\n```vue\n<template>\n  <ul>\n    <!-- two-way binding -->\n    <li>name : <input type=\"text\" id=\"username\" v-model=\"username\" /></li>\n  </ul>\n  <button @click=\"doSubmit()\" class=\"submit\">get content</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      /* two-way binding */\n      username: \"jack\",\n    };\n  },\n  methods: {\n    doSubmit() {\n      console.log(this.username);\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nThere are some modifiers for `v-model` binding, suck as `.lazy`, `.number`, `.trim`.\n\n### If else\n\n```vue\n<template>\n  {{ num == 1 ? \"num=1\" : \"num!=1\" }}\n  <div v-if=\"num == 1\">hello div</div>\n  <!-- this is invaild and will not take effect -->\n  <span vi-else>hello span</span>\n\n  <!-- this is the correct code -->\n  <div v-if=\"num == 1\">hello div</div>\n  <!-- if num != 1, the label will be deleted by DOM -->\n  <div v-else>goodbye div</div>\n\n  <!-- if num != 1, the label will be hidden by css -->\n  <div v-show=\"num == 1\">hello div</div>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return {\n      num: 2,\n    };\n  },\n};\n</script>\n```\n\n### Compute\n\nThe function declared in `computed` will be called when variables changed.\n\n```vue\n<template>\n  {{ calculateNum }}\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return { message: \"hello\" };\n  },\n  computed: {\n    calculateNum: function () {\n      let self = this as any;\n      return self.message.split(\"\").reverse().join(\"\");\n      /* The lsp will report an error when using the code below. But it will not cause error during the runtime.*/\n      /* return this.message.split(\"\").reverse().join(\"\"); */\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\nThe error in above code is caused by the static type checking of typescript lsp. Once you meet this error, and feel confused about the solution. You can fix it by transforming the type to `any`.\n\n### Watcher\n\n```vue\n<template>\n  {{ counter }}\n  {{ count }}\n  <button @click=\"counter++\">click me</button>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {\n    return { counter: 1, count: 0 };\n  },\n  watch: {\n    /* the name of the function must be the same as the variable you want to watch */\n    counter: function (value) {\n      this.count = value * 2;\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n```\n\n### Less\n\n```vue\n<template>\n  <div class=\"todolist\">\n    <h3>TodoList</h3>\n  </div>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  data() {},\n};\n</script>\n\n<style lang=\"less\" scoped>\n.todolist {\n  width: 500px;\n  height: 500px;\n  background-color: green;\n  h3 {\n    color: red;\n  }\n}\n</style>\n```\n\n### Debouncing and Throttling\n\nYou can implement debouncing and throttling by using libraries such as `Lodash`.\n\n```html\n<script src=\"https://unpkg.com/lodash@4.17.20/lodash.min.js\"></script>\n<script>\n  Vue.createApp({\n    methods: {\n      // Debouncing with Lodash\n      click: _.debounce(function () {\n        // ... respond to click ...\n      }, 500),\n    },\n  }).mount(\"#app\");\n</script>\n```\n\nIf you want to keep the component instance independently, you can add the debounced function in the created lifecycle hook.\n\n```typescript\napp.component(\"save-button\", {\n  created() {\n    // Debouncing with Lodash\n    this.debouncedClick = _.debounce(this.click, 500);\n  },\n  unmounted() {\n    // Cancel the timer when the component is removed\n    this.debouncedClick.cancel();\n  },\n  methods: {\n    click() {\n      // ... respond to click ...\n    },\n  },\n  template: `\n    <button @click=\"debouncedClick\">\n      Save\n    </button>\n  `,\n});\n```\n\nI will continue to make notes on the advanced usage of vue, so please stay tuned.\n","slug":"basic-tutorial-of-vue-vite-typescript","published":1,"updated":"2021-05-17T14:38:18.993Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmr80007rrizf5is61li","content":"<h1 id=\"Basic-Tutorial-of-Vue-Vite-Typescript\"><a href=\"#Basic-Tutorial-of-Vue-Vite-Typescript\" class=\"headerlink\" title=\"Basic Tutorial of Vue-Vite-Typescript\"></a>Basic Tutorial of Vue-Vite-Typescript</h1><p>The following are the notes I took when I studied vue with reference to the official tutorial. The biggest difference between my notes and official tutorial is that I use typescript while the tutorial uses javascript. I suggest you learn vue following the official tutorial , but I firmly believe that you need to know some of the differences in the use of ts and js.</p>\n<p>And please forgive my stiff English, I was just too lazy to switch input methods.</p>\n<h2 id=\"Init-a-vue-project\"><a href=\"#Init-a-vue-project\" class=\"headerlink\" title=\"Init a vue project\"></a>Init a vue project</h2><p>Create the project</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">npm init @vitejs&#x2F;app appName -- --template vue-ts\ncd appName\nnpm install\nnpm install less -D\nnpm install eslint eslint-plugin-vue -D\nnpm install @vuedx&#x2F;typescript-plugin-vue -D\nnode node_modules&#x2F;esbuild&#x2F;install.js<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Modify <code>coc-settings.json</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&quot;vetur.useWorkspaceDependencies&quot;: true<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>Add the content below to <code>tsconfig.json</code></p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@vuedx/typescript-plugin-vue\"</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Modify <code>vite.config.ts</code> which is located in the root path of the project.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> defineConfig <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vite\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> vue <span class=\"token keyword\">from</span> <span class=\"token string\">\"@vitejs/plugin-vue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">defineConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token function\">vue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  resolve<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    alias<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> vue<span class=\"token operator\">:</span> <span class=\"token string\">\"vue/dist/vue.esm-bundler.js\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Directory-structure-of-the-project\"><a href=\"#Directory-structure-of-the-project\" class=\"headerlink\" title=\"Directory structure of the project\"></a>Directory structure of the project</h2><p><img src=\"1.png\" alt=\"directory structure\"></p>\n<ol>\n<li>public : public resource directory</li>\n<li>src/assets : static resource directory</li>\n<li>src/components : custom components</li>\n<li>src/App.vue : root component</li>\n<li>src/main.ts : root entry</li>\n<li>index.css : root css</li>\n<li>index.html : page entry</li>\n</ol>\n<h2 id=\"Run-project\"><a href=\"#Run-project\" class=\"headerlink\" title=\"Run project\"></a>Run project</h2><p>Use <code>yarn dev</code> to run the project. And then you can check your page at browser.</p>\n<h2 id=\"Content-of-the-vue-file\"><a href=\"#Content-of-the-vue-file\" class=\"headerlink\" title=\"Content of the vue file\"></a>Content of the vue file</h2><pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\"># src&#x2F;App.vue # html part\n&lt;template&gt;\n  &lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;&#x2F;h1&gt;\n&lt;&#x2F;template&gt;\n\n# typescript part\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      msg: &quot;hello vue&quot;,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n# css part\n&lt;style type&#x3D;&quot;text&#x2F;css&quot; media&#x3D;&quot;screen&quot;&gt;\nh1 &#123;\n  text-align: center;\n  color: red;\n&#125;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Commentary\"><a href=\"#Commentary\" class=\"headerlink\" title=\"Commentary\"></a>Commentary</h2><p>In html part (inside of template lable), the commentary looks like this. <code>&lt;!-- annotation --&gt;</code></p>\n<p>In css part (inside of style lable), the commentary looks like this. <code>/* annotation */</code></p>\n<p>In typescript part (inside of script lable), the commentary looks like this. <code>// annotation</code> or <code>/* annotation */</code></p>\n<p>The content outside of the label does not effect.</p>\n<h2 id=\"Create-an-application-instance\"><a href=\"#Create-an-application-instance\" class=\"headerlink\" title=\"Create an application instance\"></a>Create an application instance</h2><p>Each vue application is created by function <code>createApp</code>. For example, you can create an application like this.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">\"./App.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span>App<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>In the above code, <code>app</code> is our root component. We use method <code>mount</code> to mount <code>app</code> to <code>#app</code>.</p>\n<p><code>#app</code> represents a html label whose id is app. And by default, <code>#app</code> is declared in <code>index.html</code>. For example, <code>&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</code>.</p>\n<p>The method <code>mount</code> returns an instance of the root component. You can get the properties of the component through its instance.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span> count<span class=\"token operator\">:</span> <span class=\"token number\">4</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> vm <span class=\"token operator\">=</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>A component contains custom properties and inner properties. You can also get inner properties through the instance of the component using <code>$</code>. For example, <code>$attrs</code>.</p>\n<h2 id=\"lifecycle-hook\"><a href=\"#lifecycle-hook\" class=\"headerlink\" title=\"lifecycle hook\"></a>lifecycle hook</h2><p>Lifetime hook is a function which would be called automatically in different stages of the program runtime.</p>\n<p>For instance, you can use <code>created</code> hook to execute your code after an instance has been created.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span> count<span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">created</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token comment\">/* `this` point to the instance of the component */</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"count is: \"</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Do not use arrow function in properties. For example, <code>created: () =&gt; console.log(&quot;hello&quot;)</code>.</p>\n<h2 id=\"Template-syntax\"><a href=\"#Template-syntax\" class=\"headerlink\" title=\"Template syntax\"></a>Template syntax</h2><h3 id=\"Variable-binding\"><a href=\"#Variable-binding\" class=\"headerlink\" title=\"Variable binding\"></a>Variable binding</h3><p>You can bind typescript variables to html part.</p>\n<ol>\n<li><p>Usually the syntax is <code>&#123;&#123; variable &#125;&#125;</code>.</p>\n</li>\n<li><p>But if you want to bind a html label, the code needs to be changed.</p>\n</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;p&gt;\n      &lt;!-- failed to bind --&gt;\n      &#123;&#123; msg &#125;&#125;\n    &lt;&#x2F;p&gt;\n    &lt;!-- successfully bind to html --&gt;\n    &lt;p&gt;bind html label : &lt;span v-html&#x3D;&quot;msg&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;p&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      msg: &quot;&lt;h2&gt; hello &lt;&#x2F;h2&gt;&quot;,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"3\">\n<li>In order to bind attributes, the syntax will look like this.</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;img v-bind:src&#x3D;&quot;imgPath&quot; alt&#x3D;&quot;&quot; &#x2F;&gt;\n    &lt;!-- or --&gt;\n    &lt;img :src&#x3D;&quot;imgPath&quot; alt&#x3D;&quot;&quot; &#x2F;&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n\t\timgPath&#x3D;&quot;imgPath&quot;\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"4\">\n<li>To bind dynamic attributes.</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;!-- cause an error due to the static url --&gt;\n    &lt;a v-bind:[attributeName]&#x3D;&quot;http:&#x2F;&#x2F;www.url.com&quot; target&#x3D;&quot;_blank&quot;\n      &gt;Anchor Text&lt;&#x2F;a\n    &gt;\n    &lt;!-- you can fix the error in this way --&gt;\n    &lt;a v-bind:[attributeName]&#x3D;&quot;&#39;http:&#x2F;&#x2F;www.url.com&#39;&quot; target&#x3D;&quot;_blank&quot;\n      &gt;Anchor Text&lt;&#x2F;a\n    &gt;\n    &lt;!-- or you can also bind the url --&gt;\n    &lt;a v-bind:[attributeName]&#x3D;&quot;link&quot; target&#x3D;&quot;_blank&quot;&gt;Anchor Text&lt;&#x2F;a&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      attributeName: &quot;href&quot;,\n      link: &quot;http:&#x2F;&#x2F;www.url.com&quot;,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"5\">\n<li>Loop traversal</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;ul&gt;\n      &lt;!-- :key is necessary, and each key must be unique --&gt;\n      &lt;li v-for&#x3D;&quot;(item, index) in list&quot; :key&#x3D;&quot;index&quot;&gt;\n        &#123;&#123; index &#125;&#125;--&#123;&#123; item &#125;&#125;\n      &lt;&#x2F;li&gt;\n    &lt;&#x2F;ul&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      list: [&quot;hello&quot;, &quot;world&quot;],\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>v-for</code> with a range.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>range<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>demo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">v-for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>n in 10<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">:key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>n<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>&#123;&#123; n &#125;&#125; <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"6\">\n<li>Only bind once</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;!-- this would never change --&gt;\n  &lt;span v-once&gt;&#123;&#123; msg &#125;&#125;&lt;&#x2F;span&gt;\n&lt;&#x2F;template&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"7\">\n<li>Bind js expressions</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; msg + 1 &#125;&#125;\n&lt;&#x2F;template&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Method-class-and-style-binding\"><a href=\"#Method-class-and-style-binding\" class=\"headerlink\" title=\"Method, class and style binding\"></a>Method, class and style binding</h3><ol>\n<li>Bind method</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &#123;&#123; msg &#125;&#125;\n    &lt;button @click&#x3D;&quot;setMsg&quot;&gt;set msg&lt;&#x2F;button&gt;\n    &lt;button @click&#x3D;&quot;getMsg&quot;&gt;get msg&lt;&#x2F;button&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      msg: &quot;hello&quot;,\n    &#125;;\n  &#125;,\n  methods: &#123;\n    setMsg() &#123;\n      this.msg &#x3D; &quot;changed msg&quot;;\n      &#x2F;* you can call methods with &#96;this&#96; *&#x2F;\n      this.getMsg();\n    &#125;,\n    getMsg() &#123;\n      alert(this.msg);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; counter &#125;&#125;\n  &lt;br &#x2F;&gt;\n  &lt;!-- You can call a method directly in the template. It will be called multiple --&gt;\n  &lt;!-- times in the rendering stage of the template. So the value of counter is not --&gt;\n  &lt;!-- sure. --&gt;\n  &#123;&#123; count() &#125;&#125;\n  &lt;button @click&#x3D;&quot;count&quot;&gt;click here to count&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      counter: 1,\n    &#125;;\n  &#125;,\n  methods: &#123;\n    count() &#123;\n      this.$data.counter++;\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Bind method with paramaters.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;button @click&#x3D;&quot;getMessage($event)&quot;&gt;click here&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    getMessage(e: any) &#123;\n      e.target.style.background &#x3D; &quot;red&quot;;\n      alert(e);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>You can also bind methods with mutiple paramaters, like this. Note that event must be the last paramater.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;button @click&#x3D;&quot;getMessage(&#39;hello&#39;, $event)&quot;&gt;click here&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    getMessage(str: string, e: any) &#123;\n      e.target.style.background &#x3D; &quot;red&quot;;\n      console.log(str);\n      alert(e);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Bind mutiple methods.</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;template&gt;\n  &lt;button @click&#x3D;&quot;hello1($event), hello2($event)&quot;&gt;click here&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    hello1(e: any) &#123;\n      e.target.style.background &#x3D; &quot;red&quot;;\n    &#125;,\n    hello2(e: any) &#123;\n      alert(e);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Use event modifiers.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">@click.stop</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>doSomething<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!-- the modifiers provided by vue is listed below --></span>\n<span class=\"token comment\">&lt;!-- 1. .stop --></span>\n<span class=\"token comment\">&lt;!-- 2. .prevent --></span>\n<span class=\"token comment\">&lt;!-- 3. .capture --></span>\n<span class=\"token comment\">&lt;!-- 4. .self --></span>\n<span class=\"token comment\">&lt;!-- 5. .once --></span>\n<span class=\"token comment\">&lt;!-- 6. .passive --></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>There are also key modifiers, such as <code>&lt;input @keyup.enter = &quot;submit&quot; /&gt;</code>.</p>\n<p>You can use key aliases, such as <code>.enter</code>, <code>.tab</code>, <code>.delete</code>, <code>.esc</code>, <code>.space</code>, <code>.up</code>, <code>.down</code>, <code>.left</code>, <code>.right</code>, instead of key modifiers.</p>\n<p>System modifier keys such as <code>.ctrl</code>, <code>.alt</code>, <code>.shift</code>, <code>.meta</code> are also useful.</p>\n<ol start=\"2\">\n<li>Bind class</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div class&#x3D;&quot;custom&quot;&gt;&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;\n.custom &#123;\n  background: red;\n  height: 100px;\n  width: 100px;\n&#125;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>You can also bind classes dynamically.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div :class&#x3D;&quot;myClass&quot;&gt;&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      myClass: &quot;custom&quot;,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;\n.custom &#123;\n  background: red;\n  height: 100px;\n  width: 100px;\n&#125;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Optionally bind classes and bind more than one class at one time.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;!-- bind class &#96;active&#96; and &#96;error&#96; optionally and also bind class &#96;custom&#96; --&gt;\n  &lt;div class&#x3D;&quot;custom&quot; :class&#x3D;&quot;&#123; active: isActive, error: isError &#125;&quot;&gt;&lt;&#x2F;div&gt;\n\n  &lt;!-- bind class &#96;active&#96; or &#96;error&#96; --&gt;\n  &lt;div class&#x3D;&quot;&#123;isActive ? active : error&#125;&quot;&gt;&lt;&#x2F;div&gt;\n\n  &lt;!-- bind class &#96;custom&#96; and &#96;active&#96; --&gt;\n  &lt;div :class&#x3D;&quot;[&#39;active&#39;, &#39;custom&#39;]&quot;&gt;&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      isActive: true,\n      isError: false,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;\n.custom &#123;\n  margin: 10px;\n&#125;\n.active &#123;\n  background: yellowgreen;\n  height: 100px;\n  width: 100px;\n&#125;\n.error &#123;\n  background: red;\n  height: 100px;\n  width: 100px;\n&#125;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"3\">\n<li>Bind style</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div :style&#x3D;&quot;&#123; color: myColor, fontSize: myFontSize &#125;&quot;&gt;hello&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      myColor: &quot;red&quot;,\n      myFontSize: &quot;190px&quot;,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>You can also bind styles optionally or in a form of array like the class binding.</p>\n<h4 id=\"Instance-monitor-an-input-box\"><a href=\"#Instance-monitor-an-input-box\" class=\"headerlink\" title=\"Instance : monitor an input box\"></a>Instance : monitor an input box</h4><ol>\n<li>The first option</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;!-- key up event will be triggered when your keyboard pops up. --&gt;\n  &lt;input type&#x3D;&quot;text&quot; @keyup&#x3D;&quot;doSearch($event)&quot; &#x2F;&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    doSearch(e: any) &#123;\n      console.log(e.keyCode);\n      &#x2F;* check the input to confirm whether &#96;enter&#96; is pressed. *&#x2F;\n      if (e.keyCode &#x3D;&#x3D; 13) &#123;\n        alert(&quot;enter key is pressed&quot;);\n        &#x2F;* do search *&#x2F;\n      &#125;\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"2\">\n<li>The second option</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;!-- key up event will be triggered when your keyboard pops up. --&gt;\n  &lt;!-- keyup.enter will be triggered when you input a &#96;enter&#96; --&gt;\n  &lt;input type&#x3D;&quot;text&quot; @keyup.enter&#x3D;&quot;doSearch($event)&quot; &#x2F;&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    doSearch(e: any) &#123;\n      &#x2F;* no need to check the input *&#x2F;\n      console.log(e.keyCode);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;ul&gt;\n    &lt;li&gt;name : &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;username&quot; &#x2F;&gt;&lt;&#x2F;li&gt;\n    &lt;li&gt;age : &lt;input type&#x3D;&quot;text&quot; ref&#x3D;&quot;age&quot; &#x2F;&gt;&lt;&#x2F;li&gt;\n  &lt;&#x2F;ul&gt;\n  &lt;button @click&#x3D;&quot;doSubmit()&quot; class&#x3D;&quot;submit&quot;&gt;get content&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    doSubmit() &#123;\n      var username &#x3D; document.querySelector(&quot;#username&quot;);\n      if (username !&#x3D; null) &#123;\n        console.log(username);\n      &#125;\n      console.log(this.$refs.age);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Two-way-binding\"><a href=\"#Two-way-binding\" class=\"headerlink\" title=\"Two-way binding\"></a>Two-way binding</h3><p>DOM consumes a lot of resources. We use the way of two-way binding to get values instead.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;ul&gt;\n    &lt;!-- two-way binding --&gt;\n    &lt;li&gt;name : &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;username&quot; v-model&#x3D;&quot;username&quot; &#x2F;&gt;&lt;&#x2F;li&gt;\n  &lt;&#x2F;ul&gt;\n  &lt;button @click&#x3D;&quot;doSubmit()&quot; class&#x3D;&quot;submit&quot;&gt;get content&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      &#x2F;* two-way binding *&#x2F;\n      username: &quot;jack&quot;,\n    &#125;;\n  &#125;,\n  methods: &#123;\n    doSubmit() &#123;\n      console.log(this.username);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>There are some modifiers for <code>v-model</code> binding, suck as <code>.lazy</code>, <code>.number</code>, <code>.trim</code>.</p>\n<h3 id=\"If-else\"><a href=\"#If-else\" class=\"headerlink\" title=\"If else\"></a>If else</h3><pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; num &#x3D;&#x3D; 1 ? &quot;num&#x3D;1&quot; : &quot;num!&#x3D;1&quot; &#125;&#125;\n  &lt;div v-if&#x3D;&quot;num &#x3D;&#x3D; 1&quot;&gt;hello div&lt;&#x2F;div&gt;\n  &lt;!-- this is invaild and will not take effect --&gt;\n  &lt;span vi-else&gt;hello span&lt;&#x2F;span&gt;\n\n  &lt;!-- this is the correct code --&gt;\n  &lt;div v-if&#x3D;&quot;num &#x3D;&#x3D; 1&quot;&gt;hello div&lt;&#x2F;div&gt;\n  &lt;!-- if num !&#x3D; 1, the label will be deleted by DOM --&gt;\n  &lt;div v-else&gt;goodbye div&lt;&#x2F;div&gt;\n\n  &lt;!-- if num !&#x3D; 1, the label will be hidden by css --&gt;\n  &lt;div v-show&#x3D;&quot;num &#x3D;&#x3D; 1&quot;&gt;hello div&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      num: 2,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Compute\"><a href=\"#Compute\" class=\"headerlink\" title=\"Compute\"></a>Compute</h3><p>The function declared in <code>computed</code> will be called when variables changed.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; calculateNum &#125;&#125;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123; message: &quot;hello&quot; &#125;;\n  &#125;,\n  computed: &#123;\n    calculateNum: function () &#123;\n      let self &#x3D; this as any;\n      return self.message.split(&quot;&quot;).reverse().join(&quot;&quot;);\n      &#x2F;* The lsp will report an error when using the code below. But it will not cause error during the runtime.*&#x2F;\n      &#x2F;* return this.message.split(&quot;&quot;).reverse().join(&quot;&quot;); *&#x2F;\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>The error in above code is caused by the static type checking of typescript lsp. Once you meet this error, and feel confused about the solution. You can fix it by transforming the type to <code>any</code>.</p>\n<h3 id=\"Watcher\"><a href=\"#Watcher\" class=\"headerlink\" title=\"Watcher\"></a>Watcher</h3><pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; counter &#125;&#125;\n  &#123;&#123; count &#125;&#125;\n  &lt;button @click&#x3D;&quot;counter++&quot;&gt;click me&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123; counter: 1, count: 0 &#125;;\n  &#125;,\n  watch: &#123;\n    &#x2F;* the name of the function must be the same as the variable you want to watch *&#x2F;\n    counter: function (value) &#123;\n      this.count &#x3D; value * 2;\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Less\"><a href=\"#Less\" class=\"headerlink\" title=\"Less\"></a>Less</h3><pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div class&#x3D;&quot;todolist&quot;&gt;\n    &lt;h3&gt;TodoList&lt;&#x2F;h3&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;&#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;\n.todolist &#123;\n  width: 500px;\n  height: 500px;\n  background-color: green;\n  h3 &#123;\n    color: red;\n  &#125;\n&#125;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Debouncing-and-Throttling\"><a href=\"#Debouncing-and-Throttling\" class=\"headerlink\" title=\"Debouncing and Throttling\"></a>Debouncing and Throttling</h3><p>You can implement debouncing and throttling by using libraries such as <code>Lodash</code>.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/lodash@4.17.20/lodash.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n    methods<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token comment\">// Debouncing with Lodash</span>\n      click<span class=\"token operator\">:</span> _<span class=\"token punctuation\">.</span><span class=\"token function\">debounce</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token comment\">// ... respond to click ...</span>\n      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>If you want to keep the component instance independently, you can add the debounced function in the created lifecycle hook.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">app<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"save-button\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">created</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token comment\">// Debouncing with Lodash</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>debouncedClick <span class=\"token operator\">=</span> _<span class=\"token punctuation\">.</span><span class=\"token function\">debounce</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">unmounted</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token comment\">// Cancel the timer when the component is removed</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>debouncedClick<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  methods<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token comment\">// ... respond to click ...</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  template<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    &lt;button @click=\"debouncedClick\">\n      Save\n    &lt;/button>\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>I will continue to make notes on the advanced usage of vue, so please stay tuned.</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"Basic-Tutorial-of-Vue-Vite-Typescript\"><a href=\"#Basic-Tutorial-of-Vue-Vite-Typescript\" class=\"headerlink\" title=\"Basic Tutorial of Vue-Vite-Typescript\"></a>Basic Tutorial of Vue-Vite-Typescript</h1><p>The following are the notes I took when I studied vue with reference to the official tutorial. The biggest difference between my notes and official tutorial is that I use typescript while the tutorial uses javascript. I suggest you learn vue following the official tutorial , but I firmly believe that you need to know some of the differences in the use of ts and js.</p>\n<p>And please forgive my stiff English, I was just too lazy to switch input methods.</p>\n<h2 id=\"Init-a-vue-project\"><a href=\"#Init-a-vue-project\" class=\"headerlink\" title=\"Init a vue project\"></a>Init a vue project</h2><p>Create the project</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">npm init @vitejs&#x2F;app appName -- --template vue-ts\ncd appName\nnpm install\nnpm install less -D\nnpm install eslint eslint-plugin-vue -D\nnpm install @vuedx&#x2F;typescript-plugin-vue -D\nnode node_modules&#x2F;esbuild&#x2F;install.js<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Modify <code>coc-settings.json</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&quot;vetur.useWorkspaceDependencies&quot;: true<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>Add the content below to <code>tsconfig.json</code></p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@vuedx/typescript-plugin-vue\"</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Modify <code>vite.config.ts</code> which is located in the root path of the project.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> defineConfig <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vite\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> vue <span class=\"token keyword\">from</span> <span class=\"token string\">\"@vitejs/plugin-vue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">defineConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token function\">vue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  resolve<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    alias<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> vue<span class=\"token operator\">:</span> <span class=\"token string\">\"vue/dist/vue.esm-bundler.js\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Directory-structure-of-the-project\"><a href=\"#Directory-structure-of-the-project\" class=\"headerlink\" title=\"Directory structure of the project\"></a>Directory structure of the project</h2><p><img src=\"1.png\" alt=\"directory structure\"></p>\n<ol>\n<li>public : public resource directory</li>\n<li>src/assets : static resource directory</li>\n<li>src/components : custom components</li>\n<li>src/App.vue : root component</li>\n<li>src/main.ts : root entry</li>\n<li>index.css : root css</li>\n<li>index.html : page entry</li>\n</ol>\n<h2 id=\"Run-project\"><a href=\"#Run-project\" class=\"headerlink\" title=\"Run project\"></a>Run project</h2><p>Use <code>yarn dev</code> to run the project. And then you can check your page at browser.</p>\n<h2 id=\"Content-of-the-vue-file\"><a href=\"#Content-of-the-vue-file\" class=\"headerlink\" title=\"Content of the vue file\"></a>Content of the vue file</h2><pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\"># src&#x2F;App.vue # html part\n&lt;template&gt;\n  &lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;&#x2F;h1&gt;\n&lt;&#x2F;template&gt;\n\n# typescript part\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      msg: &quot;hello vue&quot;,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n# css part\n&lt;style type&#x3D;&quot;text&#x2F;css&quot; media&#x3D;&quot;screen&quot;&gt;\nh1 &#123;\n  text-align: center;\n  color: red;\n&#125;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Commentary\"><a href=\"#Commentary\" class=\"headerlink\" title=\"Commentary\"></a>Commentary</h2><p>In html part (inside of template lable), the commentary looks like this. <code>&lt;!-- annotation --&gt;</code></p>\n<p>In css part (inside of style lable), the commentary looks like this. <code>/* annotation */</code></p>\n<p>In typescript part (inside of script lable), the commentary looks like this. <code>// annotation</code> or <code>/* annotation */</code></p>\n<p>The content outside of the label does not effect.</p>\n<h2 id=\"Create-an-application-instance\"><a href=\"#Create-an-application-instance\" class=\"headerlink\" title=\"Create an application instance\"></a>Create an application instance</h2><p>Each vue application is created by function <code>createApp</code>. For example, you can create an application like this.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> createApp <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">\"./App.vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span>App<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>In the above code, <code>app</code> is our root component. We use method <code>mount</code> to mount <code>app</code> to <code>#app</code>.</p>\n<p><code>#app</code> represents a html label whose id is app. And by default, <code>#app</code> is declared in <code>index.html</code>. For example, <code>&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</code>.</p>\n<p>The method <code>mount</code> returns an instance of the root component. You can get the properties of the component through its instance.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span> count<span class=\"token operator\">:</span> <span class=\"token number\">4</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> vm <span class=\"token operator\">=</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>vm<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>A component contains custom properties and inner properties. You can also get inner properties through the instance of the component using <code>$</code>. For example, <code>$attrs</code>.</p>\n<h2 id=\"lifecycle-hook\"><a href=\"#lifecycle-hook\" class=\"headerlink\" title=\"lifecycle hook\"></a>lifecycle hook</h2><p>Lifetime hook is a function which would be called automatically in different stages of the program runtime.</p>\n<p>For instance, you can use <code>created</code> hook to execute your code after an instance has been created.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span> count<span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">created</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token comment\">/* `this` point to the instance of the component */</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"count is: \"</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Do not use arrow function in properties. For example, <code>created: () =&gt; console.log(&quot;hello&quot;)</code>.</p>\n<h2 id=\"Template-syntax\"><a href=\"#Template-syntax\" class=\"headerlink\" title=\"Template syntax\"></a>Template syntax</h2><h3 id=\"Variable-binding\"><a href=\"#Variable-binding\" class=\"headerlink\" title=\"Variable binding\"></a>Variable binding</h3><p>You can bind typescript variables to html part.</p>\n<ol>\n<li><p>Usually the syntax is <code>&#123;&#123; variable &#125;&#125;</code>.</p>\n</li>\n<li><p>But if you want to bind a html label, the code needs to be changed.</p>\n</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;p&gt;\n      &lt;!-- failed to bind --&gt;\n      &#123;&#123; msg &#125;&#125;\n    &lt;&#x2F;p&gt;\n    &lt;!-- successfully bind to html --&gt;\n    &lt;p&gt;bind html label : &lt;span v-html&#x3D;&quot;msg&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;p&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      msg: &quot;&lt;h2&gt; hello &lt;&#x2F;h2&gt;&quot;,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"3\">\n<li>In order to bind attributes, the syntax will look like this.</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;img v-bind:src&#x3D;&quot;imgPath&quot; alt&#x3D;&quot;&quot; &#x2F;&gt;\n    &lt;!-- or --&gt;\n    &lt;img :src&#x3D;&quot;imgPath&quot; alt&#x3D;&quot;&quot; &#x2F;&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n\t\timgPath&#x3D;&quot;imgPath&quot;\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"4\">\n<li>To bind dynamic attributes.</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;!-- cause an error due to the static url --&gt;\n    &lt;a v-bind:[attributeName]&#x3D;&quot;http:&#x2F;&#x2F;www.url.com&quot; target&#x3D;&quot;_blank&quot;\n      &gt;Anchor Text&lt;&#x2F;a\n    &gt;\n    &lt;!-- you can fix the error in this way --&gt;\n    &lt;a v-bind:[attributeName]&#x3D;&quot;&#39;http:&#x2F;&#x2F;www.url.com&#39;&quot; target&#x3D;&quot;_blank&quot;\n      &gt;Anchor Text&lt;&#x2F;a\n    &gt;\n    &lt;!-- or you can also bind the url --&gt;\n    &lt;a v-bind:[attributeName]&#x3D;&quot;link&quot; target&#x3D;&quot;_blank&quot;&gt;Anchor Text&lt;&#x2F;a&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      attributeName: &quot;href&quot;,\n      link: &quot;http:&#x2F;&#x2F;www.url.com&quot;,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"5\">\n<li>Loop traversal</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &lt;ul&gt;\n      &lt;!-- :key is necessary, and each key must be unique --&gt;\n      &lt;li v-for&#x3D;&quot;(item, index) in list&quot; :key&#x3D;&quot;index&quot;&gt;\n        &#123;&#123; index &#125;&#125;--&#123;&#123; item &#125;&#125;\n      &lt;&#x2F;li&gt;\n    &lt;&#x2F;ul&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      list: [&quot;hello&quot;, &quot;world&quot;],\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>v-for</code> with a range.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>range<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>demo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">v-for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>n in 10<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">:key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>n<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>&#123;&#123; n &#125;&#125; <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"6\">\n<li>Only bind once</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;!-- this would never change --&gt;\n  &lt;span v-once&gt;&#123;&#123; msg &#125;&#125;&lt;&#x2F;span&gt;\n&lt;&#x2F;template&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"7\">\n<li>Bind js expressions</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; msg + 1 &#125;&#125;\n&lt;&#x2F;template&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Method-class-and-style-binding\"><a href=\"#Method-class-and-style-binding\" class=\"headerlink\" title=\"Method, class and style binding\"></a>Method, class and style binding</h3><ol>\n<li>Bind method</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div&gt;\n    &#123;&#123; msg &#125;&#125;\n    &lt;button @click&#x3D;&quot;setMsg&quot;&gt;set msg&lt;&#x2F;button&gt;\n    &lt;button @click&#x3D;&quot;getMsg&quot;&gt;get msg&lt;&#x2F;button&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script charset&#x3D;&quot;utf-8&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      msg: &quot;hello&quot;,\n    &#125;;\n  &#125;,\n  methods: &#123;\n    setMsg() &#123;\n      this.msg &#x3D; &quot;changed msg&quot;;\n      &#x2F;* you can call methods with &#96;this&#96; *&#x2F;\n      this.getMsg();\n    &#125;,\n    getMsg() &#123;\n      alert(this.msg);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; counter &#125;&#125;\n  &lt;br &#x2F;&gt;\n  &lt;!-- You can call a method directly in the template. It will be called multiple --&gt;\n  &lt;!-- times in the rendering stage of the template. So the value of counter is not --&gt;\n  &lt;!-- sure. --&gt;\n  &#123;&#123; count() &#125;&#125;\n  &lt;button @click&#x3D;&quot;count&quot;&gt;click here to count&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      counter: 1,\n    &#125;;\n  &#125;,\n  methods: &#123;\n    count() &#123;\n      this.$data.counter++;\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Bind method with paramaters.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;button @click&#x3D;&quot;getMessage($event)&quot;&gt;click here&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    getMessage(e: any) &#123;\n      e.target.style.background &#x3D; &quot;red&quot;;\n      alert(e);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>You can also bind methods with mutiple paramaters, like this. Note that event must be the last paramater.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;button @click&#x3D;&quot;getMessage(&#39;hello&#39;, $event)&quot;&gt;click here&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    getMessage(str: string, e: any) &#123;\n      e.target.style.background &#x3D; &quot;red&quot;;\n      console.log(str);\n      alert(e);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Bind mutiple methods.</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;template&gt;\n  &lt;button @click&#x3D;&quot;hello1($event), hello2($event)&quot;&gt;click here&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    hello1(e: any) &#123;\n      e.target.style.background &#x3D; &quot;red&quot;;\n    &#125;,\n    hello2(e: any) &#123;\n      alert(e);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Use event modifiers.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">@click.stop</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>doSomething<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!-- the modifiers provided by vue is listed below --></span>\n<span class=\"token comment\">&lt;!-- 1. .stop --></span>\n<span class=\"token comment\">&lt;!-- 2. .prevent --></span>\n<span class=\"token comment\">&lt;!-- 3. .capture --></span>\n<span class=\"token comment\">&lt;!-- 4. .self --></span>\n<span class=\"token comment\">&lt;!-- 5. .once --></span>\n<span class=\"token comment\">&lt;!-- 6. .passive --></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>There are also key modifiers, such as <code>&lt;input @keyup.enter = &quot;submit&quot; /&gt;</code>.</p>\n<p>You can use key aliases, such as <code>.enter</code>, <code>.tab</code>, <code>.delete</code>, <code>.esc</code>, <code>.space</code>, <code>.up</code>, <code>.down</code>, <code>.left</code>, <code>.right</code>, instead of key modifiers.</p>\n<p>System modifier keys such as <code>.ctrl</code>, <code>.alt</code>, <code>.shift</code>, <code>.meta</code> are also useful.</p>\n<ol start=\"2\">\n<li>Bind class</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div class&#x3D;&quot;custom&quot;&gt;&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;\n.custom &#123;\n  background: red;\n  height: 100px;\n  width: 100px;\n&#125;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>You can also bind classes dynamically.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div :class&#x3D;&quot;myClass&quot;&gt;&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      myClass: &quot;custom&quot;,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;\n.custom &#123;\n  background: red;\n  height: 100px;\n  width: 100px;\n&#125;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Optionally bind classes and bind more than one class at one time.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;!-- bind class &#96;active&#96; and &#96;error&#96; optionally and also bind class &#96;custom&#96; --&gt;\n  &lt;div class&#x3D;&quot;custom&quot; :class&#x3D;&quot;&#123; active: isActive, error: isError &#125;&quot;&gt;&lt;&#x2F;div&gt;\n\n  &lt;!-- bind class &#96;active&#96; or &#96;error&#96; --&gt;\n  &lt;div class&#x3D;&quot;&#123;isActive ? active : error&#125;&quot;&gt;&lt;&#x2F;div&gt;\n\n  &lt;!-- bind class &#96;custom&#96; and &#96;active&#96; --&gt;\n  &lt;div :class&#x3D;&quot;[&#39;active&#39;, &#39;custom&#39;]&quot;&gt;&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      isActive: true,\n      isError: false,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;\n.custom &#123;\n  margin: 10px;\n&#125;\n.active &#123;\n  background: yellowgreen;\n  height: 100px;\n  width: 100px;\n&#125;\n.error &#123;\n  background: red;\n  height: 100px;\n  width: 100px;\n&#125;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"3\">\n<li>Bind style</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div :style&#x3D;&quot;&#123; color: myColor, fontSize: myFontSize &#125;&quot;&gt;hello&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      myColor: &quot;red&quot;,\n      myFontSize: &quot;190px&quot;,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>You can also bind styles optionally or in a form of array like the class binding.</p>\n<h4 id=\"Instance-monitor-an-input-box\"><a href=\"#Instance-monitor-an-input-box\" class=\"headerlink\" title=\"Instance : monitor an input box\"></a>Instance : monitor an input box</h4><ol>\n<li>The first option</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;!-- key up event will be triggered when your keyboard pops up. --&gt;\n  &lt;input type&#x3D;&quot;text&quot; @keyup&#x3D;&quot;doSearch($event)&quot; &#x2F;&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    doSearch(e: any) &#123;\n      console.log(e.keyCode);\n      &#x2F;* check the input to confirm whether &#96;enter&#96; is pressed. *&#x2F;\n      if (e.keyCode &#x3D;&#x3D; 13) &#123;\n        alert(&quot;enter key is pressed&quot;);\n        &#x2F;* do search *&#x2F;\n      &#125;\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"2\">\n<li>The second option</li>\n</ol>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;!-- key up event will be triggered when your keyboard pops up. --&gt;\n  &lt;!-- keyup.enter will be triggered when you input a &#96;enter&#96; --&gt;\n  &lt;input type&#x3D;&quot;text&quot; @keyup.enter&#x3D;&quot;doSearch($event)&quot; &#x2F;&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    doSearch(e: any) &#123;\n      &#x2F;* no need to check the input *&#x2F;\n      console.log(e.keyCode);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;ul&gt;\n    &lt;li&gt;name : &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;username&quot; &#x2F;&gt;&lt;&#x2F;li&gt;\n    &lt;li&gt;age : &lt;input type&#x3D;&quot;text&quot; ref&#x3D;&quot;age&quot; &#x2F;&gt;&lt;&#x2F;li&gt;\n  &lt;&#x2F;ul&gt;\n  &lt;button @click&#x3D;&quot;doSubmit()&quot; class&#x3D;&quot;submit&quot;&gt;get content&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;&#125;;\n  &#125;,\n  methods: &#123;\n    doSubmit() &#123;\n      var username &#x3D; document.querySelector(&quot;#username&quot;);\n      if (username !&#x3D; null) &#123;\n        console.log(username);\n      &#125;\n      console.log(this.$refs.age);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Two-way-binding\"><a href=\"#Two-way-binding\" class=\"headerlink\" title=\"Two-way binding\"></a>Two-way binding</h3><p>DOM consumes a lot of resources. We use the way of two-way binding to get values instead.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;ul&gt;\n    &lt;!-- two-way binding --&gt;\n    &lt;li&gt;name : &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;username&quot; v-model&#x3D;&quot;username&quot; &#x2F;&gt;&lt;&#x2F;li&gt;\n  &lt;&#x2F;ul&gt;\n  &lt;button @click&#x3D;&quot;doSubmit()&quot; class&#x3D;&quot;submit&quot;&gt;get content&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      &#x2F;* two-way binding *&#x2F;\n      username: &quot;jack&quot;,\n    &#125;;\n  &#125;,\n  methods: &#123;\n    doSubmit() &#123;\n      console.log(this.username);\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>There are some modifiers for <code>v-model</code> binding, suck as <code>.lazy</code>, <code>.number</code>, <code>.trim</code>.</p>\n<h3 id=\"If-else\"><a href=\"#If-else\" class=\"headerlink\" title=\"If else\"></a>If else</h3><pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; num &#x3D;&#x3D; 1 ? &quot;num&#x3D;1&quot; : &quot;num!&#x3D;1&quot; &#125;&#125;\n  &lt;div v-if&#x3D;&quot;num &#x3D;&#x3D; 1&quot;&gt;hello div&lt;&#x2F;div&gt;\n  &lt;!-- this is invaild and will not take effect --&gt;\n  &lt;span vi-else&gt;hello span&lt;&#x2F;span&gt;\n\n  &lt;!-- this is the correct code --&gt;\n  &lt;div v-if&#x3D;&quot;num &#x3D;&#x3D; 1&quot;&gt;hello div&lt;&#x2F;div&gt;\n  &lt;!-- if num !&#x3D; 1, the label will be deleted by DOM --&gt;\n  &lt;div v-else&gt;goodbye div&lt;&#x2F;div&gt;\n\n  &lt;!-- if num !&#x3D; 1, the label will be hidden by css --&gt;\n  &lt;div v-show&#x3D;&quot;num &#x3D;&#x3D; 1&quot;&gt;hello div&lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123;\n      num: 2,\n    &#125;;\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Compute\"><a href=\"#Compute\" class=\"headerlink\" title=\"Compute\"></a>Compute</h3><p>The function declared in <code>computed</code> will be called when variables changed.</p>\n<pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; calculateNum &#125;&#125;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123; message: &quot;hello&quot; &#125;;\n  &#125;,\n  computed: &#123;\n    calculateNum: function () &#123;\n      let self &#x3D; this as any;\n      return self.message.split(&quot;&quot;).reverse().join(&quot;&quot;);\n      &#x2F;* The lsp will report an error when using the code below. But it will not cause error during the runtime.*&#x2F;\n      &#x2F;* return this.message.split(&quot;&quot;).reverse().join(&quot;&quot;); *&#x2F;\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>The error in above code is caused by the static type checking of typescript lsp. Once you meet this error, and feel confused about the solution. You can fix it by transforming the type to <code>any</code>.</p>\n<h3 id=\"Watcher\"><a href=\"#Watcher\" class=\"headerlink\" title=\"Watcher\"></a>Watcher</h3><pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &#123;&#123; counter &#125;&#125;\n  &#123;&#123; count &#125;&#125;\n  &lt;button @click&#x3D;&quot;counter++&quot;&gt;click me&lt;&#x2F;button&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;\n    return &#123; counter: 1, count: 0 &#125;;\n  &#125;,\n  watch: &#123;\n    &#x2F;* the name of the function must be the same as the variable you want to watch *&#x2F;\n    counter: function (value) &#123;\n      this.count &#x3D; value * 2;\n    &#125;,\n  &#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Less\"><a href=\"#Less\" class=\"headerlink\" title=\"Less\"></a>Less</h3><pre class=\"line-numbers language-vue\" data-language=\"vue\"><code class=\"language-vue\">&lt;template&gt;\n  &lt;div class&#x3D;&quot;todolist&quot;&gt;\n    &lt;h3&gt;TodoList&lt;&#x2F;h3&gt;\n  &lt;&#x2F;div&gt;\n&lt;&#x2F;template&gt;\n\n&lt;script lang&#x3D;&quot;ts&quot;&gt;\nexport default &#123;\n  data() &#123;&#125;,\n&#125;;\n&lt;&#x2F;script&gt;\n\n&lt;style lang&#x3D;&quot;less&quot; scoped&gt;\n.todolist &#123;\n  width: 500px;\n  height: 500px;\n  background-color: green;\n  h3 &#123;\n    color: red;\n  &#125;\n&#125;\n&lt;&#x2F;style&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Debouncing-and-Throttling\"><a href=\"#Debouncing-and-Throttling\" class=\"headerlink\" title=\"Debouncing and Throttling\"></a>Debouncing and Throttling</h3><p>You can implement debouncing and throttling by using libraries such as <code>Lodash</code>.</p>\n<pre class=\"line-numbers language-html\" data-language=\"html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://unpkg.com/lodash@4.17.20/lodash.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  Vue<span class=\"token punctuation\">.</span><span class=\"token function\">createApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n    methods<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token comment\">// Debouncing with Lodash</span>\n      click<span class=\"token operator\">:</span> _<span class=\"token punctuation\">.</span><span class=\"token function\">debounce</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token comment\">// ... respond to click ...</span>\n      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#app\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>If you want to keep the component instance independently, you can add the debounced function in the created lifecycle hook.</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\">app<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"save-button\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token function\">created</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token comment\">// Debouncing with Lodash</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>debouncedClick <span class=\"token operator\">=</span> _<span class=\"token punctuation\">.</span><span class=\"token function\">debounce</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">unmounted</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token comment\">// Cancel the timer when the component is removed</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>debouncedClick<span class=\"token punctuation\">.</span><span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  methods<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token comment\">// ... respond to click ...</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  template<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    &lt;button @click=\"debouncedClick\">\n      Save\n    &lt;/button>\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>I will continue to make notes on the advanced usage of vue, so please stay tuned.</p>\n"},{"title":"Better Highlight for Go Files in Vim","date":"2021-04-28T13:46:41.000Z","_content":"\n# vim 中更好的 go 语言高亮\n\n本文主要说明如何解决 go 方法在大多数配色方案中无法高亮的问题。\n\n## 问题描述\n\nvim 现有的绝大多数高亮插件都没有对 go 语言方法进行高亮。如`fmt.Printf`。则`Printf`不会被高亮。\n\n## 解决方案\n\n访问[athom/more-colorful.vim](https://github.com/athom/more-colorful.vim/blob/master/after/syntax/go.vim)。将文件内容拷贝到`~/.vim/after/syntax/`。如果是 neovim，则拷贝到`～/.config/nvim/after/syntax/`。\n\n该配置提供了操作符、函数、方法、结构体的高亮。需要取消某一高亮只需要修改以下内容。\n\n```vim\nif !exists(\"go_highlight_operators\")\n\tlet go_highlight_operators = 0\nendif\n```\n\n要给各高亮组换色只需要设置以下内容。\n\n```vim\nhi goMethod guifg=#4dffff\n```\n","source":"_posts/better-highlight-for-go-files-in-vim.md","raw":"---\ntitle: Better Highlight for Go Files in Vim\ndate: 2021-04-28 21:46:41\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# vim 中更好的 go 语言高亮\n\n本文主要说明如何解决 go 方法在大多数配色方案中无法高亮的问题。\n\n## 问题描述\n\nvim 现有的绝大多数高亮插件都没有对 go 语言方法进行高亮。如`fmt.Printf`。则`Printf`不会被高亮。\n\n## 解决方案\n\n访问[athom/more-colorful.vim](https://github.com/athom/more-colorful.vim/blob/master/after/syntax/go.vim)。将文件内容拷贝到`~/.vim/after/syntax/`。如果是 neovim，则拷贝到`～/.config/nvim/after/syntax/`。\n\n该配置提供了操作符、函数、方法、结构体的高亮。需要取消某一高亮只需要修改以下内容。\n\n```vim\nif !exists(\"go_highlight_operators\")\n\tlet go_highlight_operators = 0\nendif\n```\n\n要给各高亮组换色只需要设置以下内容。\n\n```vim\nhi goMethod guifg=#4dffff\n```\n","slug":"better-highlight-for-go-files-in-vim","published":1,"updated":"2021-04-28T14:13:36.125Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmra0009rrizhy1n939c","content":"<h1 id=\"vim-中更好的-go-语言高亮\"><a href=\"#vim-中更好的-go-语言高亮\" class=\"headerlink\" title=\"vim 中更好的 go 语言高亮\"></a>vim 中更好的 go 语言高亮</h1><p>本文主要说明如何解决 go 方法在大多数配色方案中无法高亮的问题。</p>\n<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>vim 现有的绝大多数高亮插件都没有对 go 语言方法进行高亮。如<code>fmt.Printf</code>。则<code>Printf</code>不会被高亮。</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>访问<a href=\"https://github.com/athom/more-colorful.vim/blob/master/after/syntax/go.vim\">athom/more-colorful.vim</a>。将文件内容拷贝到<code>~/.vim/after/syntax/</code>。如果是 neovim，则拷贝到<code>～/.config/nvim/after/syntax/</code>。</p>\n<p>该配置提供了操作符、函数、方法、结构体的高亮。需要取消某一高亮只需要修改以下内容。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">if</span> <span class=\"token operator\">!</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"go_highlight_operators\"</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">let</span> go_highlight_operators <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">endif</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>要给各高亮组换色只需要设置以下内容。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token builtin\">hi</span> goMethod guifg<span class=\"token operator\">=</span>#4dffff<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"vim-中更好的-go-语言高亮\"><a href=\"#vim-中更好的-go-语言高亮\" class=\"headerlink\" title=\"vim 中更好的 go 语言高亮\"></a>vim 中更好的 go 语言高亮</h1><p>本文主要说明如何解决 go 方法在大多数配色方案中无法高亮的问题。</p>\n<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>vim 现有的绝大多数高亮插件都没有对 go 语言方法进行高亮。如<code>fmt.Printf</code>。则<code>Printf</code>不会被高亮。</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>访问<a href=\"https://github.com/athom/more-colorful.vim/blob/master/after/syntax/go.vim\">athom/more-colorful.vim</a>。将文件内容拷贝到<code>~/.vim/after/syntax/</code>。如果是 neovim，则拷贝到<code>～/.config/nvim/after/syntax/</code>。</p>\n<p>该配置提供了操作符、函数、方法、结构体的高亮。需要取消某一高亮只需要修改以下内容。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">if</span> <span class=\"token operator\">!</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"go_highlight_operators\"</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">let</span> go_highlight_operators <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">endif</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>要给各高亮组换色只需要设置以下内容。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token builtin\">hi</span> goMethod guifg<span class=\"token operator\">=</span>#4dffff<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n"},{"title":"Better Use of Rust on Gentoo","date":"2021-04-24T13:26:57.000Z","_content":"\n# 在 gentoo 上更好地使用 rust\n\n本文介绍在 gentoo 上避开 portage 使用 rust 的方法以及 rust 编译缓存的设置。\n\n## 使用官方 rust\n\nrust 官方提供的 rust 安装方式为`curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh`。你可以使用该命令安装官方 rust 工具链。但是 gentoo 系统并不会自动识别你安装的 rust。因此在安装一些由 rust 编译的软件时，包管理系统依旧会先编译 rust。之所以不推荐使用系统编译的 rust，主要还是编译耗时太长，对于需要多个版本编译链的用户并不友好。接下来，说明如何使包管理系统识别到用户自己安装的 rust。\n\n首先，执行以下命令。\n\n```shell\nsudo mkdir -p /etc/portage/profile/package.provided\n```\n\n该目录用于向包管理系统标记已经安装的程序。\n\n编辑`/etc/portage/profile/package.provided/rust`，写入已经存在的程序。\n\n```\ndev-lang/rust-1.50.0\nvirtual/rust-1.50.0\ndev-util/cargo-1.50.0\ndev-util/rustup-1.23.0\n```\n\n注意，必须指明版本，查看当前软件的版本写入即可，之后如果有升级也不必修改，除非软件依赖要求更高版本。\n\n编辑`/etc/portage/profile/profile.bashrc`，写入已安装的这些软件的路径。\n\n```shell\nexport PATH=\"/home/yourname/.cargo/bin:$PATH\"\n\nSTABLE=/home/yourname/.rustup/toolchains/stable-x86_64-unknown-linux-gnu\nrustup toolchain link build-stable $STABLE &> /dev/null\nrustup default build-stable &> /dev/null\n```\n\n建议使用 stable 版本的工具链。另外使用自己的用户名。\n\n至此，包管理系统已经可以自动识别并使用用户自行安装的 rust，如果不放心，你也可以进一步 mask 掉这些包。\n\n## rust 编译缓存\n\nC、C++的编译可以使用 ccache 作为缓存器，这样下次编译时会调用本次的成果，可以大大节省编译时间。对于 rust 而言，这个工具是 sccache。\n\n执行以下命令。\n\n```shell\nemerge --ask dev-util/sccache\nmkdir -p /var/cache/sccache\nchown root:portage /var/cache/sccache\nchmod 2775 /var/cache/sccache\n```\n\n编辑`/etc/sandbox.d/20sccache`，写入\n\n```\nSANDBOX_WRITE=\"/var/cache/sccache/\"\n```\n\n编辑`/etc/portage/make.conf`，写入\n\n```\nRUSTC_WRAPPER=/usr/bin/sccache\nSCCACHE_DIR=/var/cache/sccache\nSCCACHE_MAX_FRAME_LENGTH=104857600\n```\n","source":"_posts/better-use-of-rust-on-gentoo.md","raw":"---\ntitle: Better Use of Rust on Gentoo\ndate: 2021-04-24 21:26:57\ntags:\n\t\t- Gentoo\ncategories:\n\t\t- Gentoo\n---\n\n# 在 gentoo 上更好地使用 rust\n\n本文介绍在 gentoo 上避开 portage 使用 rust 的方法以及 rust 编译缓存的设置。\n\n## 使用官方 rust\n\nrust 官方提供的 rust 安装方式为`curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh`。你可以使用该命令安装官方 rust 工具链。但是 gentoo 系统并不会自动识别你安装的 rust。因此在安装一些由 rust 编译的软件时，包管理系统依旧会先编译 rust。之所以不推荐使用系统编译的 rust，主要还是编译耗时太长，对于需要多个版本编译链的用户并不友好。接下来，说明如何使包管理系统识别到用户自己安装的 rust。\n\n首先，执行以下命令。\n\n```shell\nsudo mkdir -p /etc/portage/profile/package.provided\n```\n\n该目录用于向包管理系统标记已经安装的程序。\n\n编辑`/etc/portage/profile/package.provided/rust`，写入已经存在的程序。\n\n```\ndev-lang/rust-1.50.0\nvirtual/rust-1.50.0\ndev-util/cargo-1.50.0\ndev-util/rustup-1.23.0\n```\n\n注意，必须指明版本，查看当前软件的版本写入即可，之后如果有升级也不必修改，除非软件依赖要求更高版本。\n\n编辑`/etc/portage/profile/profile.bashrc`，写入已安装的这些软件的路径。\n\n```shell\nexport PATH=\"/home/yourname/.cargo/bin:$PATH\"\n\nSTABLE=/home/yourname/.rustup/toolchains/stable-x86_64-unknown-linux-gnu\nrustup toolchain link build-stable $STABLE &> /dev/null\nrustup default build-stable &> /dev/null\n```\n\n建议使用 stable 版本的工具链。另外使用自己的用户名。\n\n至此，包管理系统已经可以自动识别并使用用户自行安装的 rust，如果不放心，你也可以进一步 mask 掉这些包。\n\n## rust 编译缓存\n\nC、C++的编译可以使用 ccache 作为缓存器，这样下次编译时会调用本次的成果，可以大大节省编译时间。对于 rust 而言，这个工具是 sccache。\n\n执行以下命令。\n\n```shell\nemerge --ask dev-util/sccache\nmkdir -p /var/cache/sccache\nchown root:portage /var/cache/sccache\nchmod 2775 /var/cache/sccache\n```\n\n编辑`/etc/sandbox.d/20sccache`，写入\n\n```\nSANDBOX_WRITE=\"/var/cache/sccache/\"\n```\n\n编辑`/etc/portage/make.conf`，写入\n\n```\nRUSTC_WRAPPER=/usr/bin/sccache\nSCCACHE_DIR=/var/cache/sccache\nSCCACHE_MAX_FRAME_LENGTH=104857600\n```\n","slug":"better-use-of-rust-on-gentoo","published":1,"updated":"2021-04-24T13:47:26.895Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmrb000brrizdeuz3kop","content":"<h1 id=\"在-gentoo-上更好地使用-rust\"><a href=\"#在-gentoo-上更好地使用-rust\" class=\"headerlink\" title=\"在 gentoo 上更好地使用 rust\"></a>在 gentoo 上更好地使用 rust</h1><p>本文介绍在 gentoo 上避开 portage 使用 rust 的方法以及 rust 编译缓存的设置。</p>\n<h2 id=\"使用官方-rust\"><a href=\"#使用官方-rust\" class=\"headerlink\" title=\"使用官方 rust\"></a>使用官方 rust</h2><p>rust 官方提供的 rust 安装方式为<code>curl --proto &#39;=https&#39; --tlsv1.2 -sSf https://sh.rustup.rs | sh</code>。你可以使用该命令安装官方 rust 工具链。但是 gentoo 系统并不会自动识别你安装的 rust。因此在安装一些由 rust 编译的软件时，包管理系统依旧会先编译 rust。之所以不推荐使用系统编译的 rust，主要还是编译耗时太长，对于需要多个版本编译链的用户并不友好。接下来，说明如何使包管理系统识别到用户自己安装的 rust。</p>\n<p>首先，执行以下命令。</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">sudo mkdir -p &#x2F;etc&#x2F;portage&#x2F;profile&#x2F;package.provided<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>该目录用于向包管理系统标记已经安装的程序。</p>\n<p>编辑<code>/etc/portage/profile/package.provided/rust</code>，写入已经存在的程序。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">dev-lang&#x2F;rust-1.50.0\nvirtual&#x2F;rust-1.50.0\ndev-util&#x2F;cargo-1.50.0\ndev-util&#x2F;rustup-1.23.0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意，必须指明版本，查看当前软件的版本写入即可，之后如果有升级也不必修改，除非软件依赖要求更高版本。</p>\n<p>编辑<code>/etc/portage/profile/profile.bashrc</code>，写入已安装的这些软件的路径。</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">export PATH&#x3D;&quot;&#x2F;home&#x2F;yourname&#x2F;.cargo&#x2F;bin:$PATH&quot;\n\nSTABLE&#x3D;&#x2F;home&#x2F;yourname&#x2F;.rustup&#x2F;toolchains&#x2F;stable-x86_64-unknown-linux-gnu\nrustup toolchain link build-stable $STABLE &amp;&gt; &#x2F;dev&#x2F;null\nrustup default build-stable &amp;&gt; &#x2F;dev&#x2F;null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>建议使用 stable 版本的工具链。另外使用自己的用户名。</p>\n<p>至此，包管理系统已经可以自动识别并使用用户自行安装的 rust，如果不放心，你也可以进一步 mask 掉这些包。</p>\n<h2 id=\"rust-编译缓存\"><a href=\"#rust-编译缓存\" class=\"headerlink\" title=\"rust 编译缓存\"></a>rust 编译缓存</h2><p>C、C++的编译可以使用 ccache 作为缓存器，这样下次编译时会调用本次的成果，可以大大节省编译时间。对于 rust 而言，这个工具是 sccache。</p>\n<p>执行以下命令。</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">emerge --ask dev-util&#x2F;sccache\nmkdir -p &#x2F;var&#x2F;cache&#x2F;sccache\nchown root:portage &#x2F;var&#x2F;cache&#x2F;sccache\nchmod 2775 &#x2F;var&#x2F;cache&#x2F;sccache<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>编辑<code>/etc/sandbox.d/20sccache</code>，写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SANDBOX_WRITE&#x3D;&quot;&#x2F;var&#x2F;cache&#x2F;sccache&#x2F;&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>编辑<code>/etc/portage/make.conf</code>，写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">RUSTC_WRAPPER&#x3D;&#x2F;usr&#x2F;bin&#x2F;sccache\nSCCACHE_DIR&#x3D;&#x2F;var&#x2F;cache&#x2F;sccache\nSCCACHE_MAX_FRAME_LENGTH&#x3D;104857600<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"在-gentoo-上更好地使用-rust\"><a href=\"#在-gentoo-上更好地使用-rust\" class=\"headerlink\" title=\"在 gentoo 上更好地使用 rust\"></a>在 gentoo 上更好地使用 rust</h1><p>本文介绍在 gentoo 上避开 portage 使用 rust 的方法以及 rust 编译缓存的设置。</p>\n<h2 id=\"使用官方-rust\"><a href=\"#使用官方-rust\" class=\"headerlink\" title=\"使用官方 rust\"></a>使用官方 rust</h2><p>rust 官方提供的 rust 安装方式为<code>curl --proto &#39;=https&#39; --tlsv1.2 -sSf https://sh.rustup.rs | sh</code>。你可以使用该命令安装官方 rust 工具链。但是 gentoo 系统并不会自动识别你安装的 rust。因此在安装一些由 rust 编译的软件时，包管理系统依旧会先编译 rust。之所以不推荐使用系统编译的 rust，主要还是编译耗时太长，对于需要多个版本编译链的用户并不友好。接下来，说明如何使包管理系统识别到用户自己安装的 rust。</p>\n<p>首先，执行以下命令。</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">sudo mkdir -p &#x2F;etc&#x2F;portage&#x2F;profile&#x2F;package.provided<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>该目录用于向包管理系统标记已经安装的程序。</p>\n<p>编辑<code>/etc/portage/profile/package.provided/rust</code>，写入已经存在的程序。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">dev-lang&#x2F;rust-1.50.0\nvirtual&#x2F;rust-1.50.0\ndev-util&#x2F;cargo-1.50.0\ndev-util&#x2F;rustup-1.23.0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意，必须指明版本，查看当前软件的版本写入即可，之后如果有升级也不必修改，除非软件依赖要求更高版本。</p>\n<p>编辑<code>/etc/portage/profile/profile.bashrc</code>，写入已安装的这些软件的路径。</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">export PATH&#x3D;&quot;&#x2F;home&#x2F;yourname&#x2F;.cargo&#x2F;bin:$PATH&quot;\n\nSTABLE&#x3D;&#x2F;home&#x2F;yourname&#x2F;.rustup&#x2F;toolchains&#x2F;stable-x86_64-unknown-linux-gnu\nrustup toolchain link build-stable $STABLE &amp;&gt; &#x2F;dev&#x2F;null\nrustup default build-stable &amp;&gt; &#x2F;dev&#x2F;null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>建议使用 stable 版本的工具链。另外使用自己的用户名。</p>\n<p>至此，包管理系统已经可以自动识别并使用用户自行安装的 rust，如果不放心，你也可以进一步 mask 掉这些包。</p>\n<h2 id=\"rust-编译缓存\"><a href=\"#rust-编译缓存\" class=\"headerlink\" title=\"rust 编译缓存\"></a>rust 编译缓存</h2><p>C、C++的编译可以使用 ccache 作为缓存器，这样下次编译时会调用本次的成果，可以大大节省编译时间。对于 rust 而言，这个工具是 sccache。</p>\n<p>执行以下命令。</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\">emerge --ask dev-util&#x2F;sccache\nmkdir -p &#x2F;var&#x2F;cache&#x2F;sccache\nchown root:portage &#x2F;var&#x2F;cache&#x2F;sccache\nchmod 2775 &#x2F;var&#x2F;cache&#x2F;sccache<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>编辑<code>/etc/sandbox.d/20sccache</code>，写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SANDBOX_WRITE&#x3D;&quot;&#x2F;var&#x2F;cache&#x2F;sccache&#x2F;&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>编辑<code>/etc/portage/make.conf</code>，写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">RUSTC_WRAPPER&#x3D;&#x2F;usr&#x2F;bin&#x2F;sccache\nSCCACHE_DIR&#x3D;&#x2F;var&#x2F;cache&#x2F;sccache\nSCCACHE_MAX_FRAME_LENGTH&#x3D;104857600<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n"},{"title":"Build aarch64 Cross Toolchain on Gentoo with Crossdev","date":"2021-03-23T10:23:01.000Z","_content":"\n# gentoo 使用 crossdev 建立 aarch64 交叉编译链\n\ncrossdev 和 aarch64 交叉编译链的安装指令很简单，网上随处可搜到。这里主要指出其中的一个 bug。即在编译 aarch64-linux-gnu glibc 时出现`no such instruction`的 bug。该错误的意思主要是缺少汇编指令。但是并不是 binutils 的问题，而是编译 glibc 时自动选择的编译器为 gcc（应该是遵照了`/etc/portage/make.conf`中的设置，没有自动换过来），而 gcc 在系统上指的是 x86_64 的 gcc。查看是否是该原因引起的错误，看日志文件中`CC`选项。修复该错误只需要在 crossdev 命令前加上`CC=aarch64-unknown-linux-gnu-gcc`。然后在编译`cross-aarch64-unknown-linux-gnu-gcc-stage2`时，再用回 x86_64 的 gcc。\n","source":"_posts/build-aarch64-cross-toolchain-on-gentoo-with-crossdev.md","raw":"---\ntitle: Build aarch64 Cross Toolchain on Gentoo with Crossdev\ndate: 2021-03-23 18:23:01\ntags:\n\t\t- Gentoo\ncategories:\n\t\t- Gentoo\n---\n\n# gentoo 使用 crossdev 建立 aarch64 交叉编译链\n\ncrossdev 和 aarch64 交叉编译链的安装指令很简单，网上随处可搜到。这里主要指出其中的一个 bug。即在编译 aarch64-linux-gnu glibc 时出现`no such instruction`的 bug。该错误的意思主要是缺少汇编指令。但是并不是 binutils 的问题，而是编译 glibc 时自动选择的编译器为 gcc（应该是遵照了`/etc/portage/make.conf`中的设置，没有自动换过来），而 gcc 在系统上指的是 x86_64 的 gcc。查看是否是该原因引起的错误，看日志文件中`CC`选项。修复该错误只需要在 crossdev 命令前加上`CC=aarch64-unknown-linux-gnu-gcc`。然后在编译`cross-aarch64-unknown-linux-gnu-gcc-stage2`时，再用回 x86_64 的 gcc。\n","slug":"build-aarch64-cross-toolchain-on-gentoo-with-crossdev","published":1,"updated":"2021-03-23T11:11:18.575Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmrd000grrizdggf7gin","content":"<h1 id=\"gentoo-使用-crossdev-建立-aarch64-交叉编译链\"><a href=\"#gentoo-使用-crossdev-建立-aarch64-交叉编译链\" class=\"headerlink\" title=\"gentoo 使用 crossdev 建立 aarch64 交叉编译链\"></a>gentoo 使用 crossdev 建立 aarch64 交叉编译链</h1><p>crossdev 和 aarch64 交叉编译链的安装指令很简单，网上随处可搜到。这里主要指出其中的一个 bug。即在编译 aarch64-linux-gnu glibc 时出现<code>no such instruction</code>的 bug。该错误的意思主要是缺少汇编指令。但是并不是 binutils 的问题，而是编译 glibc 时自动选择的编译器为 gcc（应该是遵照了<code>/etc/portage/make.conf</code>中的设置，没有自动换过来），而 gcc 在系统上指的是 x86_64 的 gcc。查看是否是该原因引起的错误，看日志文件中<code>CC</code>选项。修复该错误只需要在 crossdev 命令前加上<code>CC=aarch64-unknown-linux-gnu-gcc</code>。然后在编译<code>cross-aarch64-unknown-linux-gnu-gcc-stage2</code>时，再用回 x86_64 的 gcc。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"gentoo-使用-crossdev-建立-aarch64-交叉编译链\"><a href=\"#gentoo-使用-crossdev-建立-aarch64-交叉编译链\" class=\"headerlink\" title=\"gentoo 使用 crossdev 建立 aarch64 交叉编译链\"></a>gentoo 使用 crossdev 建立 aarch64 交叉编译链</h1><p>crossdev 和 aarch64 交叉编译链的安装指令很简单，网上随处可搜到。这里主要指出其中的一个 bug。即在编译 aarch64-linux-gnu glibc 时出现<code>no such instruction</code>的 bug。该错误的意思主要是缺少汇编指令。但是并不是 binutils 的问题，而是编译 glibc 时自动选择的编译器为 gcc（应该是遵照了<code>/etc/portage/make.conf</code>中的设置，没有自动换过来），而 gcc 在系统上指的是 x86_64 的 gcc。查看是否是该原因引起的错误，看日志文件中<code>CC</code>选项。修复该错误只需要在 crossdev 命令前加上<code>CC=aarch64-unknown-linux-gnu-gcc</code>。然后在编译<code>cross-aarch64-unknown-linux-gnu-gcc-stage2</code>时，再用回 x86_64 的 gcc。</p>\n"},{"title":"Create Tauri Project with Vue-Typescript-Less-Vite","date":"2021-06-04T06:25:54.000Z","_content":"\n# 创建 Tauri + Vue + Typescript + Vite + Less 应用\n\n## 项目创建流程\n\n直接上代码\n\n`app_init.sh`\n\n```sh\ntemplatePath=xxx\necho \"What's your app's name?\"\nread appName\nyarn create @vitejs/app $appName --template vue-ts\ncd $appName\nyarn set version berry\ncp \"$templatePath/tauri/yarnrc.yml\" .yarnrc.yml\nyarn install\nyarn add less -D\nyarn add eslint eslint-plugin-vue -D\nyarn add @vuedx/typescript-plugin-vue -D\nrm ./tsconfig.json\ncp \"$templatePath/tauri/tsconfig.json\" tsconfig.json\nrm src/shims-vue.d.ts\nrm vite.config.ts\ncp \"$templatePath/tauri/vite.config.ts\" vite.config.ts\ncp \"$templatePath/tauri/tauri-plugin.ts\" tauri-plugin.ts\nyarn add tauri @types/sharp\nyarn add @rollup/plugin-replace -D\nyarn tauri init\n```\n\n`$templatePath`自定，注意模板文件在`$templatePath/tauri`下。\n\n以上涉及的几个文件放在下面。\n\n`yarnrc.yml`\n\n```yml\nyarnPath: \".yarn/releases/yarn-berry.cjs\"\nnodeLinker: node-modules\nnpmRegistryServer: \"https://registry.npm.taobao.org/\"\n```\n\n`tauri-plugin.ts`\n\n```typescript\nimport { TauriConfig } from \"tauri/src/types\";\nimport type { Plugin, ConfigEnv, ResolvedConfig } from \"vite\";\nimport tauriConf from \"./src-tauri/tauri.conf.json\";\nimport dev from \"tauri/dist/api/dev\";\nimport build from \"tauri/dist/api/build\";\nimport replace from \"@rollup/plugin-replace\";\nimport { isAbsolute, resolve } from \"path\";\n\ninterface Options {\n  config?: (c: TauriConfig, e: ConfigEnv) => TauriConfig;\n}\n\nexport default (options?: Options): Plugin => {\n  let tauriConfig = { ...tauriConf };\n  let viteConfig: ResolvedConfig;\n  return {\n    ...replace({\n      \"process.env.IS_TAURI\": true,\n    }),\n    name: \"tauri-plugin\",\n    configureServer(server) {\n      server.httpServer.on(\"listening\", () => {\n        if (!process.env.TAURI_SERVE) {\n          process.env.TAURI_SERVE = \"true\";\n          const serverOptions = server.config.server || {};\n          let port = serverOptions.port || 3000;\n          let hostname = serverOptions.host || \"localhost\";\n          if (hostname === \"0.0.0.0\") {\n            hostname = \"localhost\";\n          }\n          const protocol = serverOptions.https ? \"https\" : \"http\";\n          const base = server.config.base;\n          const url = `${protocol}://${hostname}:${port}${base}`;\n          tauriConfig.build.devPath = url;\n          dev(tauriConfig);\n        }\n      });\n    },\n    closeBundle() {\n      if (!process.env.TAURI_BUILD) {\n        process.env.TAURI_BUILD = \"true\";\n        let distDir = viteConfig.build.outDir;\n        if (!isAbsolute(distDir)) {\n          distDir = resolve(viteConfig.root, distDir);\n        }\n        tauriConfig.build.distDir = distDir;\n        return build(tauriConfig);\n      }\n    },\n    config(viteConfig, env) {\n      process.env.IS_TAURI = \"true\";\n      if (options && options.config) {\n        options.config(tauriConfig, env);\n      }\n      if (env.command === \"build\") {\n        viteConfig.base = \"/\";\n      }\n    },\n    configResolved(resolvedConfig) {\n      viteConfig = resolvedConfig;\n    },\n  };\n};\n```\n\n`tsconfig.json`\n\n```json\n{\n  \"compilerOptions\": {\n    \"target\": \"esnext\",\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"node\",\n    \"strict\": true,\n    \"jsx\": \"preserve\",\n    \"sourceMap\": true,\n    \"resolveJsonModule\": true,\n    \"plugins\": [\n      {\n        \"name\": \"@vuedx/typescript-plugin-vue\"\n      },\n      {\n        \"name\": \"eslint-plugin-vue\"\n      }\n    ],\n    \"esModuleInterop\": true,\n    \"lib\": [\"esnext\", \"dom\"],\n    \"types\": [\"vite/client\"]\n  },\n  \"include\": [\"src/**/*.ts\", \"src/**/*.d.ts\", \"src/**/*.tsx\", \"src/**/*.vue\"]\n}\n```\n\n`vite.config.ts`\n\n```typescript\nimport { defineConfig } from \"vite\";\nimport vue from \"@vitejs/plugin-vue\";\nimport tauri from \"./tauri-plugin\";\n\nexport default defineConfig({\n  plugins: [vue(), tauri()],\n  server: {\n    hmr: { overlay: false },\n  },\n  resolve: {\n    alias: { vue: \"vue/dist/vue.esm-bundler.js\" },\n  },\n});\n```\n\n## 说明\n\n初始化 tauri 应用时，设置目录需要与上面的配置对应，即为`../dist`。设置 url 为`http://127.0.0.1:3000`。\n\n`vite.config.ts`中关于 server 的配置是为了屏蔽调试出现的一个错误。该错误原因不明（测试结果为当 tauri 应用的名称和 vue 项目的名称相同时会发生），应该是 vite 的问题，不影响项目调试和编译打包。\n\n使用`yarn dev`进行调试，使用`yarn build`进行打包。当前设置默认打包格式为 deb 和 AppImage。打包需要额外的工具与配置，根据报错信息自行补充即可。\n","source":"_posts/create-tauri-project-with-vue-typescript-less-vite.md","raw":"---\ntitle: Create Tauri Project with Vue-Typescript-Less-Vite\ndate: 2021-06-04 14:25:54\ntags:\n  - Tauri\n  - Vue\n  - Vite\n  - Typescript\n  - Less\ncategories:\n  - [Vue]\n  - [Rust]\n---\n\n# 创建 Tauri + Vue + Typescript + Vite + Less 应用\n\n## 项目创建流程\n\n直接上代码\n\n`app_init.sh`\n\n```sh\ntemplatePath=xxx\necho \"What's your app's name?\"\nread appName\nyarn create @vitejs/app $appName --template vue-ts\ncd $appName\nyarn set version berry\ncp \"$templatePath/tauri/yarnrc.yml\" .yarnrc.yml\nyarn install\nyarn add less -D\nyarn add eslint eslint-plugin-vue -D\nyarn add @vuedx/typescript-plugin-vue -D\nrm ./tsconfig.json\ncp \"$templatePath/tauri/tsconfig.json\" tsconfig.json\nrm src/shims-vue.d.ts\nrm vite.config.ts\ncp \"$templatePath/tauri/vite.config.ts\" vite.config.ts\ncp \"$templatePath/tauri/tauri-plugin.ts\" tauri-plugin.ts\nyarn add tauri @types/sharp\nyarn add @rollup/plugin-replace -D\nyarn tauri init\n```\n\n`$templatePath`自定，注意模板文件在`$templatePath/tauri`下。\n\n以上涉及的几个文件放在下面。\n\n`yarnrc.yml`\n\n```yml\nyarnPath: \".yarn/releases/yarn-berry.cjs\"\nnodeLinker: node-modules\nnpmRegistryServer: \"https://registry.npm.taobao.org/\"\n```\n\n`tauri-plugin.ts`\n\n```typescript\nimport { TauriConfig } from \"tauri/src/types\";\nimport type { Plugin, ConfigEnv, ResolvedConfig } from \"vite\";\nimport tauriConf from \"./src-tauri/tauri.conf.json\";\nimport dev from \"tauri/dist/api/dev\";\nimport build from \"tauri/dist/api/build\";\nimport replace from \"@rollup/plugin-replace\";\nimport { isAbsolute, resolve } from \"path\";\n\ninterface Options {\n  config?: (c: TauriConfig, e: ConfigEnv) => TauriConfig;\n}\n\nexport default (options?: Options): Plugin => {\n  let tauriConfig = { ...tauriConf };\n  let viteConfig: ResolvedConfig;\n  return {\n    ...replace({\n      \"process.env.IS_TAURI\": true,\n    }),\n    name: \"tauri-plugin\",\n    configureServer(server) {\n      server.httpServer.on(\"listening\", () => {\n        if (!process.env.TAURI_SERVE) {\n          process.env.TAURI_SERVE = \"true\";\n          const serverOptions = server.config.server || {};\n          let port = serverOptions.port || 3000;\n          let hostname = serverOptions.host || \"localhost\";\n          if (hostname === \"0.0.0.0\") {\n            hostname = \"localhost\";\n          }\n          const protocol = serverOptions.https ? \"https\" : \"http\";\n          const base = server.config.base;\n          const url = `${protocol}://${hostname}:${port}${base}`;\n          tauriConfig.build.devPath = url;\n          dev(tauriConfig);\n        }\n      });\n    },\n    closeBundle() {\n      if (!process.env.TAURI_BUILD) {\n        process.env.TAURI_BUILD = \"true\";\n        let distDir = viteConfig.build.outDir;\n        if (!isAbsolute(distDir)) {\n          distDir = resolve(viteConfig.root, distDir);\n        }\n        tauriConfig.build.distDir = distDir;\n        return build(tauriConfig);\n      }\n    },\n    config(viteConfig, env) {\n      process.env.IS_TAURI = \"true\";\n      if (options && options.config) {\n        options.config(tauriConfig, env);\n      }\n      if (env.command === \"build\") {\n        viteConfig.base = \"/\";\n      }\n    },\n    configResolved(resolvedConfig) {\n      viteConfig = resolvedConfig;\n    },\n  };\n};\n```\n\n`tsconfig.json`\n\n```json\n{\n  \"compilerOptions\": {\n    \"target\": \"esnext\",\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"node\",\n    \"strict\": true,\n    \"jsx\": \"preserve\",\n    \"sourceMap\": true,\n    \"resolveJsonModule\": true,\n    \"plugins\": [\n      {\n        \"name\": \"@vuedx/typescript-plugin-vue\"\n      },\n      {\n        \"name\": \"eslint-plugin-vue\"\n      }\n    ],\n    \"esModuleInterop\": true,\n    \"lib\": [\"esnext\", \"dom\"],\n    \"types\": [\"vite/client\"]\n  },\n  \"include\": [\"src/**/*.ts\", \"src/**/*.d.ts\", \"src/**/*.tsx\", \"src/**/*.vue\"]\n}\n```\n\n`vite.config.ts`\n\n```typescript\nimport { defineConfig } from \"vite\";\nimport vue from \"@vitejs/plugin-vue\";\nimport tauri from \"./tauri-plugin\";\n\nexport default defineConfig({\n  plugins: [vue(), tauri()],\n  server: {\n    hmr: { overlay: false },\n  },\n  resolve: {\n    alias: { vue: \"vue/dist/vue.esm-bundler.js\" },\n  },\n});\n```\n\n## 说明\n\n初始化 tauri 应用时，设置目录需要与上面的配置对应，即为`../dist`。设置 url 为`http://127.0.0.1:3000`。\n\n`vite.config.ts`中关于 server 的配置是为了屏蔽调试出现的一个错误。该错误原因不明（测试结果为当 tauri 应用的名称和 vue 项目的名称相同时会发生），应该是 vite 的问题，不影响项目调试和编译打包。\n\n使用`yarn dev`进行调试，使用`yarn build`进行打包。当前设置默认打包格式为 deb 和 AppImage。打包需要额外的工具与配置，根据报错信息自行补充即可。\n","slug":"create-tauri-project-with-vue-typescript-less-vite","published":1,"updated":"2021-06-04T07:05:32.074Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmre000irriz8et28cbp","content":"<h1 id=\"创建-Tauri-Vue-Typescript-Vite-Less-应用\"><a href=\"#创建-Tauri-Vue-Typescript-Vite-Less-应用\" class=\"headerlink\" title=\"创建 Tauri + Vue + Typescript + Vite + Less 应用\"></a>创建 Tauri + Vue + Typescript + Vite + Less 应用</h1><h2 id=\"项目创建流程\"><a href=\"#项目创建流程\" class=\"headerlink\" title=\"项目创建流程\"></a>项目创建流程</h2><p>直接上代码</p>\n<p><code>app_init.sh</code></p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">templatePath&#x3D;xxx\necho &quot;What&#39;s your app&#39;s name?&quot;\nread appName\nyarn create @vitejs&#x2F;app $appName --template vue-ts\ncd $appName\nyarn set version berry\ncp &quot;$templatePath&#x2F;tauri&#x2F;yarnrc.yml&quot; .yarnrc.yml\nyarn install\nyarn add less -D\nyarn add eslint eslint-plugin-vue -D\nyarn add @vuedx&#x2F;typescript-plugin-vue -D\nrm .&#x2F;tsconfig.json\ncp &quot;$templatePath&#x2F;tauri&#x2F;tsconfig.json&quot; tsconfig.json\nrm src&#x2F;shims-vue.d.ts\nrm vite.config.ts\ncp &quot;$templatePath&#x2F;tauri&#x2F;vite.config.ts&quot; vite.config.ts\ncp &quot;$templatePath&#x2F;tauri&#x2F;tauri-plugin.ts&quot; tauri-plugin.ts\nyarn add tauri @types&#x2F;sharp\nyarn add @rollup&#x2F;plugin-replace -D\nyarn tauri init<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>$templatePath</code>自定，注意模板文件在<code>$templatePath/tauri</code>下。</p>\n<p>以上涉及的几个文件放在下面。</p>\n<p><code>yarnrc.yml</code></p>\n<pre class=\"line-numbers language-yml\" data-language=\"yml\"><code class=\"language-yml\">yarnPath: &quot;.yarn&#x2F;releases&#x2F;yarn-berry.cjs&quot;\nnodeLinker: node-modules\nnpmRegistryServer: &quot;https:&#x2F;&#x2F;registry.npm.taobao.org&#x2F;&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><code>tauri-plugin.ts</code></p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> TauriConfig <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"tauri/src/types\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">type</span> <span class=\"token punctuation\">&#123;</span> Plugin<span class=\"token punctuation\">,</span> ConfigEnv<span class=\"token punctuation\">,</span> ResolvedConfig <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vite\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> tauriConf <span class=\"token keyword\">from</span> <span class=\"token string\">\"./src-tauri/tauri.conf.json\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> dev <span class=\"token keyword\">from</span> <span class=\"token string\">\"tauri/dist/api/dev\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> build <span class=\"token keyword\">from</span> <span class=\"token string\">\"tauri/dist/api/build\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> replace <span class=\"token keyword\">from</span> <span class=\"token string\">\"@rollup/plugin-replace\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> isAbsolute<span class=\"token punctuation\">,</span> resolve <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"path\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Options</span> <span class=\"token punctuation\">&#123;</span>\n  config<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>c<span class=\"token operator\">:</span> TauriConfig<span class=\"token punctuation\">,</span> e<span class=\"token operator\">:</span> ConfigEnv<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> TauriConfig<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span>options<span class=\"token operator\">?</span><span class=\"token operator\">:</span> Options<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Plugin <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">let</span> tauriConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token operator\">...</span>tauriConf <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> viteConfig<span class=\"token operator\">:</span> ResolvedConfig<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token operator\">...</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n      <span class=\"token string\">\"process.env.IS_TAURI\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"tauri-plugin\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">configureServer</span><span class=\"token punctuation\">(</span>server<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      server<span class=\"token punctuation\">.</span>httpServer<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"listening\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">TAURI_SERVE</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n          process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">TAURI_SERVE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> serverOptions <span class=\"token operator\">=</span> server<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>server <span class=\"token operator\">||</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">let</span> port <span class=\"token operator\">=</span> serverOptions<span class=\"token punctuation\">.</span>port <span class=\"token operator\">||</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">let</span> hostname <span class=\"token operator\">=</span> serverOptions<span class=\"token punctuation\">.</span>host <span class=\"token operator\">||</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hostname <span class=\"token operator\">===</span> <span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            hostname <span class=\"token operator\">=</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">&#125;</span>\n          <span class=\"token keyword\">const</span> protocol <span class=\"token operator\">=</span> serverOptions<span class=\"token punctuation\">.</span>https <span class=\"token operator\">?</span> <span class=\"token string\">\"https\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"http\"</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> base <span class=\"token operator\">=</span> server<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>base<span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>protocol<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>hostname<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>port<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>base<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n          tauriConfig<span class=\"token punctuation\">.</span>build<span class=\"token punctuation\">.</span>devPath <span class=\"token operator\">=</span> url<span class=\"token punctuation\">;</span>\n          <span class=\"token function\">dev</span><span class=\"token punctuation\">(</span>tauriConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">closeBundle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">TAURI_BUILD</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">TAURI_BUILD</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">let</span> distDir <span class=\"token operator\">=</span> viteConfig<span class=\"token punctuation\">.</span>build<span class=\"token punctuation\">.</span>outDir<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">isAbsolute</span><span class=\"token punctuation\">(</span>distDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n          distDir <span class=\"token operator\">=</span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>viteConfig<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">,</span> distDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n        tauriConfig<span class=\"token punctuation\">.</span>build<span class=\"token punctuation\">.</span>distDir <span class=\"token operator\">=</span> distDir<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">build</span><span class=\"token punctuation\">(</span>tauriConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">config</span><span class=\"token punctuation\">(</span>viteConfig<span class=\"token punctuation\">,</span> env<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">IS_TAURI</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>options <span class=\"token operator\">&amp;&amp;</span> options<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        options<span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span>tauriConfig<span class=\"token punctuation\">,</span> env<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">&#125;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>env<span class=\"token punctuation\">.</span>command <span class=\"token operator\">===</span> <span class=\"token string\">\"build\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        viteConfig<span class=\"token punctuation\">.</span>base <span class=\"token operator\">=</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">configResolved</span><span class=\"token punctuation\">(</span>resolvedConfig<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      viteConfig <span class=\"token operator\">=</span> resolvedConfig<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>tsconfig.json</code></p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"esnext\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"esnext\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"moduleResolution\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"strict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"jsx\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"preserve\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sourceMap\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"resolveJsonModule\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@vuedx/typescript-plugin-vue\"</span>\n      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"eslint-plugin-vue\"</span>\n      <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"esModuleInterop\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"esnext\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dom\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"types\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"vite/client\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"include\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"src/**/*.ts\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"src/**/*.d.ts\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"src/**/*.tsx\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"src/**/*.vue\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>vite.config.ts</code></p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> defineConfig <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vite\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> vue <span class=\"token keyword\">from</span> <span class=\"token string\">\"@vitejs/plugin-vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> tauri <span class=\"token keyword\">from</span> <span class=\"token string\">\"./tauri-plugin\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">defineConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token function\">vue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">tauri</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  server<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    hmr<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> overlay<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  resolve<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    alias<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> vue<span class=\"token operator\">:</span> <span class=\"token string\">\"vue/dist/vue.esm-bundler.js\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h2><p>初始化 tauri 应用时，设置目录需要与上面的配置对应，即为<code>../dist</code>。设置 url 为<code>http://127.0.0.1:3000</code>。</p>\n<p><code>vite.config.ts</code>中关于 server 的配置是为了屏蔽调试出现的一个错误。该错误原因不明（测试结果为当 tauri 应用的名称和 vue 项目的名称相同时会发生），应该是 vite 的问题，不影响项目调试和编译打包。</p>\n<p>使用<code>yarn dev</code>进行调试，使用<code>yarn build</code>进行打包。当前设置默认打包格式为 deb 和 AppImage。打包需要额外的工具与配置，根据报错信息自行补充即可。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"创建-Tauri-Vue-Typescript-Vite-Less-应用\"><a href=\"#创建-Tauri-Vue-Typescript-Vite-Less-应用\" class=\"headerlink\" title=\"创建 Tauri + Vue + Typescript + Vite + Less 应用\"></a>创建 Tauri + Vue + Typescript + Vite + Less 应用</h1><h2 id=\"项目创建流程\"><a href=\"#项目创建流程\" class=\"headerlink\" title=\"项目创建流程\"></a>项目创建流程</h2><p>直接上代码</p>\n<p><code>app_init.sh</code></p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">templatePath&#x3D;xxx\necho &quot;What&#39;s your app&#39;s name?&quot;\nread appName\nyarn create @vitejs&#x2F;app $appName --template vue-ts\ncd $appName\nyarn set version berry\ncp &quot;$templatePath&#x2F;tauri&#x2F;yarnrc.yml&quot; .yarnrc.yml\nyarn install\nyarn add less -D\nyarn add eslint eslint-plugin-vue -D\nyarn add @vuedx&#x2F;typescript-plugin-vue -D\nrm .&#x2F;tsconfig.json\ncp &quot;$templatePath&#x2F;tauri&#x2F;tsconfig.json&quot; tsconfig.json\nrm src&#x2F;shims-vue.d.ts\nrm vite.config.ts\ncp &quot;$templatePath&#x2F;tauri&#x2F;vite.config.ts&quot; vite.config.ts\ncp &quot;$templatePath&#x2F;tauri&#x2F;tauri-plugin.ts&quot; tauri-plugin.ts\nyarn add tauri @types&#x2F;sharp\nyarn add @rollup&#x2F;plugin-replace -D\nyarn tauri init<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>$templatePath</code>自定，注意模板文件在<code>$templatePath/tauri</code>下。</p>\n<p>以上涉及的几个文件放在下面。</p>\n<p><code>yarnrc.yml</code></p>\n<pre class=\"line-numbers language-yml\" data-language=\"yml\"><code class=\"language-yml\">yarnPath: &quot;.yarn&#x2F;releases&#x2F;yarn-berry.cjs&quot;\nnodeLinker: node-modules\nnpmRegistryServer: &quot;https:&#x2F;&#x2F;registry.npm.taobao.org&#x2F;&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><code>tauri-plugin.ts</code></p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> TauriConfig <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"tauri/src/types\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">type</span> <span class=\"token punctuation\">&#123;</span> Plugin<span class=\"token punctuation\">,</span> ConfigEnv<span class=\"token punctuation\">,</span> ResolvedConfig <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vite\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> tauriConf <span class=\"token keyword\">from</span> <span class=\"token string\">\"./src-tauri/tauri.conf.json\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> dev <span class=\"token keyword\">from</span> <span class=\"token string\">\"tauri/dist/api/dev\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> build <span class=\"token keyword\">from</span> <span class=\"token string\">\"tauri/dist/api/build\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> replace <span class=\"token keyword\">from</span> <span class=\"token string\">\"@rollup/plugin-replace\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> isAbsolute<span class=\"token punctuation\">,</span> resolve <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"path\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Options</span> <span class=\"token punctuation\">&#123;</span>\n  config<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>c<span class=\"token operator\">:</span> TauriConfig<span class=\"token punctuation\">,</span> e<span class=\"token operator\">:</span> ConfigEnv<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> TauriConfig<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span>options<span class=\"token operator\">?</span><span class=\"token operator\">:</span> Options<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> Plugin <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token keyword\">let</span> tauriConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token operator\">...</span>tauriConf <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> viteConfig<span class=\"token operator\">:</span> ResolvedConfig<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token operator\">...</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n      <span class=\"token string\">\"process.env.IS_TAURI\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"tauri-plugin\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">configureServer</span><span class=\"token punctuation\">(</span>server<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      server<span class=\"token punctuation\">.</span>httpServer<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"listening\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">TAURI_SERVE</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n          process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">TAURI_SERVE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> serverOptions <span class=\"token operator\">=</span> server<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>server <span class=\"token operator\">||</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">let</span> port <span class=\"token operator\">=</span> serverOptions<span class=\"token punctuation\">.</span>port <span class=\"token operator\">||</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">let</span> hostname <span class=\"token operator\">=</span> serverOptions<span class=\"token punctuation\">.</span>host <span class=\"token operator\">||</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hostname <span class=\"token operator\">===</span> <span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            hostname <span class=\"token operator\">=</span> <span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">&#125;</span>\n          <span class=\"token keyword\">const</span> protocol <span class=\"token operator\">=</span> serverOptions<span class=\"token punctuation\">.</span>https <span class=\"token operator\">?</span> <span class=\"token string\">\"https\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"http\"</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> base <span class=\"token operator\">=</span> server<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span>base<span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>protocol<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">://</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>hostname<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token string\">:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>port<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">$&#123;</span>base<span class=\"token interpolation-punctuation punctuation\">&#125;</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n          tauriConfig<span class=\"token punctuation\">.</span>build<span class=\"token punctuation\">.</span>devPath <span class=\"token operator\">=</span> url<span class=\"token punctuation\">;</span>\n          <span class=\"token function\">dev</span><span class=\"token punctuation\">(</span>tauriConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">closeBundle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">TAURI_BUILD</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">TAURI_BUILD</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">let</span> distDir <span class=\"token operator\">=</span> viteConfig<span class=\"token punctuation\">.</span>build<span class=\"token punctuation\">.</span>outDir<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">isAbsolute</span><span class=\"token punctuation\">(</span>distDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n          distDir <span class=\"token operator\">=</span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>viteConfig<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">,</span> distDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span>\n        tauriConfig<span class=\"token punctuation\">.</span>build<span class=\"token punctuation\">.</span>distDir <span class=\"token operator\">=</span> distDir<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">build</span><span class=\"token punctuation\">(</span>tauriConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">config</span><span class=\"token punctuation\">(</span>viteConfig<span class=\"token punctuation\">,</span> env<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">IS_TAURI</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>options <span class=\"token operator\">&amp;&amp;</span> options<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        options<span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span>tauriConfig<span class=\"token punctuation\">,</span> env<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">&#125;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>env<span class=\"token punctuation\">.</span>command <span class=\"token operator\">===</span> <span class=\"token string\">\"build\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n        viteConfig<span class=\"token punctuation\">.</span>base <span class=\"token operator\">=</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">configResolved</span><span class=\"token punctuation\">(</span>resolvedConfig<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n      viteConfig <span class=\"token operator\">=</span> resolvedConfig<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>tsconfig.json</code></p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"esnext\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"module\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"esnext\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"moduleResolution\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"strict\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"jsx\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"preserve\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"sourceMap\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"resolveJsonModule\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@vuedx/typescript-plugin-vue\"</span>\n      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"eslint-plugin-vue\"</span>\n      <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"esModuleInterop\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"lib\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"esnext\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"dom\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"types\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"vite/client\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"include\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"src/**/*.ts\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"src/**/*.d.ts\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"src/**/*.tsx\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"src/**/*.vue\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>vite.config.ts</code></p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> defineConfig <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vite\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> vue <span class=\"token keyword\">from</span> <span class=\"token string\">\"@vitejs/plugin-vue\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> tauri <span class=\"token keyword\">from</span> <span class=\"token string\">\"./tauri-plugin\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">defineConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token function\">vue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">tauri</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  server<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    hmr<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> overlay<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  resolve<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    alias<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> vue<span class=\"token operator\">:</span> <span class=\"token string\">\"vue/dist/vue.esm-bundler.js\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h2><p>初始化 tauri 应用时，设置目录需要与上面的配置对应，即为<code>../dist</code>。设置 url 为<code>http://127.0.0.1:3000</code>。</p>\n<p><code>vite.config.ts</code>中关于 server 的配置是为了屏蔽调试出现的一个错误。该错误原因不明（测试结果为当 tauri 应用的名称和 vue 项目的名称相同时会发生），应该是 vite 的问题，不影响项目调试和编译打包。</p>\n<p>使用<code>yarn dev</code>进行调试，使用<code>yarn build</code>进行打包。当前设置默认打包格式为 deb 和 AppImage。打包需要额外的工具与配置，根据报错信息自行补充即可。</p>\n"},{"title":"Create Vue3 Project","date":"2021-05-15T14:06:13.000Z","_content":"\n# 创建 vue3 项目（vue3 + vite + typescript + less）\n\n首先声明一下，笔者只是刚玩了会 vue, 和 `cannot find module vue`斗智斗勇了半天。好不容易搞定了，来分享一下。以下不会涉及关于 vue 开发的具体内容。\n\n使用 npm 作为包管理器。\n\n> yarn2 的一系列操作让人迷惑，本来不想折腾了。最后还是忍不住折腾了一把，用法放在最后面。\n\n创建项目\n\n```sh\n# 使用vue + ts的模板创建项目\nnpm init @vitejs/app $appName -- --template vue-ts\ncd appName\n# 安装less\nnpm install less -D\n# 这是coc-vetur的依赖项，不使用vim + coc.nvim 的可以忽略\nnpm install eslint eslint-plugin-vue -D\n# 这是在vue文件中解决cannot find module问题的插件\nnpm install @vuedx/typescript-plugin-vue -D\n```\n\n现在可以进入项目，使用`npm run dev`运行。\n\n> npm7 以上版本会出错，使用`node node_modules/esbuild/install.js`解决。\n\n为了解决 ts 文件中`cannot find module vue`的问题，还需要做以下设置。\n\n在`tsconfig.json`中加入\n\n```json\n    \"plugins\": [\n      {\n        \"name\": \"@vuedx/typescript-plugin-vue\"\n      }\n    ],\n```\n\n> 可以以同样方式加入 eslint-plugin-vue。\n\n如果你使用的是 vim/neovim + coc-vetur，则在`coc-settings.json`中配置`\"vetur.useWorkspaceDependencies\": true`。这一步是让插件使用项目内的依赖，否则插件在全局找不到刚才安装的插件。\n\n如果你使用 vscode，设置` \"Select TypeScript version\" -> \"Use workspace version\"`。[参考](https://github.com/vitejs/vite/tree/main/packages/create-app/template-vue-ts)\n\n注意，此时已经不需要`src/shims-vue.d.ts`。\n\n笔者不使用 vscode，不过从[参考](https://github.com/vitejs/vite/tree/main/packages/create-app/template-vue-ts)的描述来看，应该是可以对 vue 文件和 ts 文件都产生作用。在 vim + coc.nvim 的环境中，两种文件均可生效。\n\n在 neovim + coc.nvim 环境下进行测试。\n\n1. 不启用任何插件，无论有没有`src/shims-vue.d.ts`文件，vue 文件中`import { defineComponent } from 'vue'`都不报错，`import HelloWorld from './components/HelloWorld.vue'`也不报错。\n2. 只要启用`eslint-plugin-vue`插件，就可以防止 ts 文件中`import { createApp } from 'vue'`出错。但是如果没有`src/shims-vue.d.ts`文件，`import App from './App.vue'`还是会出错。\n3. 继续启用`@vuedx/typescript-plugin-vue`，删掉`src/shims-vue.d.ts`，一切正常。\n\n为了在挂载自定义组件的时候不出错，还需要设置根目录下的`vite.config.ts`如下。\n\n```typescript\nimport { defineConfig } from \"vite\";\nimport vue from \"@vitejs/plugin-vue\";\n\nexport default defineConfig({\n  plugins: [vue()],\n  resolve: {\n    alias: { vue: \"vue/dist/vue.esm-bundler.js\" },\n  },\n});\n```\n\n使用 yarn2 代替 npm。\n\n首先安装 yarn1。\n\n> yarn2 的默认用法是把自己当成依赖安装在项目中。如果在全局安装 yarn2，也需要在项目中才能执行命令。同时 yarn2 无法执行 create 命令，还需要依靠 yarn1。\n\n```sh\n# 在全局安装yarn1\nnpm -g install yarn\n# 初始化项目\nyarn create @vitejs/app appName --template vue-ts\n# 升级成yarn2\ncd appName\nyarn set version berry\n```\n\n修改项目根目录下`.yarnrc.yml`。\n\n```yml\nyarnPath: \".yarn/releases/yarn-berry.cjs\"\nnodeLinker: node-modules\nnpmRegistries: https://registry.npm.taobao.org/\n```\n\n第二行的配置是让 yarn2 完全用 npm 的方式安装依赖。否则是不存在`node_modules`的，也就不能调用插件。虽然这样做丧失了 yarn2 的特性，但是比起 npm 至少速度上可以快点。\n\n继续完成项目初始化。\n\n```sh\nyarn install\nyarn add less -D\nyarn add eslint eslint-plugin-vue -D\nyarn add @vuedx/typescript-plugin-vue -D\n```\n","source":"_posts/create-vue3-project.md","raw":"---\ntitle: Create Vue3 Project\ndate: 2021-05-15 22:06:13\ntags:\n\t\t- Vue\n\t\t- Vite\n\t\t- Typescript\n\t\t- Less\ncategories:\n\t\t- Vue\n---\n\n# 创建 vue3 项目（vue3 + vite + typescript + less）\n\n首先声明一下，笔者只是刚玩了会 vue, 和 `cannot find module vue`斗智斗勇了半天。好不容易搞定了，来分享一下。以下不会涉及关于 vue 开发的具体内容。\n\n使用 npm 作为包管理器。\n\n> yarn2 的一系列操作让人迷惑，本来不想折腾了。最后还是忍不住折腾了一把，用法放在最后面。\n\n创建项目\n\n```sh\n# 使用vue + ts的模板创建项目\nnpm init @vitejs/app $appName -- --template vue-ts\ncd appName\n# 安装less\nnpm install less -D\n# 这是coc-vetur的依赖项，不使用vim + coc.nvim 的可以忽略\nnpm install eslint eslint-plugin-vue -D\n# 这是在vue文件中解决cannot find module问题的插件\nnpm install @vuedx/typescript-plugin-vue -D\n```\n\n现在可以进入项目，使用`npm run dev`运行。\n\n> npm7 以上版本会出错，使用`node node_modules/esbuild/install.js`解决。\n\n为了解决 ts 文件中`cannot find module vue`的问题，还需要做以下设置。\n\n在`tsconfig.json`中加入\n\n```json\n    \"plugins\": [\n      {\n        \"name\": \"@vuedx/typescript-plugin-vue\"\n      }\n    ],\n```\n\n> 可以以同样方式加入 eslint-plugin-vue。\n\n如果你使用的是 vim/neovim + coc-vetur，则在`coc-settings.json`中配置`\"vetur.useWorkspaceDependencies\": true`。这一步是让插件使用项目内的依赖，否则插件在全局找不到刚才安装的插件。\n\n如果你使用 vscode，设置` \"Select TypeScript version\" -> \"Use workspace version\"`。[参考](https://github.com/vitejs/vite/tree/main/packages/create-app/template-vue-ts)\n\n注意，此时已经不需要`src/shims-vue.d.ts`。\n\n笔者不使用 vscode，不过从[参考](https://github.com/vitejs/vite/tree/main/packages/create-app/template-vue-ts)的描述来看，应该是可以对 vue 文件和 ts 文件都产生作用。在 vim + coc.nvim 的环境中，两种文件均可生效。\n\n在 neovim + coc.nvim 环境下进行测试。\n\n1. 不启用任何插件，无论有没有`src/shims-vue.d.ts`文件，vue 文件中`import { defineComponent } from 'vue'`都不报错，`import HelloWorld from './components/HelloWorld.vue'`也不报错。\n2. 只要启用`eslint-plugin-vue`插件，就可以防止 ts 文件中`import { createApp } from 'vue'`出错。但是如果没有`src/shims-vue.d.ts`文件，`import App from './App.vue'`还是会出错。\n3. 继续启用`@vuedx/typescript-plugin-vue`，删掉`src/shims-vue.d.ts`，一切正常。\n\n为了在挂载自定义组件的时候不出错，还需要设置根目录下的`vite.config.ts`如下。\n\n```typescript\nimport { defineConfig } from \"vite\";\nimport vue from \"@vitejs/plugin-vue\";\n\nexport default defineConfig({\n  plugins: [vue()],\n  resolve: {\n    alias: { vue: \"vue/dist/vue.esm-bundler.js\" },\n  },\n});\n```\n\n使用 yarn2 代替 npm。\n\n首先安装 yarn1。\n\n> yarn2 的默认用法是把自己当成依赖安装在项目中。如果在全局安装 yarn2，也需要在项目中才能执行命令。同时 yarn2 无法执行 create 命令，还需要依靠 yarn1。\n\n```sh\n# 在全局安装yarn1\nnpm -g install yarn\n# 初始化项目\nyarn create @vitejs/app appName --template vue-ts\n# 升级成yarn2\ncd appName\nyarn set version berry\n```\n\n修改项目根目录下`.yarnrc.yml`。\n\n```yml\nyarnPath: \".yarn/releases/yarn-berry.cjs\"\nnodeLinker: node-modules\nnpmRegistries: https://registry.npm.taobao.org/\n```\n\n第二行的配置是让 yarn2 完全用 npm 的方式安装依赖。否则是不存在`node_modules`的，也就不能调用插件。虽然这样做丧失了 yarn2 的特性，但是比起 npm 至少速度上可以快点。\n\n继续完成项目初始化。\n\n```sh\nyarn install\nyarn add less -D\nyarn add eslint eslint-plugin-vue -D\nyarn add @vuedx/typescript-plugin-vue -D\n```\n","slug":"create-vue3-project","published":1,"updated":"2021-05-19T11:40:52.113Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmri000mrriz486gdbrl","content":"<h1 id=\"创建-vue3-项目（vue3-vite-typescript-less）\"><a href=\"#创建-vue3-项目（vue3-vite-typescript-less）\" class=\"headerlink\" title=\"创建 vue3 项目（vue3 + vite + typescript + less）\"></a>创建 vue3 项目（vue3 + vite + typescript + less）</h1><p>首先声明一下，笔者只是刚玩了会 vue, 和 <code>cannot find module vue</code>斗智斗勇了半天。好不容易搞定了，来分享一下。以下不会涉及关于 vue 开发的具体内容。</p>\n<p>使用 npm 作为包管理器。</p>\n<blockquote>\n<p>yarn2 的一系列操作让人迷惑，本来不想折腾了。最后还是忍不住折腾了一把，用法放在最后面。</p>\n</blockquote>\n<p>创建项目</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\"># 使用vue + ts的模板创建项目\nnpm init @vitejs&#x2F;app $appName -- --template vue-ts\ncd appName\n# 安装less\nnpm install less -D\n# 这是coc-vetur的依赖项，不使用vim + coc.nvim 的可以忽略\nnpm install eslint eslint-plugin-vue -D\n# 这是在vue文件中解决cannot find module问题的插件\nnpm install @vuedx&#x2F;typescript-plugin-vue -D<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>现在可以进入项目，使用<code>npm run dev</code>运行。</p>\n<blockquote>\n<p>npm7 以上版本会出错，使用<code>node node_modules/esbuild/install.js</code>解决。</p>\n</blockquote>\n<p>为了解决 ts 文件中<code>cannot find module vue</code>的问题，还需要做以下设置。</p>\n<p>在<code>tsconfig.json</code>中加入</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@vuedx/typescript-plugin-vue\"</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<blockquote>\n<p>可以以同样方式加入 eslint-plugin-vue。</p>\n</blockquote>\n<p>如果你使用的是 vim/neovim + coc-vetur，则在<code>coc-settings.json</code>中配置<code>&quot;vetur.useWorkspaceDependencies&quot;: true</code>。这一步是让插件使用项目内的依赖，否则插件在全局找不到刚才安装的插件。</p>\n<p>如果你使用 vscode，设置<code> &quot;Select TypeScript version&quot; -&gt; &quot;Use workspace version&quot;</code>。<a href=\"https://github.com/vitejs/vite/tree/main/packages/create-app/template-vue-ts\">参考</a></p>\n<p>注意，此时已经不需要<code>src/shims-vue.d.ts</code>。</p>\n<p>笔者不使用 vscode，不过从<a href=\"https://github.com/vitejs/vite/tree/main/packages/create-app/template-vue-ts\">参考</a>的描述来看，应该是可以对 vue 文件和 ts 文件都产生作用。在 vim + coc.nvim 的环境中，两种文件均可生效。</p>\n<p>在 neovim + coc.nvim 环境下进行测试。</p>\n<ol>\n<li>不启用任何插件，无论有没有<code>src/shims-vue.d.ts</code>文件，vue 文件中<code>import &#123; defineComponent &#125; from &#39;vue&#39;</code>都不报错，<code>import HelloWorld from &#39;./components/HelloWorld.vue&#39;</code>也不报错。</li>\n<li>只要启用<code>eslint-plugin-vue</code>插件，就可以防止 ts 文件中<code>import &#123; createApp &#125; from &#39;vue&#39;</code>出错。但是如果没有<code>src/shims-vue.d.ts</code>文件，<code>import App from &#39;./App.vue&#39;</code>还是会出错。</li>\n<li>继续启用<code>@vuedx/typescript-plugin-vue</code>，删掉<code>src/shims-vue.d.ts</code>，一切正常。</li>\n</ol>\n<p>为了在挂载自定义组件的时候不出错，还需要设置根目录下的<code>vite.config.ts</code>如下。</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> defineConfig <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vite\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> vue <span class=\"token keyword\">from</span> <span class=\"token string\">\"@vitejs/plugin-vue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">defineConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token function\">vue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  resolve<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    alias<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> vue<span class=\"token operator\">:</span> <span class=\"token string\">\"vue/dist/vue.esm-bundler.js\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>使用 yarn2 代替 npm。</p>\n<p>首先安装 yarn1。</p>\n<blockquote>\n<p>yarn2 的默认用法是把自己当成依赖安装在项目中。如果在全局安装 yarn2，也需要在项目中才能执行命令。同时 yarn2 无法执行 create 命令，还需要依靠 yarn1。</p>\n</blockquote>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\"># 在全局安装yarn1\nnpm -g install yarn\n# 初始化项目\nyarn create @vitejs&#x2F;app appName --template vue-ts\n# 升级成yarn2\ncd appName\nyarn set version berry<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>修改项目根目录下<code>.yarnrc.yml</code>。</p>\n<pre class=\"line-numbers language-yml\" data-language=\"yml\"><code class=\"language-yml\">yarnPath: &quot;.yarn&#x2F;releases&#x2F;yarn-berry.cjs&quot;\nnodeLinker: node-modules\nnpmRegistries: https:&#x2F;&#x2F;registry.npm.taobao.org&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>第二行的配置是让 yarn2 完全用 npm 的方式安装依赖。否则是不存在<code>node_modules</code>的，也就不能调用插件。虽然这样做丧失了 yarn2 的特性，但是比起 npm 至少速度上可以快点。</p>\n<p>继续完成项目初始化。</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">yarn install\nyarn add less -D\nyarn add eslint eslint-plugin-vue -D\nyarn add @vuedx&#x2F;typescript-plugin-vue -D<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"创建-vue3-项目（vue3-vite-typescript-less）\"><a href=\"#创建-vue3-项目（vue3-vite-typescript-less）\" class=\"headerlink\" title=\"创建 vue3 项目（vue3 + vite + typescript + less）\"></a>创建 vue3 项目（vue3 + vite + typescript + less）</h1><p>首先声明一下，笔者只是刚玩了会 vue, 和 <code>cannot find module vue</code>斗智斗勇了半天。好不容易搞定了，来分享一下。以下不会涉及关于 vue 开发的具体内容。</p>\n<p>使用 npm 作为包管理器。</p>\n<blockquote>\n<p>yarn2 的一系列操作让人迷惑，本来不想折腾了。最后还是忍不住折腾了一把，用法放在最后面。</p>\n</blockquote>\n<p>创建项目</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\"># 使用vue + ts的模板创建项目\nnpm init @vitejs&#x2F;app $appName -- --template vue-ts\ncd appName\n# 安装less\nnpm install less -D\n# 这是coc-vetur的依赖项，不使用vim + coc.nvim 的可以忽略\nnpm install eslint eslint-plugin-vue -D\n# 这是在vue文件中解决cannot find module问题的插件\nnpm install @vuedx&#x2F;typescript-plugin-vue -D<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>现在可以进入项目，使用<code>npm run dev</code>运行。</p>\n<blockquote>\n<p>npm7 以上版本会出错，使用<code>node node_modules/esbuild/install.js</code>解决。</p>\n</blockquote>\n<p>为了解决 ts 文件中<code>cannot find module vue</code>的问题，还需要做以下设置。</p>\n<p>在<code>tsconfig.json</code>中加入</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"@vuedx/typescript-plugin-vue\"</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<blockquote>\n<p>可以以同样方式加入 eslint-plugin-vue。</p>\n</blockquote>\n<p>如果你使用的是 vim/neovim + coc-vetur，则在<code>coc-settings.json</code>中配置<code>&quot;vetur.useWorkspaceDependencies&quot;: true</code>。这一步是让插件使用项目内的依赖，否则插件在全局找不到刚才安装的插件。</p>\n<p>如果你使用 vscode，设置<code> &quot;Select TypeScript version&quot; -&gt; &quot;Use workspace version&quot;</code>。<a href=\"https://github.com/vitejs/vite/tree/main/packages/create-app/template-vue-ts\">参考</a></p>\n<p>注意，此时已经不需要<code>src/shims-vue.d.ts</code>。</p>\n<p>笔者不使用 vscode，不过从<a href=\"https://github.com/vitejs/vite/tree/main/packages/create-app/template-vue-ts\">参考</a>的描述来看，应该是可以对 vue 文件和 ts 文件都产生作用。在 vim + coc.nvim 的环境中，两种文件均可生效。</p>\n<p>在 neovim + coc.nvim 环境下进行测试。</p>\n<ol>\n<li>不启用任何插件，无论有没有<code>src/shims-vue.d.ts</code>文件，vue 文件中<code>import &#123; defineComponent &#125; from &#39;vue&#39;</code>都不报错，<code>import HelloWorld from &#39;./components/HelloWorld.vue&#39;</code>也不报错。</li>\n<li>只要启用<code>eslint-plugin-vue</code>插件，就可以防止 ts 文件中<code>import &#123; createApp &#125; from &#39;vue&#39;</code>出错。但是如果没有<code>src/shims-vue.d.ts</code>文件，<code>import App from &#39;./App.vue&#39;</code>还是会出错。</li>\n<li>继续启用<code>@vuedx/typescript-plugin-vue</code>，删掉<code>src/shims-vue.d.ts</code>，一切正常。</li>\n</ol>\n<p>为了在挂载自定义组件的时候不出错，还需要设置根目录下的<code>vite.config.ts</code>如下。</p>\n<pre class=\"line-numbers language-typescript\" data-language=\"typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> defineConfig <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vite\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> vue <span class=\"token keyword\">from</span> <span class=\"token string\">\"@vitejs/plugin-vue\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">defineConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token function\">vue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  resolve<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    alias<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span> vue<span class=\"token operator\">:</span> <span class=\"token string\">\"vue/dist/vue.esm-bundler.js\"</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>使用 yarn2 代替 npm。</p>\n<p>首先安装 yarn1。</p>\n<blockquote>\n<p>yarn2 的默认用法是把自己当成依赖安装在项目中。如果在全局安装 yarn2，也需要在项目中才能执行命令。同时 yarn2 无法执行 create 命令，还需要依靠 yarn1。</p>\n</blockquote>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\"># 在全局安装yarn1\nnpm -g install yarn\n# 初始化项目\nyarn create @vitejs&#x2F;app appName --template vue-ts\n# 升级成yarn2\ncd appName\nyarn set version berry<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>修改项目根目录下<code>.yarnrc.yml</code>。</p>\n<pre class=\"line-numbers language-yml\" data-language=\"yml\"><code class=\"language-yml\">yarnPath: &quot;.yarn&#x2F;releases&#x2F;yarn-berry.cjs&quot;\nnodeLinker: node-modules\nnpmRegistries: https:&#x2F;&#x2F;registry.npm.taobao.org&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>第二行的配置是让 yarn2 完全用 npm 的方式安装依赖。否则是不存在<code>node_modules</code>的，也就不能调用插件。虽然这样做丧失了 yarn2 的特性，但是比起 npm 至少速度上可以快点。</p>\n<p>继续完成项目初始化。</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">yarn install\nyarn add less -D\nyarn add eslint eslint-plugin-vue -D\nyarn add @vuedx&#x2F;typescript-plugin-vue -D<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n"},{"title":"Debug Msp430g2 Project on Linux","date":"2021-03-23T10:26:43.000Z","_content":"\n# 在 linux 上 对 MSP430G2 系列工程进行调试\n\nWarning : 此方案体验太差，笔者已经弃坑了，有兴趣的可以继续折腾，等待社区推出更好的 gcc。\n\n本文介绍如何在 linux 系统上对 MSP430 程序进行 debug。包括程序的编译、下载、运行、调试以及 vim 编辑器自动补全设置。\n\n## 工具\n\n在本方案中，需要用到的主要工具包括 TI 官方提供的 IDE——CCS，mspdebug，msp430-elf-gdb，vim/neovim。\n\n注意，CCS 的 linux 版本不支持连接 MSP430G2 系列的开发板，否则就没那么多麻烦了。在本方案中，该 IDE 只作为编译工具使用。\n\nTI 官方提供的 msp430-gcc 虽然可以编译程序，但是缺少部分头文件。下面将介绍配置 GCC 的相关内容，但不建议作为编译工具使用。\n\n## 配置\n\n### 安装工具\n\n安装 CCS、mspdebug。很简单，过程略。\n\n关于 CCS 的使用，由于只需要用来做编译器，更好的选择是使用命令行操作，避免开启图形界面，具体上网搜即可。\n\nmsp430-elf-gdb 可以从 TI 官方提供的 msp430-gcc 编译工具链中获得，也可以自己编译。自己编译的过程如下。\n\n在 GNU 官网下载最版本 gdb。解压，进入目录。\n\n```shell\n# target是架构，不需要修改\n# prefix将决定最终安装gdb的位置，可以自行修改\n./configure --prefix=\"${PREFIX}\" --target=msp430-elf\nmake\nsudo make install\n```\n\n如果要拆卸 gdb，需要进入编译好后的目录中所有的子目录，执行`sudo make uninstall`。\n\n编辑器可以自由选择，本文介绍时使用 neovim。\n\n### msp430-gcc\n\n如果想要尝试 gcc，可以参考以下步骤。\n\n首先，在 TI 官网下载 msp430-gcc 及其 support-files。gcc 下载压缩包即可，不需要下载安装工具。\n\n解压两个下载包。将 support-files 中所有的.h 与.ld 文件复制到 gcc 的 msp430-elf/include 目录以及 msp430-elf/lib 目录下。这里如果想少一点麻烦就不要参考官方教程将文件放到 include/device，直接按前述操作完成即可。\n\n至此，gcc 配置完毕，只是仍然缺少部分头文件。如`delay_cycles`函数未定义。\n\n想要用 gcc 编译，可以进入 msp430gcc 目录，使用`./bin/msp430-elf-gcc -I ./msp430-elf/include -mmcu=msp430g2553 -c main.c`编译。注意，必须指定微处理器的具体型号，且不要指明 lib 路径（设定处理器型号后 gcc 会自动调用链接器，不需要指明，指明后有冲突，这是前面放置头文件操作引起的）。\n\n这样可以成功得到可执行文件。\n\n需要注意的是，如果不介意官网提供的 gcc 版本较低，尽量使用官网的版本。自己编译的 gcc 缺少头文件等问题的情况只会更严重。如 gentoo crossdev 中编译而成的 msp430-elf-gcc，进行上述操作添加头文件后，虽然可以编译程序，但实际上是错误编译，这些可执行文件不可实际运行。这种情况下还需要做更多的处理。\n\n### 编辑器自动补全与语法检查\n\nneovim 可以使用 coc.nvim，并安装 coc-clangd 插件。对于其他编辑器而言，也可以使用类似的 lsp。通用的一点是`compile_commands.json`文件，这决定了 lsp 补全与检查的依据。该文件可以使用工具从 makefile 或 CMakeList.txt 生成。\n\n什么都不会也没有关系，直接写就行，只需要七行即可。\n\n```json\n[\n  {\n    \"directory\": \"工作目录路径\",\n    \"command\": \"编译指令，可以借用一下ccs内置的gcc，把头文件和微处理器型号写入，可参考上面的gcc编译命令\",\n    \"file\": \"需要编译的文件，如./main.c\"\n  }\n]\n```\n\n将其置于工程目录下即可。\n\n建议将 ccs 安装目录中所有头文件复制到一个目录下，使用`-I`指定该目录即可。对于部分缺少的定义，可以自行在该目录下的头文件中添加，这样也不影响 ccs 编译程序。这里关于缺少的定义稍微解释一下。举个常见的例子，如`__intertupt`。如果你使用它，lsp 会报未定义错误，但是在 ccs 编译器中不会发生，且可以成功编译。查找所有的头文件，确实没有定义。这个时候就可以手动加上，骗过 lsp。如调用了\"msp430g2553.h\"，则在该头文件末尾加上`define __intertupt`。\n\n## 程序烧录与运行\n\n得到可执行文件后，使用 mspdebug 工具进行烧录。\n\n```\nsudo mspdebug rf2500\n# 进入mspdebug界面\nload your_file\n# 或者\nprog your_file\n# 运行程序\nrun\n# 擦除程序\nerase\n```\n\n## 程序调试\n\n```\nsudo mspdebug rf2500\ngdb\n# 在另一个终端窗口启动gdb，具体命令看自己的gdb名称\nmsp430-elf-gdb\n# 进入gdb界面\n# 监听上面mspdebug提供的调试端口\ntarget remote localhost:2000\n\n# moniter后加的命令相当于mspdebug下执行的命令\nmoniter prog your_file\n\nfile your_file\n\n# 使用continue运行程序，不可使用run\nc\n# 其他调试自我发挥\n```\n\n> 可以使用 gdb 打断点，单步调试等等。但是无法查看变量值，更无法查看寄存器的值。对于调试而言，基本上是个废的。\n","source":"_posts/debug-msp430g2-project-on-linux.md","raw":"---\ntitle: Debug Msp430g2 Project on Linux\ndate: 2021-03-23 18:26:43\ntags:\n\t\t- MSP430G2\n\t\t- Linux\ncategories:\n\t\t- Embedded\n---\n\n# 在 linux 上 对 MSP430G2 系列工程进行调试\n\nWarning : 此方案体验太差，笔者已经弃坑了，有兴趣的可以继续折腾，等待社区推出更好的 gcc。\n\n本文介绍如何在 linux 系统上对 MSP430 程序进行 debug。包括程序的编译、下载、运行、调试以及 vim 编辑器自动补全设置。\n\n## 工具\n\n在本方案中，需要用到的主要工具包括 TI 官方提供的 IDE——CCS，mspdebug，msp430-elf-gdb，vim/neovim。\n\n注意，CCS 的 linux 版本不支持连接 MSP430G2 系列的开发板，否则就没那么多麻烦了。在本方案中，该 IDE 只作为编译工具使用。\n\nTI 官方提供的 msp430-gcc 虽然可以编译程序，但是缺少部分头文件。下面将介绍配置 GCC 的相关内容，但不建议作为编译工具使用。\n\n## 配置\n\n### 安装工具\n\n安装 CCS、mspdebug。很简单，过程略。\n\n关于 CCS 的使用，由于只需要用来做编译器，更好的选择是使用命令行操作，避免开启图形界面，具体上网搜即可。\n\nmsp430-elf-gdb 可以从 TI 官方提供的 msp430-gcc 编译工具链中获得，也可以自己编译。自己编译的过程如下。\n\n在 GNU 官网下载最版本 gdb。解压，进入目录。\n\n```shell\n# target是架构，不需要修改\n# prefix将决定最终安装gdb的位置，可以自行修改\n./configure --prefix=\"${PREFIX}\" --target=msp430-elf\nmake\nsudo make install\n```\n\n如果要拆卸 gdb，需要进入编译好后的目录中所有的子目录，执行`sudo make uninstall`。\n\n编辑器可以自由选择，本文介绍时使用 neovim。\n\n### msp430-gcc\n\n如果想要尝试 gcc，可以参考以下步骤。\n\n首先，在 TI 官网下载 msp430-gcc 及其 support-files。gcc 下载压缩包即可，不需要下载安装工具。\n\n解压两个下载包。将 support-files 中所有的.h 与.ld 文件复制到 gcc 的 msp430-elf/include 目录以及 msp430-elf/lib 目录下。这里如果想少一点麻烦就不要参考官方教程将文件放到 include/device，直接按前述操作完成即可。\n\n至此，gcc 配置完毕，只是仍然缺少部分头文件。如`delay_cycles`函数未定义。\n\n想要用 gcc 编译，可以进入 msp430gcc 目录，使用`./bin/msp430-elf-gcc -I ./msp430-elf/include -mmcu=msp430g2553 -c main.c`编译。注意，必须指定微处理器的具体型号，且不要指明 lib 路径（设定处理器型号后 gcc 会自动调用链接器，不需要指明，指明后有冲突，这是前面放置头文件操作引起的）。\n\n这样可以成功得到可执行文件。\n\n需要注意的是，如果不介意官网提供的 gcc 版本较低，尽量使用官网的版本。自己编译的 gcc 缺少头文件等问题的情况只会更严重。如 gentoo crossdev 中编译而成的 msp430-elf-gcc，进行上述操作添加头文件后，虽然可以编译程序，但实际上是错误编译，这些可执行文件不可实际运行。这种情况下还需要做更多的处理。\n\n### 编辑器自动补全与语法检查\n\nneovim 可以使用 coc.nvim，并安装 coc-clangd 插件。对于其他编辑器而言，也可以使用类似的 lsp。通用的一点是`compile_commands.json`文件，这决定了 lsp 补全与检查的依据。该文件可以使用工具从 makefile 或 CMakeList.txt 生成。\n\n什么都不会也没有关系，直接写就行，只需要七行即可。\n\n```json\n[\n  {\n    \"directory\": \"工作目录路径\",\n    \"command\": \"编译指令，可以借用一下ccs内置的gcc，把头文件和微处理器型号写入，可参考上面的gcc编译命令\",\n    \"file\": \"需要编译的文件，如./main.c\"\n  }\n]\n```\n\n将其置于工程目录下即可。\n\n建议将 ccs 安装目录中所有头文件复制到一个目录下，使用`-I`指定该目录即可。对于部分缺少的定义，可以自行在该目录下的头文件中添加，这样也不影响 ccs 编译程序。这里关于缺少的定义稍微解释一下。举个常见的例子，如`__intertupt`。如果你使用它，lsp 会报未定义错误，但是在 ccs 编译器中不会发生，且可以成功编译。查找所有的头文件，确实没有定义。这个时候就可以手动加上，骗过 lsp。如调用了\"msp430g2553.h\"，则在该头文件末尾加上`define __intertupt`。\n\n## 程序烧录与运行\n\n得到可执行文件后，使用 mspdebug 工具进行烧录。\n\n```\nsudo mspdebug rf2500\n# 进入mspdebug界面\nload your_file\n# 或者\nprog your_file\n# 运行程序\nrun\n# 擦除程序\nerase\n```\n\n## 程序调试\n\n```\nsudo mspdebug rf2500\ngdb\n# 在另一个终端窗口启动gdb，具体命令看自己的gdb名称\nmsp430-elf-gdb\n# 进入gdb界面\n# 监听上面mspdebug提供的调试端口\ntarget remote localhost:2000\n\n# moniter后加的命令相当于mspdebug下执行的命令\nmoniter prog your_file\n\nfile your_file\n\n# 使用continue运行程序，不可使用run\nc\n# 其他调试自我发挥\n```\n\n> 可以使用 gdb 打断点，单步调试等等。但是无法查看变量值，更无法查看寄存器的值。对于调试而言，基本上是个废的。\n","slug":"debug-msp430g2-project-on-linux","published":1,"updated":"2021-05-31T08:33:54.186Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmrj000orriz1gav8por","content":"<h1 id=\"在-linux-上-对-MSP430G2-系列工程进行调试\"><a href=\"#在-linux-上-对-MSP430G2-系列工程进行调试\" class=\"headerlink\" title=\"在 linux 上 对 MSP430G2 系列工程进行调试\"></a>在 linux 上 对 MSP430G2 系列工程进行调试</h1><p>Warning : 此方案体验太差，笔者已经弃坑了，有兴趣的可以继续折腾，等待社区推出更好的 gcc。</p>\n<p>本文介绍如何在 linux 系统上对 MSP430 程序进行 debug。包括程序的编译、下载、运行、调试以及 vim 编辑器自动补全设置。</p>\n<h2 id=\"工具\"><a href=\"#工具\" class=\"headerlink\" title=\"工具\"></a>工具</h2><p>在本方案中，需要用到的主要工具包括 TI 官方提供的 IDE——CCS，mspdebug，msp430-elf-gdb，vim/neovim。</p>\n<p>注意，CCS 的 linux 版本不支持连接 MSP430G2 系列的开发板，否则就没那么多麻烦了。在本方案中，该 IDE 只作为编译工具使用。</p>\n<p>TI 官方提供的 msp430-gcc 虽然可以编译程序，但是缺少部分头文件。下面将介绍配置 GCC 的相关内容，但不建议作为编译工具使用。</p>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><h3 id=\"安装工具\"><a href=\"#安装工具\" class=\"headerlink\" title=\"安装工具\"></a>安装工具</h3><p>安装 CCS、mspdebug。很简单，过程略。</p>\n<p>关于 CCS 的使用，由于只需要用来做编译器，更好的选择是使用命令行操作，避免开启图形界面，具体上网搜即可。</p>\n<p>msp430-elf-gdb 可以从 TI 官方提供的 msp430-gcc 编译工具链中获得，也可以自己编译。自己编译的过程如下。</p>\n<p>在 GNU 官网下载最版本 gdb。解压，进入目录。</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\"># target是架构，不需要修改\n# prefix将决定最终安装gdb的位置，可以自行修改\n.&#x2F;configure --prefix&#x3D;&quot;$&#123;PREFIX&#125;&quot; --target&#x3D;msp430-elf\nmake\nsudo make install<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>如果要拆卸 gdb，需要进入编译好后的目录中所有的子目录，执行<code>sudo make uninstall</code>。</p>\n<p>编辑器可以自由选择，本文介绍时使用 neovim。</p>\n<h3 id=\"msp430-gcc\"><a href=\"#msp430-gcc\" class=\"headerlink\" title=\"msp430-gcc\"></a>msp430-gcc</h3><p>如果想要尝试 gcc，可以参考以下步骤。</p>\n<p>首先，在 TI 官网下载 msp430-gcc 及其 support-files。gcc 下载压缩包即可，不需要下载安装工具。</p>\n<p>解压两个下载包。将 support-files 中所有的.h 与.ld 文件复制到 gcc 的 msp430-elf/include 目录以及 msp430-elf/lib 目录下。这里如果想少一点麻烦就不要参考官方教程将文件放到 include/device，直接按前述操作完成即可。</p>\n<p>至此，gcc 配置完毕，只是仍然缺少部分头文件。如<code>delay_cycles</code>函数未定义。</p>\n<p>想要用 gcc 编译，可以进入 msp430gcc 目录，使用<code>./bin/msp430-elf-gcc -I ./msp430-elf/include -mmcu=msp430g2553 -c main.c</code>编译。注意，必须指定微处理器的具体型号，且不要指明 lib 路径（设定处理器型号后 gcc 会自动调用链接器，不需要指明，指明后有冲突，这是前面放置头文件操作引起的）。</p>\n<p>这样可以成功得到可执行文件。</p>\n<p>需要注意的是，如果不介意官网提供的 gcc 版本较低，尽量使用官网的版本。自己编译的 gcc 缺少头文件等问题的情况只会更严重。如 gentoo crossdev 中编译而成的 msp430-elf-gcc，进行上述操作添加头文件后，虽然可以编译程序，但实际上是错误编译，这些可执行文件不可实际运行。这种情况下还需要做更多的处理。</p>\n<h3 id=\"编辑器自动补全与语法检查\"><a href=\"#编辑器自动补全与语法检查\" class=\"headerlink\" title=\"编辑器自动补全与语法检查\"></a>编辑器自动补全与语法检查</h3><p>neovim 可以使用 coc.nvim，并安装 coc-clangd 插件。对于其他编辑器而言，也可以使用类似的 lsp。通用的一点是<code>compile_commands.json</code>文件，这决定了 lsp 补全与检查的依据。该文件可以使用工具从 makefile 或 CMakeList.txt 生成。</p>\n<p>什么都不会也没有关系，直接写就行，只需要七行即可。</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"directory\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"工作目录路径\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"command\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"编译指令，可以借用一下ccs内置的gcc，把头文件和微处理器型号写入，可参考上面的gcc编译命令\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"file\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"需要编译的文件，如./main.c\"</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>将其置于工程目录下即可。</p>\n<p>建议将 ccs 安装目录中所有头文件复制到一个目录下，使用<code>-I</code>指定该目录即可。对于部分缺少的定义，可以自行在该目录下的头文件中添加，这样也不影响 ccs 编译程序。这里关于缺少的定义稍微解释一下。举个常见的例子，如<code>__intertupt</code>。如果你使用它，lsp 会报未定义错误，但是在 ccs 编译器中不会发生，且可以成功编译。查找所有的头文件，确实没有定义。这个时候就可以手动加上，骗过 lsp。如调用了”msp430g2553.h”，则在该头文件末尾加上<code>define __intertupt</code>。</p>\n<h2 id=\"程序烧录与运行\"><a href=\"#程序烧录与运行\" class=\"headerlink\" title=\"程序烧录与运行\"></a>程序烧录与运行</h2><p>得到可执行文件后，使用 mspdebug 工具进行烧录。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo mspdebug rf2500\n# 进入mspdebug界面\nload your_file\n# 或者\nprog your_file\n# 运行程序\nrun\n# 擦除程序\nerase<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"程序调试\"><a href=\"#程序调试\" class=\"headerlink\" title=\"程序调试\"></a>程序调试</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo mspdebug rf2500\ngdb\n# 在另一个终端窗口启动gdb，具体命令看自己的gdb名称\nmsp430-elf-gdb\n# 进入gdb界面\n# 监听上面mspdebug提供的调试端口\ntarget remote localhost:2000\n\n# moniter后加的命令相当于mspdebug下执行的命令\nmoniter prog your_file\n\nfile your_file\n\n# 使用continue运行程序，不可使用run\nc\n# 其他调试自我发挥<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<blockquote>\n<p>可以使用 gdb 打断点，单步调试等等。但是无法查看变量值，更无法查看寄存器的值。对于调试而言，基本上是个废的。</p>\n</blockquote>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"在-linux-上-对-MSP430G2-系列工程进行调试\"><a href=\"#在-linux-上-对-MSP430G2-系列工程进行调试\" class=\"headerlink\" title=\"在 linux 上 对 MSP430G2 系列工程进行调试\"></a>在 linux 上 对 MSP430G2 系列工程进行调试</h1><p>Warning : 此方案体验太差，笔者已经弃坑了，有兴趣的可以继续折腾，等待社区推出更好的 gcc。</p>\n<p>本文介绍如何在 linux 系统上对 MSP430 程序进行 debug。包括程序的编译、下载、运行、调试以及 vim 编辑器自动补全设置。</p>\n<h2 id=\"工具\"><a href=\"#工具\" class=\"headerlink\" title=\"工具\"></a>工具</h2><p>在本方案中，需要用到的主要工具包括 TI 官方提供的 IDE——CCS，mspdebug，msp430-elf-gdb，vim/neovim。</p>\n<p>注意，CCS 的 linux 版本不支持连接 MSP430G2 系列的开发板，否则就没那么多麻烦了。在本方案中，该 IDE 只作为编译工具使用。</p>\n<p>TI 官方提供的 msp430-gcc 虽然可以编译程序，但是缺少部分头文件。下面将介绍配置 GCC 的相关内容，但不建议作为编译工具使用。</p>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><h3 id=\"安装工具\"><a href=\"#安装工具\" class=\"headerlink\" title=\"安装工具\"></a>安装工具</h3><p>安装 CCS、mspdebug。很简单，过程略。</p>\n<p>关于 CCS 的使用，由于只需要用来做编译器，更好的选择是使用命令行操作，避免开启图形界面，具体上网搜即可。</p>\n<p>msp430-elf-gdb 可以从 TI 官方提供的 msp430-gcc 编译工具链中获得，也可以自己编译。自己编译的过程如下。</p>\n<p>在 GNU 官网下载最版本 gdb。解压，进入目录。</p>\n<pre class=\"line-numbers language-shell\" data-language=\"shell\"><code class=\"language-shell\"># target是架构，不需要修改\n# prefix将决定最终安装gdb的位置，可以自行修改\n.&#x2F;configure --prefix&#x3D;&quot;$&#123;PREFIX&#125;&quot; --target&#x3D;msp430-elf\nmake\nsudo make install<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>如果要拆卸 gdb，需要进入编译好后的目录中所有的子目录，执行<code>sudo make uninstall</code>。</p>\n<p>编辑器可以自由选择，本文介绍时使用 neovim。</p>\n<h3 id=\"msp430-gcc\"><a href=\"#msp430-gcc\" class=\"headerlink\" title=\"msp430-gcc\"></a>msp430-gcc</h3><p>如果想要尝试 gcc，可以参考以下步骤。</p>\n<p>首先，在 TI 官网下载 msp430-gcc 及其 support-files。gcc 下载压缩包即可，不需要下载安装工具。</p>\n<p>解压两个下载包。将 support-files 中所有的.h 与.ld 文件复制到 gcc 的 msp430-elf/include 目录以及 msp430-elf/lib 目录下。这里如果想少一点麻烦就不要参考官方教程将文件放到 include/device，直接按前述操作完成即可。</p>\n<p>至此，gcc 配置完毕，只是仍然缺少部分头文件。如<code>delay_cycles</code>函数未定义。</p>\n<p>想要用 gcc 编译，可以进入 msp430gcc 目录，使用<code>./bin/msp430-elf-gcc -I ./msp430-elf/include -mmcu=msp430g2553 -c main.c</code>编译。注意，必须指定微处理器的具体型号，且不要指明 lib 路径（设定处理器型号后 gcc 会自动调用链接器，不需要指明，指明后有冲突，这是前面放置头文件操作引起的）。</p>\n<p>这样可以成功得到可执行文件。</p>\n<p>需要注意的是，如果不介意官网提供的 gcc 版本较低，尽量使用官网的版本。自己编译的 gcc 缺少头文件等问题的情况只会更严重。如 gentoo crossdev 中编译而成的 msp430-elf-gcc，进行上述操作添加头文件后，虽然可以编译程序，但实际上是错误编译，这些可执行文件不可实际运行。这种情况下还需要做更多的处理。</p>\n<h3 id=\"编辑器自动补全与语法检查\"><a href=\"#编辑器自动补全与语法检查\" class=\"headerlink\" title=\"编辑器自动补全与语法检查\"></a>编辑器自动补全与语法检查</h3><p>neovim 可以使用 coc.nvim，并安装 coc-clangd 插件。对于其他编辑器而言，也可以使用类似的 lsp。通用的一点是<code>compile_commands.json</code>文件，这决定了 lsp 补全与检查的依据。该文件可以使用工具从 makefile 或 CMakeList.txt 生成。</p>\n<p>什么都不会也没有关系，直接写就行，只需要七行即可。</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"directory\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"工作目录路径\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"command\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"编译指令，可以借用一下ccs内置的gcc，把头文件和微处理器型号写入，可参考上面的gcc编译命令\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"file\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"需要编译的文件，如./main.c\"</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">]</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>将其置于工程目录下即可。</p>\n<p>建议将 ccs 安装目录中所有头文件复制到一个目录下，使用<code>-I</code>指定该目录即可。对于部分缺少的定义，可以自行在该目录下的头文件中添加，这样也不影响 ccs 编译程序。这里关于缺少的定义稍微解释一下。举个常见的例子，如<code>__intertupt</code>。如果你使用它，lsp 会报未定义错误，但是在 ccs 编译器中不会发生，且可以成功编译。查找所有的头文件，确实没有定义。这个时候就可以手动加上，骗过 lsp。如调用了”msp430g2553.h”，则在该头文件末尾加上<code>define __intertupt</code>。</p>\n<h2 id=\"程序烧录与运行\"><a href=\"#程序烧录与运行\" class=\"headerlink\" title=\"程序烧录与运行\"></a>程序烧录与运行</h2><p>得到可执行文件后，使用 mspdebug 工具进行烧录。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo mspdebug rf2500\n# 进入mspdebug界面\nload your_file\n# 或者\nprog your_file\n# 运行程序\nrun\n# 擦除程序\nerase<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"程序调试\"><a href=\"#程序调试\" class=\"headerlink\" title=\"程序调试\"></a>程序调试</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo mspdebug rf2500\ngdb\n# 在另一个终端窗口启动gdb，具体命令看自己的gdb名称\nmsp430-elf-gdb\n# 进入gdb界面\n# 监听上面mspdebug提供的调试端口\ntarget remote localhost:2000\n\n# moniter后加的命令相当于mspdebug下执行的命令\nmoniter prog your_file\n\nfile your_file\n\n# 使用continue运行程序，不可使用run\nc\n# 其他调试自我发挥<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<blockquote>\n<p>可以使用 gdb 打断点，单步调试等等。但是无法查看变量值，更无法查看寄存器的值。对于调试而言，基本上是个废的。</p>\n</blockquote>\n"},{"title":"Develop Stm32 Project with Rust","date":"2021-03-23T10:19:56.000Z","_content":"\n# 使用 rust 开发 stm32\n\n本文介绍如何用 rust 语言开发 stm32。开发平台为 linux（gentoo）。\n\n## 硬件准备\n\n本文使用的芯片为 STM32F103C8T6。该芯片性价比较高，价格低廉，适合入门学习。需要注意的是该款芯片为国产仿品，在烧录的时候需要对软件进行一定修改。\n\n仿真器选用 STLINK V2。也可以选择 jlink。后者连接似乎更加稳定，不过使用外设时需要更加小心。\n\n连接时只需要按板子上的标注把相同的引脚连起来即可。\n\n此外需要至少四根母对母杜邦线。\n\n## 软件准备\n\n### 安装 rust\n\n步骤极为简单，建议选用 beta 或者 nightly 版本工具链。\n\n添加对相应架构的支持。\n\n```\nrustup target add thumbv6m-none-eabi thumbv7m-none-eabi thumbv7em-none-eabi thumbv7em-none-eabihf\n```\n\n### openocd\n\n用于驱动仿真器。直接搜索如何安装即可。\n\n对以上芯片，需要进行如下修改。\n\n找到 openocd 的安装目录，将`/scripts/target/stm32f1x.cfg`中的`set _CPUTAPID 0x1ba01477`修改为`set _CPUTAPID 0x2ba01477`。\n\n### arm-none-eabi 工具链\n\n对 gentoo 而言，直接使用 crossdev 进行配置即可。其中 gdb 建议下载源码编译。其他 linux 版本需要搜索如何安装。\n\ngdb 编译步骤如下。\n\n```\n# 进入源码目录\n./configure --prefix=\"${PREFIX}\" --target=arm-none-eabi\nmake\nsudo make install\n```\n\n如果要拆卸，`cd`进入编译后的各个目录，执行`sudo make uninstall`即可。\n\ncrossdev 安装 arm-none-eabi 工具链步骤如下。\n\n```\n# 首先安装crossdev\n\n# 编辑/etc/portage/make.conf，写入\nPORTDIR_OVERLAY=\"${PORTDIR_OVERLAY} /usr/local/portage\"\n\n# 编译安装工具链\nsudo crossdev -s4 -t arm-none-eabi\n# 如果软件编译失败，查看原因为masked by: corruption，则\n# 编辑/var/db/repos/localrepo-crossdev/metadata/layout.conf，写入\nmasters = gentoo\nthin-manifests = true\n# 编辑/etc/portage/repos.conf/crossdev.conf，写入\n[crossdev]\nlocation = /var/db/repos/localrepo-crossdev\npriority = 10\nmasters = gentoo\nauto-sync = no\n\n# 编译时需要使用gcc作为编译器，编译newlib时，需要把/etc/portage/make.conf中\n# COMMON_FLAGS=\"-march=native -O2 -pipe\"注释掉\n```\n\n### stlink\n\nstlink 是仿真器的驱动，在连接中可能需要。\n\n### gdbgui（可选）\n\ngdb gui 程序，便于调试。\n\n## blink\n\n新建项目`cargo new rusty-blink`。\n\n`Cargo.toml`如下\n\n```toml\n[package]\nname = \"rusty-blink\"\nversion = \"0.1.0\"\nauthors =\nedition = \"2018\"\n\n# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\n\n[profile.release]\nopt-level = 'z' # turn on maximum optimizations. We only have 64kB\nlto = true      # Link-time-optimizations for further size reduction\n\n[dependencies]\ncortex-m = \"^0.6.3\"      # Access to the generic ARM peripherals\ncortex-m-rt = \"^0.6.12\"  # Startup code for the ARM Core\nembedded-hal = \"^0.2.4\"  # Access to generic embedded functions (`set_high`)\npanic-halt = \"^0.2.0\"    # Panic handler\n\n# Access to the stm32f103 HAL.\n[dependencies.stm32f1xx-hal]\n# Bluepill contains a 64kB flash variant which is called \"medium density\"\nfeatures = [\"stm32f103\", \"rt\", \"medium\"]\nversion = \"^0.6.1\"\n```\n\n在项目根目录下新建项目配置`mkdir .cargo`。其中由于使用 lld 进行链接后会丢失调试信息，因此将 linker 指定为 gcc。runner 是执行`cargo run`之后自动执行的命令，此处为自动开启 gdb 并加载文件。\n\n```\n# .cargo/config\n[build]\ntarget = \"thumbv7m-none-eabi\"\n\n[target.'cfg(all(target_arch = \"arm\", target_os = \"none\"))']\nrunner = 'gdbgui -g arm-none-eabi-gdb'\n\n[target.thumbv7m-none-eabi]\nrustflags = [\n\t\"-C\", \"linker=arm-none-eabi-gcc\",\n\t\"-C\", \"link-arg=-Wl,-Tlink.x\",\n\t\"-C\", \"link-arg=-nostartfiles\",\n]\n```\n\n### 程序\n\n在项目根目录下新建`memory.x`。\n\n```\n/* memory.x - Linker script for the STM32F103C8T6 */\nMEMORY\n{\n  /* Flash memory begins at 0x80000000 and has a size of 64kB*/\n  FLASH : ORIGIN = 0x08000000, LENGTH = 64K\n  /* RAM begins at 0x20000000 and has a size of 20kB*/\n  RAM : ORIGIN = 0x20000000, LENGTH = 20K\n}\n```\n\n一般网上售卖的该款芯片应当是 64K 和 20K，如果有偏差需要按实际情况填写。\n\n在 src 下新建`main.rs`。该程序仅用于测试，效果为绿灯闪烁。\n\n```rust\n// src/main.rs\n\n#![no_std]\n#![no_main]\n\nuse cortex_m_rt::entry; // The runtime\nuse embedded_hal::digital::v2::OutputPin; // the `set_high/low`function\nuse stm32f1xx_hal::{delay::Delay, pac, prelude::*}; // STM32F1 specific functions\n#[allow(unused_imports)]\nuse panic_halt; // When a panic occurs, stop the microcontroller\n#[entry]\nfn main() -> ! {\n    let dp = pac::Peripherals::take().unwrap();\n    let cp = cortex_m::Peripherals::take().unwrap();\n    let mut rcc = dp.RCC.constrain();\n    let mut gpioc = dp.GPIOC.split(&mut rcc.apb2);\n    let mut led = gpioc.pc13.into_push_pull_output(&mut gpioc.crh);\n    let mut flash = dp.FLASH.constrain();\n    let clocks = rcc.cfgr.sysclk(8.mhz()).freeze(&mut flash.acr);\n    let mut delay = Delay::new(cp.SYST, clocks);\n    loop {\n        led.set_high().ok();\n        delay.delay_ms(1_000_u16);\n        led.set_low().ok();\n        delay.delay_ms(1_000_u16);\n    }\n}\n```\n\n### 烧录与调试\n\n```\n# 连接仿真器\nopenocd -f interface/stlink-v2.cfg -f target/stm32f1x.cfg\n# 如果仿真器选用jlink，则命令为openocd -f interface/jlink.cfg -f target/stm32f1x.cfg\n# 出现以下信息为连接成功\nInfo : stm32f1x.cpu: hardware has 6 breakpoints, 4 watchpoints\n\n# 编译并开启gdb\ncargo run\n\n# 在gdb窗口执行以下命令\ntarget remote :3333\nmoniter reset halt\nload\ncontinue\n```\n\n此时如果程序持续执行，应当可以在板子上看到绿灯闪烁。如果停在断点处，就再 continue。\n\n更进一步可以直接在 gdb 开启时自动执行以上命令。\n\n将`runner`改为`runner = 'arm-none-eabi-gdb -q -x debug.gdb'`。在项目根目录下新建`debug.gdb`，写入以下内容。\n\n```\ntarget remote :3333\n\nset backtrace limit 32\n\nmonitor reset halt\n\nload\n```\n","source":"_posts/develop-stm32-project-with-rust.md","raw":"---\ntitle: Develop Stm32 Project with Rust\ndate: 2021-03-23 18:19:56\ntags:\n    - Rust\n    - Stm32\ncategories:\n    - [Embedded]\n    - [Rust]\n---\n\n# 使用 rust 开发 stm32\n\n本文介绍如何用 rust 语言开发 stm32。开发平台为 linux（gentoo）。\n\n## 硬件准备\n\n本文使用的芯片为 STM32F103C8T6。该芯片性价比较高，价格低廉，适合入门学习。需要注意的是该款芯片为国产仿品，在烧录的时候需要对软件进行一定修改。\n\n仿真器选用 STLINK V2。也可以选择 jlink。后者连接似乎更加稳定，不过使用外设时需要更加小心。\n\n连接时只需要按板子上的标注把相同的引脚连起来即可。\n\n此外需要至少四根母对母杜邦线。\n\n## 软件准备\n\n### 安装 rust\n\n步骤极为简单，建议选用 beta 或者 nightly 版本工具链。\n\n添加对相应架构的支持。\n\n```\nrustup target add thumbv6m-none-eabi thumbv7m-none-eabi thumbv7em-none-eabi thumbv7em-none-eabihf\n```\n\n### openocd\n\n用于驱动仿真器。直接搜索如何安装即可。\n\n对以上芯片，需要进行如下修改。\n\n找到 openocd 的安装目录，将`/scripts/target/stm32f1x.cfg`中的`set _CPUTAPID 0x1ba01477`修改为`set _CPUTAPID 0x2ba01477`。\n\n### arm-none-eabi 工具链\n\n对 gentoo 而言，直接使用 crossdev 进行配置即可。其中 gdb 建议下载源码编译。其他 linux 版本需要搜索如何安装。\n\ngdb 编译步骤如下。\n\n```\n# 进入源码目录\n./configure --prefix=\"${PREFIX}\" --target=arm-none-eabi\nmake\nsudo make install\n```\n\n如果要拆卸，`cd`进入编译后的各个目录，执行`sudo make uninstall`即可。\n\ncrossdev 安装 arm-none-eabi 工具链步骤如下。\n\n```\n# 首先安装crossdev\n\n# 编辑/etc/portage/make.conf，写入\nPORTDIR_OVERLAY=\"${PORTDIR_OVERLAY} /usr/local/portage\"\n\n# 编译安装工具链\nsudo crossdev -s4 -t arm-none-eabi\n# 如果软件编译失败，查看原因为masked by: corruption，则\n# 编辑/var/db/repos/localrepo-crossdev/metadata/layout.conf，写入\nmasters = gentoo\nthin-manifests = true\n# 编辑/etc/portage/repos.conf/crossdev.conf，写入\n[crossdev]\nlocation = /var/db/repos/localrepo-crossdev\npriority = 10\nmasters = gentoo\nauto-sync = no\n\n# 编译时需要使用gcc作为编译器，编译newlib时，需要把/etc/portage/make.conf中\n# COMMON_FLAGS=\"-march=native -O2 -pipe\"注释掉\n```\n\n### stlink\n\nstlink 是仿真器的驱动，在连接中可能需要。\n\n### gdbgui（可选）\n\ngdb gui 程序，便于调试。\n\n## blink\n\n新建项目`cargo new rusty-blink`。\n\n`Cargo.toml`如下\n\n```toml\n[package]\nname = \"rusty-blink\"\nversion = \"0.1.0\"\nauthors =\nedition = \"2018\"\n\n# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\n\n[profile.release]\nopt-level = 'z' # turn on maximum optimizations. We only have 64kB\nlto = true      # Link-time-optimizations for further size reduction\n\n[dependencies]\ncortex-m = \"^0.6.3\"      # Access to the generic ARM peripherals\ncortex-m-rt = \"^0.6.12\"  # Startup code for the ARM Core\nembedded-hal = \"^0.2.4\"  # Access to generic embedded functions (`set_high`)\npanic-halt = \"^0.2.0\"    # Panic handler\n\n# Access to the stm32f103 HAL.\n[dependencies.stm32f1xx-hal]\n# Bluepill contains a 64kB flash variant which is called \"medium density\"\nfeatures = [\"stm32f103\", \"rt\", \"medium\"]\nversion = \"^0.6.1\"\n```\n\n在项目根目录下新建项目配置`mkdir .cargo`。其中由于使用 lld 进行链接后会丢失调试信息，因此将 linker 指定为 gcc。runner 是执行`cargo run`之后自动执行的命令，此处为自动开启 gdb 并加载文件。\n\n```\n# .cargo/config\n[build]\ntarget = \"thumbv7m-none-eabi\"\n\n[target.'cfg(all(target_arch = \"arm\", target_os = \"none\"))']\nrunner = 'gdbgui -g arm-none-eabi-gdb'\n\n[target.thumbv7m-none-eabi]\nrustflags = [\n\t\"-C\", \"linker=arm-none-eabi-gcc\",\n\t\"-C\", \"link-arg=-Wl,-Tlink.x\",\n\t\"-C\", \"link-arg=-nostartfiles\",\n]\n```\n\n### 程序\n\n在项目根目录下新建`memory.x`。\n\n```\n/* memory.x - Linker script for the STM32F103C8T6 */\nMEMORY\n{\n  /* Flash memory begins at 0x80000000 and has a size of 64kB*/\n  FLASH : ORIGIN = 0x08000000, LENGTH = 64K\n  /* RAM begins at 0x20000000 and has a size of 20kB*/\n  RAM : ORIGIN = 0x20000000, LENGTH = 20K\n}\n```\n\n一般网上售卖的该款芯片应当是 64K 和 20K，如果有偏差需要按实际情况填写。\n\n在 src 下新建`main.rs`。该程序仅用于测试，效果为绿灯闪烁。\n\n```rust\n// src/main.rs\n\n#![no_std]\n#![no_main]\n\nuse cortex_m_rt::entry; // The runtime\nuse embedded_hal::digital::v2::OutputPin; // the `set_high/low`function\nuse stm32f1xx_hal::{delay::Delay, pac, prelude::*}; // STM32F1 specific functions\n#[allow(unused_imports)]\nuse panic_halt; // When a panic occurs, stop the microcontroller\n#[entry]\nfn main() -> ! {\n    let dp = pac::Peripherals::take().unwrap();\n    let cp = cortex_m::Peripherals::take().unwrap();\n    let mut rcc = dp.RCC.constrain();\n    let mut gpioc = dp.GPIOC.split(&mut rcc.apb2);\n    let mut led = gpioc.pc13.into_push_pull_output(&mut gpioc.crh);\n    let mut flash = dp.FLASH.constrain();\n    let clocks = rcc.cfgr.sysclk(8.mhz()).freeze(&mut flash.acr);\n    let mut delay = Delay::new(cp.SYST, clocks);\n    loop {\n        led.set_high().ok();\n        delay.delay_ms(1_000_u16);\n        led.set_low().ok();\n        delay.delay_ms(1_000_u16);\n    }\n}\n```\n\n### 烧录与调试\n\n```\n# 连接仿真器\nopenocd -f interface/stlink-v2.cfg -f target/stm32f1x.cfg\n# 如果仿真器选用jlink，则命令为openocd -f interface/jlink.cfg -f target/stm32f1x.cfg\n# 出现以下信息为连接成功\nInfo : stm32f1x.cpu: hardware has 6 breakpoints, 4 watchpoints\n\n# 编译并开启gdb\ncargo run\n\n# 在gdb窗口执行以下命令\ntarget remote :3333\nmoniter reset halt\nload\ncontinue\n```\n\n此时如果程序持续执行，应当可以在板子上看到绿灯闪烁。如果停在断点处，就再 continue。\n\n更进一步可以直接在 gdb 开启时自动执行以上命令。\n\n将`runner`改为`runner = 'arm-none-eabi-gdb -q -x debug.gdb'`。在项目根目录下新建`debug.gdb`，写入以下内容。\n\n```\ntarget remote :3333\n\nset backtrace limit 32\n\nmonitor reset halt\n\nload\n```\n","slug":"develop-stm32-project-with-rust","published":1,"updated":"2021-05-31T08:34:10.063Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmrl000srriz8tod14sx","content":"<h1 id=\"使用-rust-开发-stm32\"><a href=\"#使用-rust-开发-stm32\" class=\"headerlink\" title=\"使用 rust 开发 stm32\"></a>使用 rust 开发 stm32</h1><p>本文介绍如何用 rust 语言开发 stm32。开发平台为 linux（gentoo）。</p>\n<h2 id=\"硬件准备\"><a href=\"#硬件准备\" class=\"headerlink\" title=\"硬件准备\"></a>硬件准备</h2><p>本文使用的芯片为 STM32F103C8T6。该芯片性价比较高，价格低廉，适合入门学习。需要注意的是该款芯片为国产仿品，在烧录的时候需要对软件进行一定修改。</p>\n<p>仿真器选用 STLINK V2。也可以选择 jlink。后者连接似乎更加稳定，不过使用外设时需要更加小心。</p>\n<p>连接时只需要按板子上的标注把相同的引脚连起来即可。</p>\n<p>此外需要至少四根母对母杜邦线。</p>\n<h2 id=\"软件准备\"><a href=\"#软件准备\" class=\"headerlink\" title=\"软件准备\"></a>软件准备</h2><h3 id=\"安装-rust\"><a href=\"#安装-rust\" class=\"headerlink\" title=\"安装 rust\"></a>安装 rust</h3><p>步骤极为简单，建议选用 beta 或者 nightly 版本工具链。</p>\n<p>添加对相应架构的支持。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">rustup target add thumbv6m-none-eabi thumbv7m-none-eabi thumbv7em-none-eabi thumbv7em-none-eabihf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"openocd\"><a href=\"#openocd\" class=\"headerlink\" title=\"openocd\"></a>openocd</h3><p>用于驱动仿真器。直接搜索如何安装即可。</p>\n<p>对以上芯片，需要进行如下修改。</p>\n<p>找到 openocd 的安装目录，将<code>/scripts/target/stm32f1x.cfg</code>中的<code>set _CPUTAPID 0x1ba01477</code>修改为<code>set _CPUTAPID 0x2ba01477</code>。</p>\n<h3 id=\"arm-none-eabi-工具链\"><a href=\"#arm-none-eabi-工具链\" class=\"headerlink\" title=\"arm-none-eabi 工具链\"></a>arm-none-eabi 工具链</h3><p>对 gentoo 而言，直接使用 crossdev 进行配置即可。其中 gdb 建议下载源码编译。其他 linux 版本需要搜索如何安装。</p>\n<p>gdb 编译步骤如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 进入源码目录\n.&#x2F;configure --prefix&#x3D;&quot;$&#123;PREFIX&#125;&quot; --target&#x3D;arm-none-eabi\nmake\nsudo make install<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>如果要拆卸，<code>cd</code>进入编译后的各个目录，执行<code>sudo make uninstall</code>即可。</p>\n<p>crossdev 安装 arm-none-eabi 工具链步骤如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 首先安装crossdev\n\n# 编辑&#x2F;etc&#x2F;portage&#x2F;make.conf，写入\nPORTDIR_OVERLAY&#x3D;&quot;$&#123;PORTDIR_OVERLAY&#125; &#x2F;usr&#x2F;local&#x2F;portage&quot;\n\n# 编译安装工具链\nsudo crossdev -s4 -t arm-none-eabi\n# 如果软件编译失败，查看原因为masked by: corruption，则\n# 编辑&#x2F;var&#x2F;db&#x2F;repos&#x2F;localrepo-crossdev&#x2F;metadata&#x2F;layout.conf，写入\nmasters &#x3D; gentoo\nthin-manifests &#x3D; true\n# 编辑&#x2F;etc&#x2F;portage&#x2F;repos.conf&#x2F;crossdev.conf，写入\n[crossdev]\nlocation &#x3D; &#x2F;var&#x2F;db&#x2F;repos&#x2F;localrepo-crossdev\npriority &#x3D; 10\nmasters &#x3D; gentoo\nauto-sync &#x3D; no\n\n# 编译时需要使用gcc作为编译器，编译newlib时，需要把&#x2F;etc&#x2F;portage&#x2F;make.conf中\n# COMMON_FLAGS&#x3D;&quot;-march&#x3D;native -O2 -pipe&quot;注释掉<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"stlink\"><a href=\"#stlink\" class=\"headerlink\" title=\"stlink\"></a>stlink</h3><p>stlink 是仿真器的驱动，在连接中可能需要。</p>\n<h3 id=\"gdbgui（可选）\"><a href=\"#gdbgui（可选）\" class=\"headerlink\" title=\"gdbgui（可选）\"></a>gdbgui（可选）</h3><p>gdb gui 程序，便于调试。</p>\n<h2 id=\"blink\"><a href=\"#blink\" class=\"headerlink\" title=\"blink\"></a>blink</h2><p>新建项目<code>cargo new rusty-blink</code>。</p>\n<p><code>Cargo.toml</code>如下</p>\n<pre class=\"line-numbers language-toml\" data-language=\"toml\"><code class=\"language-toml\"><span class=\"token punctuation\">[</span><span class=\"token table class-name\">package</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">name</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"rusty-blink\"</span>\n<span class=\"token key property\">version</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"0.1.0\"</span>\n<span class=\"token key property\">authors</span> <span class=\"token punctuation\">=</span>\n<span class=\"token key property\">edition</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"2018\"</span>\n\n<span class=\"token comment\"># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">profile.release</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">opt-level</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">'z'</span> <span class=\"token comment\"># turn on maximum optimizations. We only have 64kB</span>\n<span class=\"token key property\">lto</span> <span class=\"token punctuation\">=</span> <span class=\"token boolean\">true</span>      <span class=\"token comment\"># Link-time-optimizations for further size reduction</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">dependencies</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">cortex-m</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"^0.6.3\"</span>      <span class=\"token comment\"># Access to the generic ARM peripherals</span>\n<span class=\"token key property\">cortex-m-rt</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"^0.6.12\"</span>  <span class=\"token comment\"># Startup code for the ARM Core</span>\n<span class=\"token key property\">embedded-hal</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"^0.2.4\"</span>  <span class=\"token comment\"># Access to generic embedded functions (`set_high`)</span>\n<span class=\"token key property\">panic-halt</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"^0.2.0\"</span>    <span class=\"token comment\"># Panic handler</span>\n\n<span class=\"token comment\"># Access to the stm32f103 HAL.</span>\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">dependencies.stm32f1xx-hal</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># Bluepill contains a 64kB flash variant which is called \"medium density\"</span>\n<span class=\"token key property\">features</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"stm32f103\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"medium\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">version</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"^0.6.1\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>在项目根目录下新建项目配置<code>mkdir .cargo</code>。其中由于使用 lld 进行链接后会丢失调试信息，因此将 linker 指定为 gcc。runner 是执行<code>cargo run</code>之后自动执行的命令，此处为自动开启 gdb 并加载文件。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># .cargo&#x2F;config\n[build]\ntarget &#x3D; &quot;thumbv7m-none-eabi&quot;\n\n[target.&#39;cfg(all(target_arch &#x3D; &quot;arm&quot;, target_os &#x3D; &quot;none&quot;))&#39;]\nrunner &#x3D; &#39;gdbgui -g arm-none-eabi-gdb&#39;\n\n[target.thumbv7m-none-eabi]\nrustflags &#x3D; [\n\t&quot;-C&quot;, &quot;linker&#x3D;arm-none-eabi-gcc&quot;,\n\t&quot;-C&quot;, &quot;link-arg&#x3D;-Wl,-Tlink.x&quot;,\n\t&quot;-C&quot;, &quot;link-arg&#x3D;-nostartfiles&quot;,\n]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"程序\"><a href=\"#程序\" class=\"headerlink\" title=\"程序\"></a>程序</h3><p>在项目根目录下新建<code>memory.x</code>。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;* memory.x - Linker script for the STM32F103C8T6 *&#x2F;\nMEMORY\n&#123;\n  &#x2F;* Flash memory begins at 0x80000000 and has a size of 64kB*&#x2F;\n  FLASH : ORIGIN &#x3D; 0x08000000, LENGTH &#x3D; 64K\n  &#x2F;* RAM begins at 0x20000000 and has a size of 20kB*&#x2F;\n  RAM : ORIGIN &#x3D; 0x20000000, LENGTH &#x3D; 20K\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>一般网上售卖的该款芯片应当是 64K 和 20K，如果有偏差需要按实际情况填写。</p>\n<p>在 src 下新建<code>main.rs</code>。该程序仅用于测试，效果为绿灯闪烁。</p>\n<pre class=\"line-numbers language-rust\" data-language=\"rust\"><code class=\"language-rust\"><span class=\"token comment\">// src/main.rs</span>\n\n<span class=\"token attribute attr-name\">#![no_std]</span>\n<span class=\"token attribute attr-name\">#![no_main]</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token namespace\">cortex_m_rt<span class=\"token punctuation\">::</span></span>entry<span class=\"token punctuation\">;</span> <span class=\"token comment\">// The runtime</span>\n<span class=\"token keyword\">use</span> <span class=\"token namespace\">embedded_hal<span class=\"token punctuation\">::</span>digital<span class=\"token punctuation\">::</span>v2<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">OutputPin</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// the `set_high/low`function</span>\n<span class=\"token keyword\">use</span> <span class=\"token namespace\">stm32f1xx_hal<span class=\"token punctuation\">::</span></span><span class=\"token punctuation\">&#123;</span><span class=\"token namespace\">delay<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Delay</span><span class=\"token punctuation\">,</span> pac<span class=\"token punctuation\">,</span> <span class=\"token namespace\">prelude<span class=\"token punctuation\">::</span></span><span class=\"token operator\">*</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// STM32F1 specific functions</span>\n<span class=\"token attribute attr-name\">#[allow(unused_imports)]</span>\n<span class=\"token keyword\">use</span> panic_halt<span class=\"token punctuation\">;</span> <span class=\"token comment\">// When a panic occurs, stop the microcontroller</span>\n<span class=\"token attribute attr-name\">#[entry]</span>\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token operator\">!</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">let</span> dp <span class=\"token operator\">=</span> <span class=\"token namespace\">pac<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Peripherals</span><span class=\"token punctuation\">::</span><span class=\"token function\">take</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">unwrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> cp <span class=\"token operator\">=</span> <span class=\"token namespace\">cortex_m<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Peripherals</span><span class=\"token punctuation\">::</span><span class=\"token function\">take</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">unwrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> rcc <span class=\"token operator\">=</span> dp<span class=\"token punctuation\">.</span><span class=\"token constant\">RCC</span><span class=\"token punctuation\">.</span><span class=\"token function\">constrain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> gpioc <span class=\"token operator\">=</span> dp<span class=\"token punctuation\">.</span><span class=\"token constant\">GPIOC</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> rcc<span class=\"token punctuation\">.</span>apb2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> led <span class=\"token operator\">=</span> gpioc<span class=\"token punctuation\">.</span>pc13<span class=\"token punctuation\">.</span><span class=\"token function\">into_push_pull_output</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> gpioc<span class=\"token punctuation\">.</span>crh<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> flash <span class=\"token operator\">=</span> dp<span class=\"token punctuation\">.</span><span class=\"token constant\">FLASH</span><span class=\"token punctuation\">.</span><span class=\"token function\">constrain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> clocks <span class=\"token operator\">=</span> rcc<span class=\"token punctuation\">.</span>cfgr<span class=\"token punctuation\">.</span><span class=\"token function\">sysclk</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">.</span><span class=\"token function\">mhz</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">freeze</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> flash<span class=\"token punctuation\">.</span>acr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> delay <span class=\"token operator\">=</span> <span class=\"token class-name\">Delay</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span>cp<span class=\"token punctuation\">.</span><span class=\"token constant\">SYST</span><span class=\"token punctuation\">,</span> clocks<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">loop</span> <span class=\"token punctuation\">&#123;</span>\n        led<span class=\"token punctuation\">.</span><span class=\"token function\">set_high</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        delay<span class=\"token punctuation\">.</span><span class=\"token function\">delay_ms</span><span class=\"token punctuation\">(</span><span class=\"token number\">1_000_u16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        led<span class=\"token punctuation\">.</span><span class=\"token function\">set_low</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        delay<span class=\"token punctuation\">.</span><span class=\"token function\">delay_ms</span><span class=\"token punctuation\">(</span><span class=\"token number\">1_000_u16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"烧录与调试\"><a href=\"#烧录与调试\" class=\"headerlink\" title=\"烧录与调试\"></a>烧录与调试</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\"># 连接仿真器\nopenocd -f interface&#x2F;stlink-v2.cfg -f target&#x2F;stm32f1x.cfg\n# 如果仿真器选用jlink，则命令为openocd -f interface&#x2F;jlink.cfg -f target&#x2F;stm32f1x.cfg\n# 出现以下信息为连接成功\nInfo : stm32f1x.cpu: hardware has 6 breakpoints, 4 watchpoints\n\n# 编译并开启gdb\ncargo run\n\n# 在gdb窗口执行以下命令\ntarget remote :3333\nmoniter reset halt\nload\ncontinue<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>此时如果程序持续执行，应当可以在板子上看到绿灯闪烁。如果停在断点处，就再 continue。</p>\n<p>更进一步可以直接在 gdb 开启时自动执行以上命令。</p>\n<p>将<code>runner</code>改为<code>runner = &#39;arm-none-eabi-gdb -q -x debug.gdb&#39;</code>。在项目根目录下新建<code>debug.gdb</code>，写入以下内容。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">target remote :3333\n\nset backtrace limit 32\n\nmonitor reset halt\n\nload<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"使用-rust-开发-stm32\"><a href=\"#使用-rust-开发-stm32\" class=\"headerlink\" title=\"使用 rust 开发 stm32\"></a>使用 rust 开发 stm32</h1><p>本文介绍如何用 rust 语言开发 stm32。开发平台为 linux（gentoo）。</p>\n<h2 id=\"硬件准备\"><a href=\"#硬件准备\" class=\"headerlink\" title=\"硬件准备\"></a>硬件准备</h2><p>本文使用的芯片为 STM32F103C8T6。该芯片性价比较高，价格低廉，适合入门学习。需要注意的是该款芯片为国产仿品，在烧录的时候需要对软件进行一定修改。</p>\n<p>仿真器选用 STLINK V2。也可以选择 jlink。后者连接似乎更加稳定，不过使用外设时需要更加小心。</p>\n<p>连接时只需要按板子上的标注把相同的引脚连起来即可。</p>\n<p>此外需要至少四根母对母杜邦线。</p>\n<h2 id=\"软件准备\"><a href=\"#软件准备\" class=\"headerlink\" title=\"软件准备\"></a>软件准备</h2><h3 id=\"安装-rust\"><a href=\"#安装-rust\" class=\"headerlink\" title=\"安装 rust\"></a>安装 rust</h3><p>步骤极为简单，建议选用 beta 或者 nightly 版本工具链。</p>\n<p>添加对相应架构的支持。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">rustup target add thumbv6m-none-eabi thumbv7m-none-eabi thumbv7em-none-eabi thumbv7em-none-eabihf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"openocd\"><a href=\"#openocd\" class=\"headerlink\" title=\"openocd\"></a>openocd</h3><p>用于驱动仿真器。直接搜索如何安装即可。</p>\n<p>对以上芯片，需要进行如下修改。</p>\n<p>找到 openocd 的安装目录，将<code>/scripts/target/stm32f1x.cfg</code>中的<code>set _CPUTAPID 0x1ba01477</code>修改为<code>set _CPUTAPID 0x2ba01477</code>。</p>\n<h3 id=\"arm-none-eabi-工具链\"><a href=\"#arm-none-eabi-工具链\" class=\"headerlink\" title=\"arm-none-eabi 工具链\"></a>arm-none-eabi 工具链</h3><p>对 gentoo 而言，直接使用 crossdev 进行配置即可。其中 gdb 建议下载源码编译。其他 linux 版本需要搜索如何安装。</p>\n<p>gdb 编译步骤如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 进入源码目录\n.&#x2F;configure --prefix&#x3D;&quot;$&#123;PREFIX&#125;&quot; --target&#x3D;arm-none-eabi\nmake\nsudo make install<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>如果要拆卸，<code>cd</code>进入编译后的各个目录，执行<code>sudo make uninstall</code>即可。</p>\n<p>crossdev 安装 arm-none-eabi 工具链步骤如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 首先安装crossdev\n\n# 编辑&#x2F;etc&#x2F;portage&#x2F;make.conf，写入\nPORTDIR_OVERLAY&#x3D;&quot;$&#123;PORTDIR_OVERLAY&#125; &#x2F;usr&#x2F;local&#x2F;portage&quot;\n\n# 编译安装工具链\nsudo crossdev -s4 -t arm-none-eabi\n# 如果软件编译失败，查看原因为masked by: corruption，则\n# 编辑&#x2F;var&#x2F;db&#x2F;repos&#x2F;localrepo-crossdev&#x2F;metadata&#x2F;layout.conf，写入\nmasters &#x3D; gentoo\nthin-manifests &#x3D; true\n# 编辑&#x2F;etc&#x2F;portage&#x2F;repos.conf&#x2F;crossdev.conf，写入\n[crossdev]\nlocation &#x3D; &#x2F;var&#x2F;db&#x2F;repos&#x2F;localrepo-crossdev\npriority &#x3D; 10\nmasters &#x3D; gentoo\nauto-sync &#x3D; no\n\n# 编译时需要使用gcc作为编译器，编译newlib时，需要把&#x2F;etc&#x2F;portage&#x2F;make.conf中\n# COMMON_FLAGS&#x3D;&quot;-march&#x3D;native -O2 -pipe&quot;注释掉<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"stlink\"><a href=\"#stlink\" class=\"headerlink\" title=\"stlink\"></a>stlink</h3><p>stlink 是仿真器的驱动，在连接中可能需要。</p>\n<h3 id=\"gdbgui（可选）\"><a href=\"#gdbgui（可选）\" class=\"headerlink\" title=\"gdbgui（可选）\"></a>gdbgui（可选）</h3><p>gdb gui 程序，便于调试。</p>\n<h2 id=\"blink\"><a href=\"#blink\" class=\"headerlink\" title=\"blink\"></a>blink</h2><p>新建项目<code>cargo new rusty-blink</code>。</p>\n<p><code>Cargo.toml</code>如下</p>\n<pre class=\"line-numbers language-toml\" data-language=\"toml\"><code class=\"language-toml\"><span class=\"token punctuation\">[</span><span class=\"token table class-name\">package</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">name</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"rusty-blink\"</span>\n<span class=\"token key property\">version</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"0.1.0\"</span>\n<span class=\"token key property\">authors</span> <span class=\"token punctuation\">=</span>\n<span class=\"token key property\">edition</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"2018\"</span>\n\n<span class=\"token comment\"># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">profile.release</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">opt-level</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">'z'</span> <span class=\"token comment\"># turn on maximum optimizations. We only have 64kB</span>\n<span class=\"token key property\">lto</span> <span class=\"token punctuation\">=</span> <span class=\"token boolean\">true</span>      <span class=\"token comment\"># Link-time-optimizations for further size reduction</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">dependencies</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">cortex-m</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"^0.6.3\"</span>      <span class=\"token comment\"># Access to the generic ARM peripherals</span>\n<span class=\"token key property\">cortex-m-rt</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"^0.6.12\"</span>  <span class=\"token comment\"># Startup code for the ARM Core</span>\n<span class=\"token key property\">embedded-hal</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"^0.2.4\"</span>  <span class=\"token comment\"># Access to generic embedded functions (`set_high`)</span>\n<span class=\"token key property\">panic-halt</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"^0.2.0\"</span>    <span class=\"token comment\"># Panic handler</span>\n\n<span class=\"token comment\"># Access to the stm32f103 HAL.</span>\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">dependencies.stm32f1xx-hal</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># Bluepill contains a 64kB flash variant which is called \"medium density\"</span>\n<span class=\"token key property\">features</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"stm32f103\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"medium\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">version</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"^0.6.1\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>在项目根目录下新建项目配置<code>mkdir .cargo</code>。其中由于使用 lld 进行链接后会丢失调试信息，因此将 linker 指定为 gcc。runner 是执行<code>cargo run</code>之后自动执行的命令，此处为自动开启 gdb 并加载文件。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># .cargo&#x2F;config\n[build]\ntarget &#x3D; &quot;thumbv7m-none-eabi&quot;\n\n[target.&#39;cfg(all(target_arch &#x3D; &quot;arm&quot;, target_os &#x3D; &quot;none&quot;))&#39;]\nrunner &#x3D; &#39;gdbgui -g arm-none-eabi-gdb&#39;\n\n[target.thumbv7m-none-eabi]\nrustflags &#x3D; [\n\t&quot;-C&quot;, &quot;linker&#x3D;arm-none-eabi-gcc&quot;,\n\t&quot;-C&quot;, &quot;link-arg&#x3D;-Wl,-Tlink.x&quot;,\n\t&quot;-C&quot;, &quot;link-arg&#x3D;-nostartfiles&quot;,\n]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"程序\"><a href=\"#程序\" class=\"headerlink\" title=\"程序\"></a>程序</h3><p>在项目根目录下新建<code>memory.x</code>。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;* memory.x - Linker script for the STM32F103C8T6 *&#x2F;\nMEMORY\n&#123;\n  &#x2F;* Flash memory begins at 0x80000000 and has a size of 64kB*&#x2F;\n  FLASH : ORIGIN &#x3D; 0x08000000, LENGTH &#x3D; 64K\n  &#x2F;* RAM begins at 0x20000000 and has a size of 20kB*&#x2F;\n  RAM : ORIGIN &#x3D; 0x20000000, LENGTH &#x3D; 20K\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>一般网上售卖的该款芯片应当是 64K 和 20K，如果有偏差需要按实际情况填写。</p>\n<p>在 src 下新建<code>main.rs</code>。该程序仅用于测试，效果为绿灯闪烁。</p>\n<pre class=\"line-numbers language-rust\" data-language=\"rust\"><code class=\"language-rust\"><span class=\"token comment\">// src/main.rs</span>\n\n<span class=\"token attribute attr-name\">#![no_std]</span>\n<span class=\"token attribute attr-name\">#![no_main]</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token namespace\">cortex_m_rt<span class=\"token punctuation\">::</span></span>entry<span class=\"token punctuation\">;</span> <span class=\"token comment\">// The runtime</span>\n<span class=\"token keyword\">use</span> <span class=\"token namespace\">embedded_hal<span class=\"token punctuation\">::</span>digital<span class=\"token punctuation\">::</span>v2<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">OutputPin</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// the `set_high/low`function</span>\n<span class=\"token keyword\">use</span> <span class=\"token namespace\">stm32f1xx_hal<span class=\"token punctuation\">::</span></span><span class=\"token punctuation\">&#123;</span><span class=\"token namespace\">delay<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Delay</span><span class=\"token punctuation\">,</span> pac<span class=\"token punctuation\">,</span> <span class=\"token namespace\">prelude<span class=\"token punctuation\">::</span></span><span class=\"token operator\">*</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// STM32F1 specific functions</span>\n<span class=\"token attribute attr-name\">#[allow(unused_imports)]</span>\n<span class=\"token keyword\">use</span> panic_halt<span class=\"token punctuation\">;</span> <span class=\"token comment\">// When a panic occurs, stop the microcontroller</span>\n<span class=\"token attribute attr-name\">#[entry]</span>\n<span class=\"token keyword\">fn</span> <span class=\"token function-definition function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">-></span> <span class=\"token operator\">!</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">let</span> dp <span class=\"token operator\">=</span> <span class=\"token namespace\">pac<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Peripherals</span><span class=\"token punctuation\">::</span><span class=\"token function\">take</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">unwrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> cp <span class=\"token operator\">=</span> <span class=\"token namespace\">cortex_m<span class=\"token punctuation\">::</span></span><span class=\"token class-name\">Peripherals</span><span class=\"token punctuation\">::</span><span class=\"token function\">take</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">unwrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> rcc <span class=\"token operator\">=</span> dp<span class=\"token punctuation\">.</span><span class=\"token constant\">RCC</span><span class=\"token punctuation\">.</span><span class=\"token function\">constrain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> gpioc <span class=\"token operator\">=</span> dp<span class=\"token punctuation\">.</span><span class=\"token constant\">GPIOC</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> rcc<span class=\"token punctuation\">.</span>apb2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> led <span class=\"token operator\">=</span> gpioc<span class=\"token punctuation\">.</span>pc13<span class=\"token punctuation\">.</span><span class=\"token function\">into_push_pull_output</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> gpioc<span class=\"token punctuation\">.</span>crh<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> flash <span class=\"token operator\">=</span> dp<span class=\"token punctuation\">.</span><span class=\"token constant\">FLASH</span><span class=\"token punctuation\">.</span><span class=\"token function\">constrain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> clocks <span class=\"token operator\">=</span> rcc<span class=\"token punctuation\">.</span>cfgr<span class=\"token punctuation\">.</span><span class=\"token function\">sysclk</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">.</span><span class=\"token function\">mhz</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">freeze</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token keyword\">mut</span> flash<span class=\"token punctuation\">.</span>acr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> <span class=\"token keyword\">mut</span> delay <span class=\"token operator\">=</span> <span class=\"token class-name\">Delay</span><span class=\"token punctuation\">::</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span>cp<span class=\"token punctuation\">.</span><span class=\"token constant\">SYST</span><span class=\"token punctuation\">,</span> clocks<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">loop</span> <span class=\"token punctuation\">&#123;</span>\n        led<span class=\"token punctuation\">.</span><span class=\"token function\">set_high</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        delay<span class=\"token punctuation\">.</span><span class=\"token function\">delay_ms</span><span class=\"token punctuation\">(</span><span class=\"token number\">1_000_u16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        led<span class=\"token punctuation\">.</span><span class=\"token function\">set_low</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        delay<span class=\"token punctuation\">.</span><span class=\"token function\">delay_ms</span><span class=\"token punctuation\">(</span><span class=\"token number\">1_000_u16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"烧录与调试\"><a href=\"#烧录与调试\" class=\"headerlink\" title=\"烧录与调试\"></a>烧录与调试</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\"># 连接仿真器\nopenocd -f interface&#x2F;stlink-v2.cfg -f target&#x2F;stm32f1x.cfg\n# 如果仿真器选用jlink，则命令为openocd -f interface&#x2F;jlink.cfg -f target&#x2F;stm32f1x.cfg\n# 出现以下信息为连接成功\nInfo : stm32f1x.cpu: hardware has 6 breakpoints, 4 watchpoints\n\n# 编译并开启gdb\ncargo run\n\n# 在gdb窗口执行以下命令\ntarget remote :3333\nmoniter reset halt\nload\ncontinue<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>此时如果程序持续执行，应当可以在板子上看到绿灯闪烁。如果停在断点处，就再 continue。</p>\n<p>更进一步可以直接在 gdb 开启时自动执行以上命令。</p>\n<p>将<code>runner</code>改为<code>runner = &#39;arm-none-eabi-gdb -q -x debug.gdb&#39;</code>。在项目根目录下新建<code>debug.gdb</code>，写入以下内容。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">target remote :3333\n\nset backtrace limit 32\n\nmonitor reset halt\n\nload<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n"},{"title":"Gentoo Basic System Installation","date":"2020-08-07T07:36:38.000Z","_content":"\n[Gentoo 教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 基本系统安装\n\n本文介绍 gentoo 基本系统的一般安装流程。图形界面的安装配置将在后面的文章中介绍。\n\n## 刻录 gentoo 安装镜像\n\n访问[清华大学开源软件镜像站](https://mirrors.tuna.tsinghua.edu.cn/)。选择合适的架构，下载 gentoo 安装镜像。\n\n![安装镜像列表](1.png)\n\n虚拟机不需要刻录。u 盘的刻录步骤很简单，不再赘述。\n\n## 开启网络与 ssh\n\n- 有线网卡与虚拟机\n\n直接`dhcpcd`即可\n\n- wifi\n\n```\n# 查看无限网卡名称及状态\nip a\n\n# 若无限网卡未打开，则开启\nip link set interface_name up\n\n# 查看可用的wifi\n# 建议直接从其他设备上查看wifi名称，不必从本地扫描搜索\n\n# 生成wifi配置\nwpa_passphrase 网络 密码 > 文件\n\n# 连接wifi\nwpa_supplicant -c 文件 -i 接口 &\n\n# 自动分配ip地址\ndhcpcd &\n```\n\n- 开启 ssh\n\n```\n# 开启ssh\n/etc/init.d/sshd start\n# 设置livecd密码\npasswd\n# 注意远程连接时用户名不是livecd，而是root\n```\n\n## 磁盘分区\n\n详见\n\n[gentoo wiki](https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Disks/zh-cn)\n[gentoo handbook](https://wiki.gentoo.org/wiki/Handbook:X86/Blocks/Disks/zh-cn)\n\n由于此处分配分区将牵扯到后面 fstab 的配置，如果你对此完全不了解，建议按最常规的方式划分。如果你有一台现成的 linux，可以仿照其分区，可以帮助后面配置 fstab。\n\n另外参考你的电脑配置。内存与交换空间之和（单位 G）最好大于 CPU 总线程数。\n\n以下是 GPT 格式分区，引导方式为 EFI。\n\n```\nfdisk -l\n# 注意以下磁盘名nvme0n1，对于不同规格的硬盘不同\nfdisk /dev/nvme0n1\ng\n# 分区，具体操作略\nw\n# 注意以下分区格式将关系到部分软件，尤其是grub的安装配置。因此必须慎重选择。\n# 制作引导分区\nmkfs.fat -F32 /dev/nvme0n1p1\n# 制作主分区\nmkfs.ext4 /dev/nvme0n1p2\n# 制作交换分区\nmkswap /dev/nvme0n1p3\n# 启用交换\nswapon /dev/nvme0n1p3\n```\n\n分区完毕后将主分区挂在到 livecd 提供的挂载点上。\n\n```\nmount /dev/nvme0n1p2 /mnt/gentoo\n```\n\n## 获取基础编译环境\n\n上述步骤已经为 gentoo 系统开辟了空间，下面将正式进入系统的编译安装阶段。\n\n由于 gentoo livecd 并不携带完整的编译环境，因此我们需要先往系统空间中放一个现成的编译环境，即 gentoo 基础编译环境。\n\n再次访问[清华镜像站](https://mirrors.tuna.tsinghua.edu.cn/)。\n\nGentoo 的 stage3 包囊括了整套编译环境以及绝大多数 gentoo 基础工具。\n\n![stage3](2.png)\n\nGentoo stage3 包的类型包括但不限于以上几种。根据你所需要的桌面环境，查看其对应的 gentoo wiki，做出选择。其中无 systemd 表示使用 OpenRC。nomultilib 表示仅支持 64 位，一般不建议选择。\n\n本教程以 systemd kde 为例，因此选择下载以下几个包至`/mnt/gentoo`。\n\n![systemd stage3](3.png)\n\n下载完毕后使用`sha512sum -c stage3-amd64-*.tar.xz.DIGESTS`校验文件，出现两个 ok 和两个 failed 为正常。并继续使用`tar xpvf stage3-*.tar.xz --xattrs-include='*.*' --numeric-owner`解压文件。\n\n## 设置编译选项\n\n配置`/mnt/gentoo/etc/portage/make.conf`。\n\n这是整个安装过程中最核心、最重要的一步。详情参考[Gentoo wiki](https://wiki.gentoo.org/wiki//etc/portage/make.conf)以及[gentoo doc](https://dev.gentoo.org/~zmedico/portage/doc/man/make.conf.5.html)。\n\n此处不再对大部分配置进行说明，仅给出笔者第一次安装 gentoo 时的配置（虽不完美，但在当时不存在错误）。只可参考，不可照抄。\n\n```\nCOMMON_FLAGS=\"-march=native -O2 -pipe\"\n\nCFLAGS=\"${COMMON_FLAGS}\"\nCXXFLAGS=\"${COMMON_FLAGS}\"\nFCFLAGS=\"${COMMON_FLAGS}\"\nFFLAGS=\"${COMMON_FLAGS}\"\n\nCHOST=\"x86_64-pc-linux-gnu\"\n\nCONFIG_PROTECT=\"/var/bind\"\n\nPORTDIR=\"/var/db/repos/gentoo\"\nDISTDIR=\"/var/cache/distfiles\"\nPKGDIR=\"/var/cache/binpkgs\"\n\nLC_MESSAGES=C\n\nMAKEOPTS=\"-j9\"\n\nGENTOO_MIRRORS=\"https://mirrors.tuna.tsinghua.edu.cn/gentoo\"\n\nPORTAGE_TMPDIR=\"/var/tmp\"\n\nDISTDIR=/var/gentoo/distfiles\n\nACCEPT_LICENSE=\"*\"\n\nVIDEO_CARDS=\"radeon\"\n\nL10N=\"en_US en zh zh_CN\"\n\nLINGUAS=\"en-US zh-CN en zh\"\n\nAUTO_CLEAN=\"yes\"\n\nGRUB_PLATFORMS=\"efi-64\"\n\nEMERGE_DEFAULT_OPTS=\"--with-bdeps=y --ask --verbose=y --load-average --keep-going\"\n\nINPUT_DEVICES=\"libinput synaptics evdev\"\n\nUSE=\"X alsa clang udev dbus polkit udisks vulkan vdpau vaapi glamor nls\"\n\nKEYWORDS=\"amd64\"\n```\n\n下面对其中的几个选项做简略介绍。\n\n`GENTOO_MIRRORS`：建议选清华源。虽然清华源的速度中规中矩，时不时还出点问题。但 gentoo 在中国境内的源很少，应该也只有清华源在及时更新。\n\n`EMERGE_DEFAULT_OPTS`：建议添加，可大大减小 emerge 指令长度。\n\n`INPUT_DEVICES`：绝不可缺。否则会引起键盘、觸控板、鼠标失效等等问题。\n\n`KEYWORDS`：不要在这里开启测试分支。\n\n`MAKEOPTS`：建议等于 CPU 线程数+1。这样计算机在编译软件时尚有余力编译另外的软件或者进行其他操作。\n\n## 进一步配置\n\n```\nmkdir --parents /mnt/gentoo/etc/portage/repos.conf\ncp /mnt/gentoo/usr/share/portage/config/repos.conf /mnt/gentoo/etc/portage/repos.conf/gentoo.conf\ncp --dereference /etc/resolv.conf /mnt/gentoo/etc/\n```\n\n修改`/mnt/gentoo/etc/portage/repos.conf/gentoo.conf`配置 portage 镜像源\n\n```\nsync-uri = rsync://mirrors.tuna.tsinghua.edu.cn/gentoo-portage\n```\n\n## 进入新系统\n\n- 挂载剩余文件系统\n\n```\nmount --types proc /proc /mnt/gentoo/proc\nmount --rbind /sys /mnt/gentoo/sys\nmount --make-rslave /mnt/gentoo/sys\nmount --rbind /dev /mnt/gentoo/dev\nmount --make-rslave /mnt/gentoo/dev\n```\n\n- chroot 登陆新系统\n\n```\nchroot /mnt/gentoo /bin/bash\nsource /etc/profile\nexport PS1=\"(chroot) ${PS1}\"\n```\n\n- 挂载 boot 分区\n\n```\nmount /dev/nvme0n1p1 /boot\n```\n\n## 配置 Portage\n\n- 下载数据库快照\n\n```\nemerge-webrsync\n```\n\n- 选择 profile\n\nprofile 简单的说就是一系列 USE flag 等配置的集合。这将是新系统的主体配置。\n\n```\n# 先列出可用的profile，带星号是目前选择的\neselect profile list\n# 选择你需要的profile（可以从gentoo wiki获得信息）。这里选择kde桌面对应的profile\neselect profile set default/linux/amd64/17.1/desktop/plasma/systemd\n```\n\n17.0 与 17.1 版本差距并不是非常大，如果不想深究，可以随意选择。\n\n## 系统工具优化\n\n所谓工欲善其事，必先利其器。因此在正式编译系统之前，先进行部分工具的完善。\n\n### 编辑器\n\n如果你不喜欢 stage3 中解压出来的 nano，可以优先安装一款自己喜欢的编辑器。\n\n### git\n\n使用 git 同步 portage。\n\n优点：大大提高同步速度。\n\n缺点：略占用更多空间。\n\n安装 git，不赘述。\n\n修改当前系统的`/etc/portage/repos.conf/gentoo.conf`\n\n```\n[gentoo]\nsync-type = git\nsync-uri = https://github.com/gentoo-mirror/gentoo\n```\n\n```\n# 移除之前同步的portage\nrm -rf /mnt/gentoo/var/db/repos/gentoo`\n# 同步portage\n`emerge --sync`\n```\n\n### gentoolkit\n\n安装 gentoolkit，不赘述。\n\n- 常用指令\n\n```\n# 查看已经enable的USE flag\neuse -a -g或者euse -a -l\n# 激活USE flag\neuse -E flagname\n# 关闭USE flag\neuse -D flagname\n# 注意不可单独使用euse -D或者euse -E。这将作用到所有的USE flag。\n# 查看指定包的use标志\nequery --nocolor uses =gnumeric-1.12.31\n# 清理源代码\neclean-dist\n# 清理二进制包\neclean-pkg\n```\n\n- eclean 说明\n\n默认情况下当前存储库中的任何 ebuild 相对应的源文件和二进制包都不会被删除。\n\n可以通过同时使用 `--deep` 和 `--package-names` 选项指定删除当前存储库中 ebuild 对应的源文件和二进制包。\n\n### 安装 layman\n\nlayman 是一个优秀的 gentoo overlay 管理工具。eix-sync 指令中也集成了`layman -S`指令。\n\n详情见[gentoo wiki](https://wiki.gentoo.org/wiki/Layman)。\n\n- layman 安装\n\n建议开启的 USE flag 有 git、sync-plugin-portage。\n\n```\nemerge --ask app-portage/layman\nmkdir /etc/portage/repos.conf\nlayman-updater -R\n```\n\n- 相关指令\n\n```\nlayman -L # 显示存储库列表\nlayman -a <name> # 从本地列表添加存储库\nlayman -o <url of repository xml file> -f -a <name> # 添加非官方存储库\nlayman -d <name> # 删除存储库\nlayman -s <name> # 更新存储库\nlayman -S # 更新所有存储库\n```\n\n### 安装 eix\n\n详情见[gentoo wiki](https://wiki.gentoo.org/wiki/Eix)。\n\neix 在教程的前面的内容中已经提及并作简要介绍。\n\n- eix 安装\n\n```\nemerge app-portage/eix\neix-update\neix-sync\n```\n\n使用`eix-sync`代替`emerge --sync`，可以在同步数据库后自动更新 eix 的缓存。\n\n修改`/etc/eix-sync.conf`，写入`*`，以同步 ebuild 存储库。\n\n- 相关指令\n\n```\n# 搜索包\neix name\n# 搜索本地包\neix -I name\n# 在软件包描述文件中搜索，-c用于输出紧凑的结果\neix -S -c name\n# 在包类别中搜索\neix -C name\n# 搜索许可证\neix -Cc games-rpg -L \"EULA\"\n# 排除结果\neix --not -L \"EULA\"\n# 搜索过时的包\neix-test-obsolete\n```\n\n### 安装 ccache\n\nccache 原理是缓存编译时的中间结果，当重新编译时就可以大大减少编译时间。其应用场景主要为编译失败后修改配置，然后再次编译。此时之前编译的有效内容可以直接被利用，这部分将以极快的速度完成编译。但是第一次运行 ccache 时，会拖慢编译速度。\n\n- ccache 安装\n\n```\nemerge --ask ccache\nmkdir -p /var/cache/ccache\nchown root:portage /var/cache/ccache/\nchmod 2775 /var/cache/ccache/\n```\n\n修改`/etc/portage/make.conf`。\n\n```\nFEATURES=\"ccache\"\nCCACHE_DIR=\"/var/cache/ccache\"\nCCACHE_SIZE=\"16G\"\n```\n\n### 开启 32 位库支持\n\nGentoo 官方并不建议使用纯 64 位模式。其最现实的原因是几乎无法改回兼容 32 位的模式。因此对于新手而言，强烈建议选择兼容 32 位的模式。\n\n然而之前下载 stage3 包虽不是 nomultilib，但并不完全适配 32 位编译环境，需要手动修复。\n\n```\nemerge --ask --verbose db\n\n# 编辑/etc/portage/package.use/abi_x86_32，写入\n\nsys-libs/zlib abi_x86_32\n\n# 编辑/etc/portage/make.conf，写入\n\nABI_X86=\"32 64\"\n\nemerge --ask --verbose zlib\n```\n\n### 局域网编译与打包分发\n\nGentoo 可以联合局域网下的多台主机一起编译，也可以将本地编译好的包打包分发。\n\n考虑到一般个人用户不太会用到这些功能，此处不赘述。详情见[gentoo handbook](https://wiki.gentoo.org/wiki/Handbook:Parts/Full/Working/zh-cn#.E5.B0.86.E9.A2.84.E6.9E.84.E5.BB.BA.E7.9A.84.E8.BD.AF.E4.BB.B6.E5.8C.85.E5.88.86.E5.8F.91.E7.BB.99.E4.BB.96.E4.BA.BA)，[gentoo doc](https://docs.huihoo.com/gentoo/resources/document-listing/distcc.html)以及[gentoo wiki](https://wiki.gentoo.org/wiki/Distcc/zh-cn)。\n\n## 配置时间和区域\n\n时间与区域可以在之后配置，此处提前配置主要是为了方便某些 GFW 偷渡者。PS：这种东西很重要，甚至直接关系到能否成功安装，但得你自己想办法。\n\n- 时区\n\n```\n\necho Asia/Shanghai > /etc/timezone emerge --config sys-libs/timezone-data\n```\n\n- 区域\n\n```\n\n# 生成中英文 locale.gen\n\necho 'zh_CN.UTF-8 UTF-8' >> /etc/locale.gen\necho 'en_US.UTF-8 UTF-8' >> /etc/locale.gen\nlocale-gen\n\n# 列出可用的区域\n\neselect locale list\n\n# 选择英文区域的编号\n\neselect locale set 3\n\n# 重新加载环境变量\n\nenv-update && source /etc/profile && export PS1=\"(chroot) \\${PS1}\"\n\n```\n\n注意上述操作可能导致系统时间发生错误，可以手动纠正。但这可能导致/usr/bin/git 时间错误，致于无法安装 systemd。重装 git 可解决上述问题。\n\n- 时间修正\n\n```\n# 查看时间是否正确\n\nhwclock\ndate\ndate -s 2020/03/09\ndate -s 11:50:30\nhwclock -w\n\n# 自动更新，但此时暂不可用\n\ntimedatectl set-ntp true\n```\n\n## 重新编译 gcc\n\n为获取最适配本机的编译器，必须先配置并重新编译 gcc。即使你选择 clang 作为主编译器，也应当重新编译 gcc 的稳定分支。\n\n警告：此处配置编译需要万分小心。一旦出现不当，损坏编译器，就会很麻烦。如果真的遇到这种情况，也无需慌张。通过直接安装已编译完成的正常的 gcc 二进制包救场即可。\n\n- USE flag\n\n根据需求配置，以下仅为参考。\n\n```\nfortran nls nptl openmp pch sanitize ssp lto\n```\n\n- 编译 gcc\n\n```\n# 更新Portage\neix-sync\n# 编译安装gcc\nemerge --ask gcc\n# 如果编译了新版本的gcc，继续进行下列操作。\n# 查看可用gcc版本\ngcc-config --list-profiles\n# 选择新编译出来的gcc\ngcc-config 2\nsource /etc/profile\nexport PS1=\"(chroot) ${PS1}\"\nemerge --ask --oneshot --usepkg=n sys-devel/libtool\n# 检查当前gcc版本\ngcc -v\n# 如果需要拆卸旧版本\nemerge --ask --depclean =sys-devel/gcc-9.3.0\n# 验证系统完整性\nrevdep-rebuild\n# 重新编译部分包\nemerge --ask --oneshot --usepkg=n --verbose sys-devel/llvm sys-devel/clang\n# 如果有问题可以重新构建系统\nemerge --ask --emptytree --usepkg=n @system\n```\n\n## 安装 clang\n\n笔者使用 clang 作为主编译器。即使你使用 gcc 作为主编译器，也可以选择安装 clang 解决部分编译错误问题（这在[Gentoo Compile Error Handling](https://www.niuiic.top/2020/08/06/gentoo-compile-error-handling/)一文中已作介绍）。\n\n重新编译整个系统。如果你不使用 clang 作为主编译器或者觉得没有必要，可以跳过此步。\n\n```\nemerge --ask --emptytree --usepkg=n @system\n```\n\n## 更新配置\n\n```\n# 将数据库更新到最近一小时\neix-sync\nemerge --oneshot sys-apps/portage\n```\n\n至此，所有准备工作都已进行完毕。\n\n## 更新@world\n\n编译安装所有在配置中需要的软件。但在此之前，需要先安装内核源代码提供内核版本信息。\n\n```\nemerge sys-kernel/gentoo-sources\nemerge --deep --with-bdeps=y --changed-use --update --ask --verbose --keep-going @world\n```\n\n## 配置 fstab\n\nfstab 简单的说就是系统启动时挂载文件系统的配置文件。\n\n由 fstab 引起的常见错误有文件系统挂载为只读模式，无法写入任何文件等。\n\n这里不介绍 fstab 的具体配置方法。有需要的参考[gentoo wiki](https://wiki.gentoo.org/wiki/Fstab)。\n\n前面提到，如果有现成的 linux 系统，完全可以仿照其分区方式。主要就是为了 copy 现成的`/etc/fstab`。\n\n比如获得的文件如下\n\n```\nUUID=e5bc0d97-ac5c-400c-b26e-137cefe6ae68       /               ext4            rw,relatime     0 1\n\nUUID=B320-B5C7          /boot           vfat            rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,utf8,errors=remount-ro       0 2\n\nUUID=c4b396e5-cb87-42dc-b44e-4b26661e5cc0       none            swap            defaults        0 0\n```\n\n使用`blkid`获取文件系统的 UUID，替换文件中的 UUID 即可。\n\n## 内核编译\n\nGentoo 内核复杂点主要在于各选项的配置。此处不会介绍相关具体内容，只是提供一种投机取巧的方法。\n\n具体的内核选项配置，参考[gentoo wiki](https://wiki.gentoo.org/wiki/Kernel/Gentoo_Kernel_Configuration_Guide)。\n\n### 自动编译内核\n\n自动编译内核会开启大部分选项。不过如果不是对性能与简洁有极致的要求，着实是可以接受的。\n\n- 安装内核编译工具\n\n```\nemerge sys-kernel/genkernel\n```\n\n- 选择内核版本\n\n```\n# 查看源代码列表\neselect kernel list\n# 选择\neselect kernel set number\n```\n\n- 自动编译内核\n\n```\ngenkernel all\n```\n\n### 手动编译内核\n\n- 安装内核配置工具\n\n```\nemerge --ask sys-apps/pciutils\n```\n\n- 查看功能\n\n通过`lsmod`命令来查看当前所处的 Gentoo Live 镜像开启的功能，这可以作为我们在配置内核时的重要参考。\n\n- 配置\n\n```\n# 进入源码菜单\ncd /usr/src/linux\n# 打开配置工具\nmake menuconfig\n```\n\n按需求配置即可。\n\n把上面所有必选项都配置好之后，选择 save 保存配置文件，然后 exit 退出。默认配置文件名是.config，但是最好手动复制一个备份，有时候默认名称的配置文件会莫名丢失，只能重头再配置一次。然后就可以开始编译和安装。\n\n- 编译安装内核\n\n```\nmake\nmake modules_install\nmake install\n```\n\n- 投机取巧的方法\n\n先自动编译内核，等到输出信息显示配置完毕后打断进程，进入源码菜单，修改配置文件即可。这至少将提供一份正确的配置方案，在此基础上修改将节省大量时间。\n\n## 安装 firmware 和 initrampfs\n\n```\nemerge --ask sys-kernel/linux-firmware\n# 如果是自动安装内核，则不需要下一步\ngenkernel --install initramfs\n```\n\n## 配置系统\n\n此处的系统配置基于 Systemd，如果你使用的是 OpenRC，部分配置将不适用。\n\n### 网络配置\n\n- 修改`/etc/hostname`\n\n设置主机名\n\n```\nyourname\n```\n\n- 修改`/etc/hosts`\n\n```\n# 定义的是现在系统，假设主机名为tux\n127.0.0.1     localhost\n::1 \t\t  localhost\n127.0.1.1 \t  name.localdomain name\n```\n\n- 网络工具的安装\n\n如果你想在安装完毕基础系统后不再使用 livecd，就需要先安装基础网络工具。之后等桌面环境安装完毕后，最终将采用 NetworkManager 作为 wifi 配置连接工具。\n\n```\nemerge net-wireless/wpa_supplicant dhcpcd\n```\n\n### 设置密码\n\n```\npasswd\n```\n\n需要 8 字符及以上。\n\n也可以修改`/etc/pam.d/system-auth`，将`min=8,8,8,8,8 retry=3`中所有的 8 改为 1。\n\n### 部分系统工具的安装\n\n- 日志工具\n\n```\nemerge --ask app-admin/syslog-ng\nsystemctl enable syslog-ng@default\n```\n\n- 远程登录\n\n```\nsystemctl enable sshd\n```\n\n- 文件系统工具\n\n```\nemerge --ask sys-fs/dosfstools sys-fs/e2fsprogs\n```\n\n### 添加用户\n\n```\nuseradd -m -G users,wheel,audio -s /bin/bash username\npasswd username # 需要三个单词，总长度大于8个字符\n```\n\n### 磁盘清理\n\n```\nrm /stage3-*.tar.*\n```\n\n## 安装系统引导器\n\n- 安装 grub\n\n```\nemerge --ask --verbose sys-boot/grub:2\n```\n\n- 将 grub 安装到系统中\n\n注意如果你不是 efi 引导，需要修改下列命令。\n\n```\ngrub-install --target=x86_64-efi --efi-directory=/boot\ngrub-mkconfig -o /boot/grub/grub.cfg\n```\n\n### 安装配置 sudo\n\n```\nemerge --ask sudo\nnvim /etc/sudoers\n# 在root ALL=(ALL) ALL下添加新的用户\n```\n\n### 配置 sshd\n\n修改`/etc/ssh/sshd_config`，做以下修改。\n\n```\nPort 22\nPermitRootLogin yes\nPasswordAuthentication yes\n```\n\n### 开启 SysRq\n\n修改`/etc/sysctl.conf`。\n\n```\nkernel.sysrq = 1\n```\n\n至此，Gentoo 基础系统已经安装完毕。退出 chroot，重启检查是否有误。\n\n下一篇：[Gentoo Kool Desktop Environment Installation](https://www.niuiic.top/2020/08/08/gentoo-kool-desktop-environment-installation/)\n","source":"_posts/gentoo-basic-system-installation.md","raw":"---\ntitle: Gentoo Basic System Installation\ndate: 2020-08-07 15:36:38\ntags:\n\t\t- Gentoo\ncategories:\n\t\t- Gentoo\n---\n\n[Gentoo 教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 基本系统安装\n\n本文介绍 gentoo 基本系统的一般安装流程。图形界面的安装配置将在后面的文章中介绍。\n\n## 刻录 gentoo 安装镜像\n\n访问[清华大学开源软件镜像站](https://mirrors.tuna.tsinghua.edu.cn/)。选择合适的架构，下载 gentoo 安装镜像。\n\n![安装镜像列表](1.png)\n\n虚拟机不需要刻录。u 盘的刻录步骤很简单，不再赘述。\n\n## 开启网络与 ssh\n\n- 有线网卡与虚拟机\n\n直接`dhcpcd`即可\n\n- wifi\n\n```\n# 查看无限网卡名称及状态\nip a\n\n# 若无限网卡未打开，则开启\nip link set interface_name up\n\n# 查看可用的wifi\n# 建议直接从其他设备上查看wifi名称，不必从本地扫描搜索\n\n# 生成wifi配置\nwpa_passphrase 网络 密码 > 文件\n\n# 连接wifi\nwpa_supplicant -c 文件 -i 接口 &\n\n# 自动分配ip地址\ndhcpcd &\n```\n\n- 开启 ssh\n\n```\n# 开启ssh\n/etc/init.d/sshd start\n# 设置livecd密码\npasswd\n# 注意远程连接时用户名不是livecd，而是root\n```\n\n## 磁盘分区\n\n详见\n\n[gentoo wiki](https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Disks/zh-cn)\n[gentoo handbook](https://wiki.gentoo.org/wiki/Handbook:X86/Blocks/Disks/zh-cn)\n\n由于此处分配分区将牵扯到后面 fstab 的配置，如果你对此完全不了解，建议按最常规的方式划分。如果你有一台现成的 linux，可以仿照其分区，可以帮助后面配置 fstab。\n\n另外参考你的电脑配置。内存与交换空间之和（单位 G）最好大于 CPU 总线程数。\n\n以下是 GPT 格式分区，引导方式为 EFI。\n\n```\nfdisk -l\n# 注意以下磁盘名nvme0n1，对于不同规格的硬盘不同\nfdisk /dev/nvme0n1\ng\n# 分区，具体操作略\nw\n# 注意以下分区格式将关系到部分软件，尤其是grub的安装配置。因此必须慎重选择。\n# 制作引导分区\nmkfs.fat -F32 /dev/nvme0n1p1\n# 制作主分区\nmkfs.ext4 /dev/nvme0n1p2\n# 制作交换分区\nmkswap /dev/nvme0n1p3\n# 启用交换\nswapon /dev/nvme0n1p3\n```\n\n分区完毕后将主分区挂在到 livecd 提供的挂载点上。\n\n```\nmount /dev/nvme0n1p2 /mnt/gentoo\n```\n\n## 获取基础编译环境\n\n上述步骤已经为 gentoo 系统开辟了空间，下面将正式进入系统的编译安装阶段。\n\n由于 gentoo livecd 并不携带完整的编译环境，因此我们需要先往系统空间中放一个现成的编译环境，即 gentoo 基础编译环境。\n\n再次访问[清华镜像站](https://mirrors.tuna.tsinghua.edu.cn/)。\n\nGentoo 的 stage3 包囊括了整套编译环境以及绝大多数 gentoo 基础工具。\n\n![stage3](2.png)\n\nGentoo stage3 包的类型包括但不限于以上几种。根据你所需要的桌面环境，查看其对应的 gentoo wiki，做出选择。其中无 systemd 表示使用 OpenRC。nomultilib 表示仅支持 64 位，一般不建议选择。\n\n本教程以 systemd kde 为例，因此选择下载以下几个包至`/mnt/gentoo`。\n\n![systemd stage3](3.png)\n\n下载完毕后使用`sha512sum -c stage3-amd64-*.tar.xz.DIGESTS`校验文件，出现两个 ok 和两个 failed 为正常。并继续使用`tar xpvf stage3-*.tar.xz --xattrs-include='*.*' --numeric-owner`解压文件。\n\n## 设置编译选项\n\n配置`/mnt/gentoo/etc/portage/make.conf`。\n\n这是整个安装过程中最核心、最重要的一步。详情参考[Gentoo wiki](https://wiki.gentoo.org/wiki//etc/portage/make.conf)以及[gentoo doc](https://dev.gentoo.org/~zmedico/portage/doc/man/make.conf.5.html)。\n\n此处不再对大部分配置进行说明，仅给出笔者第一次安装 gentoo 时的配置（虽不完美，但在当时不存在错误）。只可参考，不可照抄。\n\n```\nCOMMON_FLAGS=\"-march=native -O2 -pipe\"\n\nCFLAGS=\"${COMMON_FLAGS}\"\nCXXFLAGS=\"${COMMON_FLAGS}\"\nFCFLAGS=\"${COMMON_FLAGS}\"\nFFLAGS=\"${COMMON_FLAGS}\"\n\nCHOST=\"x86_64-pc-linux-gnu\"\n\nCONFIG_PROTECT=\"/var/bind\"\n\nPORTDIR=\"/var/db/repos/gentoo\"\nDISTDIR=\"/var/cache/distfiles\"\nPKGDIR=\"/var/cache/binpkgs\"\n\nLC_MESSAGES=C\n\nMAKEOPTS=\"-j9\"\n\nGENTOO_MIRRORS=\"https://mirrors.tuna.tsinghua.edu.cn/gentoo\"\n\nPORTAGE_TMPDIR=\"/var/tmp\"\n\nDISTDIR=/var/gentoo/distfiles\n\nACCEPT_LICENSE=\"*\"\n\nVIDEO_CARDS=\"radeon\"\n\nL10N=\"en_US en zh zh_CN\"\n\nLINGUAS=\"en-US zh-CN en zh\"\n\nAUTO_CLEAN=\"yes\"\n\nGRUB_PLATFORMS=\"efi-64\"\n\nEMERGE_DEFAULT_OPTS=\"--with-bdeps=y --ask --verbose=y --load-average --keep-going\"\n\nINPUT_DEVICES=\"libinput synaptics evdev\"\n\nUSE=\"X alsa clang udev dbus polkit udisks vulkan vdpau vaapi glamor nls\"\n\nKEYWORDS=\"amd64\"\n```\n\n下面对其中的几个选项做简略介绍。\n\n`GENTOO_MIRRORS`：建议选清华源。虽然清华源的速度中规中矩，时不时还出点问题。但 gentoo 在中国境内的源很少，应该也只有清华源在及时更新。\n\n`EMERGE_DEFAULT_OPTS`：建议添加，可大大减小 emerge 指令长度。\n\n`INPUT_DEVICES`：绝不可缺。否则会引起键盘、觸控板、鼠标失效等等问题。\n\n`KEYWORDS`：不要在这里开启测试分支。\n\n`MAKEOPTS`：建议等于 CPU 线程数+1。这样计算机在编译软件时尚有余力编译另外的软件或者进行其他操作。\n\n## 进一步配置\n\n```\nmkdir --parents /mnt/gentoo/etc/portage/repos.conf\ncp /mnt/gentoo/usr/share/portage/config/repos.conf /mnt/gentoo/etc/portage/repos.conf/gentoo.conf\ncp --dereference /etc/resolv.conf /mnt/gentoo/etc/\n```\n\n修改`/mnt/gentoo/etc/portage/repos.conf/gentoo.conf`配置 portage 镜像源\n\n```\nsync-uri = rsync://mirrors.tuna.tsinghua.edu.cn/gentoo-portage\n```\n\n## 进入新系统\n\n- 挂载剩余文件系统\n\n```\nmount --types proc /proc /mnt/gentoo/proc\nmount --rbind /sys /mnt/gentoo/sys\nmount --make-rslave /mnt/gentoo/sys\nmount --rbind /dev /mnt/gentoo/dev\nmount --make-rslave /mnt/gentoo/dev\n```\n\n- chroot 登陆新系统\n\n```\nchroot /mnt/gentoo /bin/bash\nsource /etc/profile\nexport PS1=\"(chroot) ${PS1}\"\n```\n\n- 挂载 boot 分区\n\n```\nmount /dev/nvme0n1p1 /boot\n```\n\n## 配置 Portage\n\n- 下载数据库快照\n\n```\nemerge-webrsync\n```\n\n- 选择 profile\n\nprofile 简单的说就是一系列 USE flag 等配置的集合。这将是新系统的主体配置。\n\n```\n# 先列出可用的profile，带星号是目前选择的\neselect profile list\n# 选择你需要的profile（可以从gentoo wiki获得信息）。这里选择kde桌面对应的profile\neselect profile set default/linux/amd64/17.1/desktop/plasma/systemd\n```\n\n17.0 与 17.1 版本差距并不是非常大，如果不想深究，可以随意选择。\n\n## 系统工具优化\n\n所谓工欲善其事，必先利其器。因此在正式编译系统之前，先进行部分工具的完善。\n\n### 编辑器\n\n如果你不喜欢 stage3 中解压出来的 nano，可以优先安装一款自己喜欢的编辑器。\n\n### git\n\n使用 git 同步 portage。\n\n优点：大大提高同步速度。\n\n缺点：略占用更多空间。\n\n安装 git，不赘述。\n\n修改当前系统的`/etc/portage/repos.conf/gentoo.conf`\n\n```\n[gentoo]\nsync-type = git\nsync-uri = https://github.com/gentoo-mirror/gentoo\n```\n\n```\n# 移除之前同步的portage\nrm -rf /mnt/gentoo/var/db/repos/gentoo`\n# 同步portage\n`emerge --sync`\n```\n\n### gentoolkit\n\n安装 gentoolkit，不赘述。\n\n- 常用指令\n\n```\n# 查看已经enable的USE flag\neuse -a -g或者euse -a -l\n# 激活USE flag\neuse -E flagname\n# 关闭USE flag\neuse -D flagname\n# 注意不可单独使用euse -D或者euse -E。这将作用到所有的USE flag。\n# 查看指定包的use标志\nequery --nocolor uses =gnumeric-1.12.31\n# 清理源代码\neclean-dist\n# 清理二进制包\neclean-pkg\n```\n\n- eclean 说明\n\n默认情况下当前存储库中的任何 ebuild 相对应的源文件和二进制包都不会被删除。\n\n可以通过同时使用 `--deep` 和 `--package-names` 选项指定删除当前存储库中 ebuild 对应的源文件和二进制包。\n\n### 安装 layman\n\nlayman 是一个优秀的 gentoo overlay 管理工具。eix-sync 指令中也集成了`layman -S`指令。\n\n详情见[gentoo wiki](https://wiki.gentoo.org/wiki/Layman)。\n\n- layman 安装\n\n建议开启的 USE flag 有 git、sync-plugin-portage。\n\n```\nemerge --ask app-portage/layman\nmkdir /etc/portage/repos.conf\nlayman-updater -R\n```\n\n- 相关指令\n\n```\nlayman -L # 显示存储库列表\nlayman -a <name> # 从本地列表添加存储库\nlayman -o <url of repository xml file> -f -a <name> # 添加非官方存储库\nlayman -d <name> # 删除存储库\nlayman -s <name> # 更新存储库\nlayman -S # 更新所有存储库\n```\n\n### 安装 eix\n\n详情见[gentoo wiki](https://wiki.gentoo.org/wiki/Eix)。\n\neix 在教程的前面的内容中已经提及并作简要介绍。\n\n- eix 安装\n\n```\nemerge app-portage/eix\neix-update\neix-sync\n```\n\n使用`eix-sync`代替`emerge --sync`，可以在同步数据库后自动更新 eix 的缓存。\n\n修改`/etc/eix-sync.conf`，写入`*`，以同步 ebuild 存储库。\n\n- 相关指令\n\n```\n# 搜索包\neix name\n# 搜索本地包\neix -I name\n# 在软件包描述文件中搜索，-c用于输出紧凑的结果\neix -S -c name\n# 在包类别中搜索\neix -C name\n# 搜索许可证\neix -Cc games-rpg -L \"EULA\"\n# 排除结果\neix --not -L \"EULA\"\n# 搜索过时的包\neix-test-obsolete\n```\n\n### 安装 ccache\n\nccache 原理是缓存编译时的中间结果，当重新编译时就可以大大减少编译时间。其应用场景主要为编译失败后修改配置，然后再次编译。此时之前编译的有效内容可以直接被利用，这部分将以极快的速度完成编译。但是第一次运行 ccache 时，会拖慢编译速度。\n\n- ccache 安装\n\n```\nemerge --ask ccache\nmkdir -p /var/cache/ccache\nchown root:portage /var/cache/ccache/\nchmod 2775 /var/cache/ccache/\n```\n\n修改`/etc/portage/make.conf`。\n\n```\nFEATURES=\"ccache\"\nCCACHE_DIR=\"/var/cache/ccache\"\nCCACHE_SIZE=\"16G\"\n```\n\n### 开启 32 位库支持\n\nGentoo 官方并不建议使用纯 64 位模式。其最现实的原因是几乎无法改回兼容 32 位的模式。因此对于新手而言，强烈建议选择兼容 32 位的模式。\n\n然而之前下载 stage3 包虽不是 nomultilib，但并不完全适配 32 位编译环境，需要手动修复。\n\n```\nemerge --ask --verbose db\n\n# 编辑/etc/portage/package.use/abi_x86_32，写入\n\nsys-libs/zlib abi_x86_32\n\n# 编辑/etc/portage/make.conf，写入\n\nABI_X86=\"32 64\"\n\nemerge --ask --verbose zlib\n```\n\n### 局域网编译与打包分发\n\nGentoo 可以联合局域网下的多台主机一起编译，也可以将本地编译好的包打包分发。\n\n考虑到一般个人用户不太会用到这些功能，此处不赘述。详情见[gentoo handbook](https://wiki.gentoo.org/wiki/Handbook:Parts/Full/Working/zh-cn#.E5.B0.86.E9.A2.84.E6.9E.84.E5.BB.BA.E7.9A.84.E8.BD.AF.E4.BB.B6.E5.8C.85.E5.88.86.E5.8F.91.E7.BB.99.E4.BB.96.E4.BA.BA)，[gentoo doc](https://docs.huihoo.com/gentoo/resources/document-listing/distcc.html)以及[gentoo wiki](https://wiki.gentoo.org/wiki/Distcc/zh-cn)。\n\n## 配置时间和区域\n\n时间与区域可以在之后配置，此处提前配置主要是为了方便某些 GFW 偷渡者。PS：这种东西很重要，甚至直接关系到能否成功安装，但得你自己想办法。\n\n- 时区\n\n```\n\necho Asia/Shanghai > /etc/timezone emerge --config sys-libs/timezone-data\n```\n\n- 区域\n\n```\n\n# 生成中英文 locale.gen\n\necho 'zh_CN.UTF-8 UTF-8' >> /etc/locale.gen\necho 'en_US.UTF-8 UTF-8' >> /etc/locale.gen\nlocale-gen\n\n# 列出可用的区域\n\neselect locale list\n\n# 选择英文区域的编号\n\neselect locale set 3\n\n# 重新加载环境变量\n\nenv-update && source /etc/profile && export PS1=\"(chroot) \\${PS1}\"\n\n```\n\n注意上述操作可能导致系统时间发生错误，可以手动纠正。但这可能导致/usr/bin/git 时间错误，致于无法安装 systemd。重装 git 可解决上述问题。\n\n- 时间修正\n\n```\n# 查看时间是否正确\n\nhwclock\ndate\ndate -s 2020/03/09\ndate -s 11:50:30\nhwclock -w\n\n# 自动更新，但此时暂不可用\n\ntimedatectl set-ntp true\n```\n\n## 重新编译 gcc\n\n为获取最适配本机的编译器，必须先配置并重新编译 gcc。即使你选择 clang 作为主编译器，也应当重新编译 gcc 的稳定分支。\n\n警告：此处配置编译需要万分小心。一旦出现不当，损坏编译器，就会很麻烦。如果真的遇到这种情况，也无需慌张。通过直接安装已编译完成的正常的 gcc 二进制包救场即可。\n\n- USE flag\n\n根据需求配置，以下仅为参考。\n\n```\nfortran nls nptl openmp pch sanitize ssp lto\n```\n\n- 编译 gcc\n\n```\n# 更新Portage\neix-sync\n# 编译安装gcc\nemerge --ask gcc\n# 如果编译了新版本的gcc，继续进行下列操作。\n# 查看可用gcc版本\ngcc-config --list-profiles\n# 选择新编译出来的gcc\ngcc-config 2\nsource /etc/profile\nexport PS1=\"(chroot) ${PS1}\"\nemerge --ask --oneshot --usepkg=n sys-devel/libtool\n# 检查当前gcc版本\ngcc -v\n# 如果需要拆卸旧版本\nemerge --ask --depclean =sys-devel/gcc-9.3.0\n# 验证系统完整性\nrevdep-rebuild\n# 重新编译部分包\nemerge --ask --oneshot --usepkg=n --verbose sys-devel/llvm sys-devel/clang\n# 如果有问题可以重新构建系统\nemerge --ask --emptytree --usepkg=n @system\n```\n\n## 安装 clang\n\n笔者使用 clang 作为主编译器。即使你使用 gcc 作为主编译器，也可以选择安装 clang 解决部分编译错误问题（这在[Gentoo Compile Error Handling](https://www.niuiic.top/2020/08/06/gentoo-compile-error-handling/)一文中已作介绍）。\n\n重新编译整个系统。如果你不使用 clang 作为主编译器或者觉得没有必要，可以跳过此步。\n\n```\nemerge --ask --emptytree --usepkg=n @system\n```\n\n## 更新配置\n\n```\n# 将数据库更新到最近一小时\neix-sync\nemerge --oneshot sys-apps/portage\n```\n\n至此，所有准备工作都已进行完毕。\n\n## 更新@world\n\n编译安装所有在配置中需要的软件。但在此之前，需要先安装内核源代码提供内核版本信息。\n\n```\nemerge sys-kernel/gentoo-sources\nemerge --deep --with-bdeps=y --changed-use --update --ask --verbose --keep-going @world\n```\n\n## 配置 fstab\n\nfstab 简单的说就是系统启动时挂载文件系统的配置文件。\n\n由 fstab 引起的常见错误有文件系统挂载为只读模式，无法写入任何文件等。\n\n这里不介绍 fstab 的具体配置方法。有需要的参考[gentoo wiki](https://wiki.gentoo.org/wiki/Fstab)。\n\n前面提到，如果有现成的 linux 系统，完全可以仿照其分区方式。主要就是为了 copy 现成的`/etc/fstab`。\n\n比如获得的文件如下\n\n```\nUUID=e5bc0d97-ac5c-400c-b26e-137cefe6ae68       /               ext4            rw,relatime     0 1\n\nUUID=B320-B5C7          /boot           vfat            rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,utf8,errors=remount-ro       0 2\n\nUUID=c4b396e5-cb87-42dc-b44e-4b26661e5cc0       none            swap            defaults        0 0\n```\n\n使用`blkid`获取文件系统的 UUID，替换文件中的 UUID 即可。\n\n## 内核编译\n\nGentoo 内核复杂点主要在于各选项的配置。此处不会介绍相关具体内容，只是提供一种投机取巧的方法。\n\n具体的内核选项配置，参考[gentoo wiki](https://wiki.gentoo.org/wiki/Kernel/Gentoo_Kernel_Configuration_Guide)。\n\n### 自动编译内核\n\n自动编译内核会开启大部分选项。不过如果不是对性能与简洁有极致的要求，着实是可以接受的。\n\n- 安装内核编译工具\n\n```\nemerge sys-kernel/genkernel\n```\n\n- 选择内核版本\n\n```\n# 查看源代码列表\neselect kernel list\n# 选择\neselect kernel set number\n```\n\n- 自动编译内核\n\n```\ngenkernel all\n```\n\n### 手动编译内核\n\n- 安装内核配置工具\n\n```\nemerge --ask sys-apps/pciutils\n```\n\n- 查看功能\n\n通过`lsmod`命令来查看当前所处的 Gentoo Live 镜像开启的功能，这可以作为我们在配置内核时的重要参考。\n\n- 配置\n\n```\n# 进入源码菜单\ncd /usr/src/linux\n# 打开配置工具\nmake menuconfig\n```\n\n按需求配置即可。\n\n把上面所有必选项都配置好之后，选择 save 保存配置文件，然后 exit 退出。默认配置文件名是.config，但是最好手动复制一个备份，有时候默认名称的配置文件会莫名丢失，只能重头再配置一次。然后就可以开始编译和安装。\n\n- 编译安装内核\n\n```\nmake\nmake modules_install\nmake install\n```\n\n- 投机取巧的方法\n\n先自动编译内核，等到输出信息显示配置完毕后打断进程，进入源码菜单，修改配置文件即可。这至少将提供一份正确的配置方案，在此基础上修改将节省大量时间。\n\n## 安装 firmware 和 initrampfs\n\n```\nemerge --ask sys-kernel/linux-firmware\n# 如果是自动安装内核，则不需要下一步\ngenkernel --install initramfs\n```\n\n## 配置系统\n\n此处的系统配置基于 Systemd，如果你使用的是 OpenRC，部分配置将不适用。\n\n### 网络配置\n\n- 修改`/etc/hostname`\n\n设置主机名\n\n```\nyourname\n```\n\n- 修改`/etc/hosts`\n\n```\n# 定义的是现在系统，假设主机名为tux\n127.0.0.1     localhost\n::1 \t\t  localhost\n127.0.1.1 \t  name.localdomain name\n```\n\n- 网络工具的安装\n\n如果你想在安装完毕基础系统后不再使用 livecd，就需要先安装基础网络工具。之后等桌面环境安装完毕后，最终将采用 NetworkManager 作为 wifi 配置连接工具。\n\n```\nemerge net-wireless/wpa_supplicant dhcpcd\n```\n\n### 设置密码\n\n```\npasswd\n```\n\n需要 8 字符及以上。\n\n也可以修改`/etc/pam.d/system-auth`，将`min=8,8,8,8,8 retry=3`中所有的 8 改为 1。\n\n### 部分系统工具的安装\n\n- 日志工具\n\n```\nemerge --ask app-admin/syslog-ng\nsystemctl enable syslog-ng@default\n```\n\n- 远程登录\n\n```\nsystemctl enable sshd\n```\n\n- 文件系统工具\n\n```\nemerge --ask sys-fs/dosfstools sys-fs/e2fsprogs\n```\n\n### 添加用户\n\n```\nuseradd -m -G users,wheel,audio -s /bin/bash username\npasswd username # 需要三个单词，总长度大于8个字符\n```\n\n### 磁盘清理\n\n```\nrm /stage3-*.tar.*\n```\n\n## 安装系统引导器\n\n- 安装 grub\n\n```\nemerge --ask --verbose sys-boot/grub:2\n```\n\n- 将 grub 安装到系统中\n\n注意如果你不是 efi 引导，需要修改下列命令。\n\n```\ngrub-install --target=x86_64-efi --efi-directory=/boot\ngrub-mkconfig -o /boot/grub/grub.cfg\n```\n\n### 安装配置 sudo\n\n```\nemerge --ask sudo\nnvim /etc/sudoers\n# 在root ALL=(ALL) ALL下添加新的用户\n```\n\n### 配置 sshd\n\n修改`/etc/ssh/sshd_config`，做以下修改。\n\n```\nPort 22\nPermitRootLogin yes\nPasswordAuthentication yes\n```\n\n### 开启 SysRq\n\n修改`/etc/sysctl.conf`。\n\n```\nkernel.sysrq = 1\n```\n\n至此，Gentoo 基础系统已经安装完毕。退出 chroot，重启检查是否有误。\n\n下一篇：[Gentoo Kool Desktop Environment Installation](https://www.niuiic.top/2020/08/08/gentoo-kool-desktop-environment-installation/)\n","slug":"gentoo-basic-system-installation","published":1,"updated":"2021-03-23T11:11:18.575Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmrm000trrizflgc2c5h","content":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo 教程目录</a></p>\n<h1 id=\"Gentoo-基本系统安装\"><a href=\"#Gentoo-基本系统安装\" class=\"headerlink\" title=\"Gentoo 基本系统安装\"></a>Gentoo 基本系统安装</h1><p>本文介绍 gentoo 基本系统的一般安装流程。图形界面的安装配置将在后面的文章中介绍。</p>\n<h2 id=\"刻录-gentoo-安装镜像\"><a href=\"#刻录-gentoo-安装镜像\" class=\"headerlink\" title=\"刻录 gentoo 安装镜像\"></a>刻录 gentoo 安装镜像</h2><p>访问<a href=\"https://mirrors.tuna.tsinghua.edu.cn/\">清华大学开源软件镜像站</a>。选择合适的架构，下载 gentoo 安装镜像。</p>\n<p><img src=\"1.png\" alt=\"安装镜像列表\"></p>\n<p>虚拟机不需要刻录。u 盘的刻录步骤很简单，不再赘述。</p>\n<h2 id=\"开启网络与-ssh\"><a href=\"#开启网络与-ssh\" class=\"headerlink\" title=\"开启网络与 ssh\"></a>开启网络与 ssh</h2><ul>\n<li>有线网卡与虚拟机</li>\n</ul>\n<p>直接<code>dhcpcd</code>即可</p>\n<ul>\n<li>wifi</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看无限网卡名称及状态\nip a\n\n# 若无限网卡未打开，则开启\nip link set interface_name up\n\n# 查看可用的wifi\n# 建议直接从其他设备上查看wifi名称，不必从本地扫描搜索\n\n# 生成wifi配置\nwpa_passphrase 网络 密码 &gt; 文件\n\n# 连接wifi\nwpa_supplicant -c 文件 -i 接口 &amp;\n\n# 自动分配ip地址\ndhcpcd &amp;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>开启 ssh</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 开启ssh\n&#x2F;etc&#x2F;init.d&#x2F;sshd start\n# 设置livecd密码\npasswd\n# 注意远程连接时用户名不是livecd，而是root<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"磁盘分区\"><a href=\"#磁盘分区\" class=\"headerlink\" title=\"磁盘分区\"></a>磁盘分区</h2><p>详见</p>\n<p><a href=\"https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Disks/zh-cn\">gentoo wiki</a><br><a href=\"https://wiki.gentoo.org/wiki/Handbook:X86/Blocks/Disks/zh-cn\">gentoo handbook</a></p>\n<p>由于此处分配分区将牵扯到后面 fstab 的配置，如果你对此完全不了解，建议按最常规的方式划分。如果你有一台现成的 linux，可以仿照其分区，可以帮助后面配置 fstab。</p>\n<p>另外参考你的电脑配置。内存与交换空间之和（单位 G）最好大于 CPU 总线程数。</p>\n<p>以下是 GPT 格式分区，引导方式为 EFI。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">fdisk -l\n# 注意以下磁盘名nvme0n1，对于不同规格的硬盘不同\nfdisk &#x2F;dev&#x2F;nvme0n1\ng\n# 分区，具体操作略\nw\n# 注意以下分区格式将关系到部分软件，尤其是grub的安装配置。因此必须慎重选择。\n# 制作引导分区\nmkfs.fat -F32 &#x2F;dev&#x2F;nvme0n1p1\n# 制作主分区\nmkfs.ext4 &#x2F;dev&#x2F;nvme0n1p2\n# 制作交换分区\nmkswap &#x2F;dev&#x2F;nvme0n1p3\n# 启用交换\nswapon &#x2F;dev&#x2F;nvme0n1p3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>分区完毕后将主分区挂在到 livecd 提供的挂载点上。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mount &#x2F;dev&#x2F;nvme0n1p2 &#x2F;mnt&#x2F;gentoo<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"获取基础编译环境\"><a href=\"#获取基础编译环境\" class=\"headerlink\" title=\"获取基础编译环境\"></a>获取基础编译环境</h2><p>上述步骤已经为 gentoo 系统开辟了空间，下面将正式进入系统的编译安装阶段。</p>\n<p>由于 gentoo livecd 并不携带完整的编译环境，因此我们需要先往系统空间中放一个现成的编译环境，即 gentoo 基础编译环境。</p>\n<p>再次访问<a href=\"https://mirrors.tuna.tsinghua.edu.cn/\">清华镜像站</a>。</p>\n<p>Gentoo 的 stage3 包囊括了整套编译环境以及绝大多数 gentoo 基础工具。</p>\n<p><img src=\"2.png\" alt=\"stage3\"></p>\n<p>Gentoo stage3 包的类型包括但不限于以上几种。根据你所需要的桌面环境，查看其对应的 gentoo wiki，做出选择。其中无 systemd 表示使用 OpenRC。nomultilib 表示仅支持 64 位，一般不建议选择。</p>\n<p>本教程以 systemd kde 为例，因此选择下载以下几个包至<code>/mnt/gentoo</code>。</p>\n<p><img src=\"3.png\" alt=\"systemd stage3\"></p>\n<p>下载完毕后使用<code>sha512sum -c stage3-amd64-*.tar.xz.DIGESTS</code>校验文件，出现两个 ok 和两个 failed 为正常。并继续使用<code>tar xpvf stage3-*.tar.xz --xattrs-include=&#39;*.*&#39; --numeric-owner</code>解压文件。</p>\n<h2 id=\"设置编译选项\"><a href=\"#设置编译选项\" class=\"headerlink\" title=\"设置编译选项\"></a>设置编译选项</h2><p>配置<code>/mnt/gentoo/etc/portage/make.conf</code>。</p>\n<p>这是整个安装过程中最核心、最重要的一步。详情参考<a href=\"https://wiki.gentoo.org/wiki//etc/portage/make.conf\">Gentoo wiki</a>以及<a href=\"https://dev.gentoo.org/~zmedico/portage/doc/man/make.conf.5.html\">gentoo doc</a>。</p>\n<p>此处不再对大部分配置进行说明，仅给出笔者第一次安装 gentoo 时的配置（虽不完美，但在当时不存在错误）。只可参考，不可照抄。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">COMMON_FLAGS&#x3D;&quot;-march&#x3D;native -O2 -pipe&quot;\n\nCFLAGS&#x3D;&quot;$&#123;COMMON_FLAGS&#125;&quot;\nCXXFLAGS&#x3D;&quot;$&#123;COMMON_FLAGS&#125;&quot;\nFCFLAGS&#x3D;&quot;$&#123;COMMON_FLAGS&#125;&quot;\nFFLAGS&#x3D;&quot;$&#123;COMMON_FLAGS&#125;&quot;\n\nCHOST&#x3D;&quot;x86_64-pc-linux-gnu&quot;\n\nCONFIG_PROTECT&#x3D;&quot;&#x2F;var&#x2F;bind&quot;\n\nPORTDIR&#x3D;&quot;&#x2F;var&#x2F;db&#x2F;repos&#x2F;gentoo&quot;\nDISTDIR&#x3D;&quot;&#x2F;var&#x2F;cache&#x2F;distfiles&quot;\nPKGDIR&#x3D;&quot;&#x2F;var&#x2F;cache&#x2F;binpkgs&quot;\n\nLC_MESSAGES&#x3D;C\n\nMAKEOPTS&#x3D;&quot;-j9&quot;\n\nGENTOO_MIRRORS&#x3D;&quot;https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;gentoo&quot;\n\nPORTAGE_TMPDIR&#x3D;&quot;&#x2F;var&#x2F;tmp&quot;\n\nDISTDIR&#x3D;&#x2F;var&#x2F;gentoo&#x2F;distfiles\n\nACCEPT_LICENSE&#x3D;&quot;*&quot;\n\nVIDEO_CARDS&#x3D;&quot;radeon&quot;\n\nL10N&#x3D;&quot;en_US en zh zh_CN&quot;\n\nLINGUAS&#x3D;&quot;en-US zh-CN en zh&quot;\n\nAUTO_CLEAN&#x3D;&quot;yes&quot;\n\nGRUB_PLATFORMS&#x3D;&quot;efi-64&quot;\n\nEMERGE_DEFAULT_OPTS&#x3D;&quot;--with-bdeps&#x3D;y --ask --verbose&#x3D;y --load-average --keep-going&quot;\n\nINPUT_DEVICES&#x3D;&quot;libinput synaptics evdev&quot;\n\nUSE&#x3D;&quot;X alsa clang udev dbus polkit udisks vulkan vdpau vaapi glamor nls&quot;\n\nKEYWORDS&#x3D;&quot;amd64&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>下面对其中的几个选项做简略介绍。</p>\n<p><code>GENTOO_MIRRORS</code>：建议选清华源。虽然清华源的速度中规中矩，时不时还出点问题。但 gentoo 在中国境内的源很少，应该也只有清华源在及时更新。</p>\n<p><code>EMERGE_DEFAULT_OPTS</code>：建议添加，可大大减小 emerge 指令长度。</p>\n<p><code>INPUT_DEVICES</code>：绝不可缺。否则会引起键盘、觸控板、鼠标失效等等问题。</p>\n<p><code>KEYWORDS</code>：不要在这里开启测试分支。</p>\n<p><code>MAKEOPTS</code>：建议等于 CPU 线程数+1。这样计算机在编译软件时尚有余力编译另外的软件或者进行其他操作。</p>\n<h2 id=\"进一步配置\"><a href=\"#进一步配置\" class=\"headerlink\" title=\"进一步配置\"></a>进一步配置</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">mkdir --parents &#x2F;mnt&#x2F;gentoo&#x2F;etc&#x2F;portage&#x2F;repos.conf\ncp &#x2F;mnt&#x2F;gentoo&#x2F;usr&#x2F;share&#x2F;portage&#x2F;config&#x2F;repos.conf &#x2F;mnt&#x2F;gentoo&#x2F;etc&#x2F;portage&#x2F;repos.conf&#x2F;gentoo.conf\ncp --dereference &#x2F;etc&#x2F;resolv.conf &#x2F;mnt&#x2F;gentoo&#x2F;etc&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>修改<code>/mnt/gentoo/etc/portage/repos.conf/gentoo.conf</code>配置 portage 镜像源</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sync-uri &#x3D; rsync:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;gentoo-portage<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"进入新系统\"><a href=\"#进入新系统\" class=\"headerlink\" title=\"进入新系统\"></a>进入新系统</h2><ul>\n<li>挂载剩余文件系统</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mount --types proc &#x2F;proc &#x2F;mnt&#x2F;gentoo&#x2F;proc\nmount --rbind &#x2F;sys &#x2F;mnt&#x2F;gentoo&#x2F;sys\nmount --make-rslave &#x2F;mnt&#x2F;gentoo&#x2F;sys\nmount --rbind &#x2F;dev &#x2F;mnt&#x2F;gentoo&#x2F;dev\nmount --make-rslave &#x2F;mnt&#x2F;gentoo&#x2F;dev<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>chroot 登陆新系统</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">chroot &#x2F;mnt&#x2F;gentoo &#x2F;bin&#x2F;bash\nsource &#x2F;etc&#x2F;profile\nexport PS1&#x3D;&quot;(chroot) $&#123;PS1&#125;&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>挂载 boot 分区</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mount &#x2F;dev&#x2F;nvme0n1p1 &#x2F;boot<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"配置-Portage\"><a href=\"#配置-Portage\" class=\"headerlink\" title=\"配置 Portage\"></a>配置 Portage</h2><ul>\n<li>下载数据库快照</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge-webrsync<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>选择 profile</li>\n</ul>\n<p>profile 简单的说就是一系列 USE flag 等配置的集合。这将是新系统的主体配置。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 先列出可用的profile，带星号是目前选择的\neselect profile list\n# 选择你需要的profile（可以从gentoo wiki获得信息）。这里选择kde桌面对应的profile\neselect profile set default&#x2F;linux&#x2F;amd64&#x2F;17.1&#x2F;desktop&#x2F;plasma&#x2F;systemd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>17.0 与 17.1 版本差距并不是非常大，如果不想深究，可以随意选择。</p>\n<h2 id=\"系统工具优化\"><a href=\"#系统工具优化\" class=\"headerlink\" title=\"系统工具优化\"></a>系统工具优化</h2><p>所谓工欲善其事，必先利其器。因此在正式编译系统之前，先进行部分工具的完善。</p>\n<h3 id=\"编辑器\"><a href=\"#编辑器\" class=\"headerlink\" title=\"编辑器\"></a>编辑器</h3><p>如果你不喜欢 stage3 中解压出来的 nano，可以优先安装一款自己喜欢的编辑器。</p>\n<h3 id=\"git\"><a href=\"#git\" class=\"headerlink\" title=\"git\"></a>git</h3><p>使用 git 同步 portage。</p>\n<p>优点：大大提高同步速度。</p>\n<p>缺点：略占用更多空间。</p>\n<p>安装 git，不赘述。</p>\n<p>修改当前系统的<code>/etc/portage/repos.conf/gentoo.conf</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[gentoo]\nsync-type &#x3D; git\nsync-uri &#x3D; https:&#x2F;&#x2F;github.com&#x2F;gentoo-mirror&#x2F;gentoo<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 移除之前同步的portage\nrm -rf &#x2F;mnt&#x2F;gentoo&#x2F;var&#x2F;db&#x2F;repos&#x2F;gentoo&#96;\n# 同步portage\n&#96;emerge --sync&#96;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"gentoolkit\"><a href=\"#gentoolkit\" class=\"headerlink\" title=\"gentoolkit\"></a>gentoolkit</h3><p>安装 gentoolkit，不赘述。</p>\n<ul>\n<li>常用指令</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看已经enable的USE flag\neuse -a -g或者euse -a -l\n# 激活USE flag\neuse -E flagname\n# 关闭USE flag\neuse -D flagname\n# 注意不可单独使用euse -D或者euse -E。这将作用到所有的USE flag。\n# 查看指定包的use标志\nequery --nocolor uses &#x3D;gnumeric-1.12.31\n# 清理源代码\neclean-dist\n# 清理二进制包\neclean-pkg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>eclean 说明</li>\n</ul>\n<p>默认情况下当前存储库中的任何 ebuild 相对应的源文件和二进制包都不会被删除。</p>\n<p>可以通过同时使用 <code>--deep</code> 和 <code>--package-names</code> 选项指定删除当前存储库中 ebuild 对应的源文件和二进制包。</p>\n<h3 id=\"安装-layman\"><a href=\"#安装-layman\" class=\"headerlink\" title=\"安装 layman\"></a>安装 layman</h3><p>layman 是一个优秀的 gentoo overlay 管理工具。eix-sync 指令中也集成了<code>layman -S</code>指令。</p>\n<p>详情见<a href=\"https://wiki.gentoo.org/wiki/Layman\">gentoo wiki</a>。</p>\n<ul>\n<li>layman 安装</li>\n</ul>\n<p>建议开启的 USE flag 有 git、sync-plugin-portage。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask app-portage&#x2F;layman\nmkdir &#x2F;etc&#x2F;portage&#x2F;repos.conf\nlayman-updater -R<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>相关指令</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">layman -L # 显示存储库列表\nlayman -a &lt;name&gt; # 从本地列表添加存储库\nlayman -o &lt;url of repository xml file&gt; -f -a &lt;name&gt; # 添加非官方存储库\nlayman -d &lt;name&gt; # 删除存储库\nlayman -s &lt;name&gt; # 更新存储库\nlayman -S # 更新所有存储库<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"安装-eix\"><a href=\"#安装-eix\" class=\"headerlink\" title=\"安装 eix\"></a>安装 eix</h3><p>详情见<a href=\"https://wiki.gentoo.org/wiki/Eix\">gentoo wiki</a>。</p>\n<p>eix 在教程的前面的内容中已经提及并作简要介绍。</p>\n<ul>\n<li>eix 安装</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge app-portage&#x2F;eix\neix-update\neix-sync<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>使用<code>eix-sync</code>代替<code>emerge --sync</code>，可以在同步数据库后自动更新 eix 的缓存。</p>\n<p>修改<code>/etc/eix-sync.conf</code>，写入<code>*</code>，以同步 ebuild 存储库。</p>\n<ul>\n<li>相关指令</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 搜索包\neix name\n# 搜索本地包\neix -I name\n# 在软件包描述文件中搜索，-c用于输出紧凑的结果\neix -S -c name\n# 在包类别中搜索\neix -C name\n# 搜索许可证\neix -Cc games-rpg -L &quot;EULA&quot;\n# 排除结果\neix --not -L &quot;EULA&quot;\n# 搜索过时的包\neix-test-obsolete<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"安装-ccache\"><a href=\"#安装-ccache\" class=\"headerlink\" title=\"安装 ccache\"></a>安装 ccache</h3><p>ccache 原理是缓存编译时的中间结果，当重新编译时就可以大大减少编译时间。其应用场景主要为编译失败后修改配置，然后再次编译。此时之前编译的有效内容可以直接被利用，这部分将以极快的速度完成编译。但是第一次运行 ccache 时，会拖慢编译速度。</p>\n<ul>\n<li>ccache 安装</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask ccache\nmkdir -p &#x2F;var&#x2F;cache&#x2F;ccache\nchown root:portage &#x2F;var&#x2F;cache&#x2F;ccache&#x2F;\nchmod 2775 &#x2F;var&#x2F;cache&#x2F;ccache&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>修改<code>/etc/portage/make.conf</code>。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">FEATURES&#x3D;&quot;ccache&quot;\nCCACHE_DIR&#x3D;&quot;&#x2F;var&#x2F;cache&#x2F;ccache&quot;\nCCACHE_SIZE&#x3D;&quot;16G&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"开启-32-位库支持\"><a href=\"#开启-32-位库支持\" class=\"headerlink\" title=\"开启 32 位库支持\"></a>开启 32 位库支持</h3><p>Gentoo 官方并不建议使用纯 64 位模式。其最现实的原因是几乎无法改回兼容 32 位的模式。因此对于新手而言，强烈建议选择兼容 32 位的模式。</p>\n<p>然而之前下载 stage3 包虽不是 nomultilib，但并不完全适配 32 位编译环境，需要手动修复。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask --verbose db\n\n# 编辑&#x2F;etc&#x2F;portage&#x2F;package.use&#x2F;abi_x86_32，写入\n\nsys-libs&#x2F;zlib abi_x86_32\n\n# 编辑&#x2F;etc&#x2F;portage&#x2F;make.conf，写入\n\nABI_X86&#x3D;&quot;32 64&quot;\n\nemerge --ask --verbose zlib<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"局域网编译与打包分发\"><a href=\"#局域网编译与打包分发\" class=\"headerlink\" title=\"局域网编译与打包分发\"></a>局域网编译与打包分发</h3><p>Gentoo 可以联合局域网下的多台主机一起编译，也可以将本地编译好的包打包分发。</p>\n<p>考虑到一般个人用户不太会用到这些功能，此处不赘述。详情见<a href=\"https://wiki.gentoo.org/wiki/Handbook:Parts/Full/Working/zh-cn#.E5.B0.86.E9.A2.84.E6.9E.84.E5.BB.BA.E7.9A.84.E8.BD.AF.E4.BB.B6.E5.8C.85.E5.88.86.E5.8F.91.E7.BB.99.E4.BB.96.E4.BA.BA\">gentoo handbook</a>，<a href=\"https://docs.huihoo.com/gentoo/resources/document-listing/distcc.html\">gentoo doc</a>以及<a href=\"https://wiki.gentoo.org/wiki/Distcc/zh-cn\">gentoo wiki</a>。</p>\n<h2 id=\"配置时间和区域\"><a href=\"#配置时间和区域\" class=\"headerlink\" title=\"配置时间和区域\"></a>配置时间和区域</h2><p>时间与区域可以在之后配置，此处提前配置主要是为了方便某些 GFW 偷渡者。PS：这种东西很重要，甚至直接关系到能否成功安装，但得你自己想办法。</p>\n<ul>\n<li>时区</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">\necho Asia&#x2F;Shanghai &gt; &#x2F;etc&#x2F;timezone emerge --config sys-libs&#x2F;timezone-data<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>区域</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">\n# 生成中英文 locale.gen\n\necho &#39;zh_CN.UTF-8 UTF-8&#39; &gt;&gt; &#x2F;etc&#x2F;locale.gen\necho &#39;en_US.UTF-8 UTF-8&#39; &gt;&gt; &#x2F;etc&#x2F;locale.gen\nlocale-gen\n\n# 列出可用的区域\n\neselect locale list\n\n# 选择英文区域的编号\n\neselect locale set 3\n\n# 重新加载环境变量\n\nenv-update &amp;&amp; source &#x2F;etc&#x2F;profile &amp;&amp; export PS1&#x3D;&quot;(chroot) \\$&#123;PS1&#125;&quot;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意上述操作可能导致系统时间发生错误，可以手动纠正。但这可能导致/usr/bin/git 时间错误，致于无法安装 systemd。重装 git 可解决上述问题。</p>\n<ul>\n<li>时间修正</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看时间是否正确\n\nhwclock\ndate\ndate -s 2020&#x2F;03&#x2F;09\ndate -s 11:50:30\nhwclock -w\n\n# 自动更新，但此时暂不可用\n\ntimedatectl set-ntp true<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"重新编译-gcc\"><a href=\"#重新编译-gcc\" class=\"headerlink\" title=\"重新编译 gcc\"></a>重新编译 gcc</h2><p>为获取最适配本机的编译器，必须先配置并重新编译 gcc。即使你选择 clang 作为主编译器，也应当重新编译 gcc 的稳定分支。</p>\n<p>警告：此处配置编译需要万分小心。一旦出现不当，损坏编译器，就会很麻烦。如果真的遇到这种情况，也无需慌张。通过直接安装已编译完成的正常的 gcc 二进制包救场即可。</p>\n<ul>\n<li>USE flag</li>\n</ul>\n<p>根据需求配置，以下仅为参考。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">fortran nls nptl openmp pch sanitize ssp lto<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>编译 gcc</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 更新Portage\neix-sync\n# 编译安装gcc\nemerge --ask gcc\n# 如果编译了新版本的gcc，继续进行下列操作。\n# 查看可用gcc版本\ngcc-config --list-profiles\n# 选择新编译出来的gcc\ngcc-config 2\nsource &#x2F;etc&#x2F;profile\nexport PS1&#x3D;&quot;(chroot) $&#123;PS1&#125;&quot;\nemerge --ask --oneshot --usepkg&#x3D;n sys-devel&#x2F;libtool\n# 检查当前gcc版本\ngcc -v\n# 如果需要拆卸旧版本\nemerge --ask --depclean &#x3D;sys-devel&#x2F;gcc-9.3.0\n# 验证系统完整性\nrevdep-rebuild\n# 重新编译部分包\nemerge --ask --oneshot --usepkg&#x3D;n --verbose sys-devel&#x2F;llvm sys-devel&#x2F;clang\n# 如果有问题可以重新构建系统\nemerge --ask --emptytree --usepkg&#x3D;n @system<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"安装-clang\"><a href=\"#安装-clang\" class=\"headerlink\" title=\"安装 clang\"></a>安装 clang</h2><p>笔者使用 clang 作为主编译器。即使你使用 gcc 作为主编译器，也可以选择安装 clang 解决部分编译错误问题（这在<a href=\"https://www.niuiic.top/2020/08/06/gentoo-compile-error-handling/\">Gentoo Compile Error Handling</a>一文中已作介绍）。</p>\n<p>重新编译整个系统。如果你不使用 clang 作为主编译器或者觉得没有必要，可以跳过此步。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask --emptytree --usepkg&#x3D;n @system<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"更新配置\"><a href=\"#更新配置\" class=\"headerlink\" title=\"更新配置\"></a>更新配置</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\"># 将数据库更新到最近一小时\neix-sync\nemerge --oneshot sys-apps&#x2F;portage<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>至此，所有准备工作都已进行完毕。</p>\n<h2 id=\"更新-world\"><a href=\"#更新-world\" class=\"headerlink\" title=\"更新@world\"></a>更新@world</h2><p>编译安装所有在配置中需要的软件。但在此之前，需要先安装内核源代码提供内核版本信息。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge sys-kernel&#x2F;gentoo-sources\nemerge --deep --with-bdeps&#x3D;y --changed-use --update --ask --verbose --keep-going @world<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"配置-fstab\"><a href=\"#配置-fstab\" class=\"headerlink\" title=\"配置 fstab\"></a>配置 fstab</h2><p>fstab 简单的说就是系统启动时挂载文件系统的配置文件。</p>\n<p>由 fstab 引起的常见错误有文件系统挂载为只读模式，无法写入任何文件等。</p>\n<p>这里不介绍 fstab 的具体配置方法。有需要的参考<a href=\"https://wiki.gentoo.org/wiki/Fstab\">gentoo wiki</a>。</p>\n<p>前面提到，如果有现成的 linux 系统，完全可以仿照其分区方式。主要就是为了 copy 现成的<code>/etc/fstab</code>。</p>\n<p>比如获得的文件如下</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">UUID&#x3D;e5bc0d97-ac5c-400c-b26e-137cefe6ae68       &#x2F;               ext4            rw,relatime     0 1\n\nUUID&#x3D;B320-B5C7          &#x2F;boot           vfat            rw,relatime,fmask&#x3D;0022,dmask&#x3D;0022,codepage&#x3D;437,iocharset&#x3D;iso8859-1,shortname&#x3D;mixed,utf8,errors&#x3D;remount-ro       0 2\n\nUUID&#x3D;c4b396e5-cb87-42dc-b44e-4b26661e5cc0       none            swap            defaults        0 0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>使用<code>blkid</code>获取文件系统的 UUID，替换文件中的 UUID 即可。</p>\n<h2 id=\"内核编译\"><a href=\"#内核编译\" class=\"headerlink\" title=\"内核编译\"></a>内核编译</h2><p>Gentoo 内核复杂点主要在于各选项的配置。此处不会介绍相关具体内容，只是提供一种投机取巧的方法。</p>\n<p>具体的内核选项配置，参考<a href=\"https://wiki.gentoo.org/wiki/Kernel/Gentoo_Kernel_Configuration_Guide\">gentoo wiki</a>。</p>\n<h3 id=\"自动编译内核\"><a href=\"#自动编译内核\" class=\"headerlink\" title=\"自动编译内核\"></a>自动编译内核</h3><p>自动编译内核会开启大部分选项。不过如果不是对性能与简洁有极致的要求，着实是可以接受的。</p>\n<ul>\n<li>安装内核编译工具</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge sys-kernel&#x2F;genkernel<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>选择内核版本</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看源代码列表\neselect kernel list\n# 选择\neselect kernel set number<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>自动编译内核</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">genkernel all<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"手动编译内核\"><a href=\"#手动编译内核\" class=\"headerlink\" title=\"手动编译内核\"></a>手动编译内核</h3><ul>\n<li>安装内核配置工具</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask sys-apps&#x2F;pciutils<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>查看功能</li>\n</ul>\n<p>通过<code>lsmod</code>命令来查看当前所处的 Gentoo Live 镜像开启的功能，这可以作为我们在配置内核时的重要参考。</p>\n<ul>\n<li>配置</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 进入源码菜单\ncd &#x2F;usr&#x2F;src&#x2F;linux\n# 打开配置工具\nmake menuconfig<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>按需求配置即可。</p>\n<p>把上面所有必选项都配置好之后，选择 save 保存配置文件，然后 exit 退出。默认配置文件名是.config，但是最好手动复制一个备份，有时候默认名称的配置文件会莫名丢失，只能重头再配置一次。然后就可以开始编译和安装。</p>\n<ul>\n<li>编译安装内核</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">make\nmake modules_install\nmake install<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>投机取巧的方法</li>\n</ul>\n<p>先自动编译内核，等到输出信息显示配置完毕后打断进程，进入源码菜单，修改配置文件即可。这至少将提供一份正确的配置方案，在此基础上修改将节省大量时间。</p>\n<h2 id=\"安装-firmware-和-initrampfs\"><a href=\"#安装-firmware-和-initrampfs\" class=\"headerlink\" title=\"安装 firmware 和 initrampfs\"></a>安装 firmware 和 initrampfs</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask sys-kernel&#x2F;linux-firmware\n# 如果是自动安装内核，则不需要下一步\ngenkernel --install initramfs<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"配置系统\"><a href=\"#配置系统\" class=\"headerlink\" title=\"配置系统\"></a>配置系统</h2><p>此处的系统配置基于 Systemd，如果你使用的是 OpenRC，部分配置将不适用。</p>\n<h3 id=\"网络配置\"><a href=\"#网络配置\" class=\"headerlink\" title=\"网络配置\"></a>网络配置</h3><ul>\n<li>修改<code>/etc/hostname</code></li>\n</ul>\n<p>设置主机名</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">yourname<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>修改<code>/etc/hosts</code></li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 定义的是现在系统，假设主机名为tux\n127.0.0.1     localhost\n::1 \t\t  localhost\n127.0.1.1 \t  name.localdomain name<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>网络工具的安装</li>\n</ul>\n<p>如果你想在安装完毕基础系统后不再使用 livecd，就需要先安装基础网络工具。之后等桌面环境安装完毕后，最终将采用 NetworkManager 作为 wifi 配置连接工具。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge net-wireless&#x2F;wpa_supplicant dhcpcd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"设置密码\"><a href=\"#设置密码\" class=\"headerlink\" title=\"设置密码\"></a>设置密码</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">passwd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>需要 8 字符及以上。</p>\n<p>也可以修改<code>/etc/pam.d/system-auth</code>，将<code>min=8,8,8,8,8 retry=3</code>中所有的 8 改为 1。</p>\n<h3 id=\"部分系统工具的安装\"><a href=\"#部分系统工具的安装\" class=\"headerlink\" title=\"部分系统工具的安装\"></a>部分系统工具的安装</h3><ul>\n<li>日志工具</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask app-admin&#x2F;syslog-ng\nsystemctl enable syslog-ng@default<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>远程登录</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">systemctl enable sshd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>文件系统工具</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask sys-fs&#x2F;dosfstools sys-fs&#x2F;e2fsprogs<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"添加用户\"><a href=\"#添加用户\" class=\"headerlink\" title=\"添加用户\"></a>添加用户</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">useradd -m -G users,wheel,audio -s &#x2F;bin&#x2F;bash username\npasswd username # 需要三个单词，总长度大于8个字符<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"磁盘清理\"><a href=\"#磁盘清理\" class=\"headerlink\" title=\"磁盘清理\"></a>磁盘清理</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">rm &#x2F;stage3-*.tar.*<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"安装系统引导器\"><a href=\"#安装系统引导器\" class=\"headerlink\" title=\"安装系统引导器\"></a>安装系统引导器</h2><ul>\n<li>安装 grub</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask --verbose sys-boot&#x2F;grub:2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>将 grub 安装到系统中</li>\n</ul>\n<p>注意如果你不是 efi 引导，需要修改下列命令。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">grub-install --target&#x3D;x86_64-efi --efi-directory&#x3D;&#x2F;boot\ngrub-mkconfig -o &#x2F;boot&#x2F;grub&#x2F;grub.cfg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"安装配置-sudo\"><a href=\"#安装配置-sudo\" class=\"headerlink\" title=\"安装配置 sudo\"></a>安装配置 sudo</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask sudo\nnvim &#x2F;etc&#x2F;sudoers\n# 在root ALL&#x3D;(ALL) ALL下添加新的用户<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"配置-sshd\"><a href=\"#配置-sshd\" class=\"headerlink\" title=\"配置 sshd\"></a>配置 sshd</h3><p>修改<code>/etc/ssh/sshd_config</code>，做以下修改。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Port 22\nPermitRootLogin yes\nPasswordAuthentication yes<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"开启-SysRq\"><a href=\"#开启-SysRq\" class=\"headerlink\" title=\"开启 SysRq\"></a>开启 SysRq</h3><p>修改<code>/etc/sysctl.conf</code>。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">kernel.sysrq &#x3D; 1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>至此，Gentoo 基础系统已经安装完毕。退出 chroot，重启检查是否有误。</p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/08/gentoo-kool-desktop-environment-installation/\">Gentoo Kool Desktop Environment Installation</a></p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo 教程目录</a></p>\n<h1 id=\"Gentoo-基本系统安装\"><a href=\"#Gentoo-基本系统安装\" class=\"headerlink\" title=\"Gentoo 基本系统安装\"></a>Gentoo 基本系统安装</h1><p>本文介绍 gentoo 基本系统的一般安装流程。图形界面的安装配置将在后面的文章中介绍。</p>\n<h2 id=\"刻录-gentoo-安装镜像\"><a href=\"#刻录-gentoo-安装镜像\" class=\"headerlink\" title=\"刻录 gentoo 安装镜像\"></a>刻录 gentoo 安装镜像</h2><p>访问<a href=\"https://mirrors.tuna.tsinghua.edu.cn/\">清华大学开源软件镜像站</a>。选择合适的架构，下载 gentoo 安装镜像。</p>\n<p><img src=\"1.png\" alt=\"安装镜像列表\"></p>\n<p>虚拟机不需要刻录。u 盘的刻录步骤很简单，不再赘述。</p>\n<h2 id=\"开启网络与-ssh\"><a href=\"#开启网络与-ssh\" class=\"headerlink\" title=\"开启网络与 ssh\"></a>开启网络与 ssh</h2><ul>\n<li>有线网卡与虚拟机</li>\n</ul>\n<p>直接<code>dhcpcd</code>即可</p>\n<ul>\n<li>wifi</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看无限网卡名称及状态\nip a\n\n# 若无限网卡未打开，则开启\nip link set interface_name up\n\n# 查看可用的wifi\n# 建议直接从其他设备上查看wifi名称，不必从本地扫描搜索\n\n# 生成wifi配置\nwpa_passphrase 网络 密码 &gt; 文件\n\n# 连接wifi\nwpa_supplicant -c 文件 -i 接口 &amp;\n\n# 自动分配ip地址\ndhcpcd &amp;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>开启 ssh</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 开启ssh\n&#x2F;etc&#x2F;init.d&#x2F;sshd start\n# 设置livecd密码\npasswd\n# 注意远程连接时用户名不是livecd，而是root<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"磁盘分区\"><a href=\"#磁盘分区\" class=\"headerlink\" title=\"磁盘分区\"></a>磁盘分区</h2><p>详见</p>\n<p><a href=\"https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Disks/zh-cn\">gentoo wiki</a><br><a href=\"https://wiki.gentoo.org/wiki/Handbook:X86/Blocks/Disks/zh-cn\">gentoo handbook</a></p>\n<p>由于此处分配分区将牵扯到后面 fstab 的配置，如果你对此完全不了解，建议按最常规的方式划分。如果你有一台现成的 linux，可以仿照其分区，可以帮助后面配置 fstab。</p>\n<p>另外参考你的电脑配置。内存与交换空间之和（单位 G）最好大于 CPU 总线程数。</p>\n<p>以下是 GPT 格式分区，引导方式为 EFI。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">fdisk -l\n# 注意以下磁盘名nvme0n1，对于不同规格的硬盘不同\nfdisk &#x2F;dev&#x2F;nvme0n1\ng\n# 分区，具体操作略\nw\n# 注意以下分区格式将关系到部分软件，尤其是grub的安装配置。因此必须慎重选择。\n# 制作引导分区\nmkfs.fat -F32 &#x2F;dev&#x2F;nvme0n1p1\n# 制作主分区\nmkfs.ext4 &#x2F;dev&#x2F;nvme0n1p2\n# 制作交换分区\nmkswap &#x2F;dev&#x2F;nvme0n1p3\n# 启用交换\nswapon &#x2F;dev&#x2F;nvme0n1p3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>分区完毕后将主分区挂在到 livecd 提供的挂载点上。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mount &#x2F;dev&#x2F;nvme0n1p2 &#x2F;mnt&#x2F;gentoo<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"获取基础编译环境\"><a href=\"#获取基础编译环境\" class=\"headerlink\" title=\"获取基础编译环境\"></a>获取基础编译环境</h2><p>上述步骤已经为 gentoo 系统开辟了空间，下面将正式进入系统的编译安装阶段。</p>\n<p>由于 gentoo livecd 并不携带完整的编译环境，因此我们需要先往系统空间中放一个现成的编译环境，即 gentoo 基础编译环境。</p>\n<p>再次访问<a href=\"https://mirrors.tuna.tsinghua.edu.cn/\">清华镜像站</a>。</p>\n<p>Gentoo 的 stage3 包囊括了整套编译环境以及绝大多数 gentoo 基础工具。</p>\n<p><img src=\"2.png\" alt=\"stage3\"></p>\n<p>Gentoo stage3 包的类型包括但不限于以上几种。根据你所需要的桌面环境，查看其对应的 gentoo wiki，做出选择。其中无 systemd 表示使用 OpenRC。nomultilib 表示仅支持 64 位，一般不建议选择。</p>\n<p>本教程以 systemd kde 为例，因此选择下载以下几个包至<code>/mnt/gentoo</code>。</p>\n<p><img src=\"3.png\" alt=\"systemd stage3\"></p>\n<p>下载完毕后使用<code>sha512sum -c stage3-amd64-*.tar.xz.DIGESTS</code>校验文件，出现两个 ok 和两个 failed 为正常。并继续使用<code>tar xpvf stage3-*.tar.xz --xattrs-include=&#39;*.*&#39; --numeric-owner</code>解压文件。</p>\n<h2 id=\"设置编译选项\"><a href=\"#设置编译选项\" class=\"headerlink\" title=\"设置编译选项\"></a>设置编译选项</h2><p>配置<code>/mnt/gentoo/etc/portage/make.conf</code>。</p>\n<p>这是整个安装过程中最核心、最重要的一步。详情参考<a href=\"https://wiki.gentoo.org/wiki//etc/portage/make.conf\">Gentoo wiki</a>以及<a href=\"https://dev.gentoo.org/~zmedico/portage/doc/man/make.conf.5.html\">gentoo doc</a>。</p>\n<p>此处不再对大部分配置进行说明，仅给出笔者第一次安装 gentoo 时的配置（虽不完美，但在当时不存在错误）。只可参考，不可照抄。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">COMMON_FLAGS&#x3D;&quot;-march&#x3D;native -O2 -pipe&quot;\n\nCFLAGS&#x3D;&quot;$&#123;COMMON_FLAGS&#125;&quot;\nCXXFLAGS&#x3D;&quot;$&#123;COMMON_FLAGS&#125;&quot;\nFCFLAGS&#x3D;&quot;$&#123;COMMON_FLAGS&#125;&quot;\nFFLAGS&#x3D;&quot;$&#123;COMMON_FLAGS&#125;&quot;\n\nCHOST&#x3D;&quot;x86_64-pc-linux-gnu&quot;\n\nCONFIG_PROTECT&#x3D;&quot;&#x2F;var&#x2F;bind&quot;\n\nPORTDIR&#x3D;&quot;&#x2F;var&#x2F;db&#x2F;repos&#x2F;gentoo&quot;\nDISTDIR&#x3D;&quot;&#x2F;var&#x2F;cache&#x2F;distfiles&quot;\nPKGDIR&#x3D;&quot;&#x2F;var&#x2F;cache&#x2F;binpkgs&quot;\n\nLC_MESSAGES&#x3D;C\n\nMAKEOPTS&#x3D;&quot;-j9&quot;\n\nGENTOO_MIRRORS&#x3D;&quot;https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;gentoo&quot;\n\nPORTAGE_TMPDIR&#x3D;&quot;&#x2F;var&#x2F;tmp&quot;\n\nDISTDIR&#x3D;&#x2F;var&#x2F;gentoo&#x2F;distfiles\n\nACCEPT_LICENSE&#x3D;&quot;*&quot;\n\nVIDEO_CARDS&#x3D;&quot;radeon&quot;\n\nL10N&#x3D;&quot;en_US en zh zh_CN&quot;\n\nLINGUAS&#x3D;&quot;en-US zh-CN en zh&quot;\n\nAUTO_CLEAN&#x3D;&quot;yes&quot;\n\nGRUB_PLATFORMS&#x3D;&quot;efi-64&quot;\n\nEMERGE_DEFAULT_OPTS&#x3D;&quot;--with-bdeps&#x3D;y --ask --verbose&#x3D;y --load-average --keep-going&quot;\n\nINPUT_DEVICES&#x3D;&quot;libinput synaptics evdev&quot;\n\nUSE&#x3D;&quot;X alsa clang udev dbus polkit udisks vulkan vdpau vaapi glamor nls&quot;\n\nKEYWORDS&#x3D;&quot;amd64&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>下面对其中的几个选项做简略介绍。</p>\n<p><code>GENTOO_MIRRORS</code>：建议选清华源。虽然清华源的速度中规中矩，时不时还出点问题。但 gentoo 在中国境内的源很少，应该也只有清华源在及时更新。</p>\n<p><code>EMERGE_DEFAULT_OPTS</code>：建议添加，可大大减小 emerge 指令长度。</p>\n<p><code>INPUT_DEVICES</code>：绝不可缺。否则会引起键盘、觸控板、鼠标失效等等问题。</p>\n<p><code>KEYWORDS</code>：不要在这里开启测试分支。</p>\n<p><code>MAKEOPTS</code>：建议等于 CPU 线程数+1。这样计算机在编译软件时尚有余力编译另外的软件或者进行其他操作。</p>\n<h2 id=\"进一步配置\"><a href=\"#进一步配置\" class=\"headerlink\" title=\"进一步配置\"></a>进一步配置</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">mkdir --parents &#x2F;mnt&#x2F;gentoo&#x2F;etc&#x2F;portage&#x2F;repos.conf\ncp &#x2F;mnt&#x2F;gentoo&#x2F;usr&#x2F;share&#x2F;portage&#x2F;config&#x2F;repos.conf &#x2F;mnt&#x2F;gentoo&#x2F;etc&#x2F;portage&#x2F;repos.conf&#x2F;gentoo.conf\ncp --dereference &#x2F;etc&#x2F;resolv.conf &#x2F;mnt&#x2F;gentoo&#x2F;etc&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>修改<code>/mnt/gentoo/etc/portage/repos.conf/gentoo.conf</code>配置 portage 镜像源</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sync-uri &#x3D; rsync:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;gentoo-portage<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"进入新系统\"><a href=\"#进入新系统\" class=\"headerlink\" title=\"进入新系统\"></a>进入新系统</h2><ul>\n<li>挂载剩余文件系统</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mount --types proc &#x2F;proc &#x2F;mnt&#x2F;gentoo&#x2F;proc\nmount --rbind &#x2F;sys &#x2F;mnt&#x2F;gentoo&#x2F;sys\nmount --make-rslave &#x2F;mnt&#x2F;gentoo&#x2F;sys\nmount --rbind &#x2F;dev &#x2F;mnt&#x2F;gentoo&#x2F;dev\nmount --make-rslave &#x2F;mnt&#x2F;gentoo&#x2F;dev<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>chroot 登陆新系统</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">chroot &#x2F;mnt&#x2F;gentoo &#x2F;bin&#x2F;bash\nsource &#x2F;etc&#x2F;profile\nexport PS1&#x3D;&quot;(chroot) $&#123;PS1&#125;&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>挂载 boot 分区</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mount &#x2F;dev&#x2F;nvme0n1p1 &#x2F;boot<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"配置-Portage\"><a href=\"#配置-Portage\" class=\"headerlink\" title=\"配置 Portage\"></a>配置 Portage</h2><ul>\n<li>下载数据库快照</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge-webrsync<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>选择 profile</li>\n</ul>\n<p>profile 简单的说就是一系列 USE flag 等配置的集合。这将是新系统的主体配置。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 先列出可用的profile，带星号是目前选择的\neselect profile list\n# 选择你需要的profile（可以从gentoo wiki获得信息）。这里选择kde桌面对应的profile\neselect profile set default&#x2F;linux&#x2F;amd64&#x2F;17.1&#x2F;desktop&#x2F;plasma&#x2F;systemd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>17.0 与 17.1 版本差距并不是非常大，如果不想深究，可以随意选择。</p>\n<h2 id=\"系统工具优化\"><a href=\"#系统工具优化\" class=\"headerlink\" title=\"系统工具优化\"></a>系统工具优化</h2><p>所谓工欲善其事，必先利其器。因此在正式编译系统之前，先进行部分工具的完善。</p>\n<h3 id=\"编辑器\"><a href=\"#编辑器\" class=\"headerlink\" title=\"编辑器\"></a>编辑器</h3><p>如果你不喜欢 stage3 中解压出来的 nano，可以优先安装一款自己喜欢的编辑器。</p>\n<h3 id=\"git\"><a href=\"#git\" class=\"headerlink\" title=\"git\"></a>git</h3><p>使用 git 同步 portage。</p>\n<p>优点：大大提高同步速度。</p>\n<p>缺点：略占用更多空间。</p>\n<p>安装 git，不赘述。</p>\n<p>修改当前系统的<code>/etc/portage/repos.conf/gentoo.conf</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[gentoo]\nsync-type &#x3D; git\nsync-uri &#x3D; https:&#x2F;&#x2F;github.com&#x2F;gentoo-mirror&#x2F;gentoo<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 移除之前同步的portage\nrm -rf &#x2F;mnt&#x2F;gentoo&#x2F;var&#x2F;db&#x2F;repos&#x2F;gentoo&#96;\n# 同步portage\n&#96;emerge --sync&#96;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"gentoolkit\"><a href=\"#gentoolkit\" class=\"headerlink\" title=\"gentoolkit\"></a>gentoolkit</h3><p>安装 gentoolkit，不赘述。</p>\n<ul>\n<li>常用指令</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看已经enable的USE flag\neuse -a -g或者euse -a -l\n# 激活USE flag\neuse -E flagname\n# 关闭USE flag\neuse -D flagname\n# 注意不可单独使用euse -D或者euse -E。这将作用到所有的USE flag。\n# 查看指定包的use标志\nequery --nocolor uses &#x3D;gnumeric-1.12.31\n# 清理源代码\neclean-dist\n# 清理二进制包\neclean-pkg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>eclean 说明</li>\n</ul>\n<p>默认情况下当前存储库中的任何 ebuild 相对应的源文件和二进制包都不会被删除。</p>\n<p>可以通过同时使用 <code>--deep</code> 和 <code>--package-names</code> 选项指定删除当前存储库中 ebuild 对应的源文件和二进制包。</p>\n<h3 id=\"安装-layman\"><a href=\"#安装-layman\" class=\"headerlink\" title=\"安装 layman\"></a>安装 layman</h3><p>layman 是一个优秀的 gentoo overlay 管理工具。eix-sync 指令中也集成了<code>layman -S</code>指令。</p>\n<p>详情见<a href=\"https://wiki.gentoo.org/wiki/Layman\">gentoo wiki</a>。</p>\n<ul>\n<li>layman 安装</li>\n</ul>\n<p>建议开启的 USE flag 有 git、sync-plugin-portage。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask app-portage&#x2F;layman\nmkdir &#x2F;etc&#x2F;portage&#x2F;repos.conf\nlayman-updater -R<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>相关指令</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">layman -L # 显示存储库列表\nlayman -a &lt;name&gt; # 从本地列表添加存储库\nlayman -o &lt;url of repository xml file&gt; -f -a &lt;name&gt; # 添加非官方存储库\nlayman -d &lt;name&gt; # 删除存储库\nlayman -s &lt;name&gt; # 更新存储库\nlayman -S # 更新所有存储库<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"安装-eix\"><a href=\"#安装-eix\" class=\"headerlink\" title=\"安装 eix\"></a>安装 eix</h3><p>详情见<a href=\"https://wiki.gentoo.org/wiki/Eix\">gentoo wiki</a>。</p>\n<p>eix 在教程的前面的内容中已经提及并作简要介绍。</p>\n<ul>\n<li>eix 安装</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge app-portage&#x2F;eix\neix-update\neix-sync<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>使用<code>eix-sync</code>代替<code>emerge --sync</code>，可以在同步数据库后自动更新 eix 的缓存。</p>\n<p>修改<code>/etc/eix-sync.conf</code>，写入<code>*</code>，以同步 ebuild 存储库。</p>\n<ul>\n<li>相关指令</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 搜索包\neix name\n# 搜索本地包\neix -I name\n# 在软件包描述文件中搜索，-c用于输出紧凑的结果\neix -S -c name\n# 在包类别中搜索\neix -C name\n# 搜索许可证\neix -Cc games-rpg -L &quot;EULA&quot;\n# 排除结果\neix --not -L &quot;EULA&quot;\n# 搜索过时的包\neix-test-obsolete<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"安装-ccache\"><a href=\"#安装-ccache\" class=\"headerlink\" title=\"安装 ccache\"></a>安装 ccache</h3><p>ccache 原理是缓存编译时的中间结果，当重新编译时就可以大大减少编译时间。其应用场景主要为编译失败后修改配置，然后再次编译。此时之前编译的有效内容可以直接被利用，这部分将以极快的速度完成编译。但是第一次运行 ccache 时，会拖慢编译速度。</p>\n<ul>\n<li>ccache 安装</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask ccache\nmkdir -p &#x2F;var&#x2F;cache&#x2F;ccache\nchown root:portage &#x2F;var&#x2F;cache&#x2F;ccache&#x2F;\nchmod 2775 &#x2F;var&#x2F;cache&#x2F;ccache&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>修改<code>/etc/portage/make.conf</code>。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">FEATURES&#x3D;&quot;ccache&quot;\nCCACHE_DIR&#x3D;&quot;&#x2F;var&#x2F;cache&#x2F;ccache&quot;\nCCACHE_SIZE&#x3D;&quot;16G&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"开启-32-位库支持\"><a href=\"#开启-32-位库支持\" class=\"headerlink\" title=\"开启 32 位库支持\"></a>开启 32 位库支持</h3><p>Gentoo 官方并不建议使用纯 64 位模式。其最现实的原因是几乎无法改回兼容 32 位的模式。因此对于新手而言，强烈建议选择兼容 32 位的模式。</p>\n<p>然而之前下载 stage3 包虽不是 nomultilib，但并不完全适配 32 位编译环境，需要手动修复。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask --verbose db\n\n# 编辑&#x2F;etc&#x2F;portage&#x2F;package.use&#x2F;abi_x86_32，写入\n\nsys-libs&#x2F;zlib abi_x86_32\n\n# 编辑&#x2F;etc&#x2F;portage&#x2F;make.conf，写入\n\nABI_X86&#x3D;&quot;32 64&quot;\n\nemerge --ask --verbose zlib<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"局域网编译与打包分发\"><a href=\"#局域网编译与打包分发\" class=\"headerlink\" title=\"局域网编译与打包分发\"></a>局域网编译与打包分发</h3><p>Gentoo 可以联合局域网下的多台主机一起编译，也可以将本地编译好的包打包分发。</p>\n<p>考虑到一般个人用户不太会用到这些功能，此处不赘述。详情见<a href=\"https://wiki.gentoo.org/wiki/Handbook:Parts/Full/Working/zh-cn#.E5.B0.86.E9.A2.84.E6.9E.84.E5.BB.BA.E7.9A.84.E8.BD.AF.E4.BB.B6.E5.8C.85.E5.88.86.E5.8F.91.E7.BB.99.E4.BB.96.E4.BA.BA\">gentoo handbook</a>，<a href=\"https://docs.huihoo.com/gentoo/resources/document-listing/distcc.html\">gentoo doc</a>以及<a href=\"https://wiki.gentoo.org/wiki/Distcc/zh-cn\">gentoo wiki</a>。</p>\n<h2 id=\"配置时间和区域\"><a href=\"#配置时间和区域\" class=\"headerlink\" title=\"配置时间和区域\"></a>配置时间和区域</h2><p>时间与区域可以在之后配置，此处提前配置主要是为了方便某些 GFW 偷渡者。PS：这种东西很重要，甚至直接关系到能否成功安装，但得你自己想办法。</p>\n<ul>\n<li>时区</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">\necho Asia&#x2F;Shanghai &gt; &#x2F;etc&#x2F;timezone emerge --config sys-libs&#x2F;timezone-data<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>区域</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">\n# 生成中英文 locale.gen\n\necho &#39;zh_CN.UTF-8 UTF-8&#39; &gt;&gt; &#x2F;etc&#x2F;locale.gen\necho &#39;en_US.UTF-8 UTF-8&#39; &gt;&gt; &#x2F;etc&#x2F;locale.gen\nlocale-gen\n\n# 列出可用的区域\n\neselect locale list\n\n# 选择英文区域的编号\n\neselect locale set 3\n\n# 重新加载环境变量\n\nenv-update &amp;&amp; source &#x2F;etc&#x2F;profile &amp;&amp; export PS1&#x3D;&quot;(chroot) \\$&#123;PS1&#125;&quot;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意上述操作可能导致系统时间发生错误，可以手动纠正。但这可能导致/usr/bin/git 时间错误，致于无法安装 systemd。重装 git 可解决上述问题。</p>\n<ul>\n<li>时间修正</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看时间是否正确\n\nhwclock\ndate\ndate -s 2020&#x2F;03&#x2F;09\ndate -s 11:50:30\nhwclock -w\n\n# 自动更新，但此时暂不可用\n\ntimedatectl set-ntp true<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"重新编译-gcc\"><a href=\"#重新编译-gcc\" class=\"headerlink\" title=\"重新编译 gcc\"></a>重新编译 gcc</h2><p>为获取最适配本机的编译器，必须先配置并重新编译 gcc。即使你选择 clang 作为主编译器，也应当重新编译 gcc 的稳定分支。</p>\n<p>警告：此处配置编译需要万分小心。一旦出现不当，损坏编译器，就会很麻烦。如果真的遇到这种情况，也无需慌张。通过直接安装已编译完成的正常的 gcc 二进制包救场即可。</p>\n<ul>\n<li>USE flag</li>\n</ul>\n<p>根据需求配置，以下仅为参考。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">fortran nls nptl openmp pch sanitize ssp lto<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>编译 gcc</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 更新Portage\neix-sync\n# 编译安装gcc\nemerge --ask gcc\n# 如果编译了新版本的gcc，继续进行下列操作。\n# 查看可用gcc版本\ngcc-config --list-profiles\n# 选择新编译出来的gcc\ngcc-config 2\nsource &#x2F;etc&#x2F;profile\nexport PS1&#x3D;&quot;(chroot) $&#123;PS1&#125;&quot;\nemerge --ask --oneshot --usepkg&#x3D;n sys-devel&#x2F;libtool\n# 检查当前gcc版本\ngcc -v\n# 如果需要拆卸旧版本\nemerge --ask --depclean &#x3D;sys-devel&#x2F;gcc-9.3.0\n# 验证系统完整性\nrevdep-rebuild\n# 重新编译部分包\nemerge --ask --oneshot --usepkg&#x3D;n --verbose sys-devel&#x2F;llvm sys-devel&#x2F;clang\n# 如果有问题可以重新构建系统\nemerge --ask --emptytree --usepkg&#x3D;n @system<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"安装-clang\"><a href=\"#安装-clang\" class=\"headerlink\" title=\"安装 clang\"></a>安装 clang</h2><p>笔者使用 clang 作为主编译器。即使你使用 gcc 作为主编译器，也可以选择安装 clang 解决部分编译错误问题（这在<a href=\"https://www.niuiic.top/2020/08/06/gentoo-compile-error-handling/\">Gentoo Compile Error Handling</a>一文中已作介绍）。</p>\n<p>重新编译整个系统。如果你不使用 clang 作为主编译器或者觉得没有必要，可以跳过此步。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask --emptytree --usepkg&#x3D;n @system<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"更新配置\"><a href=\"#更新配置\" class=\"headerlink\" title=\"更新配置\"></a>更新配置</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\"># 将数据库更新到最近一小时\neix-sync\nemerge --oneshot sys-apps&#x2F;portage<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>至此，所有准备工作都已进行完毕。</p>\n<h2 id=\"更新-world\"><a href=\"#更新-world\" class=\"headerlink\" title=\"更新@world\"></a>更新@world</h2><p>编译安装所有在配置中需要的软件。但在此之前，需要先安装内核源代码提供内核版本信息。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge sys-kernel&#x2F;gentoo-sources\nemerge --deep --with-bdeps&#x3D;y --changed-use --update --ask --verbose --keep-going @world<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"配置-fstab\"><a href=\"#配置-fstab\" class=\"headerlink\" title=\"配置 fstab\"></a>配置 fstab</h2><p>fstab 简单的说就是系统启动时挂载文件系统的配置文件。</p>\n<p>由 fstab 引起的常见错误有文件系统挂载为只读模式，无法写入任何文件等。</p>\n<p>这里不介绍 fstab 的具体配置方法。有需要的参考<a href=\"https://wiki.gentoo.org/wiki/Fstab\">gentoo wiki</a>。</p>\n<p>前面提到，如果有现成的 linux 系统，完全可以仿照其分区方式。主要就是为了 copy 现成的<code>/etc/fstab</code>。</p>\n<p>比如获得的文件如下</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">UUID&#x3D;e5bc0d97-ac5c-400c-b26e-137cefe6ae68       &#x2F;               ext4            rw,relatime     0 1\n\nUUID&#x3D;B320-B5C7          &#x2F;boot           vfat            rw,relatime,fmask&#x3D;0022,dmask&#x3D;0022,codepage&#x3D;437,iocharset&#x3D;iso8859-1,shortname&#x3D;mixed,utf8,errors&#x3D;remount-ro       0 2\n\nUUID&#x3D;c4b396e5-cb87-42dc-b44e-4b26661e5cc0       none            swap            defaults        0 0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>使用<code>blkid</code>获取文件系统的 UUID，替换文件中的 UUID 即可。</p>\n<h2 id=\"内核编译\"><a href=\"#内核编译\" class=\"headerlink\" title=\"内核编译\"></a>内核编译</h2><p>Gentoo 内核复杂点主要在于各选项的配置。此处不会介绍相关具体内容，只是提供一种投机取巧的方法。</p>\n<p>具体的内核选项配置，参考<a href=\"https://wiki.gentoo.org/wiki/Kernel/Gentoo_Kernel_Configuration_Guide\">gentoo wiki</a>。</p>\n<h3 id=\"自动编译内核\"><a href=\"#自动编译内核\" class=\"headerlink\" title=\"自动编译内核\"></a>自动编译内核</h3><p>自动编译内核会开启大部分选项。不过如果不是对性能与简洁有极致的要求，着实是可以接受的。</p>\n<ul>\n<li>安装内核编译工具</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge sys-kernel&#x2F;genkernel<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>选择内核版本</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看源代码列表\neselect kernel list\n# 选择\neselect kernel set number<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>自动编译内核</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">genkernel all<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"手动编译内核\"><a href=\"#手动编译内核\" class=\"headerlink\" title=\"手动编译内核\"></a>手动编译内核</h3><ul>\n<li>安装内核配置工具</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask sys-apps&#x2F;pciutils<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>查看功能</li>\n</ul>\n<p>通过<code>lsmod</code>命令来查看当前所处的 Gentoo Live 镜像开启的功能，这可以作为我们在配置内核时的重要参考。</p>\n<ul>\n<li>配置</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 进入源码菜单\ncd &#x2F;usr&#x2F;src&#x2F;linux\n# 打开配置工具\nmake menuconfig<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>按需求配置即可。</p>\n<p>把上面所有必选项都配置好之后，选择 save 保存配置文件，然后 exit 退出。默认配置文件名是.config，但是最好手动复制一个备份，有时候默认名称的配置文件会莫名丢失，只能重头再配置一次。然后就可以开始编译和安装。</p>\n<ul>\n<li>编译安装内核</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">make\nmake modules_install\nmake install<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>投机取巧的方法</li>\n</ul>\n<p>先自动编译内核，等到输出信息显示配置完毕后打断进程，进入源码菜单，修改配置文件即可。这至少将提供一份正确的配置方案，在此基础上修改将节省大量时间。</p>\n<h2 id=\"安装-firmware-和-initrampfs\"><a href=\"#安装-firmware-和-initrampfs\" class=\"headerlink\" title=\"安装 firmware 和 initrampfs\"></a>安装 firmware 和 initrampfs</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask sys-kernel&#x2F;linux-firmware\n# 如果是自动安装内核，则不需要下一步\ngenkernel --install initramfs<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"配置系统\"><a href=\"#配置系统\" class=\"headerlink\" title=\"配置系统\"></a>配置系统</h2><p>此处的系统配置基于 Systemd，如果你使用的是 OpenRC，部分配置将不适用。</p>\n<h3 id=\"网络配置\"><a href=\"#网络配置\" class=\"headerlink\" title=\"网络配置\"></a>网络配置</h3><ul>\n<li>修改<code>/etc/hostname</code></li>\n</ul>\n<p>设置主机名</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">yourname<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>修改<code>/etc/hosts</code></li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 定义的是现在系统，假设主机名为tux\n127.0.0.1     localhost\n::1 \t\t  localhost\n127.0.1.1 \t  name.localdomain name<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>网络工具的安装</li>\n</ul>\n<p>如果你想在安装完毕基础系统后不再使用 livecd，就需要先安装基础网络工具。之后等桌面环境安装完毕后，最终将采用 NetworkManager 作为 wifi 配置连接工具。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge net-wireless&#x2F;wpa_supplicant dhcpcd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"设置密码\"><a href=\"#设置密码\" class=\"headerlink\" title=\"设置密码\"></a>设置密码</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">passwd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>需要 8 字符及以上。</p>\n<p>也可以修改<code>/etc/pam.d/system-auth</code>，将<code>min=8,8,8,8,8 retry=3</code>中所有的 8 改为 1。</p>\n<h3 id=\"部分系统工具的安装\"><a href=\"#部分系统工具的安装\" class=\"headerlink\" title=\"部分系统工具的安装\"></a>部分系统工具的安装</h3><ul>\n<li>日志工具</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask app-admin&#x2F;syslog-ng\nsystemctl enable syslog-ng@default<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>远程登录</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">systemctl enable sshd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>文件系统工具</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask sys-fs&#x2F;dosfstools sys-fs&#x2F;e2fsprogs<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"添加用户\"><a href=\"#添加用户\" class=\"headerlink\" title=\"添加用户\"></a>添加用户</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">useradd -m -G users,wheel,audio -s &#x2F;bin&#x2F;bash username\npasswd username # 需要三个单词，总长度大于8个字符<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"磁盘清理\"><a href=\"#磁盘清理\" class=\"headerlink\" title=\"磁盘清理\"></a>磁盘清理</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">rm &#x2F;stage3-*.tar.*<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"安装系统引导器\"><a href=\"#安装系统引导器\" class=\"headerlink\" title=\"安装系统引导器\"></a>安装系统引导器</h2><ul>\n<li>安装 grub</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask --verbose sys-boot&#x2F;grub:2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>将 grub 安装到系统中</li>\n</ul>\n<p>注意如果你不是 efi 引导，需要修改下列命令。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">grub-install --target&#x3D;x86_64-efi --efi-directory&#x3D;&#x2F;boot\ngrub-mkconfig -o &#x2F;boot&#x2F;grub&#x2F;grub.cfg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h3 id=\"安装配置-sudo\"><a href=\"#安装配置-sudo\" class=\"headerlink\" title=\"安装配置 sudo\"></a>安装配置 sudo</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --ask sudo\nnvim &#x2F;etc&#x2F;sudoers\n# 在root ALL&#x3D;(ALL) ALL下添加新的用户<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"配置-sshd\"><a href=\"#配置-sshd\" class=\"headerlink\" title=\"配置 sshd\"></a>配置 sshd</h3><p>修改<code>/etc/ssh/sshd_config</code>，做以下修改。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Port 22\nPermitRootLogin yes\nPasswordAuthentication yes<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"开启-SysRq\"><a href=\"#开启-SysRq\" class=\"headerlink\" title=\"开启 SysRq\"></a>开启 SysRq</h3><p>修改<code>/etc/sysctl.conf</code>。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">kernel.sysrq &#x3D; 1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>至此，Gentoo 基础系统已经安装完毕。退出 chroot，重启检查是否有误。</p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/08/gentoo-kool-desktop-environment-installation/\">Gentoo Kool Desktop Environment Installation</a></p>\n"},{"title":"Gentoo Compile Error Handling","date":"2020-08-06T00:26:07.000Z","_content":"\n[Gentoo教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 编译错误解决方案\n\n本文介绍软件编译错误的常用解决方案。仅限于 gentoo 系统提供的操作，不涉及源代码层面的 bug 修复等内容。\n\n## 找出错误\n\n无论发生什么错误，知道是什么错误都是第一步。\n\ngentoo 的 emerge 指令会在编译过程中输出 log，且在编译失败后打印错误信息以及日志文件地址等内容。及时查看并找到错误点是解决问题的第一步，也是最重要的一步。\n\n## 分析错误\n\n这里指的编译错误分为三类：编译前错误、编译期错误、安装期错误。\n\n编译前错误五花八门，但解决难度一般较低，除非是严重的依赖问题。这类问题中大部分已经在[Gentoo Package Management](https://www.niuiic.top/2020/08/05/gentoo-package-management/)一文中提及。这里不赘述。\n\n编译期错误一般不会显示在最后的报错信息中，需要自行到 log 中查找。这类错误一般看起来像是源代码本身的 bug，但实际上绝大多数不过是编译选项、软件选项、编译器选择的问题。这类问题将在下文中作详细讨论。\n\n安装期错误是最让人摸不着头脑的。这类错误也并无统一的解决方案。通常遇到这种错误时，第一时间使用 google 或其他搜索引擎搜索该错误信息。如果没有满意的结果，建议直接向打包者或源代码作者寻求帮助。当然如果你对 linux 系统的了解比较深，可能可以自行解决部分问题。\n\n## 解决错误的一般方案\n\n如前所述，这里的解决方案针对编译期错误。建议参考下列方案的列写顺序以及错误信息的分析结果有顺序地进行尝试。\n\n- 重试\n\n重试看起来无效，但事实上是可能解决问题的。若重试一次无效，则无需再试。\n\n- 利用搜索引擎\n\n使用搜索引擎直接搜索错误信息是效率最高的搜索方法。但需要注意以下几点。\n\n优先使用英文搜索，再考虑中文。\n\n优先使用 google 搜索，再考虑其他。\n\n如果错误信息看起来与 gentoo 无关联，则在适当位置加入 gentoo 关键字。\n\n- 更换编译器\n\ngcc 和 clang 互换，或者不同版本的同一编译器互换。这在用 clang 或者测试分支的 gcc 作为主编译器的情况下非常有效。\n\n- 减小编译线程数\n\n部分软件编译过程产生的临时文件过大，内存和交换无法负载，就会导致编译失败。\n\n- 设置编译选项\n\n主要是关闭编译优化。\n\n但是还有一些特殊情况，该软件对 CC 及 CXX 的设置要求比较苛刻。比如`app-text/enchant-1.6.1-r1`，其要求的设置如下。\n\n```\nCC=x86_64-pc-linux-gnu-gcc\nCXX=x86_64-pc-linux-gnu-g++\n```\n\n- 设置软件选项\n\n主要是 USE flag。一般通过错误信息判断可能是哪个 USE flag 管理的功能编译出错，将其禁用即可。\n\n- 控制软件版本\n\n升级或降级。\n\n- 打补丁\n\n前面使用搜索引擎搜索时注意某些软件可能已经给出修复 bug 的补丁。但这些补丁并未直接加入 ebuild。这时需要手动添加。\n\n以`x11-misc/pcmanfm-1.2.5`为例。`mkdir -p /etc/portage/patches/x11-misc/pcmanfm-1.2.5`。然后将补丁放在该目录下，重新编译即可。\n\n- 等待上游修复 bug\n\n看起来是个逃避问题的选择，但实际上是相当常用且实用的方案。\n\n## 解决错误的高级方案\n\n以上方案已经足以应对绝大多数编译错误。剩下的部分问题，除了源代码的 bug，其他的基本都可以使用重写 ebuild 解决。这将在后面的文章中介绍。\n\n下一篇：[Gentoo Basic System Installation](https://www.niuiic.top/2020/08/07/gentoo-basic-system-installation/)\n","source":"_posts/gentoo-compile-error-handling.md","raw":"---\ntitle: Gentoo Compile Error Handling\ndate: 2020-08-06 08:26:07\ntags:\n\t\t- Gentoo\ncategories:\n\t\t- Gentoo\n---\n\n[Gentoo教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 编译错误解决方案\n\n本文介绍软件编译错误的常用解决方案。仅限于 gentoo 系统提供的操作，不涉及源代码层面的 bug 修复等内容。\n\n## 找出错误\n\n无论发生什么错误，知道是什么错误都是第一步。\n\ngentoo 的 emerge 指令会在编译过程中输出 log，且在编译失败后打印错误信息以及日志文件地址等内容。及时查看并找到错误点是解决问题的第一步，也是最重要的一步。\n\n## 分析错误\n\n这里指的编译错误分为三类：编译前错误、编译期错误、安装期错误。\n\n编译前错误五花八门，但解决难度一般较低，除非是严重的依赖问题。这类问题中大部分已经在[Gentoo Package Management](https://www.niuiic.top/2020/08/05/gentoo-package-management/)一文中提及。这里不赘述。\n\n编译期错误一般不会显示在最后的报错信息中，需要自行到 log 中查找。这类错误一般看起来像是源代码本身的 bug，但实际上绝大多数不过是编译选项、软件选项、编译器选择的问题。这类问题将在下文中作详细讨论。\n\n安装期错误是最让人摸不着头脑的。这类错误也并无统一的解决方案。通常遇到这种错误时，第一时间使用 google 或其他搜索引擎搜索该错误信息。如果没有满意的结果，建议直接向打包者或源代码作者寻求帮助。当然如果你对 linux 系统的了解比较深，可能可以自行解决部分问题。\n\n## 解决错误的一般方案\n\n如前所述，这里的解决方案针对编译期错误。建议参考下列方案的列写顺序以及错误信息的分析结果有顺序地进行尝试。\n\n- 重试\n\n重试看起来无效，但事实上是可能解决问题的。若重试一次无效，则无需再试。\n\n- 利用搜索引擎\n\n使用搜索引擎直接搜索错误信息是效率最高的搜索方法。但需要注意以下几点。\n\n优先使用英文搜索，再考虑中文。\n\n优先使用 google 搜索，再考虑其他。\n\n如果错误信息看起来与 gentoo 无关联，则在适当位置加入 gentoo 关键字。\n\n- 更换编译器\n\ngcc 和 clang 互换，或者不同版本的同一编译器互换。这在用 clang 或者测试分支的 gcc 作为主编译器的情况下非常有效。\n\n- 减小编译线程数\n\n部分软件编译过程产生的临时文件过大，内存和交换无法负载，就会导致编译失败。\n\n- 设置编译选项\n\n主要是关闭编译优化。\n\n但是还有一些特殊情况，该软件对 CC 及 CXX 的设置要求比较苛刻。比如`app-text/enchant-1.6.1-r1`，其要求的设置如下。\n\n```\nCC=x86_64-pc-linux-gnu-gcc\nCXX=x86_64-pc-linux-gnu-g++\n```\n\n- 设置软件选项\n\n主要是 USE flag。一般通过错误信息判断可能是哪个 USE flag 管理的功能编译出错，将其禁用即可。\n\n- 控制软件版本\n\n升级或降级。\n\n- 打补丁\n\n前面使用搜索引擎搜索时注意某些软件可能已经给出修复 bug 的补丁。但这些补丁并未直接加入 ebuild。这时需要手动添加。\n\n以`x11-misc/pcmanfm-1.2.5`为例。`mkdir -p /etc/portage/patches/x11-misc/pcmanfm-1.2.5`。然后将补丁放在该目录下，重新编译即可。\n\n- 等待上游修复 bug\n\n看起来是个逃避问题的选择，但实际上是相当常用且实用的方案。\n\n## 解决错误的高级方案\n\n以上方案已经足以应对绝大多数编译错误。剩下的部分问题，除了源代码的 bug，其他的基本都可以使用重写 ebuild 解决。这将在后面的文章中介绍。\n\n下一篇：[Gentoo Basic System Installation](https://www.niuiic.top/2020/08/07/gentoo-basic-system-installation/)\n","slug":"gentoo-compile-error-handling","published":1,"updated":"2021-03-23T11:11:18.579Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmrn000xrrizg81ne4wp","content":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo教程目录</a></p>\n<h1 id=\"Gentoo-编译错误解决方案\"><a href=\"#Gentoo-编译错误解决方案\" class=\"headerlink\" title=\"Gentoo 编译错误解决方案\"></a>Gentoo 编译错误解决方案</h1><p>本文介绍软件编译错误的常用解决方案。仅限于 gentoo 系统提供的操作，不涉及源代码层面的 bug 修复等内容。</p>\n<h2 id=\"找出错误\"><a href=\"#找出错误\" class=\"headerlink\" title=\"找出错误\"></a>找出错误</h2><p>无论发生什么错误，知道是什么错误都是第一步。</p>\n<p>gentoo 的 emerge 指令会在编译过程中输出 log，且在编译失败后打印错误信息以及日志文件地址等内容。及时查看并找到错误点是解决问题的第一步，也是最重要的一步。</p>\n<h2 id=\"分析错误\"><a href=\"#分析错误\" class=\"headerlink\" title=\"分析错误\"></a>分析错误</h2><p>这里指的编译错误分为三类：编译前错误、编译期错误、安装期错误。</p>\n<p>编译前错误五花八门，但解决难度一般较低，除非是严重的依赖问题。这类问题中大部分已经在<a href=\"https://www.niuiic.top/2020/08/05/gentoo-package-management/\">Gentoo Package Management</a>一文中提及。这里不赘述。</p>\n<p>编译期错误一般不会显示在最后的报错信息中，需要自行到 log 中查找。这类错误一般看起来像是源代码本身的 bug，但实际上绝大多数不过是编译选项、软件选项、编译器选择的问题。这类问题将在下文中作详细讨论。</p>\n<p>安装期错误是最让人摸不着头脑的。这类错误也并无统一的解决方案。通常遇到这种错误时，第一时间使用 google 或其他搜索引擎搜索该错误信息。如果没有满意的结果，建议直接向打包者或源代码作者寻求帮助。当然如果你对 linux 系统的了解比较深，可能可以自行解决部分问题。</p>\n<h2 id=\"解决错误的一般方案\"><a href=\"#解决错误的一般方案\" class=\"headerlink\" title=\"解决错误的一般方案\"></a>解决错误的一般方案</h2><p>如前所述，这里的解决方案针对编译期错误。建议参考下列方案的列写顺序以及错误信息的分析结果有顺序地进行尝试。</p>\n<ul>\n<li>重试</li>\n</ul>\n<p>重试看起来无效，但事实上是可能解决问题的。若重试一次无效，则无需再试。</p>\n<ul>\n<li>利用搜索引擎</li>\n</ul>\n<p>使用搜索引擎直接搜索错误信息是效率最高的搜索方法。但需要注意以下几点。</p>\n<p>优先使用英文搜索，再考虑中文。</p>\n<p>优先使用 google 搜索，再考虑其他。</p>\n<p>如果错误信息看起来与 gentoo 无关联，则在适当位置加入 gentoo 关键字。</p>\n<ul>\n<li>更换编译器</li>\n</ul>\n<p>gcc 和 clang 互换，或者不同版本的同一编译器互换。这在用 clang 或者测试分支的 gcc 作为主编译器的情况下非常有效。</p>\n<ul>\n<li>减小编译线程数</li>\n</ul>\n<p>部分软件编译过程产生的临时文件过大，内存和交换无法负载，就会导致编译失败。</p>\n<ul>\n<li>设置编译选项</li>\n</ul>\n<p>主要是关闭编译优化。</p>\n<p>但是还有一些特殊情况，该软件对 CC 及 CXX 的设置要求比较苛刻。比如<code>app-text/enchant-1.6.1-r1</code>，其要求的设置如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CC&#x3D;x86_64-pc-linux-gnu-gcc\nCXX&#x3D;x86_64-pc-linux-gnu-g++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>设置软件选项</li>\n</ul>\n<p>主要是 USE flag。一般通过错误信息判断可能是哪个 USE flag 管理的功能编译出错，将其禁用即可。</p>\n<ul>\n<li>控制软件版本</li>\n</ul>\n<p>升级或降级。</p>\n<ul>\n<li>打补丁</li>\n</ul>\n<p>前面使用搜索引擎搜索时注意某些软件可能已经给出修复 bug 的补丁。但这些补丁并未直接加入 ebuild。这时需要手动添加。</p>\n<p>以<code>x11-misc/pcmanfm-1.2.5</code>为例。<code>mkdir -p /etc/portage/patches/x11-misc/pcmanfm-1.2.5</code>。然后将补丁放在该目录下，重新编译即可。</p>\n<ul>\n<li>等待上游修复 bug</li>\n</ul>\n<p>看起来是个逃避问题的选择，但实际上是相当常用且实用的方案。</p>\n<h2 id=\"解决错误的高级方案\"><a href=\"#解决错误的高级方案\" class=\"headerlink\" title=\"解决错误的高级方案\"></a>解决错误的高级方案</h2><p>以上方案已经足以应对绝大多数编译错误。剩下的部分问题，除了源代码的 bug，其他的基本都可以使用重写 ebuild 解决。这将在后面的文章中介绍。</p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/07/gentoo-basic-system-installation/\">Gentoo Basic System Installation</a></p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo教程目录</a></p>\n<h1 id=\"Gentoo-编译错误解决方案\"><a href=\"#Gentoo-编译错误解决方案\" class=\"headerlink\" title=\"Gentoo 编译错误解决方案\"></a>Gentoo 编译错误解决方案</h1><p>本文介绍软件编译错误的常用解决方案。仅限于 gentoo 系统提供的操作，不涉及源代码层面的 bug 修复等内容。</p>\n<h2 id=\"找出错误\"><a href=\"#找出错误\" class=\"headerlink\" title=\"找出错误\"></a>找出错误</h2><p>无论发生什么错误，知道是什么错误都是第一步。</p>\n<p>gentoo 的 emerge 指令会在编译过程中输出 log，且在编译失败后打印错误信息以及日志文件地址等内容。及时查看并找到错误点是解决问题的第一步，也是最重要的一步。</p>\n<h2 id=\"分析错误\"><a href=\"#分析错误\" class=\"headerlink\" title=\"分析错误\"></a>分析错误</h2><p>这里指的编译错误分为三类：编译前错误、编译期错误、安装期错误。</p>\n<p>编译前错误五花八门，但解决难度一般较低，除非是严重的依赖问题。这类问题中大部分已经在<a href=\"https://www.niuiic.top/2020/08/05/gentoo-package-management/\">Gentoo Package Management</a>一文中提及。这里不赘述。</p>\n<p>编译期错误一般不会显示在最后的报错信息中，需要自行到 log 中查找。这类错误一般看起来像是源代码本身的 bug，但实际上绝大多数不过是编译选项、软件选项、编译器选择的问题。这类问题将在下文中作详细讨论。</p>\n<p>安装期错误是最让人摸不着头脑的。这类错误也并无统一的解决方案。通常遇到这种错误时，第一时间使用 google 或其他搜索引擎搜索该错误信息。如果没有满意的结果，建议直接向打包者或源代码作者寻求帮助。当然如果你对 linux 系统的了解比较深，可能可以自行解决部分问题。</p>\n<h2 id=\"解决错误的一般方案\"><a href=\"#解决错误的一般方案\" class=\"headerlink\" title=\"解决错误的一般方案\"></a>解决错误的一般方案</h2><p>如前所述，这里的解决方案针对编译期错误。建议参考下列方案的列写顺序以及错误信息的分析结果有顺序地进行尝试。</p>\n<ul>\n<li>重试</li>\n</ul>\n<p>重试看起来无效，但事实上是可能解决问题的。若重试一次无效，则无需再试。</p>\n<ul>\n<li>利用搜索引擎</li>\n</ul>\n<p>使用搜索引擎直接搜索错误信息是效率最高的搜索方法。但需要注意以下几点。</p>\n<p>优先使用英文搜索，再考虑中文。</p>\n<p>优先使用 google 搜索，再考虑其他。</p>\n<p>如果错误信息看起来与 gentoo 无关联，则在适当位置加入 gentoo 关键字。</p>\n<ul>\n<li>更换编译器</li>\n</ul>\n<p>gcc 和 clang 互换，或者不同版本的同一编译器互换。这在用 clang 或者测试分支的 gcc 作为主编译器的情况下非常有效。</p>\n<ul>\n<li>减小编译线程数</li>\n</ul>\n<p>部分软件编译过程产生的临时文件过大，内存和交换无法负载，就会导致编译失败。</p>\n<ul>\n<li>设置编译选项</li>\n</ul>\n<p>主要是关闭编译优化。</p>\n<p>但是还有一些特殊情况，该软件对 CC 及 CXX 的设置要求比较苛刻。比如<code>app-text/enchant-1.6.1-r1</code>，其要求的设置如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CC&#x3D;x86_64-pc-linux-gnu-gcc\nCXX&#x3D;x86_64-pc-linux-gnu-g++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>设置软件选项</li>\n</ul>\n<p>主要是 USE flag。一般通过错误信息判断可能是哪个 USE flag 管理的功能编译出错，将其禁用即可。</p>\n<ul>\n<li>控制软件版本</li>\n</ul>\n<p>升级或降级。</p>\n<ul>\n<li>打补丁</li>\n</ul>\n<p>前面使用搜索引擎搜索时注意某些软件可能已经给出修复 bug 的补丁。但这些补丁并未直接加入 ebuild。这时需要手动添加。</p>\n<p>以<code>x11-misc/pcmanfm-1.2.5</code>为例。<code>mkdir -p /etc/portage/patches/x11-misc/pcmanfm-1.2.5</code>。然后将补丁放在该目录下，重新编译即可。</p>\n<ul>\n<li>等待上游修复 bug</li>\n</ul>\n<p>看起来是个逃避问题的选择，但实际上是相当常用且实用的方案。</p>\n<h2 id=\"解决错误的高级方案\"><a href=\"#解决错误的高级方案\" class=\"headerlink\" title=\"解决错误的高级方案\"></a>解决错误的高级方案</h2><p>以上方案已经足以应对绝大多数编译错误。剩下的部分问题，除了源代码的 bug，其他的基本都可以使用重写 ebuild 解决。这将在后面的文章中介绍。</p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/07/gentoo-basic-system-installation/\">Gentoo Basic System Installation</a></p>\n"},{"title":"Gentoo Compiler Selection","date":"2020-08-05T14:50:35.000Z","_content":"\n[Gentoo教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 编译器选择\n\n本文介绍构建 gentoo 系统的编译器选择方案，及一些尤其引起的 bug 的解决方案，不涉及选择编译器的专业观点。\n\n## 简介\n\n众所周知 Gentoo 系统完全在本地构建。因此编译器的选择很大程度上决定了编译系统的耗时以及整个系统的性能。\n\n用于构建整个 Gentoo 系统的编译器只推荐两个，gcc 与 clang。\n\ngcc 由 GNU 出品，与 GNU linux 自然匹配度更高。因此选择 gcc 作为编译器是最稳妥的方案。\n\nclang 被苹果公司支持，近年来发展速度迅速，也具备许多 gcc 不具备的特性。但 clang 编译 linux 系统尚不稳定。\n\n目前，绝大多数使用 clang 编译出错的 bug 已有解决方案。但部分软件，比如 gcc、linux 内核等必须使用 gcc 构建。因此即便你选择 clang 作为主编译器，也必须保留 gcc 作为辅助编译器。\n\n## 使用 gcc 作为主编译器\n\ngcc 是 gentoo 的默认编译器，且比较稳定，这里不作太多说明。\n\n只是需要注意一点，测试分支的 gcc 存在许多不稳定因素，可能会造成编译错误。考虑到编译器对于系统的重要性，强烈建议保留稳定分支的 gcc。\n\n- gcc 版本选择\n\n```\n# 查看系统中的gcc版本\ngcc-config --list-profiles\n# 选择需要的gcc\ngcc-config number\n# 刷新配置\nsource /etc/profile\n```\n\n## 使用 clang 作为主编译器\n\n详见[gentoo wiki](https://wiki.gentoo.org/wiki/Clang)\n\n关于 clang 的安装，可以参考上面的链接。这里主要介绍将 clang 作为主编译器的必要配置。\n\n首先，在`make.conf`中作如下设置。\n\n```\nCC = clang\nCXX = clang++\n```\n\n此时，clang 已经成为系统的默认编译器。接下来设置备选方案，即当软件无法用 clang 编译时，使用 gcc 编译。\n\n在`/etc/portage/env`目录下创建`compiler-gcc`，写入\n\n```\nCC = gcc\nCXX = g++\n```\n\n然后在`/etc/portage/package.env`文件中写入如`sys-devel/gcc compiler-gcc`的内容，即可将该包的编译器设置为 gcc。\n\n这一步可以通过`app-portage/flaggie`工具自动完成。其指令为`flaggie app-foo/bar +compiler-gcc`。\n\n至此，配置完毕。当发现 clang 无法编译某软件而 gcc 可行时只需将其加入上述文件即可。\n\n## 编译选项\n\n这里的编译选项主要指优化选项。为提高系统性能，你可以设置编译优化选项。但由此带来的问题是编译时间大大增长，更容易遇到 bug，过多的或者不合理的优化选项导致性能反而下降。\n\n这里不介绍配置优化选项的具体内容，只通过大致的感受给出一个建议。基于亲身体会，优化与不优化差别并不大，至少以人的感官很难感觉出来。因此这里建议新手不要开启优化选项，至少是过多的优化选项，除非你是为了折腾。\n\n就前文提到的 gcc 备选方案的配置，你也可以将其运用到为具体的包选择性开启优化选项。比如编辑`/etc/portage/env/compiler-gcc-flto`。\n\n```\nCC=\"gcc\"\nCXX=\"g++\"\nCFLAGS=\"-flto -march=native -O2 -pipe\"\nCXXFLAGS=\"${CFLAGS}\"\nAR=\"gcc-ar\"\nNM=\"gcc-nm\"\nRANLIB=\"gcc-ranlib\"\n```\n\n再在`/etc/portage/package.env`中设置包的编译方案即可。\n\n下一篇：[Gentoo Compile Error Handling](https://www.niuiic.top/2020/08/06/gentoo-compile-error-handling/)\n","source":"_posts/gentoo-compiler-selection.md","raw":"---\ntitle: Gentoo Compiler Selection\ndate: 2020-08-05 22:50:35\ntags:\n        - Gentoo\ncategories:\n        - Gentoo\n---\n\n[Gentoo教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 编译器选择\n\n本文介绍构建 gentoo 系统的编译器选择方案，及一些尤其引起的 bug 的解决方案，不涉及选择编译器的专业观点。\n\n## 简介\n\n众所周知 Gentoo 系统完全在本地构建。因此编译器的选择很大程度上决定了编译系统的耗时以及整个系统的性能。\n\n用于构建整个 Gentoo 系统的编译器只推荐两个，gcc 与 clang。\n\ngcc 由 GNU 出品，与 GNU linux 自然匹配度更高。因此选择 gcc 作为编译器是最稳妥的方案。\n\nclang 被苹果公司支持，近年来发展速度迅速，也具备许多 gcc 不具备的特性。但 clang 编译 linux 系统尚不稳定。\n\n目前，绝大多数使用 clang 编译出错的 bug 已有解决方案。但部分软件，比如 gcc、linux 内核等必须使用 gcc 构建。因此即便你选择 clang 作为主编译器，也必须保留 gcc 作为辅助编译器。\n\n## 使用 gcc 作为主编译器\n\ngcc 是 gentoo 的默认编译器，且比较稳定，这里不作太多说明。\n\n只是需要注意一点，测试分支的 gcc 存在许多不稳定因素，可能会造成编译错误。考虑到编译器对于系统的重要性，强烈建议保留稳定分支的 gcc。\n\n- gcc 版本选择\n\n```\n# 查看系统中的gcc版本\ngcc-config --list-profiles\n# 选择需要的gcc\ngcc-config number\n# 刷新配置\nsource /etc/profile\n```\n\n## 使用 clang 作为主编译器\n\n详见[gentoo wiki](https://wiki.gentoo.org/wiki/Clang)\n\n关于 clang 的安装，可以参考上面的链接。这里主要介绍将 clang 作为主编译器的必要配置。\n\n首先，在`make.conf`中作如下设置。\n\n```\nCC = clang\nCXX = clang++\n```\n\n此时，clang 已经成为系统的默认编译器。接下来设置备选方案，即当软件无法用 clang 编译时，使用 gcc 编译。\n\n在`/etc/portage/env`目录下创建`compiler-gcc`，写入\n\n```\nCC = gcc\nCXX = g++\n```\n\n然后在`/etc/portage/package.env`文件中写入如`sys-devel/gcc compiler-gcc`的内容，即可将该包的编译器设置为 gcc。\n\n这一步可以通过`app-portage/flaggie`工具自动完成。其指令为`flaggie app-foo/bar +compiler-gcc`。\n\n至此，配置完毕。当发现 clang 无法编译某软件而 gcc 可行时只需将其加入上述文件即可。\n\n## 编译选项\n\n这里的编译选项主要指优化选项。为提高系统性能，你可以设置编译优化选项。但由此带来的问题是编译时间大大增长，更容易遇到 bug，过多的或者不合理的优化选项导致性能反而下降。\n\n这里不介绍配置优化选项的具体内容，只通过大致的感受给出一个建议。基于亲身体会，优化与不优化差别并不大，至少以人的感官很难感觉出来。因此这里建议新手不要开启优化选项，至少是过多的优化选项，除非你是为了折腾。\n\n就前文提到的 gcc 备选方案的配置，你也可以将其运用到为具体的包选择性开启优化选项。比如编辑`/etc/portage/env/compiler-gcc-flto`。\n\n```\nCC=\"gcc\"\nCXX=\"g++\"\nCFLAGS=\"-flto -march=native -O2 -pipe\"\nCXXFLAGS=\"${CFLAGS}\"\nAR=\"gcc-ar\"\nNM=\"gcc-nm\"\nRANLIB=\"gcc-ranlib\"\n```\n\n再在`/etc/portage/package.env`中设置包的编译方案即可。\n\n下一篇：[Gentoo Compile Error Handling](https://www.niuiic.top/2020/08/06/gentoo-compile-error-handling/)\n","slug":"gentoo-compiler-selection","published":1,"updated":"2021-03-23T11:11:18.579Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmrp0010rrizap29b69e","content":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo教程目录</a></p>\n<h1 id=\"Gentoo-编译器选择\"><a href=\"#Gentoo-编译器选择\" class=\"headerlink\" title=\"Gentoo 编译器选择\"></a>Gentoo 编译器选择</h1><p>本文介绍构建 gentoo 系统的编译器选择方案，及一些尤其引起的 bug 的解决方案，不涉及选择编译器的专业观点。</p>\n<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>众所周知 Gentoo 系统完全在本地构建。因此编译器的选择很大程度上决定了编译系统的耗时以及整个系统的性能。</p>\n<p>用于构建整个 Gentoo 系统的编译器只推荐两个，gcc 与 clang。</p>\n<p>gcc 由 GNU 出品，与 GNU linux 自然匹配度更高。因此选择 gcc 作为编译器是最稳妥的方案。</p>\n<p>clang 被苹果公司支持，近年来发展速度迅速，也具备许多 gcc 不具备的特性。但 clang 编译 linux 系统尚不稳定。</p>\n<p>目前，绝大多数使用 clang 编译出错的 bug 已有解决方案。但部分软件，比如 gcc、linux 内核等必须使用 gcc 构建。因此即便你选择 clang 作为主编译器，也必须保留 gcc 作为辅助编译器。</p>\n<h2 id=\"使用-gcc-作为主编译器\"><a href=\"#使用-gcc-作为主编译器\" class=\"headerlink\" title=\"使用 gcc 作为主编译器\"></a>使用 gcc 作为主编译器</h2><p>gcc 是 gentoo 的默认编译器，且比较稳定，这里不作太多说明。</p>\n<p>只是需要注意一点，测试分支的 gcc 存在许多不稳定因素，可能会造成编译错误。考虑到编译器对于系统的重要性，强烈建议保留稳定分支的 gcc。</p>\n<ul>\n<li>gcc 版本选择</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看系统中的gcc版本\ngcc-config --list-profiles\n# 选择需要的gcc\ngcc-config number\n# 刷新配置\nsource &#x2F;etc&#x2F;profile<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"使用-clang-作为主编译器\"><a href=\"#使用-clang-作为主编译器\" class=\"headerlink\" title=\"使用 clang 作为主编译器\"></a>使用 clang 作为主编译器</h2><p>详见<a href=\"https://wiki.gentoo.org/wiki/Clang\">gentoo wiki</a></p>\n<p>关于 clang 的安装，可以参考上面的链接。这里主要介绍将 clang 作为主编译器的必要配置。</p>\n<p>首先，在<code>make.conf</code>中作如下设置。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CC &#x3D; clang\nCXX &#x3D; clang++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>此时，clang 已经成为系统的默认编译器。接下来设置备选方案，即当软件无法用 clang 编译时，使用 gcc 编译。</p>\n<p>在<code>/etc/portage/env</code>目录下创建<code>compiler-gcc</code>，写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CC &#x3D; gcc\nCXX &#x3D; g++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>然后在<code>/etc/portage/package.env</code>文件中写入如<code>sys-devel/gcc compiler-gcc</code>的内容，即可将该包的编译器设置为 gcc。</p>\n<p>这一步可以通过<code>app-portage/flaggie</code>工具自动完成。其指令为<code>flaggie app-foo/bar +compiler-gcc</code>。</p>\n<p>至此，配置完毕。当发现 clang 无法编译某软件而 gcc 可行时只需将其加入上述文件即可。</p>\n<h2 id=\"编译选项\"><a href=\"#编译选项\" class=\"headerlink\" title=\"编译选项\"></a>编译选项</h2><p>这里的编译选项主要指优化选项。为提高系统性能，你可以设置编译优化选项。但由此带来的问题是编译时间大大增长，更容易遇到 bug，过多的或者不合理的优化选项导致性能反而下降。</p>\n<p>这里不介绍配置优化选项的具体内容，只通过大致的感受给出一个建议。基于亲身体会，优化与不优化差别并不大，至少以人的感官很难感觉出来。因此这里建议新手不要开启优化选项，至少是过多的优化选项，除非你是为了折腾。</p>\n<p>就前文提到的 gcc 备选方案的配置，你也可以将其运用到为具体的包选择性开启优化选项。比如编辑<code>/etc/portage/env/compiler-gcc-flto</code>。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CC&#x3D;&quot;gcc&quot;\nCXX&#x3D;&quot;g++&quot;\nCFLAGS&#x3D;&quot;-flto -march&#x3D;native -O2 -pipe&quot;\nCXXFLAGS&#x3D;&quot;$&#123;CFLAGS&#125;&quot;\nAR&#x3D;&quot;gcc-ar&quot;\nNM&#x3D;&quot;gcc-nm&quot;\nRANLIB&#x3D;&quot;gcc-ranlib&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>再在<code>/etc/portage/package.env</code>中设置包的编译方案即可。</p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/06/gentoo-compile-error-handling/\">Gentoo Compile Error Handling</a></p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo教程目录</a></p>\n<h1 id=\"Gentoo-编译器选择\"><a href=\"#Gentoo-编译器选择\" class=\"headerlink\" title=\"Gentoo 编译器选择\"></a>Gentoo 编译器选择</h1><p>本文介绍构建 gentoo 系统的编译器选择方案，及一些尤其引起的 bug 的解决方案，不涉及选择编译器的专业观点。</p>\n<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>众所周知 Gentoo 系统完全在本地构建。因此编译器的选择很大程度上决定了编译系统的耗时以及整个系统的性能。</p>\n<p>用于构建整个 Gentoo 系统的编译器只推荐两个，gcc 与 clang。</p>\n<p>gcc 由 GNU 出品，与 GNU linux 自然匹配度更高。因此选择 gcc 作为编译器是最稳妥的方案。</p>\n<p>clang 被苹果公司支持，近年来发展速度迅速，也具备许多 gcc 不具备的特性。但 clang 编译 linux 系统尚不稳定。</p>\n<p>目前，绝大多数使用 clang 编译出错的 bug 已有解决方案。但部分软件，比如 gcc、linux 内核等必须使用 gcc 构建。因此即便你选择 clang 作为主编译器，也必须保留 gcc 作为辅助编译器。</p>\n<h2 id=\"使用-gcc-作为主编译器\"><a href=\"#使用-gcc-作为主编译器\" class=\"headerlink\" title=\"使用 gcc 作为主编译器\"></a>使用 gcc 作为主编译器</h2><p>gcc 是 gentoo 的默认编译器，且比较稳定，这里不作太多说明。</p>\n<p>只是需要注意一点，测试分支的 gcc 存在许多不稳定因素，可能会造成编译错误。考虑到编译器对于系统的重要性，强烈建议保留稳定分支的 gcc。</p>\n<ul>\n<li>gcc 版本选择</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看系统中的gcc版本\ngcc-config --list-profiles\n# 选择需要的gcc\ngcc-config number\n# 刷新配置\nsource &#x2F;etc&#x2F;profile<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"使用-clang-作为主编译器\"><a href=\"#使用-clang-作为主编译器\" class=\"headerlink\" title=\"使用 clang 作为主编译器\"></a>使用 clang 作为主编译器</h2><p>详见<a href=\"https://wiki.gentoo.org/wiki/Clang\">gentoo wiki</a></p>\n<p>关于 clang 的安装，可以参考上面的链接。这里主要介绍将 clang 作为主编译器的必要配置。</p>\n<p>首先，在<code>make.conf</code>中作如下设置。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CC &#x3D; clang\nCXX &#x3D; clang++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>此时，clang 已经成为系统的默认编译器。接下来设置备选方案，即当软件无法用 clang 编译时，使用 gcc 编译。</p>\n<p>在<code>/etc/portage/env</code>目录下创建<code>compiler-gcc</code>，写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CC &#x3D; gcc\nCXX &#x3D; g++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>然后在<code>/etc/portage/package.env</code>文件中写入如<code>sys-devel/gcc compiler-gcc</code>的内容，即可将该包的编译器设置为 gcc。</p>\n<p>这一步可以通过<code>app-portage/flaggie</code>工具自动完成。其指令为<code>flaggie app-foo/bar +compiler-gcc</code>。</p>\n<p>至此，配置完毕。当发现 clang 无法编译某软件而 gcc 可行时只需将其加入上述文件即可。</p>\n<h2 id=\"编译选项\"><a href=\"#编译选项\" class=\"headerlink\" title=\"编译选项\"></a>编译选项</h2><p>这里的编译选项主要指优化选项。为提高系统性能，你可以设置编译优化选项。但由此带来的问题是编译时间大大增长，更容易遇到 bug，过多的或者不合理的优化选项导致性能反而下降。</p>\n<p>这里不介绍配置优化选项的具体内容，只通过大致的感受给出一个建议。基于亲身体会，优化与不优化差别并不大，至少以人的感官很难感觉出来。因此这里建议新手不要开启优化选项，至少是过多的优化选项，除非你是为了折腾。</p>\n<p>就前文提到的 gcc 备选方案的配置，你也可以将其运用到为具体的包选择性开启优化选项。比如编辑<code>/etc/portage/env/compiler-gcc-flto</code>。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CC&#x3D;&quot;gcc&quot;\nCXX&#x3D;&quot;g++&quot;\nCFLAGS&#x3D;&quot;-flto -march&#x3D;native -O2 -pipe&quot;\nCXXFLAGS&#x3D;&quot;$&#123;CFLAGS&#125;&quot;\nAR&#x3D;&quot;gcc-ar&quot;\nNM&#x3D;&quot;gcc-nm&quot;\nRANLIB&#x3D;&quot;gcc-ranlib&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>再在<code>/etc/portage/package.env</code>中设置包的编译方案即可。</p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/06/gentoo-compile-error-handling/\">Gentoo Compile Error Handling</a></p>\n"},{"title":"Gentoo Kool Desktop Environment Installation","date":"2020-08-07T16:44:23.000Z","_content":"\n[Gentoo 教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo KDE 桌面安装\n\n本文以 kde 为例，介绍 gentoo 系统桌面安装流程。\n\nkde 桌面的安装可参考[gentoo wiki](https://wiki.gentoo.org/wiki/KDE/)。\n\n## 基本桌面环境安装\n\n参考上面的链接，安装`kde-plasma`以及应用程序包。\n\n```\nsystemctl enable sddm\n```\n\n## 安装使用 NetworkManager\n\n- 安装\n\n参考[gentoo wiki](https://wiki.gentoo.org/wiki/NetworkManager)。\n\n- 允许用户使用\n\n```\ngpasswd -a <user_name> plugdev\n```\n\n- 开机启动\n\n```\nsystemctl enable NetworkManager\n```\n\n重启，测试是否可以进入图形界面。\n\n下一篇：[Gentoo System Further Improvement](https://www.niuiic.top/2020/08/08/gentoo-system-further-improvement/)\n","source":"_posts/gentoo-kool-desktop-environment-installation.md","raw":"---\ntitle: Gentoo Kool Desktop Environment Installation\ndate: 2020-08-08 00:44:23\ntags:\n\t\t- Gentoo\ncategories:\n\t\t- Gentoo\n---\n\n[Gentoo 教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo KDE 桌面安装\n\n本文以 kde 为例，介绍 gentoo 系统桌面安装流程。\n\nkde 桌面的安装可参考[gentoo wiki](https://wiki.gentoo.org/wiki/KDE/)。\n\n## 基本桌面环境安装\n\n参考上面的链接，安装`kde-plasma`以及应用程序包。\n\n```\nsystemctl enable sddm\n```\n\n## 安装使用 NetworkManager\n\n- 安装\n\n参考[gentoo wiki](https://wiki.gentoo.org/wiki/NetworkManager)。\n\n- 允许用户使用\n\n```\ngpasswd -a <user_name> plugdev\n```\n\n- 开机启动\n\n```\nsystemctl enable NetworkManager\n```\n\n重启，测试是否可以进入图形界面。\n\n下一篇：[Gentoo System Further Improvement](https://www.niuiic.top/2020/08/08/gentoo-system-further-improvement/)\n","slug":"gentoo-kool-desktop-environment-installation","published":1,"updated":"2021-03-23T11:11:18.579Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmrt0015rrizbj3man27","content":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo 教程目录</a></p>\n<h1 id=\"Gentoo-KDE-桌面安装\"><a href=\"#Gentoo-KDE-桌面安装\" class=\"headerlink\" title=\"Gentoo KDE 桌面安装\"></a>Gentoo KDE 桌面安装</h1><p>本文以 kde 为例，介绍 gentoo 系统桌面安装流程。</p>\n<p>kde 桌面的安装可参考<a href=\"https://wiki.gentoo.org/wiki/KDE/\">gentoo wiki</a>。</p>\n<h2 id=\"基本桌面环境安装\"><a href=\"#基本桌面环境安装\" class=\"headerlink\" title=\"基本桌面环境安装\"></a>基本桌面环境安装</h2><p>参考上面的链接，安装<code>kde-plasma</code>以及应用程序包。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">systemctl enable sddm<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"安装使用-NetworkManager\"><a href=\"#安装使用-NetworkManager\" class=\"headerlink\" title=\"安装使用 NetworkManager\"></a>安装使用 NetworkManager</h2><ul>\n<li>安装</li>\n</ul>\n<p>参考<a href=\"https://wiki.gentoo.org/wiki/NetworkManager\">gentoo wiki</a>。</p>\n<ul>\n<li>允许用户使用</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">gpasswd -a &lt;user_name&gt; plugdev<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>开机启动</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">systemctl enable NetworkManager<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>重启，测试是否可以进入图形界面。</p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/08/gentoo-system-further-improvement/\">Gentoo System Further Improvement</a></p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo 教程目录</a></p>\n<h1 id=\"Gentoo-KDE-桌面安装\"><a href=\"#Gentoo-KDE-桌面安装\" class=\"headerlink\" title=\"Gentoo KDE 桌面安装\"></a>Gentoo KDE 桌面安装</h1><p>本文以 kde 为例，介绍 gentoo 系统桌面安装流程。</p>\n<p>kde 桌面的安装可参考<a href=\"https://wiki.gentoo.org/wiki/KDE/\">gentoo wiki</a>。</p>\n<h2 id=\"基本桌面环境安装\"><a href=\"#基本桌面环境安装\" class=\"headerlink\" title=\"基本桌面环境安装\"></a>基本桌面环境安装</h2><p>参考上面的链接，安装<code>kde-plasma</code>以及应用程序包。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">systemctl enable sddm<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"安装使用-NetworkManager\"><a href=\"#安装使用-NetworkManager\" class=\"headerlink\" title=\"安装使用 NetworkManager\"></a>安装使用 NetworkManager</h2><ul>\n<li>安装</li>\n</ul>\n<p>参考<a href=\"https://wiki.gentoo.org/wiki/NetworkManager\">gentoo wiki</a>。</p>\n<ul>\n<li>允许用户使用</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">gpasswd -a &lt;user_name&gt; plugdev<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>开机启动</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">systemctl enable NetworkManager<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>重启，测试是否可以进入图形界面。</p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/08/gentoo-system-further-improvement/\">Gentoo System Further Improvement</a></p>\n"},{"title":"Gentoo Package Management","date":"2020-08-05T01:56:38.000Z","_content":"\n[Gentoo 教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 包管理\n\n本文介绍 gentoo 包管理系统核心配置，以清晰明了、简单易懂为原则，不涉及深层内容。\n\n掌握本文内容足以应对绝大部分软件安装、管理问题。\n\n## 简介\n\nGentoo 的包管理系统是 Portage，详情可查看 emerge 的 man page 及以下链接。\n\n[gentoo handbook](https://wiki.gentoo.org/wiki/Handbook:X86/Working/Portage/zh-cn)\n\n[gentoo wiki](https://wiki.gentoo.org/wiki/Portage)\n\n## Gentoo 软件仓库\n\nPortage 对于软件的行为基于本地的 ebuild。 ebuild 相当于 arch 的 PKGBUILD，简单的说，ebuild 用于指导软件包及其依赖的构建。\n\n- 如何获取 ebuild\n\n绝大多数的 ebuild 或者说软件包都被包含在 gentoo 官方仓库中，只需同步软件仓库即可得到。\n\n```\nemerge --sync\n# 或者\nemerge-webrsync\n```\n\n但部分软件并非由官方打包，其 ebuild 也不是官方维护。这些称为“野包”，可以通过添加其所属 overlay 后同步软件仓库获得。\n\n- 如何查找 ebuild\n\n假设你需要安装一个软件，但只知其一般名称，不清楚具体名称，且不清楚是否存在本地 ebuild。\n\n首先通过`emerge -S package_name`模糊查询本地 ebuild。如果没有，访问<https://packages.gentoo.org/>查找所需软件。这里包含了所有官方维护的 ebuild 以及已注册的一些 overlay 中的 ebuild。如果还是没有，可以 google 或 github 搜索`gentoo package_name`。如果还是没有，可以尝试自己创建。\n\n## 辅助工具\n\n### gentookit\n\ngentookit 包含了一系列用于软件管理的工具，可以帮助用户管理软件包并跟踪其系统中正在发生的事情。对于新手而言，主要使用的是 euse（USE flag 管理工具）、revdep-rebuild（依赖修复工具）、eclean（源码及二进制包清理工具）。\n\n详见[gentoo wiki](https://wiki.gentoo.org/wiki/Gentoolkit)\n\n### eix\n\neix 主要用于替代`emerge -S`，提供更好的搜索体验。对于新手而言，熟悉`eix package_name`以及`eix -I package_name`足以。\n\n详见[gentoo wiki](https://wiki.gentoo.org/wiki/Eix)\n\n## 软件选项\n\nGentoo 的包管理系统为软件定制设置了许多选项。其全局配置文件为`/etc/portage/make.conf`。\n\n### USE flag\n\n简单的说，USE flag 就是指定软件功能的选项。比如你需要某软件的文档，那么就为该软件激活`doc`这个 USE flag。如果不需要文档，则将其关闭，设置为`-doc`。\n\n- USE flag 设置分类\n\n一种分类方法是全局和局部。\n\n全局配置文件`/etc/portage/make.conf`（以下简称`make.conf`）中可以设置`USE=\"clang nls\"`等全局 USE flag。\n\n局部配置是为具体的包定制的，其配置位于`/etc/portage/package.use`。注意这可以是一个目录，也可以是一个文件。据个人经验，未防止自动更新配置文件时打乱注释，建议使用目录形式，为每个包单独设置一个配置文件。比如配置`sys-devel/gcc`的 USE flag，创建`/etc/portage/package.use/gcc`（文件名理论上可以任意取，但建议取用包名或部分包名）。在文件中添加`sys-devel/gcc fortran nls nptl openmp pch sanitize ssp lto`，其中`sys-devel/gcc`是包名，后面的都是 USE flag。当然你也可以分行写，每一行都是包名 + 一个 USE flag。\n\n另一种分类方法是永久和临时。\n\n永久的设置方式前面已经说明。同时 gentoo 还提供了一种临时使用 USE flag 的办法。这种临时方法也适用于很多其他选项。\n\n比如安装 gcc，使用`USE=\"nls pch\" emerge sys-devel/gcc`即可。\n\n- 如何查看 USE flag\n\n使用`equery uses package_name`查看包当前 USE flag 的状态。\n\nEquery 是使用`app-portage/gentoolkit`包安装的工具集的一部分。详见[gentoo wiki](https://wiki.gentoo.org/wiki/Equery)。\n\n也可以使用`eix package_name`查看。\n\n如果你不知道每个 USE flag 的具体含义，可查看<https://www.gentoo.org/support/use-flags/>。也可以点击<https://packages.gentoo.org/>中包页面中的 USE flag 查看详情。对于一些重要且流行的包，如 kde 的 plasma，可以在其相关的 wiki 中找到 USE flag 说明。\n\n### keywords\n\n简单的说，keywords 用于告知软件在哪些架构下是稳定的、测试状态的或者未测试的。详见[gentoo wiki](https://wiki.gentoo.org/wiki/KEYWORDS)。\n\n以 amd64 为例，`KEYWORDS=amd64`表示接受所有已经在 amd64 架构下测试过的进入稳定分支的软件包。`KEYWORDS=~amd64`则表示接受所有在 amd64 架构下进入稳定分支和测试分支的软件包。\n\n此外还有一些特殊形式的 KEYWORDS。但本质上是一样的。\n\n如果软件的 ebuild 的 KEYWORDS 中不包含 amd64，则表明当前软件未在该架构下测试，或不可用。\n\n- 如何配置 keywords\n\n同样，在全局配置文件`make.conf`中可以配置`KEYWORDS=amd64`。\n\n也可以在`/etc/portage/package.accept_keywords`中接受具体包的 keywords。同样这可以是一个目录，也可以是一个文件，建议设置为目录。在文件中写入`app-i18n/fcitx5-chinese-addons`之类的包全称即可。\n\n这里还可以对包版本进行控制。如上例是接受该包所有版本的 keywords。若要接受指定版本，则`=x11-libs/xcb-imdkit-99999999999 **`。同样`> < >= <=`均是适用的。这也可以用于其他选项的配置。\n\n- 如何查看 keywords\n\n`equery meta package_name`或者`eix package_name`\n\n建议使用`eix package_name`，结果如下\n\n![gcc](1.png)\n\n![kcm-fcitx5](2.png)\n\n其中版本号前带`~`的为测试分支。特别注意带`(**)`的在配置文件中应当写入`=app-i18n/kcm-fcitx5-99999999 **`。直接写入`app-i18n/kcm-fcitx5`不会接受该版本。\n\n- 是否选择开启测试分支\n\n测试分支与稳定分支的差异无需多言。不过对于 gentoo 而言，有相当一部分“野包”并未进入稳定分支。因此软件的测试分支并不一定不稳定。\n\n首先明确，新手绝不要在全局开启测试分支。一来，软件不稳定，bug 较多，新手无能力修复。二来更新频繁，电脑性能不足将严重影响体验感。最后，想再改到稳定分支难上加难。\n\n是否需要为内核开启测试分支取决于计算机配置。截至本文攥写时，gentoo 稳定分支最新内核版本为 5.4.48，可能已经无法满足部分新机型需要。此时可以选择开启测试分支。gentoo 测试分支内核源码更新频率基本维持在几天一更。如果觉得过于频繁，可以指定测试分支版本或者隔几个版本编译一次内核。\n\n### 其他\n\n另外一个重要的选项是 license，即许可证。虽然 gentoo wiki 并不建议在全局接受所有许可证，但个人建议，如果你对此并不了解，完全可以在`make.conf`中直接设置`ACCEPT_LICENSE=\"*\"`。\n\n对于新手而言，熟悉以上三个选项足以。\n\n其他选项可以自行参考 gentoo wiki。\n\n## 版本控制\n\n多版本软件并存是 gentoo 的一大特色，但事实上绝大多数软件并不具备该特性。\n\n- 如何查看是否可以多版本共存\n\n![instance](3.png)\n\n上图是`eix clang`的部分结果，其中 clang 与 clang-common 均存在多个可选版本。其中版本号前有`(number)`的 clang 可以多版本共存，而 clang-common 不可。\n\n- 如何控制软件版本\n\n临时设置可以直接在安装命令中指定，如`emerge \"=sys-devel/clang-9.0.1\"`。\n\n如果需要永久固定软件版本，可以通过以下两种方案。\n\n方案一：如果该软件版本处于测试分支，则在接受其 keyword 时，指定具体版本。当然，这并不能屏蔽稳定分支版本。因此仅适用于无稳定分支的软件。\n\n方案二：对于方案一不可行的软件，可以在`/etc/portage/package.mask`中设置将该版本之后的所有版本屏蔽。如`>=sys-power/powertop-1.97`。\n\n## Portage 常见报错\n\n### 被阻挡的包\n\n- 报错示例\n\n```\n!!! Error: the mail-mta/postfix package conflicts with another package.\n!!!        both can't be installed on the same system together.\n!!!        Please use 'emerge --pretend' to determine blockers.\n```\n\n- 原因\n\n首先由报错信息可知，该软件包被阻挡显然是因为包冲突。一般是因为依赖冲突，包括编译依赖冲突和运行依赖冲突。\n\n- 解决方案\n\n如果你不熟悉 ebuild，不应当首先考虑修改 ebuild。如果可以二者取其一，则只需拆卸一个。如果二者都需要，可以考虑修改安装软件的版本，这可能助于避开依赖冲突。实在没有办法的情况下可以到[Gentoo's bugtracking system](https://bugs.gentoo.org/)提交 bug。\n\n### 被屏蔽的包\n\n- 报错示例\n\n```\n!!! all ebuilds that could satisfy \"bootsplash\" have been masked.\n```\n\n```\n!!! possible candidates are:\n\n- gnome-base/gnome-2.8.0_pre1 (masked by: ~x86 keyword)\n- lm-sensors/lm-sensors-2.8.7 (masked by: -sparc keyword)\n- sys-libs/glibc-2.3.4.20040808 (masked by: -* keyword)\n- dev-util/cvsd-1.0.2 (masked by: missing keyword)\n- games-fps/unreal-tournament-451 (masked by: package.mask)\n- sys-libs/glibc-2.3.2-r11 (masked by: profile)\n- net-im/skype-2.1.0.81 (masked by: skype-eula license(s))\n```\n\n- 原因\n\n一般是由于 keyword（包未经测试，未进入稳定分支）、license（许可证未接受）、package.mask（软件包损坏或有严重问题）或 profile（软件不适合当前 profile）。\n\n- 解决方案\n\n首先明确处于最后两种情况的软件不应被安装。\n\n前两种情况只需单独为包设置 keyword 或者 license 即可。\n\n### USE flag 的必要更改\n\n- 报错示例\n\n```\nThe following USE changes are necessary to proceed:\n#required by app-text/happypackage-2.0, required by happypackage (argument)\n>=app-text/feelings-1.0.0 test\n```\n\n- 原因\n\nUSE flag 不满足当前软件包编译安装需要\n\n- 解决方案\n\n手动修改 USE flag 或者`etc-update`\n\n### 其他\n\n依赖缺失、循环依赖等依赖方面的错误对于新手而言是个难题，如果你并没有能力自己修复，那么等上游修复 bug 后重试是最好的选择。\n\n下载失败错误的一般原因应当不用多说，但也不排除 ebuild 中下载地址错误的情况。\n\n下一篇：[Gentoo Compiler Selection](https://www.niuiic.top/2020/08/05/gentoo-compiler-selection/)\n","source":"_posts/gentoo-package-management.md","raw":"---\ntitle: Gentoo Package Management\ndate: 2020-08-05 09:56:38\ntags:\n        - Gentoo\ncategories:\n        - Gentoo\n---\n\n[Gentoo 教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 包管理\n\n本文介绍 gentoo 包管理系统核心配置，以清晰明了、简单易懂为原则，不涉及深层内容。\n\n掌握本文内容足以应对绝大部分软件安装、管理问题。\n\n## 简介\n\nGentoo 的包管理系统是 Portage，详情可查看 emerge 的 man page 及以下链接。\n\n[gentoo handbook](https://wiki.gentoo.org/wiki/Handbook:X86/Working/Portage/zh-cn)\n\n[gentoo wiki](https://wiki.gentoo.org/wiki/Portage)\n\n## Gentoo 软件仓库\n\nPortage 对于软件的行为基于本地的 ebuild。 ebuild 相当于 arch 的 PKGBUILD，简单的说，ebuild 用于指导软件包及其依赖的构建。\n\n- 如何获取 ebuild\n\n绝大多数的 ebuild 或者说软件包都被包含在 gentoo 官方仓库中，只需同步软件仓库即可得到。\n\n```\nemerge --sync\n# 或者\nemerge-webrsync\n```\n\n但部分软件并非由官方打包，其 ebuild 也不是官方维护。这些称为“野包”，可以通过添加其所属 overlay 后同步软件仓库获得。\n\n- 如何查找 ebuild\n\n假设你需要安装一个软件，但只知其一般名称，不清楚具体名称，且不清楚是否存在本地 ebuild。\n\n首先通过`emerge -S package_name`模糊查询本地 ebuild。如果没有，访问<https://packages.gentoo.org/>查找所需软件。这里包含了所有官方维护的 ebuild 以及已注册的一些 overlay 中的 ebuild。如果还是没有，可以 google 或 github 搜索`gentoo package_name`。如果还是没有，可以尝试自己创建。\n\n## 辅助工具\n\n### gentookit\n\ngentookit 包含了一系列用于软件管理的工具，可以帮助用户管理软件包并跟踪其系统中正在发生的事情。对于新手而言，主要使用的是 euse（USE flag 管理工具）、revdep-rebuild（依赖修复工具）、eclean（源码及二进制包清理工具）。\n\n详见[gentoo wiki](https://wiki.gentoo.org/wiki/Gentoolkit)\n\n### eix\n\neix 主要用于替代`emerge -S`，提供更好的搜索体验。对于新手而言，熟悉`eix package_name`以及`eix -I package_name`足以。\n\n详见[gentoo wiki](https://wiki.gentoo.org/wiki/Eix)\n\n## 软件选项\n\nGentoo 的包管理系统为软件定制设置了许多选项。其全局配置文件为`/etc/portage/make.conf`。\n\n### USE flag\n\n简单的说，USE flag 就是指定软件功能的选项。比如你需要某软件的文档，那么就为该软件激活`doc`这个 USE flag。如果不需要文档，则将其关闭，设置为`-doc`。\n\n- USE flag 设置分类\n\n一种分类方法是全局和局部。\n\n全局配置文件`/etc/portage/make.conf`（以下简称`make.conf`）中可以设置`USE=\"clang nls\"`等全局 USE flag。\n\n局部配置是为具体的包定制的，其配置位于`/etc/portage/package.use`。注意这可以是一个目录，也可以是一个文件。据个人经验，未防止自动更新配置文件时打乱注释，建议使用目录形式，为每个包单独设置一个配置文件。比如配置`sys-devel/gcc`的 USE flag，创建`/etc/portage/package.use/gcc`（文件名理论上可以任意取，但建议取用包名或部分包名）。在文件中添加`sys-devel/gcc fortran nls nptl openmp pch sanitize ssp lto`，其中`sys-devel/gcc`是包名，后面的都是 USE flag。当然你也可以分行写，每一行都是包名 + 一个 USE flag。\n\n另一种分类方法是永久和临时。\n\n永久的设置方式前面已经说明。同时 gentoo 还提供了一种临时使用 USE flag 的办法。这种临时方法也适用于很多其他选项。\n\n比如安装 gcc，使用`USE=\"nls pch\" emerge sys-devel/gcc`即可。\n\n- 如何查看 USE flag\n\n使用`equery uses package_name`查看包当前 USE flag 的状态。\n\nEquery 是使用`app-portage/gentoolkit`包安装的工具集的一部分。详见[gentoo wiki](https://wiki.gentoo.org/wiki/Equery)。\n\n也可以使用`eix package_name`查看。\n\n如果你不知道每个 USE flag 的具体含义，可查看<https://www.gentoo.org/support/use-flags/>。也可以点击<https://packages.gentoo.org/>中包页面中的 USE flag 查看详情。对于一些重要且流行的包，如 kde 的 plasma，可以在其相关的 wiki 中找到 USE flag 说明。\n\n### keywords\n\n简单的说，keywords 用于告知软件在哪些架构下是稳定的、测试状态的或者未测试的。详见[gentoo wiki](https://wiki.gentoo.org/wiki/KEYWORDS)。\n\n以 amd64 为例，`KEYWORDS=amd64`表示接受所有已经在 amd64 架构下测试过的进入稳定分支的软件包。`KEYWORDS=~amd64`则表示接受所有在 amd64 架构下进入稳定分支和测试分支的软件包。\n\n此外还有一些特殊形式的 KEYWORDS。但本质上是一样的。\n\n如果软件的 ebuild 的 KEYWORDS 中不包含 amd64，则表明当前软件未在该架构下测试，或不可用。\n\n- 如何配置 keywords\n\n同样，在全局配置文件`make.conf`中可以配置`KEYWORDS=amd64`。\n\n也可以在`/etc/portage/package.accept_keywords`中接受具体包的 keywords。同样这可以是一个目录，也可以是一个文件，建议设置为目录。在文件中写入`app-i18n/fcitx5-chinese-addons`之类的包全称即可。\n\n这里还可以对包版本进行控制。如上例是接受该包所有版本的 keywords。若要接受指定版本，则`=x11-libs/xcb-imdkit-99999999999 **`。同样`> < >= <=`均是适用的。这也可以用于其他选项的配置。\n\n- 如何查看 keywords\n\n`equery meta package_name`或者`eix package_name`\n\n建议使用`eix package_name`，结果如下\n\n![gcc](1.png)\n\n![kcm-fcitx5](2.png)\n\n其中版本号前带`~`的为测试分支。特别注意带`(**)`的在配置文件中应当写入`=app-i18n/kcm-fcitx5-99999999 **`。直接写入`app-i18n/kcm-fcitx5`不会接受该版本。\n\n- 是否选择开启测试分支\n\n测试分支与稳定分支的差异无需多言。不过对于 gentoo 而言，有相当一部分“野包”并未进入稳定分支。因此软件的测试分支并不一定不稳定。\n\n首先明确，新手绝不要在全局开启测试分支。一来，软件不稳定，bug 较多，新手无能力修复。二来更新频繁，电脑性能不足将严重影响体验感。最后，想再改到稳定分支难上加难。\n\n是否需要为内核开启测试分支取决于计算机配置。截至本文攥写时，gentoo 稳定分支最新内核版本为 5.4.48，可能已经无法满足部分新机型需要。此时可以选择开启测试分支。gentoo 测试分支内核源码更新频率基本维持在几天一更。如果觉得过于频繁，可以指定测试分支版本或者隔几个版本编译一次内核。\n\n### 其他\n\n另外一个重要的选项是 license，即许可证。虽然 gentoo wiki 并不建议在全局接受所有许可证，但个人建议，如果你对此并不了解，完全可以在`make.conf`中直接设置`ACCEPT_LICENSE=\"*\"`。\n\n对于新手而言，熟悉以上三个选项足以。\n\n其他选项可以自行参考 gentoo wiki。\n\n## 版本控制\n\n多版本软件并存是 gentoo 的一大特色，但事实上绝大多数软件并不具备该特性。\n\n- 如何查看是否可以多版本共存\n\n![instance](3.png)\n\n上图是`eix clang`的部分结果，其中 clang 与 clang-common 均存在多个可选版本。其中版本号前有`(number)`的 clang 可以多版本共存，而 clang-common 不可。\n\n- 如何控制软件版本\n\n临时设置可以直接在安装命令中指定，如`emerge \"=sys-devel/clang-9.0.1\"`。\n\n如果需要永久固定软件版本，可以通过以下两种方案。\n\n方案一：如果该软件版本处于测试分支，则在接受其 keyword 时，指定具体版本。当然，这并不能屏蔽稳定分支版本。因此仅适用于无稳定分支的软件。\n\n方案二：对于方案一不可行的软件，可以在`/etc/portage/package.mask`中设置将该版本之后的所有版本屏蔽。如`>=sys-power/powertop-1.97`。\n\n## Portage 常见报错\n\n### 被阻挡的包\n\n- 报错示例\n\n```\n!!! Error: the mail-mta/postfix package conflicts with another package.\n!!!        both can't be installed on the same system together.\n!!!        Please use 'emerge --pretend' to determine blockers.\n```\n\n- 原因\n\n首先由报错信息可知，该软件包被阻挡显然是因为包冲突。一般是因为依赖冲突，包括编译依赖冲突和运行依赖冲突。\n\n- 解决方案\n\n如果你不熟悉 ebuild，不应当首先考虑修改 ebuild。如果可以二者取其一，则只需拆卸一个。如果二者都需要，可以考虑修改安装软件的版本，这可能助于避开依赖冲突。实在没有办法的情况下可以到[Gentoo's bugtracking system](https://bugs.gentoo.org/)提交 bug。\n\n### 被屏蔽的包\n\n- 报错示例\n\n```\n!!! all ebuilds that could satisfy \"bootsplash\" have been masked.\n```\n\n```\n!!! possible candidates are:\n\n- gnome-base/gnome-2.8.0_pre1 (masked by: ~x86 keyword)\n- lm-sensors/lm-sensors-2.8.7 (masked by: -sparc keyword)\n- sys-libs/glibc-2.3.4.20040808 (masked by: -* keyword)\n- dev-util/cvsd-1.0.2 (masked by: missing keyword)\n- games-fps/unreal-tournament-451 (masked by: package.mask)\n- sys-libs/glibc-2.3.2-r11 (masked by: profile)\n- net-im/skype-2.1.0.81 (masked by: skype-eula license(s))\n```\n\n- 原因\n\n一般是由于 keyword（包未经测试，未进入稳定分支）、license（许可证未接受）、package.mask（软件包损坏或有严重问题）或 profile（软件不适合当前 profile）。\n\n- 解决方案\n\n首先明确处于最后两种情况的软件不应被安装。\n\n前两种情况只需单独为包设置 keyword 或者 license 即可。\n\n### USE flag 的必要更改\n\n- 报错示例\n\n```\nThe following USE changes are necessary to proceed:\n#required by app-text/happypackage-2.0, required by happypackage (argument)\n>=app-text/feelings-1.0.0 test\n```\n\n- 原因\n\nUSE flag 不满足当前软件包编译安装需要\n\n- 解决方案\n\n手动修改 USE flag 或者`etc-update`\n\n### 其他\n\n依赖缺失、循环依赖等依赖方面的错误对于新手而言是个难题，如果你并没有能力自己修复，那么等上游修复 bug 后重试是最好的选择。\n\n下载失败错误的一般原因应当不用多说，但也不排除 ebuild 中下载地址错误的情况。\n\n下一篇：[Gentoo Compiler Selection](https://www.niuiic.top/2020/08/05/gentoo-compiler-selection/)\n","slug":"gentoo-package-management","published":1,"updated":"2021-03-23T11:11:18.579Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmru0018rrizd7kh4n98","content":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo 教程目录</a></p>\n<h1 id=\"Gentoo-包管理\"><a href=\"#Gentoo-包管理\" class=\"headerlink\" title=\"Gentoo 包管理\"></a>Gentoo 包管理</h1><p>本文介绍 gentoo 包管理系统核心配置，以清晰明了、简单易懂为原则，不涉及深层内容。</p>\n<p>掌握本文内容足以应对绝大部分软件安装、管理问题。</p>\n<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>Gentoo 的包管理系统是 Portage，详情可查看 emerge 的 man page 及以下链接。</p>\n<p><a href=\"https://wiki.gentoo.org/wiki/Handbook:X86/Working/Portage/zh-cn\">gentoo handbook</a></p>\n<p><a href=\"https://wiki.gentoo.org/wiki/Portage\">gentoo wiki</a></p>\n<h2 id=\"Gentoo-软件仓库\"><a href=\"#Gentoo-软件仓库\" class=\"headerlink\" title=\"Gentoo 软件仓库\"></a>Gentoo 软件仓库</h2><p>Portage 对于软件的行为基于本地的 ebuild。 ebuild 相当于 arch 的 PKGBUILD，简单的说，ebuild 用于指导软件包及其依赖的构建。</p>\n<ul>\n<li>如何获取 ebuild</li>\n</ul>\n<p>绝大多数的 ebuild 或者说软件包都被包含在 gentoo 官方仓库中，只需同步软件仓库即可得到。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --sync\n# 或者\nemerge-webrsync<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>但部分软件并非由官方打包，其 ebuild 也不是官方维护。这些称为“野包”，可以通过添加其所属 overlay 后同步软件仓库获得。</p>\n<ul>\n<li>如何查找 ebuild</li>\n</ul>\n<p>假设你需要安装一个软件，但只知其一般名称，不清楚具体名称，且不清楚是否存在本地 ebuild。</p>\n<p>首先通过<code>emerge -S package_name</code>模糊查询本地 ebuild。如果没有，访问<a href=\"https://packages.gentoo.org/\">https://packages.gentoo.org/</a>查找所需软件。这里包含了所有官方维护的 ebuild 以及已注册的一些 overlay 中的 ebuild。如果还是没有，可以 google 或 github 搜索<code>gentoo package_name</code>。如果还是没有，可以尝试自己创建。</p>\n<h2 id=\"辅助工具\"><a href=\"#辅助工具\" class=\"headerlink\" title=\"辅助工具\"></a>辅助工具</h2><h3 id=\"gentookit\"><a href=\"#gentookit\" class=\"headerlink\" title=\"gentookit\"></a>gentookit</h3><p>gentookit 包含了一系列用于软件管理的工具，可以帮助用户管理软件包并跟踪其系统中正在发生的事情。对于新手而言，主要使用的是 euse（USE flag 管理工具）、revdep-rebuild（依赖修复工具）、eclean（源码及二进制包清理工具）。</p>\n<p>详见<a href=\"https://wiki.gentoo.org/wiki/Gentoolkit\">gentoo wiki</a></p>\n<h3 id=\"eix\"><a href=\"#eix\" class=\"headerlink\" title=\"eix\"></a>eix</h3><p>eix 主要用于替代<code>emerge -S</code>，提供更好的搜索体验。对于新手而言，熟悉<code>eix package_name</code>以及<code>eix -I package_name</code>足以。</p>\n<p>详见<a href=\"https://wiki.gentoo.org/wiki/Eix\">gentoo wiki</a></p>\n<h2 id=\"软件选项\"><a href=\"#软件选项\" class=\"headerlink\" title=\"软件选项\"></a>软件选项</h2><p>Gentoo 的包管理系统为软件定制设置了许多选项。其全局配置文件为<code>/etc/portage/make.conf</code>。</p>\n<h3 id=\"USE-flag\"><a href=\"#USE-flag\" class=\"headerlink\" title=\"USE flag\"></a>USE flag</h3><p>简单的说，USE flag 就是指定软件功能的选项。比如你需要某软件的文档，那么就为该软件激活<code>doc</code>这个 USE flag。如果不需要文档，则将其关闭，设置为<code>-doc</code>。</p>\n<ul>\n<li>USE flag 设置分类</li>\n</ul>\n<p>一种分类方法是全局和局部。</p>\n<p>全局配置文件<code>/etc/portage/make.conf</code>（以下简称<code>make.conf</code>）中可以设置<code>USE=&quot;clang nls&quot;</code>等全局 USE flag。</p>\n<p>局部配置是为具体的包定制的，其配置位于<code>/etc/portage/package.use</code>。注意这可以是一个目录，也可以是一个文件。据个人经验，未防止自动更新配置文件时打乱注释，建议使用目录形式，为每个包单独设置一个配置文件。比如配置<code>sys-devel/gcc</code>的 USE flag，创建<code>/etc/portage/package.use/gcc</code>（文件名理论上可以任意取，但建议取用包名或部分包名）。在文件中添加<code>sys-devel/gcc fortran nls nptl openmp pch sanitize ssp lto</code>，其中<code>sys-devel/gcc</code>是包名，后面的都是 USE flag。当然你也可以分行写，每一行都是包名 + 一个 USE flag。</p>\n<p>另一种分类方法是永久和临时。</p>\n<p>永久的设置方式前面已经说明。同时 gentoo 还提供了一种临时使用 USE flag 的办法。这种临时方法也适用于很多其他选项。</p>\n<p>比如安装 gcc，使用<code>USE=&quot;nls pch&quot; emerge sys-devel/gcc</code>即可。</p>\n<ul>\n<li>如何查看 USE flag</li>\n</ul>\n<p>使用<code>equery uses package_name</code>查看包当前 USE flag 的状态。</p>\n<p>Equery 是使用<code>app-portage/gentoolkit</code>包安装的工具集的一部分。详见<a href=\"https://wiki.gentoo.org/wiki/Equery\">gentoo wiki</a>。</p>\n<p>也可以使用<code>eix package_name</code>查看。</p>\n<p>如果你不知道每个 USE flag 的具体含义，可查看<a href=\"https://www.gentoo.org/support/use-flags/\">https://www.gentoo.org/support/use-flags/</a>。也可以点击<a href=\"https://packages.gentoo.org/\">https://packages.gentoo.org/</a>中包页面中的 USE flag 查看详情。对于一些重要且流行的包，如 kde 的 plasma，可以在其相关的 wiki 中找到 USE flag 说明。</p>\n<h3 id=\"keywords\"><a href=\"#keywords\" class=\"headerlink\" title=\"keywords\"></a>keywords</h3><p>简单的说，keywords 用于告知软件在哪些架构下是稳定的、测试状态的或者未测试的。详见<a href=\"https://wiki.gentoo.org/wiki/KEYWORDS\">gentoo wiki</a>。</p>\n<p>以 amd64 为例，<code>KEYWORDS=amd64</code>表示接受所有已经在 amd64 架构下测试过的进入稳定分支的软件包。<code>KEYWORDS=~amd64</code>则表示接受所有在 amd64 架构下进入稳定分支和测试分支的软件包。</p>\n<p>此外还有一些特殊形式的 KEYWORDS。但本质上是一样的。</p>\n<p>如果软件的 ebuild 的 KEYWORDS 中不包含 amd64，则表明当前软件未在该架构下测试，或不可用。</p>\n<ul>\n<li>如何配置 keywords</li>\n</ul>\n<p>同样，在全局配置文件<code>make.conf</code>中可以配置<code>KEYWORDS=amd64</code>。</p>\n<p>也可以在<code>/etc/portage/package.accept_keywords</code>中接受具体包的 keywords。同样这可以是一个目录，也可以是一个文件，建议设置为目录。在文件中写入<code>app-i18n/fcitx5-chinese-addons</code>之类的包全称即可。</p>\n<p>这里还可以对包版本进行控制。如上例是接受该包所有版本的 keywords。若要接受指定版本，则<code>=x11-libs/xcb-imdkit-99999999999 **</code>。同样<code>&gt; &lt; &gt;= &lt;=</code>均是适用的。这也可以用于其他选项的配置。</p>\n<ul>\n<li>如何查看 keywords</li>\n</ul>\n<p><code>equery meta package_name</code>或者<code>eix package_name</code></p>\n<p>建议使用<code>eix package_name</code>，结果如下</p>\n<p><img src=\"1.png\" alt=\"gcc\"></p>\n<p><img src=\"2.png\" alt=\"kcm-fcitx5\"></p>\n<p>其中版本号前带<code>~</code>的为测试分支。特别注意带<code>(**)</code>的在配置文件中应当写入<code>=app-i18n/kcm-fcitx5-99999999 **</code>。直接写入<code>app-i18n/kcm-fcitx5</code>不会接受该版本。</p>\n<ul>\n<li>是否选择开启测试分支</li>\n</ul>\n<p>测试分支与稳定分支的差异无需多言。不过对于 gentoo 而言，有相当一部分“野包”并未进入稳定分支。因此软件的测试分支并不一定不稳定。</p>\n<p>首先明确，新手绝不要在全局开启测试分支。一来，软件不稳定，bug 较多，新手无能力修复。二来更新频繁，电脑性能不足将严重影响体验感。最后，想再改到稳定分支难上加难。</p>\n<p>是否需要为内核开启测试分支取决于计算机配置。截至本文攥写时，gentoo 稳定分支最新内核版本为 5.4.48，可能已经无法满足部分新机型需要。此时可以选择开启测试分支。gentoo 测试分支内核源码更新频率基本维持在几天一更。如果觉得过于频繁，可以指定测试分支版本或者隔几个版本编译一次内核。</p>\n<h3 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h3><p>另外一个重要的选项是 license，即许可证。虽然 gentoo wiki 并不建议在全局接受所有许可证，但个人建议，如果你对此并不了解，完全可以在<code>make.conf</code>中直接设置<code>ACCEPT_LICENSE=&quot;*&quot;</code>。</p>\n<p>对于新手而言，熟悉以上三个选项足以。</p>\n<p>其他选项可以自行参考 gentoo wiki。</p>\n<h2 id=\"版本控制\"><a href=\"#版本控制\" class=\"headerlink\" title=\"版本控制\"></a>版本控制</h2><p>多版本软件并存是 gentoo 的一大特色，但事实上绝大多数软件并不具备该特性。</p>\n<ul>\n<li>如何查看是否可以多版本共存</li>\n</ul>\n<p><img src=\"3.png\" alt=\"instance\"></p>\n<p>上图是<code>eix clang</code>的部分结果，其中 clang 与 clang-common 均存在多个可选版本。其中版本号前有<code>(number)</code>的 clang 可以多版本共存，而 clang-common 不可。</p>\n<ul>\n<li>如何控制软件版本</li>\n</ul>\n<p>临时设置可以直接在安装命令中指定，如<code>emerge &quot;=sys-devel/clang-9.0.1&quot;</code>。</p>\n<p>如果需要永久固定软件版本，可以通过以下两种方案。</p>\n<p>方案一：如果该软件版本处于测试分支，则在接受其 keyword 时，指定具体版本。当然，这并不能屏蔽稳定分支版本。因此仅适用于无稳定分支的软件。</p>\n<p>方案二：对于方案一不可行的软件，可以在<code>/etc/portage/package.mask</code>中设置将该版本之后的所有版本屏蔽。如<code>&gt;=sys-power/powertop-1.97</code>。</p>\n<h2 id=\"Portage-常见报错\"><a href=\"#Portage-常见报错\" class=\"headerlink\" title=\"Portage 常见报错\"></a>Portage 常见报错</h2><h3 id=\"被阻挡的包\"><a href=\"#被阻挡的包\" class=\"headerlink\" title=\"被阻挡的包\"></a>被阻挡的包</h3><ul>\n<li>报错示例</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">!!! Error: the mail-mta&#x2F;postfix package conflicts with another package.\n!!!        both can&#39;t be installed on the same system together.\n!!!        Please use &#39;emerge --pretend&#39; to determine blockers.<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>原因</li>\n</ul>\n<p>首先由报错信息可知，该软件包被阻挡显然是因为包冲突。一般是因为依赖冲突，包括编译依赖冲突和运行依赖冲突。</p>\n<ul>\n<li>解决方案</li>\n</ul>\n<p>如果你不熟悉 ebuild，不应当首先考虑修改 ebuild。如果可以二者取其一，则只需拆卸一个。如果二者都需要，可以考虑修改安装软件的版本，这可能助于避开依赖冲突。实在没有办法的情况下可以到<a href=\"https://bugs.gentoo.org/\">Gentoo’s bugtracking system</a>提交 bug。</p>\n<h3 id=\"被屏蔽的包\"><a href=\"#被屏蔽的包\" class=\"headerlink\" title=\"被屏蔽的包\"></a>被屏蔽的包</h3><ul>\n<li>报错示例</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">!!! all ebuilds that could satisfy &quot;bootsplash&quot; have been masked.<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">!!! possible candidates are:\n\n- gnome-base&#x2F;gnome-2.8.0_pre1 (masked by: ~x86 keyword)\n- lm-sensors&#x2F;lm-sensors-2.8.7 (masked by: -sparc keyword)\n- sys-libs&#x2F;glibc-2.3.4.20040808 (masked by: -* keyword)\n- dev-util&#x2F;cvsd-1.0.2 (masked by: missing keyword)\n- games-fps&#x2F;unreal-tournament-451 (masked by: package.mask)\n- sys-libs&#x2F;glibc-2.3.2-r11 (masked by: profile)\n- net-im&#x2F;skype-2.1.0.81 (masked by: skype-eula license(s))<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>原因</li>\n</ul>\n<p>一般是由于 keyword（包未经测试，未进入稳定分支）、license（许可证未接受）、package.mask（软件包损坏或有严重问题）或 profile（软件不适合当前 profile）。</p>\n<ul>\n<li>解决方案</li>\n</ul>\n<p>首先明确处于最后两种情况的软件不应被安装。</p>\n<p>前两种情况只需单独为包设置 keyword 或者 license 即可。</p>\n<h3 id=\"USE-flag-的必要更改\"><a href=\"#USE-flag-的必要更改\" class=\"headerlink\" title=\"USE flag 的必要更改\"></a>USE flag 的必要更改</h3><ul>\n<li>报错示例</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">The following USE changes are necessary to proceed:\n#required by app-text&#x2F;happypackage-2.0, required by happypackage (argument)\n&gt;&#x3D;app-text&#x2F;feelings-1.0.0 test<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>原因</li>\n</ul>\n<p>USE flag 不满足当前软件包编译安装需要</p>\n<ul>\n<li>解决方案</li>\n</ul>\n<p>手动修改 USE flag 或者<code>etc-update</code></p>\n<h3 id=\"其他-1\"><a href=\"#其他-1\" class=\"headerlink\" title=\"其他\"></a>其他</h3><p>依赖缺失、循环依赖等依赖方面的错误对于新手而言是个难题，如果你并没有能力自己修复，那么等上游修复 bug 后重试是最好的选择。</p>\n<p>下载失败错误的一般原因应当不用多说，但也不排除 ebuild 中下载地址错误的情况。</p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/05/gentoo-compiler-selection/\">Gentoo Compiler Selection</a></p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo 教程目录</a></p>\n<h1 id=\"Gentoo-包管理\"><a href=\"#Gentoo-包管理\" class=\"headerlink\" title=\"Gentoo 包管理\"></a>Gentoo 包管理</h1><p>本文介绍 gentoo 包管理系统核心配置，以清晰明了、简单易懂为原则，不涉及深层内容。</p>\n<p>掌握本文内容足以应对绝大部分软件安装、管理问题。</p>\n<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>Gentoo 的包管理系统是 Portage，详情可查看 emerge 的 man page 及以下链接。</p>\n<p><a href=\"https://wiki.gentoo.org/wiki/Handbook:X86/Working/Portage/zh-cn\">gentoo handbook</a></p>\n<p><a href=\"https://wiki.gentoo.org/wiki/Portage\">gentoo wiki</a></p>\n<h2 id=\"Gentoo-软件仓库\"><a href=\"#Gentoo-软件仓库\" class=\"headerlink\" title=\"Gentoo 软件仓库\"></a>Gentoo 软件仓库</h2><p>Portage 对于软件的行为基于本地的 ebuild。 ebuild 相当于 arch 的 PKGBUILD，简单的说，ebuild 用于指导软件包及其依赖的构建。</p>\n<ul>\n<li>如何获取 ebuild</li>\n</ul>\n<p>绝大多数的 ebuild 或者说软件包都被包含在 gentoo 官方仓库中，只需同步软件仓库即可得到。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge --sync\n# 或者\nemerge-webrsync<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>但部分软件并非由官方打包，其 ebuild 也不是官方维护。这些称为“野包”，可以通过添加其所属 overlay 后同步软件仓库获得。</p>\n<ul>\n<li>如何查找 ebuild</li>\n</ul>\n<p>假设你需要安装一个软件，但只知其一般名称，不清楚具体名称，且不清楚是否存在本地 ebuild。</p>\n<p>首先通过<code>emerge -S package_name</code>模糊查询本地 ebuild。如果没有，访问<a href=\"https://packages.gentoo.org/\">https://packages.gentoo.org/</a>查找所需软件。这里包含了所有官方维护的 ebuild 以及已注册的一些 overlay 中的 ebuild。如果还是没有，可以 google 或 github 搜索<code>gentoo package_name</code>。如果还是没有，可以尝试自己创建。</p>\n<h2 id=\"辅助工具\"><a href=\"#辅助工具\" class=\"headerlink\" title=\"辅助工具\"></a>辅助工具</h2><h3 id=\"gentookit\"><a href=\"#gentookit\" class=\"headerlink\" title=\"gentookit\"></a>gentookit</h3><p>gentookit 包含了一系列用于软件管理的工具，可以帮助用户管理软件包并跟踪其系统中正在发生的事情。对于新手而言，主要使用的是 euse（USE flag 管理工具）、revdep-rebuild（依赖修复工具）、eclean（源码及二进制包清理工具）。</p>\n<p>详见<a href=\"https://wiki.gentoo.org/wiki/Gentoolkit\">gentoo wiki</a></p>\n<h3 id=\"eix\"><a href=\"#eix\" class=\"headerlink\" title=\"eix\"></a>eix</h3><p>eix 主要用于替代<code>emerge -S</code>，提供更好的搜索体验。对于新手而言，熟悉<code>eix package_name</code>以及<code>eix -I package_name</code>足以。</p>\n<p>详见<a href=\"https://wiki.gentoo.org/wiki/Eix\">gentoo wiki</a></p>\n<h2 id=\"软件选项\"><a href=\"#软件选项\" class=\"headerlink\" title=\"软件选项\"></a>软件选项</h2><p>Gentoo 的包管理系统为软件定制设置了许多选项。其全局配置文件为<code>/etc/portage/make.conf</code>。</p>\n<h3 id=\"USE-flag\"><a href=\"#USE-flag\" class=\"headerlink\" title=\"USE flag\"></a>USE flag</h3><p>简单的说，USE flag 就是指定软件功能的选项。比如你需要某软件的文档，那么就为该软件激活<code>doc</code>这个 USE flag。如果不需要文档，则将其关闭，设置为<code>-doc</code>。</p>\n<ul>\n<li>USE flag 设置分类</li>\n</ul>\n<p>一种分类方法是全局和局部。</p>\n<p>全局配置文件<code>/etc/portage/make.conf</code>（以下简称<code>make.conf</code>）中可以设置<code>USE=&quot;clang nls&quot;</code>等全局 USE flag。</p>\n<p>局部配置是为具体的包定制的，其配置位于<code>/etc/portage/package.use</code>。注意这可以是一个目录，也可以是一个文件。据个人经验，未防止自动更新配置文件时打乱注释，建议使用目录形式，为每个包单独设置一个配置文件。比如配置<code>sys-devel/gcc</code>的 USE flag，创建<code>/etc/portage/package.use/gcc</code>（文件名理论上可以任意取，但建议取用包名或部分包名）。在文件中添加<code>sys-devel/gcc fortran nls nptl openmp pch sanitize ssp lto</code>，其中<code>sys-devel/gcc</code>是包名，后面的都是 USE flag。当然你也可以分行写，每一行都是包名 + 一个 USE flag。</p>\n<p>另一种分类方法是永久和临时。</p>\n<p>永久的设置方式前面已经说明。同时 gentoo 还提供了一种临时使用 USE flag 的办法。这种临时方法也适用于很多其他选项。</p>\n<p>比如安装 gcc，使用<code>USE=&quot;nls pch&quot; emerge sys-devel/gcc</code>即可。</p>\n<ul>\n<li>如何查看 USE flag</li>\n</ul>\n<p>使用<code>equery uses package_name</code>查看包当前 USE flag 的状态。</p>\n<p>Equery 是使用<code>app-portage/gentoolkit</code>包安装的工具集的一部分。详见<a href=\"https://wiki.gentoo.org/wiki/Equery\">gentoo wiki</a>。</p>\n<p>也可以使用<code>eix package_name</code>查看。</p>\n<p>如果你不知道每个 USE flag 的具体含义，可查看<a href=\"https://www.gentoo.org/support/use-flags/\">https://www.gentoo.org/support/use-flags/</a>。也可以点击<a href=\"https://packages.gentoo.org/\">https://packages.gentoo.org/</a>中包页面中的 USE flag 查看详情。对于一些重要且流行的包，如 kde 的 plasma，可以在其相关的 wiki 中找到 USE flag 说明。</p>\n<h3 id=\"keywords\"><a href=\"#keywords\" class=\"headerlink\" title=\"keywords\"></a>keywords</h3><p>简单的说，keywords 用于告知软件在哪些架构下是稳定的、测试状态的或者未测试的。详见<a href=\"https://wiki.gentoo.org/wiki/KEYWORDS\">gentoo wiki</a>。</p>\n<p>以 amd64 为例，<code>KEYWORDS=amd64</code>表示接受所有已经在 amd64 架构下测试过的进入稳定分支的软件包。<code>KEYWORDS=~amd64</code>则表示接受所有在 amd64 架构下进入稳定分支和测试分支的软件包。</p>\n<p>此外还有一些特殊形式的 KEYWORDS。但本质上是一样的。</p>\n<p>如果软件的 ebuild 的 KEYWORDS 中不包含 amd64，则表明当前软件未在该架构下测试，或不可用。</p>\n<ul>\n<li>如何配置 keywords</li>\n</ul>\n<p>同样，在全局配置文件<code>make.conf</code>中可以配置<code>KEYWORDS=amd64</code>。</p>\n<p>也可以在<code>/etc/portage/package.accept_keywords</code>中接受具体包的 keywords。同样这可以是一个目录，也可以是一个文件，建议设置为目录。在文件中写入<code>app-i18n/fcitx5-chinese-addons</code>之类的包全称即可。</p>\n<p>这里还可以对包版本进行控制。如上例是接受该包所有版本的 keywords。若要接受指定版本，则<code>=x11-libs/xcb-imdkit-99999999999 **</code>。同样<code>&gt; &lt; &gt;= &lt;=</code>均是适用的。这也可以用于其他选项的配置。</p>\n<ul>\n<li>如何查看 keywords</li>\n</ul>\n<p><code>equery meta package_name</code>或者<code>eix package_name</code></p>\n<p>建议使用<code>eix package_name</code>，结果如下</p>\n<p><img src=\"1.png\" alt=\"gcc\"></p>\n<p><img src=\"2.png\" alt=\"kcm-fcitx5\"></p>\n<p>其中版本号前带<code>~</code>的为测试分支。特别注意带<code>(**)</code>的在配置文件中应当写入<code>=app-i18n/kcm-fcitx5-99999999 **</code>。直接写入<code>app-i18n/kcm-fcitx5</code>不会接受该版本。</p>\n<ul>\n<li>是否选择开启测试分支</li>\n</ul>\n<p>测试分支与稳定分支的差异无需多言。不过对于 gentoo 而言，有相当一部分“野包”并未进入稳定分支。因此软件的测试分支并不一定不稳定。</p>\n<p>首先明确，新手绝不要在全局开启测试分支。一来，软件不稳定，bug 较多，新手无能力修复。二来更新频繁，电脑性能不足将严重影响体验感。最后，想再改到稳定分支难上加难。</p>\n<p>是否需要为内核开启测试分支取决于计算机配置。截至本文攥写时，gentoo 稳定分支最新内核版本为 5.4.48，可能已经无法满足部分新机型需要。此时可以选择开启测试分支。gentoo 测试分支内核源码更新频率基本维持在几天一更。如果觉得过于频繁，可以指定测试分支版本或者隔几个版本编译一次内核。</p>\n<h3 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h3><p>另外一个重要的选项是 license，即许可证。虽然 gentoo wiki 并不建议在全局接受所有许可证，但个人建议，如果你对此并不了解，完全可以在<code>make.conf</code>中直接设置<code>ACCEPT_LICENSE=&quot;*&quot;</code>。</p>\n<p>对于新手而言，熟悉以上三个选项足以。</p>\n<p>其他选项可以自行参考 gentoo wiki。</p>\n<h2 id=\"版本控制\"><a href=\"#版本控制\" class=\"headerlink\" title=\"版本控制\"></a>版本控制</h2><p>多版本软件并存是 gentoo 的一大特色，但事实上绝大多数软件并不具备该特性。</p>\n<ul>\n<li>如何查看是否可以多版本共存</li>\n</ul>\n<p><img src=\"3.png\" alt=\"instance\"></p>\n<p>上图是<code>eix clang</code>的部分结果，其中 clang 与 clang-common 均存在多个可选版本。其中版本号前有<code>(number)</code>的 clang 可以多版本共存，而 clang-common 不可。</p>\n<ul>\n<li>如何控制软件版本</li>\n</ul>\n<p>临时设置可以直接在安装命令中指定，如<code>emerge &quot;=sys-devel/clang-9.0.1&quot;</code>。</p>\n<p>如果需要永久固定软件版本，可以通过以下两种方案。</p>\n<p>方案一：如果该软件版本处于测试分支，则在接受其 keyword 时，指定具体版本。当然，这并不能屏蔽稳定分支版本。因此仅适用于无稳定分支的软件。</p>\n<p>方案二：对于方案一不可行的软件，可以在<code>/etc/portage/package.mask</code>中设置将该版本之后的所有版本屏蔽。如<code>&gt;=sys-power/powertop-1.97</code>。</p>\n<h2 id=\"Portage-常见报错\"><a href=\"#Portage-常见报错\" class=\"headerlink\" title=\"Portage 常见报错\"></a>Portage 常见报错</h2><h3 id=\"被阻挡的包\"><a href=\"#被阻挡的包\" class=\"headerlink\" title=\"被阻挡的包\"></a>被阻挡的包</h3><ul>\n<li>报错示例</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">!!! Error: the mail-mta&#x2F;postfix package conflicts with another package.\n!!!        both can&#39;t be installed on the same system together.\n!!!        Please use &#39;emerge --pretend&#39; to determine blockers.<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>原因</li>\n</ul>\n<p>首先由报错信息可知，该软件包被阻挡显然是因为包冲突。一般是因为依赖冲突，包括编译依赖冲突和运行依赖冲突。</p>\n<ul>\n<li>解决方案</li>\n</ul>\n<p>如果你不熟悉 ebuild，不应当首先考虑修改 ebuild。如果可以二者取其一，则只需拆卸一个。如果二者都需要，可以考虑修改安装软件的版本，这可能助于避开依赖冲突。实在没有办法的情况下可以到<a href=\"https://bugs.gentoo.org/\">Gentoo’s bugtracking system</a>提交 bug。</p>\n<h3 id=\"被屏蔽的包\"><a href=\"#被屏蔽的包\" class=\"headerlink\" title=\"被屏蔽的包\"></a>被屏蔽的包</h3><ul>\n<li>报错示例</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">!!! all ebuilds that could satisfy &quot;bootsplash&quot; have been masked.<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">!!! possible candidates are:\n\n- gnome-base&#x2F;gnome-2.8.0_pre1 (masked by: ~x86 keyword)\n- lm-sensors&#x2F;lm-sensors-2.8.7 (masked by: -sparc keyword)\n- sys-libs&#x2F;glibc-2.3.4.20040808 (masked by: -* keyword)\n- dev-util&#x2F;cvsd-1.0.2 (masked by: missing keyword)\n- games-fps&#x2F;unreal-tournament-451 (masked by: package.mask)\n- sys-libs&#x2F;glibc-2.3.2-r11 (masked by: profile)\n- net-im&#x2F;skype-2.1.0.81 (masked by: skype-eula license(s))<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>原因</li>\n</ul>\n<p>一般是由于 keyword（包未经测试，未进入稳定分支）、license（许可证未接受）、package.mask（软件包损坏或有严重问题）或 profile（软件不适合当前 profile）。</p>\n<ul>\n<li>解决方案</li>\n</ul>\n<p>首先明确处于最后两种情况的软件不应被安装。</p>\n<p>前两种情况只需单独为包设置 keyword 或者 license 即可。</p>\n<h3 id=\"USE-flag-的必要更改\"><a href=\"#USE-flag-的必要更改\" class=\"headerlink\" title=\"USE flag 的必要更改\"></a>USE flag 的必要更改</h3><ul>\n<li>报错示例</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">The following USE changes are necessary to proceed:\n#required by app-text&#x2F;happypackage-2.0, required by happypackage (argument)\n&gt;&#x3D;app-text&#x2F;feelings-1.0.0 test<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>原因</li>\n</ul>\n<p>USE flag 不满足当前软件包编译安装需要</p>\n<ul>\n<li>解决方案</li>\n</ul>\n<p>手动修改 USE flag 或者<code>etc-update</code></p>\n<h3 id=\"其他-1\"><a href=\"#其他-1\" class=\"headerlink\" title=\"其他\"></a>其他</h3><p>依赖缺失、循环依赖等依赖方面的错误对于新手而言是个难题，如果你并没有能力自己修复，那么等上游修复 bug 后重试是最好的选择。</p>\n<p>下载失败错误的一般原因应当不用多说，但也不排除 ebuild 中下载地址错误的情况。</p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/05/gentoo-compiler-selection/\">Gentoo Compiler Selection</a></p>\n"},{"title":"Gentoo Preface","date":"2020-08-04T01:57:34.000Z","_content":"\n[Gentoo 教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 教程：前言\n\n## 声明\n\n本教程旨在帮助 gentoo 入坑者快速熟悉 gentoo 系统基本操作。\n\n你应当可以在完成本教程后成功安装，配置 gentoo 系统。并具备一定维护能力。\n\n笔者并非专业人士，文中涉及的部分操作可能并不合适。但对于新手而言应当是非常有效的。\n\n参考来源：\n\n[gentoo wiki](https://wiki.gentoo.org/wiki/Main_Page)\n[arch wiki](https://wiki.archlinux.org/)\n[gentoo forums](https://forums.gentoo.org/)\n[gentoo handbook](https://wiki.gentoo.org/wiki/Handbook:Main_Page/zh-cn)\n[gentoo documentation](https://www.gentoo.org/support/documentation/)\n\n## 前提\n\n- 必须对 linux 系统有一定了解，且比较熟悉命令行。（如果你能安装 arch，就足以尝试安装 gentoo）\n- 电脑配置及格。\n\n## 建议\n\n- 官方 wiki 是最好的教程，但比较零散。强烈建议参考本教程的步骤，结合官方 wiki，进行操作。\n- 先在虚拟机中尝试，方便回滚，减少犯错的时间成本。\n- 切勿急于求成，一定要保证配置好编译选项以及内核。\n\n## 成品\n\n![Gentoo Linux with Kool Desktop Environment](1.png)\n\n下一篇：[Gentoo Package Management](https://www.niuiic.top/2020/08/05/gentoo-package-management/)\n","source":"_posts/gentoo-preface.md","raw":"---\ntitle: Gentoo Preface\ndate: 2020-08-04 09:57:34\ntags:\n        - Gentoo\ncategories:\n        - Gentoo\n---\n\n[Gentoo 教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 教程：前言\n\n## 声明\n\n本教程旨在帮助 gentoo 入坑者快速熟悉 gentoo 系统基本操作。\n\n你应当可以在完成本教程后成功安装，配置 gentoo 系统。并具备一定维护能力。\n\n笔者并非专业人士，文中涉及的部分操作可能并不合适。但对于新手而言应当是非常有效的。\n\n参考来源：\n\n[gentoo wiki](https://wiki.gentoo.org/wiki/Main_Page)\n[arch wiki](https://wiki.archlinux.org/)\n[gentoo forums](https://forums.gentoo.org/)\n[gentoo handbook](https://wiki.gentoo.org/wiki/Handbook:Main_Page/zh-cn)\n[gentoo documentation](https://www.gentoo.org/support/documentation/)\n\n## 前提\n\n- 必须对 linux 系统有一定了解，且比较熟悉命令行。（如果你能安装 arch，就足以尝试安装 gentoo）\n- 电脑配置及格。\n\n## 建议\n\n- 官方 wiki 是最好的教程，但比较零散。强烈建议参考本教程的步骤，结合官方 wiki，进行操作。\n- 先在虚拟机中尝试，方便回滚，减少犯错的时间成本。\n- 切勿急于求成，一定要保证配置好编译选项以及内核。\n\n## 成品\n\n![Gentoo Linux with Kool Desktop Environment](1.png)\n\n下一篇：[Gentoo Package Management](https://www.niuiic.top/2020/08/05/gentoo-package-management/)\n","slug":"gentoo-preface","published":1,"updated":"2021-03-23T11:11:18.579Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmrw001crrizgwrkebz7","content":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo 教程目录</a></p>\n<h1 id=\"Gentoo-教程：前言\"><a href=\"#Gentoo-教程：前言\" class=\"headerlink\" title=\"Gentoo 教程：前言\"></a>Gentoo 教程：前言</h1><h2 id=\"声明\"><a href=\"#声明\" class=\"headerlink\" title=\"声明\"></a>声明</h2><p>本教程旨在帮助 gentoo 入坑者快速熟悉 gentoo 系统基本操作。</p>\n<p>你应当可以在完成本教程后成功安装，配置 gentoo 系统。并具备一定维护能力。</p>\n<p>笔者并非专业人士，文中涉及的部分操作可能并不合适。但对于新手而言应当是非常有效的。</p>\n<p>参考来源：</p>\n<p><a href=\"https://wiki.gentoo.org/wiki/Main_Page\">gentoo wiki</a><br><a href=\"https://wiki.archlinux.org/\">arch wiki</a><br><a href=\"https://forums.gentoo.org/\">gentoo forums</a><br><a href=\"https://wiki.gentoo.org/wiki/Handbook:Main_Page/zh-cn\">gentoo handbook</a><br><a href=\"https://www.gentoo.org/support/documentation/\">gentoo documentation</a></p>\n<h2 id=\"前提\"><a href=\"#前提\" class=\"headerlink\" title=\"前提\"></a>前提</h2><ul>\n<li>必须对 linux 系统有一定了解，且比较熟悉命令行。（如果你能安装 arch，就足以尝试安装 gentoo）</li>\n<li>电脑配置及格。</li>\n</ul>\n<h2 id=\"建议\"><a href=\"#建议\" class=\"headerlink\" title=\"建议\"></a>建议</h2><ul>\n<li>官方 wiki 是最好的教程，但比较零散。强烈建议参考本教程的步骤，结合官方 wiki，进行操作。</li>\n<li>先在虚拟机中尝试，方便回滚，减少犯错的时间成本。</li>\n<li>切勿急于求成，一定要保证配置好编译选项以及内核。</li>\n</ul>\n<h2 id=\"成品\"><a href=\"#成品\" class=\"headerlink\" title=\"成品\"></a>成品</h2><p><img src=\"1.png\" alt=\"Gentoo Linux with Kool Desktop Environment\"></p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/05/gentoo-package-management/\">Gentoo Package Management</a></p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo 教程目录</a></p>\n<h1 id=\"Gentoo-教程：前言\"><a href=\"#Gentoo-教程：前言\" class=\"headerlink\" title=\"Gentoo 教程：前言\"></a>Gentoo 教程：前言</h1><h2 id=\"声明\"><a href=\"#声明\" class=\"headerlink\" title=\"声明\"></a>声明</h2><p>本教程旨在帮助 gentoo 入坑者快速熟悉 gentoo 系统基本操作。</p>\n<p>你应当可以在完成本教程后成功安装，配置 gentoo 系统。并具备一定维护能力。</p>\n<p>笔者并非专业人士，文中涉及的部分操作可能并不合适。但对于新手而言应当是非常有效的。</p>\n<p>参考来源：</p>\n<p><a href=\"https://wiki.gentoo.org/wiki/Main_Page\">gentoo wiki</a><br><a href=\"https://wiki.archlinux.org/\">arch wiki</a><br><a href=\"https://forums.gentoo.org/\">gentoo forums</a><br><a href=\"https://wiki.gentoo.org/wiki/Handbook:Main_Page/zh-cn\">gentoo handbook</a><br><a href=\"https://www.gentoo.org/support/documentation/\">gentoo documentation</a></p>\n<h2 id=\"前提\"><a href=\"#前提\" class=\"headerlink\" title=\"前提\"></a>前提</h2><ul>\n<li>必须对 linux 系统有一定了解，且比较熟悉命令行。（如果你能安装 arch，就足以尝试安装 gentoo）</li>\n<li>电脑配置及格。</li>\n</ul>\n<h2 id=\"建议\"><a href=\"#建议\" class=\"headerlink\" title=\"建议\"></a>建议</h2><ul>\n<li>官方 wiki 是最好的教程，但比较零散。强烈建议参考本教程的步骤，结合官方 wiki，进行操作。</li>\n<li>先在虚拟机中尝试，方便回滚，减少犯错的时间成本。</li>\n<li>切勿急于求成，一定要保证配置好编译选项以及内核。</li>\n</ul>\n<h2 id=\"成品\"><a href=\"#成品\" class=\"headerlink\" title=\"成品\"></a>成品</h2><p><img src=\"1.png\" alt=\"Gentoo Linux with Kool Desktop Environment\"></p>\n<p>下一篇：<a href=\"https://www.niuiic.top/2020/08/05/gentoo-package-management/\">Gentoo Package Management</a></p>\n"},{"title":"Gentoo System Further Improvement","date":"2020-08-08T01:44:38.000Z","_content":"\n[Gentoo 教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 系统完善\n\n本文介绍 gentoo 系统的进一步完善。主要包括一些软件的安装和一些系统配置。\n\n## 添加 gentoo-zh overlay\n\ngentoo-zh 包含了许多国内常用的软件。\n\n```\nemerge eselect-repository\neselect repository add gentoo-zh git https://github.com/microcai/gentoo-zh\neix-sync\n# 或者可以直接使用layman\n```\n\n如果同步时发生错误`Main gentoo tree does not appear to have changed: exiting`，可以`rm -rf /var/db/repos/*`或者`eix-sync -a`解决。\n\n## 字体配置\n\n- 安装 fontconfig\n\n添加 USE flag`static-libs`\n\n`emerge media-libs/fontconfig`\n\n更多配置见[gentoo wiki fontdconfig](https://wiki.gentoo.org/wiki/Fontconfig)。\n\n- 安装字体（不需要全部安装）\n\n```\nemerge media-fonts/font-isas-misc\nemerge media-fonts/arphicfonts\nemerge media-fonts/opendesktop-fonts\nemerge media-fonts/wqy-zenhei\nemerge media-fonts/zh-kcfonts\n```\n\n- 激活字体\n\n```\n# 查看字体配置文件\neselect fontconfig list\n# 激活上面安装的字体\neselect fontconfig enable number\n```\n\n- （可选）将区域改为中文\n\n```\n# 列出可用的区域\neselect locale list\n# 选择中文区域的编号\neselect locale set 5\n```\n\n- 设置桌面使用中文语言\n\n值得注意的是 kde 桌面不能完全汉化。如果你不能接受，干脆用全英文。\n\n```\nnvim ~/.xprofile\n\nexport LANG=zh_CN.UTF-8\nexport LANGUAGE=zh_CN:en_US\n```\n\n## 输入法\n\n这里选用 fcitx5 作为输入法。\n\n- 安装输入法\n\n```\n# 编辑/etc/portage/package.accept_keywords/fcitx5，加入\n\n=app-i18n/fcitx5-999999999 **\n=app-i18n/kcm-fcitx5-99999999 **\n=app-i18n/fcitx5-qt-9999999999 **\napp-i18n/fcitx5-chinese-addons\n=app-i18n/libime-99999999 **\n=x11-libs/xcb-imdkit-99999999999 **\n=app-i18n/cldr-emoji-annotation-9999 **\n=app-i18n/fcitx5-gtk-999999999 **\n```\n\n```\nemerge boost\nemerge xcb-imdkit cldr-emoji-annotation fcitx5 kcm-fcitx5 fcitx5-qt fcitx5-chinese-addons libime fcitx5-gtk\n```\n\n其中`app-text/enchant-1.6.1-r1`编译失败的解决方案为设置 CC 和 CXX 为\n\n```\nCC=x86_64-pc-linux-gnu-gcc\nCXX=x86_64-pc-linux-gnu-g++\n```\n\nlibime 如果编译失败，可尝试修改`=app-i18n/libime-99999999 **`为`app-i18n/libime`（`fcitx5-chinese-addons`失败同理）。\n\n```\n# 修改~/.xprofile\n\nexport GTK_IM_MODULE=fcitx5\nexport QT_IM_MODULE=fcitx5\nexport XMODIFIERS=\"@im=fcitx\"\n\n```\n\n```\nmkdir ~/.config/autostart\ncp /usr/share/applications/fcitx5.desktop ~/.config/autostart\n\n# 自启动也可以在系统设置 start and shutdown 中设置\n```\n\n- 安装主题\n\n先关闭 fcitx5\n\n```\nmkdir -p ~/.local/share/fcitx5/themes/Material-Color\n\n# 以hosxy/Fcitx5-Material-Color为例\n\ngit clone https://github.com/hosxy/Fcitx5-Material-Color.git ~/.local/share/fcitx5/themes/Material-Color\n\ncd ~/.local/share/fcitx5/themes/Material-Color\n\nln -sf ./panel-teal.png panel.png\n\nln -sf ./highlight-teal.png highlight.png\n\n# 修改~/.config/fcitx5/conf/classicui.conf\n\nVertical Candidate List=False\nPerScreenDPI=True\nTheme=Material-Color\n```\n\n更多配置可以直接在`kcm-fcitx5`中配置。\n\n## tlp\n\n```\neselect repository add tlp git https://github.com/dywisor/tlp-portage\n\n# 修改/etc/portage/package.accept_keywords/tlp\n\napp-laptop/tlp\nsys-power/linux-x86-power-tools\n\n# 安装\n\nemerge tlp\nsystemctl enable tlp\n```\n\n## zsh\n\n```\nemerge zsh\n# 设置zsh为默认shell\nchsh -s /bin/zsh\n# 查看当前shell\necho $SHELL\n# 安装oh-my-zsh\ngit clone git://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zsh\ncp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc\n# 配置oh-my-zsh\ngit clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting\ngit clone git://github.com/zsh-users/zsh-autosuggestions $ZSH_CUSTOM/plugins/zsh-autosuggestions\n\nnvim ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh\n\nZSH_AUTOSUGGEST_HIGHLIGHT_STYLE=’fg=20’\n\nnvim ~/.zshrc\n# 设置主题\nZSH_THEME=\"ys\"\n# 设置插件\nplugins=(git z zsh-syntax-highlighting zsh-autosuggestions extract vi-mode)\n\nsource ~/.zshrc\n```\n\n## 键盘映射\n\n```\nemerge xmodmap\nxmodmap -pke > ~/.Xmodmap\n# 修改 ~/.Xmodmap，具体配置自行查询。\nxmodmap ~/.Xmodmap # 用ssh连接是无法启动的，需要在主机上执行\n```\n\n### 触控板手势配置\n\n```\nsudo gpasswd -a $USER input\nemerge x11-misc/libinput-gestures\nlibinput-gestures-setup autostart\n\n# 查看dev-libs/libinput和x11-drivers/xf86-input-libinput以及x11-misc/xdotool是否缺失，缺则补\n\nmkdir /etc/X11/xorg.conf.d\ncp /usr/share/X11/xorg.conf.d/40-libinput.conf /etc/X11/xorg.conf.d/40-libinput.conf\ncp /etc/libinput-gestures.conf ~/.config/libinput-gestures.conf\n# 修改 ~/.config/libinput-gestures.conf，具体配置自行查询。\n```\n\n## grub 主题\n\n[下载 grub 主题](https://www.gnome-look.org/browse/cat/109/)\n\n将主题包解压后放在`/boot/grub/themes`下。\n\n```\n# 修改/etc/default/grub\n\nGRUB_THEME=\"/boot/grub/themes/主题包名/theme.txt\"\nGRUB_GFXMODE=\"1920x1080x32\"\n\n# 更新配置\n\ngrub-mkconfig -o /boot/grub/grub.cfg\n```\n\n## 启用 snap\n\n- 添加 USE flag\n\n```\nsys-apps/systemd policykit apparmor\nsys-libs/libseccomp static-libs\n```\n\n- 开启测试分支\n\n```\nsys-libs/libapparmor\nsys-apps/apparmor\napp-emulation/snapd\nsec-policy/apparmor-profiles\n```\n\n- 安装包\n\n```\nemerge sys-apps/systemd\nemerge sys-apps/apparmor\n```\n\n- 修改 grub 配置\n\n```\nnvim /etc/default/grub\n# 添加\nGRUB_CMDLINE_LINIX_DEFAULT=\"apparmor=1 security=apparmor\"\n\ngrub-mkconfig -o /boot/grub/grub.cfg\n```\n\n- 安装 snap\n\n```\nlayman -a snapd\neix-sync\n# 内核需要开启CONFIG_SECURITY_APPARMOR\n# 如果前面采用的是自动编译，则可以将此项加入/usr/src/linux/.config，再重新编译内核\nemerge --ask app-emulation/snapd\n\nsudo systemctl enable --now snapd\nsudo systemctl enable --now snapd.socket\nsudo systemctl enable --now snapd.apparmor\n```\n\n- snap 加速\n\n```\nsudo systemctl edit snapd\n\n[Service]\nEnvironment=\"http_proxy=http://127.0.0.1:port\"\nEnvironment=\"https_proxy=http://127.0.0.1:port\"\n\nsudo systemctl daemon-reload\nsudo systemctl restart snapd\n```\n","source":"_posts/gentoo-system-further-improvement.md","raw":"---\ntitle: Gentoo System Further Improvement\ndate: 2020-08-08 09:44:38\ntags:\n\t\t- Gentoo\ncategories:\n\t\t- Gentoo\n---\n\n[Gentoo 教程目录](https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/)\n\n# Gentoo 系统完善\n\n本文介绍 gentoo 系统的进一步完善。主要包括一些软件的安装和一些系统配置。\n\n## 添加 gentoo-zh overlay\n\ngentoo-zh 包含了许多国内常用的软件。\n\n```\nemerge eselect-repository\neselect repository add gentoo-zh git https://github.com/microcai/gentoo-zh\neix-sync\n# 或者可以直接使用layman\n```\n\n如果同步时发生错误`Main gentoo tree does not appear to have changed: exiting`，可以`rm -rf /var/db/repos/*`或者`eix-sync -a`解决。\n\n## 字体配置\n\n- 安装 fontconfig\n\n添加 USE flag`static-libs`\n\n`emerge media-libs/fontconfig`\n\n更多配置见[gentoo wiki fontdconfig](https://wiki.gentoo.org/wiki/Fontconfig)。\n\n- 安装字体（不需要全部安装）\n\n```\nemerge media-fonts/font-isas-misc\nemerge media-fonts/arphicfonts\nemerge media-fonts/opendesktop-fonts\nemerge media-fonts/wqy-zenhei\nemerge media-fonts/zh-kcfonts\n```\n\n- 激活字体\n\n```\n# 查看字体配置文件\neselect fontconfig list\n# 激活上面安装的字体\neselect fontconfig enable number\n```\n\n- （可选）将区域改为中文\n\n```\n# 列出可用的区域\neselect locale list\n# 选择中文区域的编号\neselect locale set 5\n```\n\n- 设置桌面使用中文语言\n\n值得注意的是 kde 桌面不能完全汉化。如果你不能接受，干脆用全英文。\n\n```\nnvim ~/.xprofile\n\nexport LANG=zh_CN.UTF-8\nexport LANGUAGE=zh_CN:en_US\n```\n\n## 输入法\n\n这里选用 fcitx5 作为输入法。\n\n- 安装输入法\n\n```\n# 编辑/etc/portage/package.accept_keywords/fcitx5，加入\n\n=app-i18n/fcitx5-999999999 **\n=app-i18n/kcm-fcitx5-99999999 **\n=app-i18n/fcitx5-qt-9999999999 **\napp-i18n/fcitx5-chinese-addons\n=app-i18n/libime-99999999 **\n=x11-libs/xcb-imdkit-99999999999 **\n=app-i18n/cldr-emoji-annotation-9999 **\n=app-i18n/fcitx5-gtk-999999999 **\n```\n\n```\nemerge boost\nemerge xcb-imdkit cldr-emoji-annotation fcitx5 kcm-fcitx5 fcitx5-qt fcitx5-chinese-addons libime fcitx5-gtk\n```\n\n其中`app-text/enchant-1.6.1-r1`编译失败的解决方案为设置 CC 和 CXX 为\n\n```\nCC=x86_64-pc-linux-gnu-gcc\nCXX=x86_64-pc-linux-gnu-g++\n```\n\nlibime 如果编译失败，可尝试修改`=app-i18n/libime-99999999 **`为`app-i18n/libime`（`fcitx5-chinese-addons`失败同理）。\n\n```\n# 修改~/.xprofile\n\nexport GTK_IM_MODULE=fcitx5\nexport QT_IM_MODULE=fcitx5\nexport XMODIFIERS=\"@im=fcitx\"\n\n```\n\n```\nmkdir ~/.config/autostart\ncp /usr/share/applications/fcitx5.desktop ~/.config/autostart\n\n# 自启动也可以在系统设置 start and shutdown 中设置\n```\n\n- 安装主题\n\n先关闭 fcitx5\n\n```\nmkdir -p ~/.local/share/fcitx5/themes/Material-Color\n\n# 以hosxy/Fcitx5-Material-Color为例\n\ngit clone https://github.com/hosxy/Fcitx5-Material-Color.git ~/.local/share/fcitx5/themes/Material-Color\n\ncd ~/.local/share/fcitx5/themes/Material-Color\n\nln -sf ./panel-teal.png panel.png\n\nln -sf ./highlight-teal.png highlight.png\n\n# 修改~/.config/fcitx5/conf/classicui.conf\n\nVertical Candidate List=False\nPerScreenDPI=True\nTheme=Material-Color\n```\n\n更多配置可以直接在`kcm-fcitx5`中配置。\n\n## tlp\n\n```\neselect repository add tlp git https://github.com/dywisor/tlp-portage\n\n# 修改/etc/portage/package.accept_keywords/tlp\n\napp-laptop/tlp\nsys-power/linux-x86-power-tools\n\n# 安装\n\nemerge tlp\nsystemctl enable tlp\n```\n\n## zsh\n\n```\nemerge zsh\n# 设置zsh为默认shell\nchsh -s /bin/zsh\n# 查看当前shell\necho $SHELL\n# 安装oh-my-zsh\ngit clone git://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zsh\ncp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc\n# 配置oh-my-zsh\ngit clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting\ngit clone git://github.com/zsh-users/zsh-autosuggestions $ZSH_CUSTOM/plugins/zsh-autosuggestions\n\nnvim ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh\n\nZSH_AUTOSUGGEST_HIGHLIGHT_STYLE=’fg=20’\n\nnvim ~/.zshrc\n# 设置主题\nZSH_THEME=\"ys\"\n# 设置插件\nplugins=(git z zsh-syntax-highlighting zsh-autosuggestions extract vi-mode)\n\nsource ~/.zshrc\n```\n\n## 键盘映射\n\n```\nemerge xmodmap\nxmodmap -pke > ~/.Xmodmap\n# 修改 ~/.Xmodmap，具体配置自行查询。\nxmodmap ~/.Xmodmap # 用ssh连接是无法启动的，需要在主机上执行\n```\n\n### 触控板手势配置\n\n```\nsudo gpasswd -a $USER input\nemerge x11-misc/libinput-gestures\nlibinput-gestures-setup autostart\n\n# 查看dev-libs/libinput和x11-drivers/xf86-input-libinput以及x11-misc/xdotool是否缺失，缺则补\n\nmkdir /etc/X11/xorg.conf.d\ncp /usr/share/X11/xorg.conf.d/40-libinput.conf /etc/X11/xorg.conf.d/40-libinput.conf\ncp /etc/libinput-gestures.conf ~/.config/libinput-gestures.conf\n# 修改 ~/.config/libinput-gestures.conf，具体配置自行查询。\n```\n\n## grub 主题\n\n[下载 grub 主题](https://www.gnome-look.org/browse/cat/109/)\n\n将主题包解压后放在`/boot/grub/themes`下。\n\n```\n# 修改/etc/default/grub\n\nGRUB_THEME=\"/boot/grub/themes/主题包名/theme.txt\"\nGRUB_GFXMODE=\"1920x1080x32\"\n\n# 更新配置\n\ngrub-mkconfig -o /boot/grub/grub.cfg\n```\n\n## 启用 snap\n\n- 添加 USE flag\n\n```\nsys-apps/systemd policykit apparmor\nsys-libs/libseccomp static-libs\n```\n\n- 开启测试分支\n\n```\nsys-libs/libapparmor\nsys-apps/apparmor\napp-emulation/snapd\nsec-policy/apparmor-profiles\n```\n\n- 安装包\n\n```\nemerge sys-apps/systemd\nemerge sys-apps/apparmor\n```\n\n- 修改 grub 配置\n\n```\nnvim /etc/default/grub\n# 添加\nGRUB_CMDLINE_LINIX_DEFAULT=\"apparmor=1 security=apparmor\"\n\ngrub-mkconfig -o /boot/grub/grub.cfg\n```\n\n- 安装 snap\n\n```\nlayman -a snapd\neix-sync\n# 内核需要开启CONFIG_SECURITY_APPARMOR\n# 如果前面采用的是自动编译，则可以将此项加入/usr/src/linux/.config，再重新编译内核\nemerge --ask app-emulation/snapd\n\nsudo systemctl enable --now snapd\nsudo systemctl enable --now snapd.socket\nsudo systemctl enable --now snapd.apparmor\n```\n\n- snap 加速\n\n```\nsudo systemctl edit snapd\n\n[Service]\nEnvironment=\"http_proxy=http://127.0.0.1:port\"\nEnvironment=\"https_proxy=http://127.0.0.1:port\"\n\nsudo systemctl daemon-reload\nsudo systemctl restart snapd\n```\n","slug":"gentoo-system-further-improvement","published":1,"updated":"2021-03-23T11:11:18.582Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmrx001erriz9fz43hk0","content":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo 教程目录</a></p>\n<h1 id=\"Gentoo-系统完善\"><a href=\"#Gentoo-系统完善\" class=\"headerlink\" title=\"Gentoo 系统完善\"></a>Gentoo 系统完善</h1><p>本文介绍 gentoo 系统的进一步完善。主要包括一些软件的安装和一些系统配置。</p>\n<h2 id=\"添加-gentoo-zh-overlay\"><a href=\"#添加-gentoo-zh-overlay\" class=\"headerlink\" title=\"添加 gentoo-zh overlay\"></a>添加 gentoo-zh overlay</h2><p>gentoo-zh 包含了许多国内常用的软件。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge eselect-repository\neselect repository add gentoo-zh git https:&#x2F;&#x2F;github.com&#x2F;microcai&#x2F;gentoo-zh\neix-sync\n# 或者可以直接使用layman<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>如果同步时发生错误<code>Main gentoo tree does not appear to have changed: exiting</code>，可以<code>rm -rf /var/db/repos/*</code>或者<code>eix-sync -a</code>解决。</p>\n<h2 id=\"字体配置\"><a href=\"#字体配置\" class=\"headerlink\" title=\"字体配置\"></a>字体配置</h2><ul>\n<li>安装 fontconfig</li>\n</ul>\n<p>添加 USE flag<code>static-libs</code></p>\n<p><code>emerge media-libs/fontconfig</code></p>\n<p>更多配置见<a href=\"https://wiki.gentoo.org/wiki/Fontconfig\">gentoo wiki fontdconfig</a>。</p>\n<ul>\n<li>安装字体（不需要全部安装）</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge media-fonts&#x2F;font-isas-misc\nemerge media-fonts&#x2F;arphicfonts\nemerge media-fonts&#x2F;opendesktop-fonts\nemerge media-fonts&#x2F;wqy-zenhei\nemerge media-fonts&#x2F;zh-kcfonts<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>激活字体</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看字体配置文件\neselect fontconfig list\n# 激活上面安装的字体\neselect fontconfig enable number<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>（可选）将区域改为中文</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 列出可用的区域\neselect locale list\n# 选择中文区域的编号\neselect locale set 5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>设置桌面使用中文语言</li>\n</ul>\n<p>值得注意的是 kde 桌面不能完全汉化。如果你不能接受，干脆用全英文。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nvim ~&#x2F;.xprofile\n\nexport LANG&#x3D;zh_CN.UTF-8\nexport LANGUAGE&#x3D;zh_CN:en_US<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"输入法\"><a href=\"#输入法\" class=\"headerlink\" title=\"输入法\"></a>输入法</h2><p>这里选用 fcitx5 作为输入法。</p>\n<ul>\n<li>安装输入法</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 编辑&#x2F;etc&#x2F;portage&#x2F;package.accept_keywords&#x2F;fcitx5，加入\n\n&#x3D;app-i18n&#x2F;fcitx5-999999999 **\n&#x3D;app-i18n&#x2F;kcm-fcitx5-99999999 **\n&#x3D;app-i18n&#x2F;fcitx5-qt-9999999999 **\napp-i18n&#x2F;fcitx5-chinese-addons\n&#x3D;app-i18n&#x2F;libime-99999999 **\n&#x3D;x11-libs&#x2F;xcb-imdkit-99999999999 **\n&#x3D;app-i18n&#x2F;cldr-emoji-annotation-9999 **\n&#x3D;app-i18n&#x2F;fcitx5-gtk-999999999 **<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge boost\nemerge xcb-imdkit cldr-emoji-annotation fcitx5 kcm-fcitx5 fcitx5-qt fcitx5-chinese-addons libime fcitx5-gtk<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>其中<code>app-text/enchant-1.6.1-r1</code>编译失败的解决方案为设置 CC 和 CXX 为</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CC&#x3D;x86_64-pc-linux-gnu-gcc\nCXX&#x3D;x86_64-pc-linux-gnu-g++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>libime 如果编译失败，可尝试修改<code>=app-i18n/libime-99999999 **</code>为<code>app-i18n/libime</code>（<code>fcitx5-chinese-addons</code>失败同理）。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 修改~&#x2F;.xprofile\n\nexport GTK_IM_MODULE&#x3D;fcitx5\nexport QT_IM_MODULE&#x3D;fcitx5\nexport XMODIFIERS&#x3D;&quot;@im&#x3D;fcitx&quot;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mkdir ~&#x2F;.config&#x2F;autostart\ncp &#x2F;usr&#x2F;share&#x2F;applications&#x2F;fcitx5.desktop ~&#x2F;.config&#x2F;autostart\n\n# 自启动也可以在系统设置 start and shutdown 中设置<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>安装主题</li>\n</ul>\n<p>先关闭 fcitx5</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mkdir -p ~&#x2F;.local&#x2F;share&#x2F;fcitx5&#x2F;themes&#x2F;Material-Color\n\n# 以hosxy&#x2F;Fcitx5-Material-Color为例\n\ngit clone https:&#x2F;&#x2F;github.com&#x2F;hosxy&#x2F;Fcitx5-Material-Color.git ~&#x2F;.local&#x2F;share&#x2F;fcitx5&#x2F;themes&#x2F;Material-Color\n\ncd ~&#x2F;.local&#x2F;share&#x2F;fcitx5&#x2F;themes&#x2F;Material-Color\n\nln -sf .&#x2F;panel-teal.png panel.png\n\nln -sf .&#x2F;highlight-teal.png highlight.png\n\n# 修改~&#x2F;.config&#x2F;fcitx5&#x2F;conf&#x2F;classicui.conf\n\nVertical Candidate List&#x3D;False\nPerScreenDPI&#x3D;True\nTheme&#x3D;Material-Color<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>更多配置可以直接在<code>kcm-fcitx5</code>中配置。</p>\n<h2 id=\"tlp\"><a href=\"#tlp\" class=\"headerlink\" title=\"tlp\"></a>tlp</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">eselect repository add tlp git https:&#x2F;&#x2F;github.com&#x2F;dywisor&#x2F;tlp-portage\n\n# 修改&#x2F;etc&#x2F;portage&#x2F;package.accept_keywords&#x2F;tlp\n\napp-laptop&#x2F;tlp\nsys-power&#x2F;linux-x86-power-tools\n\n# 安装\n\nemerge tlp\nsystemctl enable tlp<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"zsh\"><a href=\"#zsh\" class=\"headerlink\" title=\"zsh\"></a>zsh</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge zsh\n# 设置zsh为默认shell\nchsh -s &#x2F;bin&#x2F;zsh\n# 查看当前shell\necho $SHELL\n# 安装oh-my-zsh\ngit clone git:&#x2F;&#x2F;github.com&#x2F;robbyrussell&#x2F;oh-my-zsh.git ~&#x2F;.oh-my-zsh\ncp ~&#x2F;.oh-my-zsh&#x2F;templates&#x2F;zshrc.zsh-template ~&#x2F;.zshrc\n# 配置oh-my-zsh\ngit clone https:&#x2F;&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-syntax-highlighting.git $&#123;ZSH_CUSTOM:-~&#x2F;.oh-my-zsh&#x2F;custom&#125;&#x2F;plugins&#x2F;zsh-syntax-highlighting\ngit clone git:&#x2F;&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-autosuggestions $ZSH_CUSTOM&#x2F;plugins&#x2F;zsh-autosuggestions\n\nnvim ~&#x2F;.oh-my-zsh&#x2F;custom&#x2F;plugins&#x2F;zsh-autosuggestions&#x2F;zsh-autosuggestions.zsh\n\nZSH_AUTOSUGGEST_HIGHLIGHT_STYLE&#x3D;’fg&#x3D;20’\n\nnvim ~&#x2F;.zshrc\n# 设置主题\nZSH_THEME&#x3D;&quot;ys&quot;\n# 设置插件\nplugins&#x3D;(git z zsh-syntax-highlighting zsh-autosuggestions extract vi-mode)\n\nsource ~&#x2F;.zshrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"键盘映射\"><a href=\"#键盘映射\" class=\"headerlink\" title=\"键盘映射\"></a>键盘映射</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge xmodmap\nxmodmap -pke &gt; ~&#x2F;.Xmodmap\n# 修改 ~&#x2F;.Xmodmap，具体配置自行查询。\nxmodmap ~&#x2F;.Xmodmap # 用ssh连接是无法启动的，需要在主机上执行<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"触控板手势配置\"><a href=\"#触控板手势配置\" class=\"headerlink\" title=\"触控板手势配置\"></a>触控板手势配置</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo gpasswd -a $USER input\nemerge x11-misc&#x2F;libinput-gestures\nlibinput-gestures-setup autostart\n\n# 查看dev-libs&#x2F;libinput和x11-drivers&#x2F;xf86-input-libinput以及x11-misc&#x2F;xdotool是否缺失，缺则补\n\nmkdir &#x2F;etc&#x2F;X11&#x2F;xorg.conf.d\ncp &#x2F;usr&#x2F;share&#x2F;X11&#x2F;xorg.conf.d&#x2F;40-libinput.conf &#x2F;etc&#x2F;X11&#x2F;xorg.conf.d&#x2F;40-libinput.conf\ncp &#x2F;etc&#x2F;libinput-gestures.conf ~&#x2F;.config&#x2F;libinput-gestures.conf\n# 修改 ~&#x2F;.config&#x2F;libinput-gestures.conf，具体配置自行查询。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"grub-主题\"><a href=\"#grub-主题\" class=\"headerlink\" title=\"grub 主题\"></a>grub 主题</h2><p><a href=\"https://www.gnome-look.org/browse/cat/109/\">下载 grub 主题</a></p>\n<p>将主题包解压后放在<code>/boot/grub/themes</code>下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 修改&#x2F;etc&#x2F;default&#x2F;grub\n\nGRUB_THEME&#x3D;&quot;&#x2F;boot&#x2F;grub&#x2F;themes&#x2F;主题包名&#x2F;theme.txt&quot;\nGRUB_GFXMODE&#x3D;&quot;1920x1080x32&quot;\n\n# 更新配置\n\ngrub-mkconfig -o &#x2F;boot&#x2F;grub&#x2F;grub.cfg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"启用-snap\"><a href=\"#启用-snap\" class=\"headerlink\" title=\"启用 snap\"></a>启用 snap</h2><ul>\n<li>添加 USE flag</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sys-apps&#x2F;systemd policykit apparmor\nsys-libs&#x2F;libseccomp static-libs<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>开启测试分支</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sys-libs&#x2F;libapparmor\nsys-apps&#x2F;apparmor\napp-emulation&#x2F;snapd\nsec-policy&#x2F;apparmor-profiles<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>安装包</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge sys-apps&#x2F;systemd\nemerge sys-apps&#x2F;apparmor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>修改 grub 配置</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nvim &#x2F;etc&#x2F;default&#x2F;grub\n# 添加\nGRUB_CMDLINE_LINIX_DEFAULT&#x3D;&quot;apparmor&#x3D;1 security&#x3D;apparmor&quot;\n\ngrub-mkconfig -o &#x2F;boot&#x2F;grub&#x2F;grub.cfg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>安装 snap</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">layman -a snapd\neix-sync\n# 内核需要开启CONFIG_SECURITY_APPARMOR\n# 如果前面采用的是自动编译，则可以将此项加入&#x2F;usr&#x2F;src&#x2F;linux&#x2F;.config，再重新编译内核\nemerge --ask app-emulation&#x2F;snapd\n\nsudo systemctl enable --now snapd\nsudo systemctl enable --now snapd.socket\nsudo systemctl enable --now snapd.apparmor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>snap 加速</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo systemctl edit snapd\n\n[Service]\nEnvironment&#x3D;&quot;http_proxy&#x3D;http:&#x2F;&#x2F;127.0.0.1:port&quot;\nEnvironment&#x3D;&quot;https_proxy&#x3D;http:&#x2F;&#x2F;127.0.0.1:port&quot;\n\nsudo systemctl daemon-reload\nsudo systemctl restart snapd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<p><a href=\"https://www.niuiic.top/2020/08/06/gentoo-tutorials-directory/\">Gentoo 教程目录</a></p>\n<h1 id=\"Gentoo-系统完善\"><a href=\"#Gentoo-系统完善\" class=\"headerlink\" title=\"Gentoo 系统完善\"></a>Gentoo 系统完善</h1><p>本文介绍 gentoo 系统的进一步完善。主要包括一些软件的安装和一些系统配置。</p>\n<h2 id=\"添加-gentoo-zh-overlay\"><a href=\"#添加-gentoo-zh-overlay\" class=\"headerlink\" title=\"添加 gentoo-zh overlay\"></a>添加 gentoo-zh overlay</h2><p>gentoo-zh 包含了许多国内常用的软件。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge eselect-repository\neselect repository add gentoo-zh git https:&#x2F;&#x2F;github.com&#x2F;microcai&#x2F;gentoo-zh\neix-sync\n# 或者可以直接使用layman<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>如果同步时发生错误<code>Main gentoo tree does not appear to have changed: exiting</code>，可以<code>rm -rf /var/db/repos/*</code>或者<code>eix-sync -a</code>解决。</p>\n<h2 id=\"字体配置\"><a href=\"#字体配置\" class=\"headerlink\" title=\"字体配置\"></a>字体配置</h2><ul>\n<li>安装 fontconfig</li>\n</ul>\n<p>添加 USE flag<code>static-libs</code></p>\n<p><code>emerge media-libs/fontconfig</code></p>\n<p>更多配置见<a href=\"https://wiki.gentoo.org/wiki/Fontconfig\">gentoo wiki fontdconfig</a>。</p>\n<ul>\n<li>安装字体（不需要全部安装）</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge media-fonts&#x2F;font-isas-misc\nemerge media-fonts&#x2F;arphicfonts\nemerge media-fonts&#x2F;opendesktop-fonts\nemerge media-fonts&#x2F;wqy-zenhei\nemerge media-fonts&#x2F;zh-kcfonts<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>激活字体</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 查看字体配置文件\neselect fontconfig list\n# 激活上面安装的字体\neselect fontconfig enable number<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>（可选）将区域改为中文</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 列出可用的区域\neselect locale list\n# 选择中文区域的编号\neselect locale set 5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>设置桌面使用中文语言</li>\n</ul>\n<p>值得注意的是 kde 桌面不能完全汉化。如果你不能接受，干脆用全英文。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nvim ~&#x2F;.xprofile\n\nexport LANG&#x3D;zh_CN.UTF-8\nexport LANGUAGE&#x3D;zh_CN:en_US<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"输入法\"><a href=\"#输入法\" class=\"headerlink\" title=\"输入法\"></a>输入法</h2><p>这里选用 fcitx5 作为输入法。</p>\n<ul>\n<li>安装输入法</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 编辑&#x2F;etc&#x2F;portage&#x2F;package.accept_keywords&#x2F;fcitx5，加入\n\n&#x3D;app-i18n&#x2F;fcitx5-999999999 **\n&#x3D;app-i18n&#x2F;kcm-fcitx5-99999999 **\n&#x3D;app-i18n&#x2F;fcitx5-qt-9999999999 **\napp-i18n&#x2F;fcitx5-chinese-addons\n&#x3D;app-i18n&#x2F;libime-99999999 **\n&#x3D;x11-libs&#x2F;xcb-imdkit-99999999999 **\n&#x3D;app-i18n&#x2F;cldr-emoji-annotation-9999 **\n&#x3D;app-i18n&#x2F;fcitx5-gtk-999999999 **<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge boost\nemerge xcb-imdkit cldr-emoji-annotation fcitx5 kcm-fcitx5 fcitx5-qt fcitx5-chinese-addons libime fcitx5-gtk<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>其中<code>app-text/enchant-1.6.1-r1</code>编译失败的解决方案为设置 CC 和 CXX 为</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CC&#x3D;x86_64-pc-linux-gnu-gcc\nCXX&#x3D;x86_64-pc-linux-gnu-g++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>libime 如果编译失败，可尝试修改<code>=app-i18n/libime-99999999 **</code>为<code>app-i18n/libime</code>（<code>fcitx5-chinese-addons</code>失败同理）。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 修改~&#x2F;.xprofile\n\nexport GTK_IM_MODULE&#x3D;fcitx5\nexport QT_IM_MODULE&#x3D;fcitx5\nexport XMODIFIERS&#x3D;&quot;@im&#x3D;fcitx&quot;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mkdir ~&#x2F;.config&#x2F;autostart\ncp &#x2F;usr&#x2F;share&#x2F;applications&#x2F;fcitx5.desktop ~&#x2F;.config&#x2F;autostart\n\n# 自启动也可以在系统设置 start and shutdown 中设置<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>安装主题</li>\n</ul>\n<p>先关闭 fcitx5</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mkdir -p ~&#x2F;.local&#x2F;share&#x2F;fcitx5&#x2F;themes&#x2F;Material-Color\n\n# 以hosxy&#x2F;Fcitx5-Material-Color为例\n\ngit clone https:&#x2F;&#x2F;github.com&#x2F;hosxy&#x2F;Fcitx5-Material-Color.git ~&#x2F;.local&#x2F;share&#x2F;fcitx5&#x2F;themes&#x2F;Material-Color\n\ncd ~&#x2F;.local&#x2F;share&#x2F;fcitx5&#x2F;themes&#x2F;Material-Color\n\nln -sf .&#x2F;panel-teal.png panel.png\n\nln -sf .&#x2F;highlight-teal.png highlight.png\n\n# 修改~&#x2F;.config&#x2F;fcitx5&#x2F;conf&#x2F;classicui.conf\n\nVertical Candidate List&#x3D;False\nPerScreenDPI&#x3D;True\nTheme&#x3D;Material-Color<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>更多配置可以直接在<code>kcm-fcitx5</code>中配置。</p>\n<h2 id=\"tlp\"><a href=\"#tlp\" class=\"headerlink\" title=\"tlp\"></a>tlp</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">eselect repository add tlp git https:&#x2F;&#x2F;github.com&#x2F;dywisor&#x2F;tlp-portage\n\n# 修改&#x2F;etc&#x2F;portage&#x2F;package.accept_keywords&#x2F;tlp\n\napp-laptop&#x2F;tlp\nsys-power&#x2F;linux-x86-power-tools\n\n# 安装\n\nemerge tlp\nsystemctl enable tlp<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"zsh\"><a href=\"#zsh\" class=\"headerlink\" title=\"zsh\"></a>zsh</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge zsh\n# 设置zsh为默认shell\nchsh -s &#x2F;bin&#x2F;zsh\n# 查看当前shell\necho $SHELL\n# 安装oh-my-zsh\ngit clone git:&#x2F;&#x2F;github.com&#x2F;robbyrussell&#x2F;oh-my-zsh.git ~&#x2F;.oh-my-zsh\ncp ~&#x2F;.oh-my-zsh&#x2F;templates&#x2F;zshrc.zsh-template ~&#x2F;.zshrc\n# 配置oh-my-zsh\ngit clone https:&#x2F;&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-syntax-highlighting.git $&#123;ZSH_CUSTOM:-~&#x2F;.oh-my-zsh&#x2F;custom&#125;&#x2F;plugins&#x2F;zsh-syntax-highlighting\ngit clone git:&#x2F;&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-autosuggestions $ZSH_CUSTOM&#x2F;plugins&#x2F;zsh-autosuggestions\n\nnvim ~&#x2F;.oh-my-zsh&#x2F;custom&#x2F;plugins&#x2F;zsh-autosuggestions&#x2F;zsh-autosuggestions.zsh\n\nZSH_AUTOSUGGEST_HIGHLIGHT_STYLE&#x3D;’fg&#x3D;20’\n\nnvim ~&#x2F;.zshrc\n# 设置主题\nZSH_THEME&#x3D;&quot;ys&quot;\n# 设置插件\nplugins&#x3D;(git z zsh-syntax-highlighting zsh-autosuggestions extract vi-mode)\n\nsource ~&#x2F;.zshrc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"键盘映射\"><a href=\"#键盘映射\" class=\"headerlink\" title=\"键盘映射\"></a>键盘映射</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge xmodmap\nxmodmap -pke &gt; ~&#x2F;.Xmodmap\n# 修改 ~&#x2F;.Xmodmap，具体配置自行查询。\nxmodmap ~&#x2F;.Xmodmap # 用ssh连接是无法启动的，需要在主机上执行<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"触控板手势配置\"><a href=\"#触控板手势配置\" class=\"headerlink\" title=\"触控板手势配置\"></a>触控板手势配置</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo gpasswd -a $USER input\nemerge x11-misc&#x2F;libinput-gestures\nlibinput-gestures-setup autostart\n\n# 查看dev-libs&#x2F;libinput和x11-drivers&#x2F;xf86-input-libinput以及x11-misc&#x2F;xdotool是否缺失，缺则补\n\nmkdir &#x2F;etc&#x2F;X11&#x2F;xorg.conf.d\ncp &#x2F;usr&#x2F;share&#x2F;X11&#x2F;xorg.conf.d&#x2F;40-libinput.conf &#x2F;etc&#x2F;X11&#x2F;xorg.conf.d&#x2F;40-libinput.conf\ncp &#x2F;etc&#x2F;libinput-gestures.conf ~&#x2F;.config&#x2F;libinput-gestures.conf\n# 修改 ~&#x2F;.config&#x2F;libinput-gestures.conf，具体配置自行查询。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"grub-主题\"><a href=\"#grub-主题\" class=\"headerlink\" title=\"grub 主题\"></a>grub 主题</h2><p><a href=\"https://www.gnome-look.org/browse/cat/109/\">下载 grub 主题</a></p>\n<p>将主题包解压后放在<code>/boot/grub/themes</code>下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 修改&#x2F;etc&#x2F;default&#x2F;grub\n\nGRUB_THEME&#x3D;&quot;&#x2F;boot&#x2F;grub&#x2F;themes&#x2F;主题包名&#x2F;theme.txt&quot;\nGRUB_GFXMODE&#x3D;&quot;1920x1080x32&quot;\n\n# 更新配置\n\ngrub-mkconfig -o &#x2F;boot&#x2F;grub&#x2F;grub.cfg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"启用-snap\"><a href=\"#启用-snap\" class=\"headerlink\" title=\"启用 snap\"></a>启用 snap</h2><ul>\n<li>添加 USE flag</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sys-apps&#x2F;systemd policykit apparmor\nsys-libs&#x2F;libseccomp static-libs<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>开启测试分支</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sys-libs&#x2F;libapparmor\nsys-apps&#x2F;apparmor\napp-emulation&#x2F;snapd\nsec-policy&#x2F;apparmor-profiles<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>安装包</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">emerge sys-apps&#x2F;systemd\nemerge sys-apps&#x2F;apparmor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<ul>\n<li>修改 grub 配置</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nvim &#x2F;etc&#x2F;default&#x2F;grub\n# 添加\nGRUB_CMDLINE_LINIX_DEFAULT&#x3D;&quot;apparmor&#x3D;1 security&#x3D;apparmor&quot;\n\ngrub-mkconfig -o &#x2F;boot&#x2F;grub&#x2F;grub.cfg<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>安装 snap</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">layman -a snapd\neix-sync\n# 内核需要开启CONFIG_SECURITY_APPARMOR\n# 如果前面采用的是自动编译，则可以将此项加入&#x2F;usr&#x2F;src&#x2F;linux&#x2F;.config，再重新编译内核\nemerge --ask app-emulation&#x2F;snapd\n\nsudo systemctl enable --now snapd\nsudo systemctl enable --now snapd.socket\nsudo systemctl enable --now snapd.apparmor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>snap 加速</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo systemctl edit snapd\n\n[Service]\nEnvironment&#x3D;&quot;http_proxy&#x3D;http:&#x2F;&#x2F;127.0.0.1:port&quot;\nEnvironment&#x3D;&quot;https_proxy&#x3D;http:&#x2F;&#x2F;127.0.0.1:port&quot;\n\nsudo systemctl daemon-reload\nsudo systemctl restart snapd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n"},{"title":"Gentoo Tutorials Directory","date":"2020-08-06T14:00:09.000Z","_content":"\n# Gentoo 系列教程目录\n\n## [Gentoo Preface](https://niuiic.top/2020/08/04/gentoo-preface/)\n\n## [Gentoo Package Management](https://niuiic.top/2020/08/05/gentoo-package-management/)\n\n## [Gentoo Compiler Selection](https://niuiic.top/2020/08/05/gentoo-compiler-selection/)\n\n## [Gentoo Compile Error Handling](https://niuiic.top/2020/08/06/gentoo-compile-error-handling/)\n\n## [Gentoo Basic System Installation](https://www.niuiic.top/2020/08/07/gentoo-basic-system-installation/)\n\n## [Gentoo Kool Desktop Environment Installation](https://www.niuiic.top/2020/08/08/gentoo-kool-desktop-environment-installation/)\n\n## [Gentoo System Further Improvement](https://www.niuiic.top/2020/08/08/gentoo-system-further-improvement/)\n","source":"_posts/gentoo-tutorials-directory.md","raw":"---\ntitle: Gentoo Tutorials Directory\ndate: 2020-08-06 22:00:09\ntags:\n        - Gentoo\ncategories:\n        - Gentoo\n---\n\n# Gentoo 系列教程目录\n\n## [Gentoo Preface](https://niuiic.top/2020/08/04/gentoo-preface/)\n\n## [Gentoo Package Management](https://niuiic.top/2020/08/05/gentoo-package-management/)\n\n## [Gentoo Compiler Selection](https://niuiic.top/2020/08/05/gentoo-compiler-selection/)\n\n## [Gentoo Compile Error Handling](https://niuiic.top/2020/08/06/gentoo-compile-error-handling/)\n\n## [Gentoo Basic System Installation](https://www.niuiic.top/2020/08/07/gentoo-basic-system-installation/)\n\n## [Gentoo Kool Desktop Environment Installation](https://www.niuiic.top/2020/08/08/gentoo-kool-desktop-environment-installation/)\n\n## [Gentoo System Further Improvement](https://www.niuiic.top/2020/08/08/gentoo-system-further-improvement/)\n","slug":"gentoo-tutorials-directory","published":1,"updated":"2021-03-23T11:11:18.582Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmrz001hrriz942n79wc","content":"<h1 id=\"Gentoo-系列教程目录\"><a href=\"#Gentoo-系列教程目录\" class=\"headerlink\" title=\"Gentoo 系列教程目录\"></a>Gentoo 系列教程目录</h1><h2 id=\"Gentoo-Preface\"><a href=\"#Gentoo-Preface\" class=\"headerlink\" title=\"Gentoo Preface\"></a><a href=\"https://niuiic.top/2020/08/04/gentoo-preface/\">Gentoo Preface</a></h2><h2 id=\"Gentoo-Package-Management\"><a href=\"#Gentoo-Package-Management\" class=\"headerlink\" title=\"Gentoo Package Management\"></a><a href=\"https://niuiic.top/2020/08/05/gentoo-package-management/\">Gentoo Package Management</a></h2><h2 id=\"Gentoo-Compiler-Selection\"><a href=\"#Gentoo-Compiler-Selection\" class=\"headerlink\" title=\"Gentoo Compiler Selection\"></a><a href=\"https://niuiic.top/2020/08/05/gentoo-compiler-selection/\">Gentoo Compiler Selection</a></h2><h2 id=\"Gentoo-Compile-Error-Handling\"><a href=\"#Gentoo-Compile-Error-Handling\" class=\"headerlink\" title=\"Gentoo Compile Error Handling\"></a><a href=\"https://niuiic.top/2020/08/06/gentoo-compile-error-handling/\">Gentoo Compile Error Handling</a></h2><h2 id=\"Gentoo-Basic-System-Installation\"><a href=\"#Gentoo-Basic-System-Installation\" class=\"headerlink\" title=\"Gentoo Basic System Installation\"></a><a href=\"https://www.niuiic.top/2020/08/07/gentoo-basic-system-installation/\">Gentoo Basic System Installation</a></h2><h2 id=\"Gentoo-Kool-Desktop-Environment-Installation\"><a href=\"#Gentoo-Kool-Desktop-Environment-Installation\" class=\"headerlink\" title=\"Gentoo Kool Desktop Environment Installation\"></a><a href=\"https://www.niuiic.top/2020/08/08/gentoo-kool-desktop-environment-installation/\">Gentoo Kool Desktop Environment Installation</a></h2><h2 id=\"Gentoo-System-Further-Improvement\"><a href=\"#Gentoo-System-Further-Improvement\" class=\"headerlink\" title=\"Gentoo System Further Improvement\"></a><a href=\"https://www.niuiic.top/2020/08/08/gentoo-system-further-improvement/\">Gentoo System Further Improvement</a></h2>","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"Gentoo-系列教程目录\"><a href=\"#Gentoo-系列教程目录\" class=\"headerlink\" title=\"Gentoo 系列教程目录\"></a>Gentoo 系列教程目录</h1><h2 id=\"Gentoo-Preface\"><a href=\"#Gentoo-Preface\" class=\"headerlink\" title=\"Gentoo Preface\"></a><a href=\"https://niuiic.top/2020/08/04/gentoo-preface/\">Gentoo Preface</a></h2><h2 id=\"Gentoo-Package-Management\"><a href=\"#Gentoo-Package-Management\" class=\"headerlink\" title=\"Gentoo Package Management\"></a><a href=\"https://niuiic.top/2020/08/05/gentoo-package-management/\">Gentoo Package Management</a></h2><h2 id=\"Gentoo-Compiler-Selection\"><a href=\"#Gentoo-Compiler-Selection\" class=\"headerlink\" title=\"Gentoo Compiler Selection\"></a><a href=\"https://niuiic.top/2020/08/05/gentoo-compiler-selection/\">Gentoo Compiler Selection</a></h2><h2 id=\"Gentoo-Compile-Error-Handling\"><a href=\"#Gentoo-Compile-Error-Handling\" class=\"headerlink\" title=\"Gentoo Compile Error Handling\"></a><a href=\"https://niuiic.top/2020/08/06/gentoo-compile-error-handling/\">Gentoo Compile Error Handling</a></h2><h2 id=\"Gentoo-Basic-System-Installation\"><a href=\"#Gentoo-Basic-System-Installation\" class=\"headerlink\" title=\"Gentoo Basic System Installation\"></a><a href=\"https://www.niuiic.top/2020/08/07/gentoo-basic-system-installation/\">Gentoo Basic System Installation</a></h2><h2 id=\"Gentoo-Kool-Desktop-Environment-Installation\"><a href=\"#Gentoo-Kool-Desktop-Environment-Installation\" class=\"headerlink\" title=\"Gentoo Kool Desktop Environment Installation\"></a><a href=\"https://www.niuiic.top/2020/08/08/gentoo-kool-desktop-environment-installation/\">Gentoo Kool Desktop Environment Installation</a></h2><h2 id=\"Gentoo-System-Further-Improvement\"><a href=\"#Gentoo-System-Further-Improvement\" class=\"headerlink\" title=\"Gentoo System Further Improvement\"></a><a href=\"https://www.niuiic.top/2020/08/08/gentoo-system-further-improvement/\">Gentoo System Further Improvement</a></h2>"},{"title":"Install Manjaro on rpi4","date":"2021-05-15T13:53:05.000Z","_content":"\n# 在树莓派 4 上安装 manjaro\n\n本文介绍如何在树莓派 4 上安装系统并做一定的性能提升。\n\n## 方案介绍\n\n1. 放弃孱弱的 SD 卡，使用固态硬盘从 USB 引导启动。\n2. 加装 USB 网卡，解决内置网卡被外壳屏蔽的问题。\n3. 使用 64 位 manjaro 系统。既容易安装，又可以使用 arch 庞大的软件库，还更加稳定。\n\n> 1. SD 卡接口读写速度大概在几十 M 左右，换成 USB3.0 后可以达到几百 M，差不多可以翻 10 倍。\n> 2. 如果使用全封闭式金属外壳，内置网卡甚至总是连不上网。不过就算全敞开，也不见得有号称的千兆网卡的性能。\n> 3. 使用 manjaro 主要是软件比较新而且丰富。不使用 arch 主要还是没空折腾。\n\n## 硬件准备\n\n1. 一张 SD 卡（16G 就可以）。\n2. 一个 USB 读卡器。\n3. 一个免驱 USB 网卡。\n4. 一个的 128G 固态硬盘。\n5. 一条网线。\n\n> 1. 固态的容量不需要很大。因为树莓派不能当电脑用，不需要安装过多软件。如果要存储，可以另加。\n> 2. 不需要使用 m2 接口的固态。因为 USB3.0 接口的读写速度有限，500M/s 读写速度的硬盘就足够了。\n\n## 设置从 USB 引导\n\n设置从 USB 引导需要升级固件并做设置。\n\n> 如果是较新的树莓派 4，固件已经不需要升级。不过为了方便做设置，也需要进行以下步骤。\n\n### 安装 Raspberry Pi OS\n\n访问[树莓派系统官网](https://www.raspberrypi.org/software/)下载 Raspberry Pi Imager。\n\n用该软件向 SD 卡中写入 Raspberry Pi OS 镜像（只有字符界面的就可以）。\n\n写完后拔下读卡器。\n\n以下假设电脑有以太网接口，且为 windows 系统（其他情况上网查找如何连接树莓派）。\n\n打开 windows 中的更改适配器设置。将当前联网的适配器，如 wifi，共享给以太网接口（新版本的 windows 中已经没有具体共享给哪个接口的选项，只需要设置共享即可）。\n\n把卡插入树莓派，用网线连接树莓派与电脑，启动树莓派。\n\n待树莓派启动后（查看网络适配器，发现以太网接口已经连接，只是无法识别），打开 cmd，输入`arp -a`。结果如下所示。\n\n![cmd](1.png)\n\n一般进行上述设置后，以太网接口的 ip 变成`192.168.137.1`。如果是别的，需要根据实际 ip 修改下面的设置。\n\n> 为什么要共享网络。虽然不共享网络也会有以太网 ip。但是这个 ip 基本不会是 192.168 开头的，会影响到树莓派连接 wifi。\n\n给树莓派断电，拔出 SD 卡，再用读卡器插回电脑。\n\n现在可以看到的是树莓派系统的 boot 分区。修改`cmdline.txt`的第一行，再开头添加`ip=192.168.137.20`。`192.168.137`是网段，这一段必须和前面查出的一致。最后一个数字可以随便选择，这里以 20 为例。\n\n新建 SSH 文件。注意该文件空白且无后缀。这是为了正常启用 SSH。\n\n再把 SD 卡插回树莓派，启动。\n\n等树莓派完全启动后就可以在电脑上使用 putty 或者其他软件通过`192.168.137.20`访问树莓派。默认用户为 pi，密码为 raspberry。\n\n登录后，先来连接网络。首先把免驱 USB 网卡插到 USB2.0（黑色）接口上。\n\n> 一般家用网络传输速度不会超过 USB2.0 的传输速度，所谓的千兆网卡一般也不行。当然如果另一个 USB3 没用的话可以插上。\n\n由于是字符界面，因此使用命令行工具来连接。\n\n```\n# wifi name 和 password 改成实际的值。wifi名称可以在手机或者电脑上看。\nwpa_passphrase \"wifi name\" password > internet.conf\n# wlan0是内置网卡接口的名称。可以使用ip a来查看USB网卡的名称，然后使用USB网卡。\nsudo wpa_supplicant -c ./internet.conf -i wlan0 &\nsudo dhcpcd &\n```\n\n连上网后，给系统换源。\n\n```\n# 编辑/etc/apt/sources.list，修改内容为\ndeb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib\ndeb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib\n# 编辑/etc/apt/sources.list.d/raspi.list，修改内容为\ndeb http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui\n```\n\n### 更新固件\n\n```\nsudo apt update\nsudo apt full-upgrade\n# 编辑/etc/default/rpi-eeprom-update，修改为\nFIRMWARE_RELEASE_STATUS=\"stable\"\n\nsudo rpi-eeprom-update -d -a\n```\n\n### 设置引导顺序\n\n使用`sudo raspi-config`启动配置工具。在其中设置 boot order 即可。\n\n## 安装 manjaro\n\n前往[清华镜像站](https://mirrors.tuna.tsinghua.edu.cn/osdn/storage/g/m/ma/manjaro-arm/rpi4/)下载自己想要的系统。\n\n> 如果你需要桌面，且又不想耗费太多性能，可以选择 i3 或者 xfce 桌面。如果你不熟悉 wayland，最好不要选择 sway。\n\n下载完成之后，使用树莓派镜像刻录工具将镜像写入固态硬盘中。\n\n写完后拔出固态，再插回。在`cmdline.txt`文件的第一行开头加上`ip=192.168.137.20`，然后再新建`SSH`文件。\n\n把固态硬盘接到树莓派 USB3 接口（蓝色）上，上电。\n\n### 初始设置\n\n使用`root`用户登录。首次登录无密码，直接进入设置页面。自行设置。\n\n1. 一般的键盘，其布局为 us。\n2. 时区选择`Asia/Shanghai`。\n3. locale 可以选`en_US.UTF-8`或者`zh_CN.UTF-8`。\n\n设置完成后会自动重启。\n\n### 连接网络\n\n使用`ip a`查看网络连接情况，结果如下。\n![ip a](2.png)\n\n1. 关闭内置网卡。`sudo ip link set wlan0 down`\n2. 连接 wifi。`sudo nmcli d wifi connect \"KFC_free\" password \"12345678\"`\n   > 第一步的目的是让 NetworkManager 在树莓派启动时不会自动使用 wlan0 连接 wifi。如果第一次联网时不先关闭 wlan0，则下次联网时两个接口都会获得 ip。但是系统一次只能用一个，如果用到内置网卡，可能就会影响速度。如果你熟悉网络方面的设置，可以设置轮流使用两个网卡。比如一个网卡在下载，用另一个网卡浏览网页。本文不做这方面介绍。\n\n### 换源\n\n```\nsudo pacman-mirrors -i -c China -m rank\n# 编辑 /etc/pacman.conf，在最后写入\n\n[archlinuxcn]\nSigLevel = Optional TrustAll\nServer = http://mirrors.163.com/archlinux-cn/$arch\n\n# 更新\nsudo pacman -Syyy\n```\n\n> 1. 为了稳定，只使用 manjaro 的稳定源，不添加 arch 源。\n> 2. 清华源总是莫名其妙的对 ip 限流，个人选择绕开它。\n\n安装 yay。`sudo pacman -S yay`\n换源。`yay --aururl \"https://aur.tuna.tsinghua.edu.cn\" --save`\n\n> 这个只能选清华源了。\n\n升级所有软件。`sudo pacman -Syu`\n\n### VNC\n\n设置远程连接桌面。\n\n```\nsudo pacman -S tigervnc\n# 设置密码\nvncpasswd\n# 配置用户，把niuiic换成自己的用户名\nif [ -z \"$(grep niuiic /etc/tigervnc/vncserver.users)\" ];then\n        #sudo sed -i '/niuiic/d' /etc/tigervnc/vncserver.users\n        echo \"  :1=niuiic\" | sudo tee -a /etc/tigervnc/vncserver.users\n    fi\n# 查看自己的桌面。注意如果你前面安装了sway桌面，这里就麻烦了。\n# 因为sway使用wayland协议，你压根不会有这个目录。\n# 可以参考https://github.com/swaywm/sway/issues/100自己设置。\nls   /usr/share/xsessions/\n# 编辑~/.vnc/config\n# session是桌面名，geometry是分辨率。\nsession=xfce\ngeometry=1920x1080\nalwaysshared\n# 启动vnc\n# 默认端口为5901\nsudo systemctl enable vncserver@:1\nsudo systemctl start vncserver@:1\n```\n\n下载 vncviewer 软件。使用`192.168.137.20:5901`连接树莓派。以下是连接成功后的桌面截图。有点黑边，调整下软件窗口大小即可。\n\n![screen](3.png)\n\n### vulkan\n\n安装 vulkan 只是为了测试一些特定的包。不需要的可以略过。（想玩游戏的就省省吧，树莓派这性能还跑不了需要 vulkan 的游戏，除非是你自己写的贪吃蛇~~。）\n\n```\nsudo pacman -Syu linux-rpi4-rc linux-rpi4-rc-headers mesa-git\n# 如果显示没有xf86-video-fbturbo包，就不管它。\nsudo pacman -U xf86-video-fbturbo\n```\n\n目前 mesa-git 还不支持 DRI3。\n\n还有一件事，源里的 v2ray 有点问题，去 GitHub 上下个吧。\n\n到此为止了，其他配置网上都查得到，多数也都是正确的，不需要折腾。\n","source":"_posts/install-manjaro-on-rpi4.md","raw":"---\ntitle: Install Manjaro on rpi4\ndate: 2021-05-15 21:53:05\ntags:\n  - Raspberry Pi\n  - Manjaro\ncategories:\n  - Raspberry Pi\n---\n\n# 在树莓派 4 上安装 manjaro\n\n本文介绍如何在树莓派 4 上安装系统并做一定的性能提升。\n\n## 方案介绍\n\n1. 放弃孱弱的 SD 卡，使用固态硬盘从 USB 引导启动。\n2. 加装 USB 网卡，解决内置网卡被外壳屏蔽的问题。\n3. 使用 64 位 manjaro 系统。既容易安装，又可以使用 arch 庞大的软件库，还更加稳定。\n\n> 1. SD 卡接口读写速度大概在几十 M 左右，换成 USB3.0 后可以达到几百 M，差不多可以翻 10 倍。\n> 2. 如果使用全封闭式金属外壳，内置网卡甚至总是连不上网。不过就算全敞开，也不见得有号称的千兆网卡的性能。\n> 3. 使用 manjaro 主要是软件比较新而且丰富。不使用 arch 主要还是没空折腾。\n\n## 硬件准备\n\n1. 一张 SD 卡（16G 就可以）。\n2. 一个 USB 读卡器。\n3. 一个免驱 USB 网卡。\n4. 一个的 128G 固态硬盘。\n5. 一条网线。\n\n> 1. 固态的容量不需要很大。因为树莓派不能当电脑用，不需要安装过多软件。如果要存储，可以另加。\n> 2. 不需要使用 m2 接口的固态。因为 USB3.0 接口的读写速度有限，500M/s 读写速度的硬盘就足够了。\n\n## 设置从 USB 引导\n\n设置从 USB 引导需要升级固件并做设置。\n\n> 如果是较新的树莓派 4，固件已经不需要升级。不过为了方便做设置，也需要进行以下步骤。\n\n### 安装 Raspberry Pi OS\n\n访问[树莓派系统官网](https://www.raspberrypi.org/software/)下载 Raspberry Pi Imager。\n\n用该软件向 SD 卡中写入 Raspberry Pi OS 镜像（只有字符界面的就可以）。\n\n写完后拔下读卡器。\n\n以下假设电脑有以太网接口，且为 windows 系统（其他情况上网查找如何连接树莓派）。\n\n打开 windows 中的更改适配器设置。将当前联网的适配器，如 wifi，共享给以太网接口（新版本的 windows 中已经没有具体共享给哪个接口的选项，只需要设置共享即可）。\n\n把卡插入树莓派，用网线连接树莓派与电脑，启动树莓派。\n\n待树莓派启动后（查看网络适配器，发现以太网接口已经连接，只是无法识别），打开 cmd，输入`arp -a`。结果如下所示。\n\n![cmd](1.png)\n\n一般进行上述设置后，以太网接口的 ip 变成`192.168.137.1`。如果是别的，需要根据实际 ip 修改下面的设置。\n\n> 为什么要共享网络。虽然不共享网络也会有以太网 ip。但是这个 ip 基本不会是 192.168 开头的，会影响到树莓派连接 wifi。\n\n给树莓派断电，拔出 SD 卡，再用读卡器插回电脑。\n\n现在可以看到的是树莓派系统的 boot 分区。修改`cmdline.txt`的第一行，再开头添加`ip=192.168.137.20`。`192.168.137`是网段，这一段必须和前面查出的一致。最后一个数字可以随便选择，这里以 20 为例。\n\n新建 SSH 文件。注意该文件空白且无后缀。这是为了正常启用 SSH。\n\n再把 SD 卡插回树莓派，启动。\n\n等树莓派完全启动后就可以在电脑上使用 putty 或者其他软件通过`192.168.137.20`访问树莓派。默认用户为 pi，密码为 raspberry。\n\n登录后，先来连接网络。首先把免驱 USB 网卡插到 USB2.0（黑色）接口上。\n\n> 一般家用网络传输速度不会超过 USB2.0 的传输速度，所谓的千兆网卡一般也不行。当然如果另一个 USB3 没用的话可以插上。\n\n由于是字符界面，因此使用命令行工具来连接。\n\n```\n# wifi name 和 password 改成实际的值。wifi名称可以在手机或者电脑上看。\nwpa_passphrase \"wifi name\" password > internet.conf\n# wlan0是内置网卡接口的名称。可以使用ip a来查看USB网卡的名称，然后使用USB网卡。\nsudo wpa_supplicant -c ./internet.conf -i wlan0 &\nsudo dhcpcd &\n```\n\n连上网后，给系统换源。\n\n```\n# 编辑/etc/apt/sources.list，修改内容为\ndeb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib\ndeb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib\n# 编辑/etc/apt/sources.list.d/raspi.list，修改内容为\ndeb http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui\n```\n\n### 更新固件\n\n```\nsudo apt update\nsudo apt full-upgrade\n# 编辑/etc/default/rpi-eeprom-update，修改为\nFIRMWARE_RELEASE_STATUS=\"stable\"\n\nsudo rpi-eeprom-update -d -a\n```\n\n### 设置引导顺序\n\n使用`sudo raspi-config`启动配置工具。在其中设置 boot order 即可。\n\n## 安装 manjaro\n\n前往[清华镜像站](https://mirrors.tuna.tsinghua.edu.cn/osdn/storage/g/m/ma/manjaro-arm/rpi4/)下载自己想要的系统。\n\n> 如果你需要桌面，且又不想耗费太多性能，可以选择 i3 或者 xfce 桌面。如果你不熟悉 wayland，最好不要选择 sway。\n\n下载完成之后，使用树莓派镜像刻录工具将镜像写入固态硬盘中。\n\n写完后拔出固态，再插回。在`cmdline.txt`文件的第一行开头加上`ip=192.168.137.20`，然后再新建`SSH`文件。\n\n把固态硬盘接到树莓派 USB3 接口（蓝色）上，上电。\n\n### 初始设置\n\n使用`root`用户登录。首次登录无密码，直接进入设置页面。自行设置。\n\n1. 一般的键盘，其布局为 us。\n2. 时区选择`Asia/Shanghai`。\n3. locale 可以选`en_US.UTF-8`或者`zh_CN.UTF-8`。\n\n设置完成后会自动重启。\n\n### 连接网络\n\n使用`ip a`查看网络连接情况，结果如下。\n![ip a](2.png)\n\n1. 关闭内置网卡。`sudo ip link set wlan0 down`\n2. 连接 wifi。`sudo nmcli d wifi connect \"KFC_free\" password \"12345678\"`\n   > 第一步的目的是让 NetworkManager 在树莓派启动时不会自动使用 wlan0 连接 wifi。如果第一次联网时不先关闭 wlan0，则下次联网时两个接口都会获得 ip。但是系统一次只能用一个，如果用到内置网卡，可能就会影响速度。如果你熟悉网络方面的设置，可以设置轮流使用两个网卡。比如一个网卡在下载，用另一个网卡浏览网页。本文不做这方面介绍。\n\n### 换源\n\n```\nsudo pacman-mirrors -i -c China -m rank\n# 编辑 /etc/pacman.conf，在最后写入\n\n[archlinuxcn]\nSigLevel = Optional TrustAll\nServer = http://mirrors.163.com/archlinux-cn/$arch\n\n# 更新\nsudo pacman -Syyy\n```\n\n> 1. 为了稳定，只使用 manjaro 的稳定源，不添加 arch 源。\n> 2. 清华源总是莫名其妙的对 ip 限流，个人选择绕开它。\n\n安装 yay。`sudo pacman -S yay`\n换源。`yay --aururl \"https://aur.tuna.tsinghua.edu.cn\" --save`\n\n> 这个只能选清华源了。\n\n升级所有软件。`sudo pacman -Syu`\n\n### VNC\n\n设置远程连接桌面。\n\n```\nsudo pacman -S tigervnc\n# 设置密码\nvncpasswd\n# 配置用户，把niuiic换成自己的用户名\nif [ -z \"$(grep niuiic /etc/tigervnc/vncserver.users)\" ];then\n        #sudo sed -i '/niuiic/d' /etc/tigervnc/vncserver.users\n        echo \"  :1=niuiic\" | sudo tee -a /etc/tigervnc/vncserver.users\n    fi\n# 查看自己的桌面。注意如果你前面安装了sway桌面，这里就麻烦了。\n# 因为sway使用wayland协议，你压根不会有这个目录。\n# 可以参考https://github.com/swaywm/sway/issues/100自己设置。\nls   /usr/share/xsessions/\n# 编辑~/.vnc/config\n# session是桌面名，geometry是分辨率。\nsession=xfce\ngeometry=1920x1080\nalwaysshared\n# 启动vnc\n# 默认端口为5901\nsudo systemctl enable vncserver@:1\nsudo systemctl start vncserver@:1\n```\n\n下载 vncviewer 软件。使用`192.168.137.20:5901`连接树莓派。以下是连接成功后的桌面截图。有点黑边，调整下软件窗口大小即可。\n\n![screen](3.png)\n\n### vulkan\n\n安装 vulkan 只是为了测试一些特定的包。不需要的可以略过。（想玩游戏的就省省吧，树莓派这性能还跑不了需要 vulkan 的游戏，除非是你自己写的贪吃蛇~~。）\n\n```\nsudo pacman -Syu linux-rpi4-rc linux-rpi4-rc-headers mesa-git\n# 如果显示没有xf86-video-fbturbo包，就不管它。\nsudo pacman -U xf86-video-fbturbo\n```\n\n目前 mesa-git 还不支持 DRI3。\n\n还有一件事，源里的 v2ray 有点问题，去 GitHub 上下个吧。\n\n到此为止了，其他配置网上都查得到，多数也都是正确的，不需要折腾。\n","slug":"install-manjaro-on-rpi4","published":1,"updated":"2021-05-15T14:02:39.093Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtms1001lrriz6uz8ea6x","content":"<h1 id=\"在树莓派-4-上安装-manjaro\"><a href=\"#在树莓派-4-上安装-manjaro\" class=\"headerlink\" title=\"在树莓派 4 上安装 manjaro\"></a>在树莓派 4 上安装 manjaro</h1><p>本文介绍如何在树莓派 4 上安装系统并做一定的性能提升。</p>\n<h2 id=\"方案介绍\"><a href=\"#方案介绍\" class=\"headerlink\" title=\"方案介绍\"></a>方案介绍</h2><ol>\n<li>放弃孱弱的 SD 卡，使用固态硬盘从 USB 引导启动。</li>\n<li>加装 USB 网卡，解决内置网卡被外壳屏蔽的问题。</li>\n<li>使用 64 位 manjaro 系统。既容易安装，又可以使用 arch 庞大的软件库，还更加稳定。</li>\n</ol>\n<blockquote>\n<ol>\n<li>SD 卡接口读写速度大概在几十 M 左右，换成 USB3.0 后可以达到几百 M，差不多可以翻 10 倍。</li>\n<li>如果使用全封闭式金属外壳，内置网卡甚至总是连不上网。不过就算全敞开，也不见得有号称的千兆网卡的性能。</li>\n<li>使用 manjaro 主要是软件比较新而且丰富。不使用 arch 主要还是没空折腾。</li>\n</ol>\n</blockquote>\n<h2 id=\"硬件准备\"><a href=\"#硬件准备\" class=\"headerlink\" title=\"硬件准备\"></a>硬件准备</h2><ol>\n<li>一张 SD 卡（16G 就可以）。</li>\n<li>一个 USB 读卡器。</li>\n<li>一个免驱 USB 网卡。</li>\n<li>一个的 128G 固态硬盘。</li>\n<li>一条网线。</li>\n</ol>\n<blockquote>\n<ol>\n<li>固态的容量不需要很大。因为树莓派不能当电脑用，不需要安装过多软件。如果要存储，可以另加。</li>\n<li>不需要使用 m2 接口的固态。因为 USB3.0 接口的读写速度有限，500M/s 读写速度的硬盘就足够了。</li>\n</ol>\n</blockquote>\n<h2 id=\"设置从-USB-引导\"><a href=\"#设置从-USB-引导\" class=\"headerlink\" title=\"设置从 USB 引导\"></a>设置从 USB 引导</h2><p>设置从 USB 引导需要升级固件并做设置。</p>\n<blockquote>\n<p>如果是较新的树莓派 4，固件已经不需要升级。不过为了方便做设置，也需要进行以下步骤。</p>\n</blockquote>\n<h3 id=\"安装-Raspberry-Pi-OS\"><a href=\"#安装-Raspberry-Pi-OS\" class=\"headerlink\" title=\"安装 Raspberry Pi OS\"></a>安装 Raspberry Pi OS</h3><p>访问<a href=\"https://www.raspberrypi.org/software/\">树莓派系统官网</a>下载 Raspberry Pi Imager。</p>\n<p>用该软件向 SD 卡中写入 Raspberry Pi OS 镜像（只有字符界面的就可以）。</p>\n<p>写完后拔下读卡器。</p>\n<p>以下假设电脑有以太网接口，且为 windows 系统（其他情况上网查找如何连接树莓派）。</p>\n<p>打开 windows 中的更改适配器设置。将当前联网的适配器，如 wifi，共享给以太网接口（新版本的 windows 中已经没有具体共享给哪个接口的选项，只需要设置共享即可）。</p>\n<p>把卡插入树莓派，用网线连接树莓派与电脑，启动树莓派。</p>\n<p>待树莓派启动后（查看网络适配器，发现以太网接口已经连接，只是无法识别），打开 cmd，输入<code>arp -a</code>。结果如下所示。</p>\n<p><img src=\"1.png\" alt=\"cmd\"></p>\n<p>一般进行上述设置后，以太网接口的 ip 变成<code>192.168.137.1</code>。如果是别的，需要根据实际 ip 修改下面的设置。</p>\n<blockquote>\n<p>为什么要共享网络。虽然不共享网络也会有以太网 ip。但是这个 ip 基本不会是 192.168 开头的，会影响到树莓派连接 wifi。</p>\n</blockquote>\n<p>给树莓派断电，拔出 SD 卡，再用读卡器插回电脑。</p>\n<p>现在可以看到的是树莓派系统的 boot 分区。修改<code>cmdline.txt</code>的第一行，再开头添加<code>ip=192.168.137.20</code>。<code>192.168.137</code>是网段，这一段必须和前面查出的一致。最后一个数字可以随便选择，这里以 20 为例。</p>\n<p>新建 SSH 文件。注意该文件空白且无后缀。这是为了正常启用 SSH。</p>\n<p>再把 SD 卡插回树莓派，启动。</p>\n<p>等树莓派完全启动后就可以在电脑上使用 putty 或者其他软件通过<code>192.168.137.20</code>访问树莓派。默认用户为 pi，密码为 raspberry。</p>\n<p>登录后，先来连接网络。首先把免驱 USB 网卡插到 USB2.0（黑色）接口上。</p>\n<blockquote>\n<p>一般家用网络传输速度不会超过 USB2.0 的传输速度，所谓的千兆网卡一般也不行。当然如果另一个 USB3 没用的话可以插上。</p>\n</blockquote>\n<p>由于是字符界面，因此使用命令行工具来连接。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># wifi name 和 password 改成实际的值。wifi名称可以在手机或者电脑上看。\nwpa_passphrase &quot;wifi name&quot; password &gt; internet.conf\n# wlan0是内置网卡接口的名称。可以使用ip a来查看USB网卡的名称，然后使用USB网卡。\nsudo wpa_supplicant -c .&#x2F;internet.conf -i wlan0 &amp;\nsudo dhcpcd &amp;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>连上网后，给系统换源。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 编辑&#x2F;etc&#x2F;apt&#x2F;sources.list，修改内容为\ndeb http:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;raspbian&#x2F;raspbian&#x2F; buster main non-free contrib\ndeb-src http:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;raspbian&#x2F;raspbian&#x2F; buster main non-free contrib\n# 编辑&#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;raspi.list，修改内容为\ndeb http:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;raspberrypi&#x2F; buster main ui<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"更新固件\"><a href=\"#更新固件\" class=\"headerlink\" title=\"更新固件\"></a>更新固件</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo apt update\nsudo apt full-upgrade\n# 编辑&#x2F;etc&#x2F;default&#x2F;rpi-eeprom-update，修改为\nFIRMWARE_RELEASE_STATUS&#x3D;&quot;stable&quot;\n\nsudo rpi-eeprom-update -d -a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"设置引导顺序\"><a href=\"#设置引导顺序\" class=\"headerlink\" title=\"设置引导顺序\"></a>设置引导顺序</h3><p>使用<code>sudo raspi-config</code>启动配置工具。在其中设置 boot order 即可。</p>\n<h2 id=\"安装-manjaro\"><a href=\"#安装-manjaro\" class=\"headerlink\" title=\"安装 manjaro\"></a>安装 manjaro</h2><p>前往<a href=\"https://mirrors.tuna.tsinghua.edu.cn/osdn/storage/g/m/ma/manjaro-arm/rpi4/\">清华镜像站</a>下载自己想要的系统。</p>\n<blockquote>\n<p>如果你需要桌面，且又不想耗费太多性能，可以选择 i3 或者 xfce 桌面。如果你不熟悉 wayland，最好不要选择 sway。</p>\n</blockquote>\n<p>下载完成之后，使用树莓派镜像刻录工具将镜像写入固态硬盘中。</p>\n<p>写完后拔出固态，再插回。在<code>cmdline.txt</code>文件的第一行开头加上<code>ip=192.168.137.20</code>，然后再新建<code>SSH</code>文件。</p>\n<p>把固态硬盘接到树莓派 USB3 接口（蓝色）上，上电。</p>\n<h3 id=\"初始设置\"><a href=\"#初始设置\" class=\"headerlink\" title=\"初始设置\"></a>初始设置</h3><p>使用<code>root</code>用户登录。首次登录无密码，直接进入设置页面。自行设置。</p>\n<ol>\n<li>一般的键盘，其布局为 us。</li>\n<li>时区选择<code>Asia/Shanghai</code>。</li>\n<li>locale 可以选<code>en_US.UTF-8</code>或者<code>zh_CN.UTF-8</code>。</li>\n</ol>\n<p>设置完成后会自动重启。</p>\n<h3 id=\"连接网络\"><a href=\"#连接网络\" class=\"headerlink\" title=\"连接网络\"></a>连接网络</h3><p>使用<code>ip a</code>查看网络连接情况，结果如下。<br><img src=\"2.png\" alt=\"ip a\"></p>\n<ol>\n<li>关闭内置网卡。<code>sudo ip link set wlan0 down</code></li>\n<li>连接 wifi。<code>sudo nmcli d wifi connect &quot;KFC_free&quot; password &quot;12345678&quot;</code><blockquote>\n<p>第一步的目的是让 NetworkManager 在树莓派启动时不会自动使用 wlan0 连接 wifi。如果第一次联网时不先关闭 wlan0，则下次联网时两个接口都会获得 ip。但是系统一次只能用一个，如果用到内置网卡，可能就会影响速度。如果你熟悉网络方面的设置，可以设置轮流使用两个网卡。比如一个网卡在下载，用另一个网卡浏览网页。本文不做这方面介绍。</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"换源\"><a href=\"#换源\" class=\"headerlink\" title=\"换源\"></a>换源</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo pacman-mirrors -i -c China -m rank\n# 编辑 &#x2F;etc&#x2F;pacman.conf，在最后写入\n\n[archlinuxcn]\nSigLevel &#x3D; Optional TrustAll\nServer &#x3D; http:&#x2F;&#x2F;mirrors.163.com&#x2F;archlinux-cn&#x2F;$arch\n\n# 更新\nsudo pacman -Syyy<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<blockquote>\n<ol>\n<li>为了稳定，只使用 manjaro 的稳定源，不添加 arch 源。</li>\n<li>清华源总是莫名其妙的对 ip 限流，个人选择绕开它。</li>\n</ol>\n</blockquote>\n<p>安装 yay。<code>sudo pacman -S yay</code><br>换源。<code>yay --aururl &quot;https://aur.tuna.tsinghua.edu.cn&quot; --save</code></p>\n<blockquote>\n<p>这个只能选清华源了。</p>\n</blockquote>\n<p>升级所有软件。<code>sudo pacman -Syu</code></p>\n<h3 id=\"VNC\"><a href=\"#VNC\" class=\"headerlink\" title=\"VNC\"></a>VNC</h3><p>设置远程连接桌面。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo pacman -S tigervnc\n# 设置密码\nvncpasswd\n# 配置用户，把niuiic换成自己的用户名\nif [ -z &quot;$(grep niuiic &#x2F;etc&#x2F;tigervnc&#x2F;vncserver.users)&quot; ];then\n        #sudo sed -i &#39;&#x2F;niuiic&#x2F;d&#39; &#x2F;etc&#x2F;tigervnc&#x2F;vncserver.users\n        echo &quot;  :1&#x3D;niuiic&quot; | sudo tee -a &#x2F;etc&#x2F;tigervnc&#x2F;vncserver.users\n    fi\n# 查看自己的桌面。注意如果你前面安装了sway桌面，这里就麻烦了。\n# 因为sway使用wayland协议，你压根不会有这个目录。\n# 可以参考https:&#x2F;&#x2F;github.com&#x2F;swaywm&#x2F;sway&#x2F;issues&#x2F;100自己设置。\nls   &#x2F;usr&#x2F;share&#x2F;xsessions&#x2F;\n# 编辑~&#x2F;.vnc&#x2F;config\n# session是桌面名，geometry是分辨率。\nsession&#x3D;xfce\ngeometry&#x3D;1920x1080\nalwaysshared\n# 启动vnc\n# 默认端口为5901\nsudo systemctl enable vncserver@:1\nsudo systemctl start vncserver@:1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>下载 vncviewer 软件。使用<code>192.168.137.20:5901</code>连接树莓派。以下是连接成功后的桌面截图。有点黑边，调整下软件窗口大小即可。</p>\n<p><img src=\"3.png\" alt=\"screen\"></p>\n<h3 id=\"vulkan\"><a href=\"#vulkan\" class=\"headerlink\" title=\"vulkan\"></a>vulkan</h3><p>安装 vulkan 只是为了测试一些特定的包。不需要的可以略过。（想玩游戏的就省省吧，树莓派这性能还跑不了需要 vulkan 的游戏，除非是你自己写的贪吃蛇~~。）</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo pacman -Syu linux-rpi4-rc linux-rpi4-rc-headers mesa-git\n# 如果显示没有xf86-video-fbturbo包，就不管它。\nsudo pacman -U xf86-video-fbturbo<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>目前 mesa-git 还不支持 DRI3。</p>\n<p>还有一件事，源里的 v2ray 有点问题，去 GitHub 上下个吧。</p>\n<p>到此为止了，其他配置网上都查得到，多数也都是正确的，不需要折腾。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"在树莓派-4-上安装-manjaro\"><a href=\"#在树莓派-4-上安装-manjaro\" class=\"headerlink\" title=\"在树莓派 4 上安装 manjaro\"></a>在树莓派 4 上安装 manjaro</h1><p>本文介绍如何在树莓派 4 上安装系统并做一定的性能提升。</p>\n<h2 id=\"方案介绍\"><a href=\"#方案介绍\" class=\"headerlink\" title=\"方案介绍\"></a>方案介绍</h2><ol>\n<li>放弃孱弱的 SD 卡，使用固态硬盘从 USB 引导启动。</li>\n<li>加装 USB 网卡，解决内置网卡被外壳屏蔽的问题。</li>\n<li>使用 64 位 manjaro 系统。既容易安装，又可以使用 arch 庞大的软件库，还更加稳定。</li>\n</ol>\n<blockquote>\n<ol>\n<li>SD 卡接口读写速度大概在几十 M 左右，换成 USB3.0 后可以达到几百 M，差不多可以翻 10 倍。</li>\n<li>如果使用全封闭式金属外壳，内置网卡甚至总是连不上网。不过就算全敞开，也不见得有号称的千兆网卡的性能。</li>\n<li>使用 manjaro 主要是软件比较新而且丰富。不使用 arch 主要还是没空折腾。</li>\n</ol>\n</blockquote>\n<h2 id=\"硬件准备\"><a href=\"#硬件准备\" class=\"headerlink\" title=\"硬件准备\"></a>硬件准备</h2><ol>\n<li>一张 SD 卡（16G 就可以）。</li>\n<li>一个 USB 读卡器。</li>\n<li>一个免驱 USB 网卡。</li>\n<li>一个的 128G 固态硬盘。</li>\n<li>一条网线。</li>\n</ol>\n<blockquote>\n<ol>\n<li>固态的容量不需要很大。因为树莓派不能当电脑用，不需要安装过多软件。如果要存储，可以另加。</li>\n<li>不需要使用 m2 接口的固态。因为 USB3.0 接口的读写速度有限，500M/s 读写速度的硬盘就足够了。</li>\n</ol>\n</blockquote>\n<h2 id=\"设置从-USB-引导\"><a href=\"#设置从-USB-引导\" class=\"headerlink\" title=\"设置从 USB 引导\"></a>设置从 USB 引导</h2><p>设置从 USB 引导需要升级固件并做设置。</p>\n<blockquote>\n<p>如果是较新的树莓派 4，固件已经不需要升级。不过为了方便做设置，也需要进行以下步骤。</p>\n</blockquote>\n<h3 id=\"安装-Raspberry-Pi-OS\"><a href=\"#安装-Raspberry-Pi-OS\" class=\"headerlink\" title=\"安装 Raspberry Pi OS\"></a>安装 Raspberry Pi OS</h3><p>访问<a href=\"https://www.raspberrypi.org/software/\">树莓派系统官网</a>下载 Raspberry Pi Imager。</p>\n<p>用该软件向 SD 卡中写入 Raspberry Pi OS 镜像（只有字符界面的就可以）。</p>\n<p>写完后拔下读卡器。</p>\n<p>以下假设电脑有以太网接口，且为 windows 系统（其他情况上网查找如何连接树莓派）。</p>\n<p>打开 windows 中的更改适配器设置。将当前联网的适配器，如 wifi，共享给以太网接口（新版本的 windows 中已经没有具体共享给哪个接口的选项，只需要设置共享即可）。</p>\n<p>把卡插入树莓派，用网线连接树莓派与电脑，启动树莓派。</p>\n<p>待树莓派启动后（查看网络适配器，发现以太网接口已经连接，只是无法识别），打开 cmd，输入<code>arp -a</code>。结果如下所示。</p>\n<p><img src=\"1.png\" alt=\"cmd\"></p>\n<p>一般进行上述设置后，以太网接口的 ip 变成<code>192.168.137.1</code>。如果是别的，需要根据实际 ip 修改下面的设置。</p>\n<blockquote>\n<p>为什么要共享网络。虽然不共享网络也会有以太网 ip。但是这个 ip 基本不会是 192.168 开头的，会影响到树莓派连接 wifi。</p>\n</blockquote>\n<p>给树莓派断电，拔出 SD 卡，再用读卡器插回电脑。</p>\n<p>现在可以看到的是树莓派系统的 boot 分区。修改<code>cmdline.txt</code>的第一行，再开头添加<code>ip=192.168.137.20</code>。<code>192.168.137</code>是网段，这一段必须和前面查出的一致。最后一个数字可以随便选择，这里以 20 为例。</p>\n<p>新建 SSH 文件。注意该文件空白且无后缀。这是为了正常启用 SSH。</p>\n<p>再把 SD 卡插回树莓派，启动。</p>\n<p>等树莓派完全启动后就可以在电脑上使用 putty 或者其他软件通过<code>192.168.137.20</code>访问树莓派。默认用户为 pi，密码为 raspberry。</p>\n<p>登录后，先来连接网络。首先把免驱 USB 网卡插到 USB2.0（黑色）接口上。</p>\n<blockquote>\n<p>一般家用网络传输速度不会超过 USB2.0 的传输速度，所谓的千兆网卡一般也不行。当然如果另一个 USB3 没用的话可以插上。</p>\n</blockquote>\n<p>由于是字符界面，因此使用命令行工具来连接。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># wifi name 和 password 改成实际的值。wifi名称可以在手机或者电脑上看。\nwpa_passphrase &quot;wifi name&quot; password &gt; internet.conf\n# wlan0是内置网卡接口的名称。可以使用ip a来查看USB网卡的名称，然后使用USB网卡。\nsudo wpa_supplicant -c .&#x2F;internet.conf -i wlan0 &amp;\nsudo dhcpcd &amp;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>连上网后，给系统换源。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># 编辑&#x2F;etc&#x2F;apt&#x2F;sources.list，修改内容为\ndeb http:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;raspbian&#x2F;raspbian&#x2F; buster main non-free contrib\ndeb-src http:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;raspbian&#x2F;raspbian&#x2F; buster main non-free contrib\n# 编辑&#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;raspi.list，修改内容为\ndeb http:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;raspberrypi&#x2F; buster main ui<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"更新固件\"><a href=\"#更新固件\" class=\"headerlink\" title=\"更新固件\"></a>更新固件</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo apt update\nsudo apt full-upgrade\n# 编辑&#x2F;etc&#x2F;default&#x2F;rpi-eeprom-update，修改为\nFIRMWARE_RELEASE_STATUS&#x3D;&quot;stable&quot;\n\nsudo rpi-eeprom-update -d -a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"设置引导顺序\"><a href=\"#设置引导顺序\" class=\"headerlink\" title=\"设置引导顺序\"></a>设置引导顺序</h3><p>使用<code>sudo raspi-config</code>启动配置工具。在其中设置 boot order 即可。</p>\n<h2 id=\"安装-manjaro\"><a href=\"#安装-manjaro\" class=\"headerlink\" title=\"安装 manjaro\"></a>安装 manjaro</h2><p>前往<a href=\"https://mirrors.tuna.tsinghua.edu.cn/osdn/storage/g/m/ma/manjaro-arm/rpi4/\">清华镜像站</a>下载自己想要的系统。</p>\n<blockquote>\n<p>如果你需要桌面，且又不想耗费太多性能，可以选择 i3 或者 xfce 桌面。如果你不熟悉 wayland，最好不要选择 sway。</p>\n</blockquote>\n<p>下载完成之后，使用树莓派镜像刻录工具将镜像写入固态硬盘中。</p>\n<p>写完后拔出固态，再插回。在<code>cmdline.txt</code>文件的第一行开头加上<code>ip=192.168.137.20</code>，然后再新建<code>SSH</code>文件。</p>\n<p>把固态硬盘接到树莓派 USB3 接口（蓝色）上，上电。</p>\n<h3 id=\"初始设置\"><a href=\"#初始设置\" class=\"headerlink\" title=\"初始设置\"></a>初始设置</h3><p>使用<code>root</code>用户登录。首次登录无密码，直接进入设置页面。自行设置。</p>\n<ol>\n<li>一般的键盘，其布局为 us。</li>\n<li>时区选择<code>Asia/Shanghai</code>。</li>\n<li>locale 可以选<code>en_US.UTF-8</code>或者<code>zh_CN.UTF-8</code>。</li>\n</ol>\n<p>设置完成后会自动重启。</p>\n<h3 id=\"连接网络\"><a href=\"#连接网络\" class=\"headerlink\" title=\"连接网络\"></a>连接网络</h3><p>使用<code>ip a</code>查看网络连接情况，结果如下。<br><img src=\"2.png\" alt=\"ip a\"></p>\n<ol>\n<li>关闭内置网卡。<code>sudo ip link set wlan0 down</code></li>\n<li>连接 wifi。<code>sudo nmcli d wifi connect &quot;KFC_free&quot; password &quot;12345678&quot;</code><blockquote>\n<p>第一步的目的是让 NetworkManager 在树莓派启动时不会自动使用 wlan0 连接 wifi。如果第一次联网时不先关闭 wlan0，则下次联网时两个接口都会获得 ip。但是系统一次只能用一个，如果用到内置网卡，可能就会影响速度。如果你熟悉网络方面的设置，可以设置轮流使用两个网卡。比如一个网卡在下载，用另一个网卡浏览网页。本文不做这方面介绍。</p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"换源\"><a href=\"#换源\" class=\"headerlink\" title=\"换源\"></a>换源</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo pacman-mirrors -i -c China -m rank\n# 编辑 &#x2F;etc&#x2F;pacman.conf，在最后写入\n\n[archlinuxcn]\nSigLevel &#x3D; Optional TrustAll\nServer &#x3D; http:&#x2F;&#x2F;mirrors.163.com&#x2F;archlinux-cn&#x2F;$arch\n\n# 更新\nsudo pacman -Syyy<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<blockquote>\n<ol>\n<li>为了稳定，只使用 manjaro 的稳定源，不添加 arch 源。</li>\n<li>清华源总是莫名其妙的对 ip 限流，个人选择绕开它。</li>\n</ol>\n</blockquote>\n<p>安装 yay。<code>sudo pacman -S yay</code><br>换源。<code>yay --aururl &quot;https://aur.tuna.tsinghua.edu.cn&quot; --save</code></p>\n<blockquote>\n<p>这个只能选清华源了。</p>\n</blockquote>\n<p>升级所有软件。<code>sudo pacman -Syu</code></p>\n<h3 id=\"VNC\"><a href=\"#VNC\" class=\"headerlink\" title=\"VNC\"></a>VNC</h3><p>设置远程连接桌面。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo pacman -S tigervnc\n# 设置密码\nvncpasswd\n# 配置用户，把niuiic换成自己的用户名\nif [ -z &quot;$(grep niuiic &#x2F;etc&#x2F;tigervnc&#x2F;vncserver.users)&quot; ];then\n        #sudo sed -i &#39;&#x2F;niuiic&#x2F;d&#39; &#x2F;etc&#x2F;tigervnc&#x2F;vncserver.users\n        echo &quot;  :1&#x3D;niuiic&quot; | sudo tee -a &#x2F;etc&#x2F;tigervnc&#x2F;vncserver.users\n    fi\n# 查看自己的桌面。注意如果你前面安装了sway桌面，这里就麻烦了。\n# 因为sway使用wayland协议，你压根不会有这个目录。\n# 可以参考https:&#x2F;&#x2F;github.com&#x2F;swaywm&#x2F;sway&#x2F;issues&#x2F;100自己设置。\nls   &#x2F;usr&#x2F;share&#x2F;xsessions&#x2F;\n# 编辑~&#x2F;.vnc&#x2F;config\n# session是桌面名，geometry是分辨率。\nsession&#x3D;xfce\ngeometry&#x3D;1920x1080\nalwaysshared\n# 启动vnc\n# 默认端口为5901\nsudo systemctl enable vncserver@:1\nsudo systemctl start vncserver@:1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>下载 vncviewer 软件。使用<code>192.168.137.20:5901</code>连接树莓派。以下是连接成功后的桌面截图。有点黑边，调整下软件窗口大小即可。</p>\n<p><img src=\"3.png\" alt=\"screen\"></p>\n<h3 id=\"vulkan\"><a href=\"#vulkan\" class=\"headerlink\" title=\"vulkan\"></a>vulkan</h3><p>安装 vulkan 只是为了测试一些特定的包。不需要的可以略过。（想玩游戏的就省省吧，树莓派这性能还跑不了需要 vulkan 的游戏，除非是你自己写的贪吃蛇~~。）</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo pacman -Syu linux-rpi4-rc linux-rpi4-rc-headers mesa-git\n# 如果显示没有xf86-video-fbturbo包，就不管它。\nsudo pacman -U xf86-video-fbturbo<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>目前 mesa-git 还不支持 DRI3。</p>\n<p>还有一件事，源里的 v2ray 有点问题，去 GitHub 上下个吧。</p>\n<p>到此为止了，其他配置网上都查得到，多数也都是正确的，不需要折腾。</p>\n"},{"title":"Install Oracle Jdk and Jre on Gentoo","date":"2021-03-23T10:14:01.000Z","_content":"\n# Gentoo系统安装Oracle jdk和jre\n\n## why not openjdk\n\nopenjdk 在部分情况下无法完全替代闭源版本。尤其是在需要完整 javafx 的情况下。\n\ngentoo 提供了具有 javafx USE flag 的 openjdk。不过笔者未能成功开启，应该是与主 profile 冲突。另外也有提供 openjfx，不过该 javafx 属于阉割版，比如没有对 webkit 的支持。\n\n## 通过包管理器安装\n\ngentoo overlay 中有 oracle-jdk-bin 的 ebuild，希望通过包管理系统安装的可以使用。但是由于 oracle 禁止从链接直接获取二进制包。必须手动下载合适版本，放入指定位置后才可编译。\n\n该方案有几个缺点。一是 overlay 上没有提供最新版本。二是由于指定位置实际上是个临时文件夹，也就是说每次 emerge 都会改变位置。然而等你获取提示中的位置信息时，再将下载的文件放入已经无效。笔者未曾遇到过这种问题，偷懒放弃解决。实在解决不了的可以把人家的 ebuild copy 到自己的 overlay 中，改链接到你上传下载的 jdk、jre 的地址也行。\n\n## 直接安装\n\n从 oracle [官网](https://www.oracle.com/java/technologies/javase-downloads.html) 下载 jdk。以 oracle-jdk8u271 为例。\n\n1. 解压。\n2. 将其移动到合适位置并赋予权限。\n\n```\ntar xvzf XXX\nsudo chown -R 777 XXX\nmv XXX XXX\n```\n\n`XXX`部分自行填写。\n\n3. 配置 java 信息。\n\n编辑`/usr/share/java-config-2/vm/oracle-jdk8u271`。写入\n\n```\nVERSION=\"Oracle-Sun JDK 8u271\"\nJAVA_HOME=\"/opt/jdk1.8.0_271\"\nJDK_HOME=\"/opt/jdk1.8.0_271\"\nJAVAC=\"${JAVA_HOME}/bin/javac\"\nPATH=\"${JAVA_HOME}/bin:${JAVA_HOME}/jre/bin\"\nROOTPATH=\"${JAVA_HOME}/bin:${JAVA_HOME}/jre/bin\"\nLDPATH=\"${JAVA_HOME}/jre/lib/amd64/:${JAVA_HOME}/jre/lib/amd64/native_threads/:${JAVA_HOME}/jre/lib/amd64/xawt/:${JAVA_HOME}/jre/lib/amd64/server/\"\nMANPATH=\"/opt/icedtea-bin-8.2.2.1/man\"\nPROVIDES_TYPE=\"JDK JRE\"\nPROVIDES_VERSION=\"1.8\"\n# Taken from sun.boot.class.path property\nBOOTCLASSPATH=\"${JAVA_HOME}/jre/lib/resources.jar:${JAVA_HOME}/jre/lib/rt.jar:${JAVA_HOME}/jre/lib/jsse.jar:${JAVA_HOME}/jre/lib/jce.jar:${JAVA_HOME}/jre/lib/charsets.jar\"\nGENERATION=\"2\"\nENV_VARS=\"JAVA_HOME JDK_HOME JAVAC PATH ROOTPATH LDPATH MANPATH\"\nVMHANDLE=\"oracle-jdk8\"\nBUILD_ONLY=\"FALSE\"\n```\n\n注意修改版本号。\n\n4. 将 jdk 文件夹软链接到`/usr/lib/jvm`。\n\n如`ln -s /opt/jdk1.8.0_271/ /usr/lib/jvm/oracle-jdk8u271`。\n\n5. 设置 java 版本。\n\n```\n// 查看当前可用的java虚拟机。\neselect java-vm list\n// 设置虚拟机，不可使用sudo。\neselect java-vm set user number\n// 或者\neselect java-vm set system number\n```\n\n其他 linux 版本可以通过`java-config -L`查看，`java-config set number`设置。（该操作对 gentoo 无效）\n","source":"_posts/install-oracle-jdk-and-jre-on-gentoo.md","raw":"---\ntitle: Install Oracle Jdk and Jre on Gentoo\ndate: 2021-03-23 18:14:01\ntags:\n\t\t- Gentoo\n\t\t- Java\n\t\t- Oracle\ncategories:\n\t\t- Gentoo\n---\n\n# Gentoo系统安装Oracle jdk和jre\n\n## why not openjdk\n\nopenjdk 在部分情况下无法完全替代闭源版本。尤其是在需要完整 javafx 的情况下。\n\ngentoo 提供了具有 javafx USE flag 的 openjdk。不过笔者未能成功开启，应该是与主 profile 冲突。另外也有提供 openjfx，不过该 javafx 属于阉割版，比如没有对 webkit 的支持。\n\n## 通过包管理器安装\n\ngentoo overlay 中有 oracle-jdk-bin 的 ebuild，希望通过包管理系统安装的可以使用。但是由于 oracle 禁止从链接直接获取二进制包。必须手动下载合适版本，放入指定位置后才可编译。\n\n该方案有几个缺点。一是 overlay 上没有提供最新版本。二是由于指定位置实际上是个临时文件夹，也就是说每次 emerge 都会改变位置。然而等你获取提示中的位置信息时，再将下载的文件放入已经无效。笔者未曾遇到过这种问题，偷懒放弃解决。实在解决不了的可以把人家的 ebuild copy 到自己的 overlay 中，改链接到你上传下载的 jdk、jre 的地址也行。\n\n## 直接安装\n\n从 oracle [官网](https://www.oracle.com/java/technologies/javase-downloads.html) 下载 jdk。以 oracle-jdk8u271 为例。\n\n1. 解压。\n2. 将其移动到合适位置并赋予权限。\n\n```\ntar xvzf XXX\nsudo chown -R 777 XXX\nmv XXX XXX\n```\n\n`XXX`部分自行填写。\n\n3. 配置 java 信息。\n\n编辑`/usr/share/java-config-2/vm/oracle-jdk8u271`。写入\n\n```\nVERSION=\"Oracle-Sun JDK 8u271\"\nJAVA_HOME=\"/opt/jdk1.8.0_271\"\nJDK_HOME=\"/opt/jdk1.8.0_271\"\nJAVAC=\"${JAVA_HOME}/bin/javac\"\nPATH=\"${JAVA_HOME}/bin:${JAVA_HOME}/jre/bin\"\nROOTPATH=\"${JAVA_HOME}/bin:${JAVA_HOME}/jre/bin\"\nLDPATH=\"${JAVA_HOME}/jre/lib/amd64/:${JAVA_HOME}/jre/lib/amd64/native_threads/:${JAVA_HOME}/jre/lib/amd64/xawt/:${JAVA_HOME}/jre/lib/amd64/server/\"\nMANPATH=\"/opt/icedtea-bin-8.2.2.1/man\"\nPROVIDES_TYPE=\"JDK JRE\"\nPROVIDES_VERSION=\"1.8\"\n# Taken from sun.boot.class.path property\nBOOTCLASSPATH=\"${JAVA_HOME}/jre/lib/resources.jar:${JAVA_HOME}/jre/lib/rt.jar:${JAVA_HOME}/jre/lib/jsse.jar:${JAVA_HOME}/jre/lib/jce.jar:${JAVA_HOME}/jre/lib/charsets.jar\"\nGENERATION=\"2\"\nENV_VARS=\"JAVA_HOME JDK_HOME JAVAC PATH ROOTPATH LDPATH MANPATH\"\nVMHANDLE=\"oracle-jdk8\"\nBUILD_ONLY=\"FALSE\"\n```\n\n注意修改版本号。\n\n4. 将 jdk 文件夹软链接到`/usr/lib/jvm`。\n\n如`ln -s /opt/jdk1.8.0_271/ /usr/lib/jvm/oracle-jdk8u271`。\n\n5. 设置 java 版本。\n\n```\n// 查看当前可用的java虚拟机。\neselect java-vm list\n// 设置虚拟机，不可使用sudo。\neselect java-vm set user number\n// 或者\neselect java-vm set system number\n```\n\n其他 linux 版本可以通过`java-config -L`查看，`java-config set number`设置。（该操作对 gentoo 无效）\n","slug":"install-oracle-jdk-and-jre-on-gentoo","published":1,"updated":"2021-03-23T11:11:18.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtms2001orriz2o3s6hei","content":"<h1 id=\"Gentoo系统安装Oracle-jdk和jre\"><a href=\"#Gentoo系统安装Oracle-jdk和jre\" class=\"headerlink\" title=\"Gentoo系统安装Oracle jdk和jre\"></a>Gentoo系统安装Oracle jdk和jre</h1><h2 id=\"why-not-openjdk\"><a href=\"#why-not-openjdk\" class=\"headerlink\" title=\"why not openjdk\"></a>why not openjdk</h2><p>openjdk 在部分情况下无法完全替代闭源版本。尤其是在需要完整 javafx 的情况下。</p>\n<p>gentoo 提供了具有 javafx USE flag 的 openjdk。不过笔者未能成功开启，应该是与主 profile 冲突。另外也有提供 openjfx，不过该 javafx 属于阉割版，比如没有对 webkit 的支持。</p>\n<h2 id=\"通过包管理器安装\"><a href=\"#通过包管理器安装\" class=\"headerlink\" title=\"通过包管理器安装\"></a>通过包管理器安装</h2><p>gentoo overlay 中有 oracle-jdk-bin 的 ebuild，希望通过包管理系统安装的可以使用。但是由于 oracle 禁止从链接直接获取二进制包。必须手动下载合适版本，放入指定位置后才可编译。</p>\n<p>该方案有几个缺点。一是 overlay 上没有提供最新版本。二是由于指定位置实际上是个临时文件夹，也就是说每次 emerge 都会改变位置。然而等你获取提示中的位置信息时，再将下载的文件放入已经无效。笔者未曾遇到过这种问题，偷懒放弃解决。实在解决不了的可以把人家的 ebuild copy 到自己的 overlay 中，改链接到你上传下载的 jdk、jre 的地址也行。</p>\n<h2 id=\"直接安装\"><a href=\"#直接安装\" class=\"headerlink\" title=\"直接安装\"></a>直接安装</h2><p>从 oracle <a href=\"https://www.oracle.com/java/technologies/javase-downloads.html\">官网</a> 下载 jdk。以 oracle-jdk8u271 为例。</p>\n<ol>\n<li>解压。</li>\n<li>将其移动到合适位置并赋予权限。</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">tar xvzf XXX\nsudo chown -R 777 XXX\nmv XXX XXX<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><code>XXX</code>部分自行填写。</p>\n<ol start=\"3\">\n<li>配置 java 信息。</li>\n</ol>\n<p>编辑<code>/usr/share/java-config-2/vm/oracle-jdk8u271</code>。写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">VERSION&#x3D;&quot;Oracle-Sun JDK 8u271&quot;\nJAVA_HOME&#x3D;&quot;&#x2F;opt&#x2F;jdk1.8.0_271&quot;\nJDK_HOME&#x3D;&quot;&#x2F;opt&#x2F;jdk1.8.0_271&quot;\nJAVAC&#x3D;&quot;$&#123;JAVA_HOME&#125;&#x2F;bin&#x2F;javac&quot;\nPATH&#x3D;&quot;$&#123;JAVA_HOME&#125;&#x2F;bin:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;bin&quot;\nROOTPATH&#x3D;&quot;$&#123;JAVA_HOME&#125;&#x2F;bin:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;bin&quot;\nLDPATH&#x3D;&quot;$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;amd64&#x2F;:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;amd64&#x2F;native_threads&#x2F;:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;amd64&#x2F;xawt&#x2F;:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;amd64&#x2F;server&#x2F;&quot;\nMANPATH&#x3D;&quot;&#x2F;opt&#x2F;icedtea-bin-8.2.2.1&#x2F;man&quot;\nPROVIDES_TYPE&#x3D;&quot;JDK JRE&quot;\nPROVIDES_VERSION&#x3D;&quot;1.8&quot;\n# Taken from sun.boot.class.path property\nBOOTCLASSPATH&#x3D;&quot;$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;resources.jar:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;rt.jar:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;jsse.jar:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;jce.jar:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;charsets.jar&quot;\nGENERATION&#x3D;&quot;2&quot;\nENV_VARS&#x3D;&quot;JAVA_HOME JDK_HOME JAVAC PATH ROOTPATH LDPATH MANPATH&quot;\nVMHANDLE&#x3D;&quot;oracle-jdk8&quot;\nBUILD_ONLY&#x3D;&quot;FALSE&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意修改版本号。</p>\n<ol start=\"4\">\n<li>将 jdk 文件夹软链接到<code>/usr/lib/jvm</code>。</li>\n</ol>\n<p>如<code>ln -s /opt/jdk1.8.0_271/ /usr/lib/jvm/oracle-jdk8u271</code>。</p>\n<ol start=\"5\">\n<li>设置 java 版本。</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; 查看当前可用的java虚拟机。\neselect java-vm list\n&#x2F;&#x2F; 设置虚拟机，不可使用sudo。\neselect java-vm set user number\n&#x2F;&#x2F; 或者\neselect java-vm set system number<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>其他 linux 版本可以通过<code>java-config -L</code>查看，<code>java-config set number</code>设置。（该操作对 gentoo 无效）</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"Gentoo系统安装Oracle-jdk和jre\"><a href=\"#Gentoo系统安装Oracle-jdk和jre\" class=\"headerlink\" title=\"Gentoo系统安装Oracle jdk和jre\"></a>Gentoo系统安装Oracle jdk和jre</h1><h2 id=\"why-not-openjdk\"><a href=\"#why-not-openjdk\" class=\"headerlink\" title=\"why not openjdk\"></a>why not openjdk</h2><p>openjdk 在部分情况下无法完全替代闭源版本。尤其是在需要完整 javafx 的情况下。</p>\n<p>gentoo 提供了具有 javafx USE flag 的 openjdk。不过笔者未能成功开启，应该是与主 profile 冲突。另外也有提供 openjfx，不过该 javafx 属于阉割版，比如没有对 webkit 的支持。</p>\n<h2 id=\"通过包管理器安装\"><a href=\"#通过包管理器安装\" class=\"headerlink\" title=\"通过包管理器安装\"></a>通过包管理器安装</h2><p>gentoo overlay 中有 oracle-jdk-bin 的 ebuild，希望通过包管理系统安装的可以使用。但是由于 oracle 禁止从链接直接获取二进制包。必须手动下载合适版本，放入指定位置后才可编译。</p>\n<p>该方案有几个缺点。一是 overlay 上没有提供最新版本。二是由于指定位置实际上是个临时文件夹，也就是说每次 emerge 都会改变位置。然而等你获取提示中的位置信息时，再将下载的文件放入已经无效。笔者未曾遇到过这种问题，偷懒放弃解决。实在解决不了的可以把人家的 ebuild copy 到自己的 overlay 中，改链接到你上传下载的 jdk、jre 的地址也行。</p>\n<h2 id=\"直接安装\"><a href=\"#直接安装\" class=\"headerlink\" title=\"直接安装\"></a>直接安装</h2><p>从 oracle <a href=\"https://www.oracle.com/java/technologies/javase-downloads.html\">官网</a> 下载 jdk。以 oracle-jdk8u271 为例。</p>\n<ol>\n<li>解压。</li>\n<li>将其移动到合适位置并赋予权限。</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">tar xvzf XXX\nsudo chown -R 777 XXX\nmv XXX XXX<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><code>XXX</code>部分自行填写。</p>\n<ol start=\"3\">\n<li>配置 java 信息。</li>\n</ol>\n<p>编辑<code>/usr/share/java-config-2/vm/oracle-jdk8u271</code>。写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">VERSION&#x3D;&quot;Oracle-Sun JDK 8u271&quot;\nJAVA_HOME&#x3D;&quot;&#x2F;opt&#x2F;jdk1.8.0_271&quot;\nJDK_HOME&#x3D;&quot;&#x2F;opt&#x2F;jdk1.8.0_271&quot;\nJAVAC&#x3D;&quot;$&#123;JAVA_HOME&#125;&#x2F;bin&#x2F;javac&quot;\nPATH&#x3D;&quot;$&#123;JAVA_HOME&#125;&#x2F;bin:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;bin&quot;\nROOTPATH&#x3D;&quot;$&#123;JAVA_HOME&#125;&#x2F;bin:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;bin&quot;\nLDPATH&#x3D;&quot;$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;amd64&#x2F;:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;amd64&#x2F;native_threads&#x2F;:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;amd64&#x2F;xawt&#x2F;:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;amd64&#x2F;server&#x2F;&quot;\nMANPATH&#x3D;&quot;&#x2F;opt&#x2F;icedtea-bin-8.2.2.1&#x2F;man&quot;\nPROVIDES_TYPE&#x3D;&quot;JDK JRE&quot;\nPROVIDES_VERSION&#x3D;&quot;1.8&quot;\n# Taken from sun.boot.class.path property\nBOOTCLASSPATH&#x3D;&quot;$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;resources.jar:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;rt.jar:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;jsse.jar:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;jce.jar:$&#123;JAVA_HOME&#125;&#x2F;jre&#x2F;lib&#x2F;charsets.jar&quot;\nGENERATION&#x3D;&quot;2&quot;\nENV_VARS&#x3D;&quot;JAVA_HOME JDK_HOME JAVAC PATH ROOTPATH LDPATH MANPATH&quot;\nVMHANDLE&#x3D;&quot;oracle-jdk8&quot;\nBUILD_ONLY&#x3D;&quot;FALSE&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意修改版本号。</p>\n<ol start=\"4\">\n<li>将 jdk 文件夹软链接到<code>/usr/lib/jvm</code>。</li>\n</ol>\n<p>如<code>ln -s /opt/jdk1.8.0_271/ /usr/lib/jvm/oracle-jdk8u271</code>。</p>\n<ol start=\"5\">\n<li>设置 java 版本。</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; 查看当前可用的java虚拟机。\neselect java-vm list\n&#x2F;&#x2F; 设置虚拟机，不可使用sudo。\neselect java-vm set user number\n&#x2F;&#x2F; 或者\neselect java-vm set system number<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>其他 linux 版本可以通过<code>java-config -L</code>查看，<code>java-config set number</code>设置。（该操作对 gentoo 无效）</p>\n"},{"title":"Install rpm/deb Packages on Gentoo","date":"2021-03-23T10:28:40.000Z","_content":"\n# 在 gentoo 系统上“安装” deb/rpm 包\n\n## 安装原理\n\n众所周知，与本系统包管理体系不相容的安装包不能安装在系统上。但这里的情况分两种。\n\n第一种，安装包内可执行文件编译时对应的架构与你的系统不同。比如你不能将 arm 架构下的软件直接跑在 amd64 的系统上。这种情况属于无解，除非自己做一个中间层。\n\n第二种，仅仅是安装包的打包方式不同。如 deb 和 rpm。对于这种情况，完全可以将安装包拆解，然后手动将解压出来的文件放到该放的位置。这样，软件依旧可以运行，也就变相地完成了”安装“。但这并不意味着所有安装包都可以采用这种方式安装，需要解决的最大问题就是依赖。\n\n## 安装流程\n\n这里以 utools 为例，仅介绍安装流程，不包括如何补全依赖。\n\n该软件只提供了 deb 安装包。\n\n首先获得 deb 安装包。\n\n然后，解压安装包。\n\n解压后可以看到两个目录，control 和 data。data 目录下有 usr 和 opt 两个子目录。显然，这里存放了应该被放入系统 usr 和 opt 目录下的文件。\n\n一般这种软件都会自动创建一个快捷方式，即.desktop 文件。先找到这个文件。utools 的 utools.desktop 文件（已修改）如下。\n\n```\n[Desktop Entry]\nName=uTools\nExec=/opt/utools/data/opt/uTools/utools\nTerminal=false\nType=Application\nIcon=/opt/utools/data/usr/share/icons/hicolor/512x512/apps/utools.png\nStartupWMClass=uTools\nComment=你的生产力工具集\nCategories=System;\n```\n\n上面的文件内容是修改后的。修改之前，你可以通过`Exec`这一行看到可执行文件的位置。\n\n找到可执行文件，直接在当前目录下运行一下，如`./utools`。如果软件可以跑起来，那基本上可以确定该软件不缺依赖，且可以直接通过相对位置找到它的配置文件等文件。对于这样的软件，建议不要直接将文件放到 usr 和 opt 下，因为这样将很难维护该软件。可以直接将整个解压出来的目录放到/opt 目录下，如/opt/utools。\n\n将.desktop 文件修改后，放到`~/.local/share/applications`目录或者`/usr/share/applications`目录下。一般`/usr/share/applications`目录必是存放.desktop 文件的目录，前者可能因为系统或设置不同而不同。注意必须把文件修改好之后再放入。如果先放再修改，可能修改会无效，这可能是桌面环境设置造成的问题。\n\n至此，该软件安装已经完成。\n\n整个步骤中最关键的一步是运行可执行文件时可以运行起来，如果不能，就需要手动补全依赖或者排查其他问题。\n\n此外，一些系统上有一些包转换工具，如 arch，可以使用特定的软件将 deb 包等转化为 arch 的安装包。如果存在该类软件（gentoo 系统由于发行源代码，可以说不存在安装包，所以也不会有这种工具），尽量采用这种方式。如果想要或者更好的维护体验，可以自己写个 ebuild。\n","source":"_posts/install-rpm-deb-packages-on-gentoo.md","raw":"---\ntitle: Install rpm/deb Packages on Gentoo\ndate: 2021-03-23 18:28:40\ntags:\n\t\t- Gentoo\ncategories:\n\t\t- Gentoo\n---\n\n# 在 gentoo 系统上“安装” deb/rpm 包\n\n## 安装原理\n\n众所周知，与本系统包管理体系不相容的安装包不能安装在系统上。但这里的情况分两种。\n\n第一种，安装包内可执行文件编译时对应的架构与你的系统不同。比如你不能将 arm 架构下的软件直接跑在 amd64 的系统上。这种情况属于无解，除非自己做一个中间层。\n\n第二种，仅仅是安装包的打包方式不同。如 deb 和 rpm。对于这种情况，完全可以将安装包拆解，然后手动将解压出来的文件放到该放的位置。这样，软件依旧可以运行，也就变相地完成了”安装“。但这并不意味着所有安装包都可以采用这种方式安装，需要解决的最大问题就是依赖。\n\n## 安装流程\n\n这里以 utools 为例，仅介绍安装流程，不包括如何补全依赖。\n\n该软件只提供了 deb 安装包。\n\n首先获得 deb 安装包。\n\n然后，解压安装包。\n\n解压后可以看到两个目录，control 和 data。data 目录下有 usr 和 opt 两个子目录。显然，这里存放了应该被放入系统 usr 和 opt 目录下的文件。\n\n一般这种软件都会自动创建一个快捷方式，即.desktop 文件。先找到这个文件。utools 的 utools.desktop 文件（已修改）如下。\n\n```\n[Desktop Entry]\nName=uTools\nExec=/opt/utools/data/opt/uTools/utools\nTerminal=false\nType=Application\nIcon=/opt/utools/data/usr/share/icons/hicolor/512x512/apps/utools.png\nStartupWMClass=uTools\nComment=你的生产力工具集\nCategories=System;\n```\n\n上面的文件内容是修改后的。修改之前，你可以通过`Exec`这一行看到可执行文件的位置。\n\n找到可执行文件，直接在当前目录下运行一下，如`./utools`。如果软件可以跑起来，那基本上可以确定该软件不缺依赖，且可以直接通过相对位置找到它的配置文件等文件。对于这样的软件，建议不要直接将文件放到 usr 和 opt 下，因为这样将很难维护该软件。可以直接将整个解压出来的目录放到/opt 目录下，如/opt/utools。\n\n将.desktop 文件修改后，放到`~/.local/share/applications`目录或者`/usr/share/applications`目录下。一般`/usr/share/applications`目录必是存放.desktop 文件的目录，前者可能因为系统或设置不同而不同。注意必须把文件修改好之后再放入。如果先放再修改，可能修改会无效，这可能是桌面环境设置造成的问题。\n\n至此，该软件安装已经完成。\n\n整个步骤中最关键的一步是运行可执行文件时可以运行起来，如果不能，就需要手动补全依赖或者排查其他问题。\n\n此外，一些系统上有一些包转换工具，如 arch，可以使用特定的软件将 deb 包等转化为 arch 的安装包。如果存在该类软件（gentoo 系统由于发行源代码，可以说不存在安装包，所以也不会有这种工具），尽量采用这种方式。如果想要或者更好的维护体验，可以自己写个 ebuild。\n","slug":"install-rpm-deb-packages-on-gentoo","published":1,"updated":"2021-03-23T11:11:18.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtms4001trrizcw6dgwz3","content":"<h1 id=\"在-gentoo-系统上“安装”-deb-rpm-包\"><a href=\"#在-gentoo-系统上“安装”-deb-rpm-包\" class=\"headerlink\" title=\"在 gentoo 系统上“安装” deb/rpm 包\"></a>在 gentoo 系统上“安装” deb/rpm 包</h1><h2 id=\"安装原理\"><a href=\"#安装原理\" class=\"headerlink\" title=\"安装原理\"></a>安装原理</h2><p>众所周知，与本系统包管理体系不相容的安装包不能安装在系统上。但这里的情况分两种。</p>\n<p>第一种，安装包内可执行文件编译时对应的架构与你的系统不同。比如你不能将 arm 架构下的软件直接跑在 amd64 的系统上。这种情况属于无解，除非自己做一个中间层。</p>\n<p>第二种，仅仅是安装包的打包方式不同。如 deb 和 rpm。对于这种情况，完全可以将安装包拆解，然后手动将解压出来的文件放到该放的位置。这样，软件依旧可以运行，也就变相地完成了”安装“。但这并不意味着所有安装包都可以采用这种方式安装，需要解决的最大问题就是依赖。</p>\n<h2 id=\"安装流程\"><a href=\"#安装流程\" class=\"headerlink\" title=\"安装流程\"></a>安装流程</h2><p>这里以 utools 为例，仅介绍安装流程，不包括如何补全依赖。</p>\n<p>该软件只提供了 deb 安装包。</p>\n<p>首先获得 deb 安装包。</p>\n<p>然后，解压安装包。</p>\n<p>解压后可以看到两个目录，control 和 data。data 目录下有 usr 和 opt 两个子目录。显然，这里存放了应该被放入系统 usr 和 opt 目录下的文件。</p>\n<p>一般这种软件都会自动创建一个快捷方式，即.desktop 文件。先找到这个文件。utools 的 utools.desktop 文件（已修改）如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[Desktop Entry]\nName&#x3D;uTools\nExec&#x3D;&#x2F;opt&#x2F;utools&#x2F;data&#x2F;opt&#x2F;uTools&#x2F;utools\nTerminal&#x3D;false\nType&#x3D;Application\nIcon&#x3D;&#x2F;opt&#x2F;utools&#x2F;data&#x2F;usr&#x2F;share&#x2F;icons&#x2F;hicolor&#x2F;512x512&#x2F;apps&#x2F;utools.png\nStartupWMClass&#x3D;uTools\nComment&#x3D;你的生产力工具集\nCategories&#x3D;System;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>上面的文件内容是修改后的。修改之前，你可以通过<code>Exec</code>这一行看到可执行文件的位置。</p>\n<p>找到可执行文件，直接在当前目录下运行一下，如<code>./utools</code>。如果软件可以跑起来，那基本上可以确定该软件不缺依赖，且可以直接通过相对位置找到它的配置文件等文件。对于这样的软件，建议不要直接将文件放到 usr 和 opt 下，因为这样将很难维护该软件。可以直接将整个解压出来的目录放到/opt 目录下，如/opt/utools。</p>\n<p>将.desktop 文件修改后，放到<code>~/.local/share/applications</code>目录或者<code>/usr/share/applications</code>目录下。一般<code>/usr/share/applications</code>目录必是存放.desktop 文件的目录，前者可能因为系统或设置不同而不同。注意必须把文件修改好之后再放入。如果先放再修改，可能修改会无效，这可能是桌面环境设置造成的问题。</p>\n<p>至此，该软件安装已经完成。</p>\n<p>整个步骤中最关键的一步是运行可执行文件时可以运行起来，如果不能，就需要手动补全依赖或者排查其他问题。</p>\n<p>此外，一些系统上有一些包转换工具，如 arch，可以使用特定的软件将 deb 包等转化为 arch 的安装包。如果存在该类软件（gentoo 系统由于发行源代码，可以说不存在安装包，所以也不会有这种工具），尽量采用这种方式。如果想要或者更好的维护体验，可以自己写个 ebuild。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"在-gentoo-系统上“安装”-deb-rpm-包\"><a href=\"#在-gentoo-系统上“安装”-deb-rpm-包\" class=\"headerlink\" title=\"在 gentoo 系统上“安装” deb/rpm 包\"></a>在 gentoo 系统上“安装” deb/rpm 包</h1><h2 id=\"安装原理\"><a href=\"#安装原理\" class=\"headerlink\" title=\"安装原理\"></a>安装原理</h2><p>众所周知，与本系统包管理体系不相容的安装包不能安装在系统上。但这里的情况分两种。</p>\n<p>第一种，安装包内可执行文件编译时对应的架构与你的系统不同。比如你不能将 arm 架构下的软件直接跑在 amd64 的系统上。这种情况属于无解，除非自己做一个中间层。</p>\n<p>第二种，仅仅是安装包的打包方式不同。如 deb 和 rpm。对于这种情况，完全可以将安装包拆解，然后手动将解压出来的文件放到该放的位置。这样，软件依旧可以运行，也就变相地完成了”安装“。但这并不意味着所有安装包都可以采用这种方式安装，需要解决的最大问题就是依赖。</p>\n<h2 id=\"安装流程\"><a href=\"#安装流程\" class=\"headerlink\" title=\"安装流程\"></a>安装流程</h2><p>这里以 utools 为例，仅介绍安装流程，不包括如何补全依赖。</p>\n<p>该软件只提供了 deb 安装包。</p>\n<p>首先获得 deb 安装包。</p>\n<p>然后，解压安装包。</p>\n<p>解压后可以看到两个目录，control 和 data。data 目录下有 usr 和 opt 两个子目录。显然，这里存放了应该被放入系统 usr 和 opt 目录下的文件。</p>\n<p>一般这种软件都会自动创建一个快捷方式，即.desktop 文件。先找到这个文件。utools 的 utools.desktop 文件（已修改）如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[Desktop Entry]\nName&#x3D;uTools\nExec&#x3D;&#x2F;opt&#x2F;utools&#x2F;data&#x2F;opt&#x2F;uTools&#x2F;utools\nTerminal&#x3D;false\nType&#x3D;Application\nIcon&#x3D;&#x2F;opt&#x2F;utools&#x2F;data&#x2F;usr&#x2F;share&#x2F;icons&#x2F;hicolor&#x2F;512x512&#x2F;apps&#x2F;utools.png\nStartupWMClass&#x3D;uTools\nComment&#x3D;你的生产力工具集\nCategories&#x3D;System;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>上面的文件内容是修改后的。修改之前，你可以通过<code>Exec</code>这一行看到可执行文件的位置。</p>\n<p>找到可执行文件，直接在当前目录下运行一下，如<code>./utools</code>。如果软件可以跑起来，那基本上可以确定该软件不缺依赖，且可以直接通过相对位置找到它的配置文件等文件。对于这样的软件，建议不要直接将文件放到 usr 和 opt 下，因为这样将很难维护该软件。可以直接将整个解压出来的目录放到/opt 目录下，如/opt/utools。</p>\n<p>将.desktop 文件修改后，放到<code>~/.local/share/applications</code>目录或者<code>/usr/share/applications</code>目录下。一般<code>/usr/share/applications</code>目录必是存放.desktop 文件的目录，前者可能因为系统或设置不同而不同。注意必须把文件修改好之后再放入。如果先放再修改，可能修改会无效，这可能是桌面环境设置造成的问题。</p>\n<p>至此，该软件安装已经完成。</p>\n<p>整个步骤中最关键的一步是运行可执行文件时可以运行起来，如果不能，就需要手动补全依赖或者排查其他问题。</p>\n<p>此外，一些系统上有一些包转换工具，如 arch，可以使用特定的软件将 deb 包等转化为 arch 的安装包。如果存在该类软件（gentoo 系统由于发行源代码，可以说不存在安装包，所以也不会有这种工具），尽量采用这种方式。如果想要或者更好的维护体验，可以自己写个 ebuild。</p>\n"},{"title":"Rust Tauri \"Hello World\"","date":"2021-05-11T12:14:05.000Z","_content":"\n# Rust Tauri \"Hello World\"\n\n本文介绍如何在 linux 系统上运行第一个 tauri 应用。\n\n> js 开发人员应当可以直接参考官方文档跑通程序。本文旨在为不熟悉此类开发的人士梳理开发流程。\n\n## 什么是 tauri\n\n用一句话回答：tauri 是 electron 的替代品。目前它已经可以做到比 electron 更好。\n\n## Hello World\n\n接下来，来看如何使用 tauri 框架。\n\n### 环境配置\n\n根据[官方文档](https://tauri.studio/en/docs/getting-started/setup-linux)。\n\n在 linux 下使用 tauri 需要 webkit library、nodejs runtime 以及 rust 环境的支持。\n\n> 以下默认以 yarn 作为 js 包管理器。\n\n这部分可以参考文档解决。另外记得给 yarn 和 cargo 换源。\n\n### 初始化项目\n\n1. `yarn init`\n\n一切默认即可。\n\n2. `yarn add @tauri-apps/cli`\n\n在当前项目目录添加 tauri 可执行程序及其依赖。\n\n为了方便使用，在`package.json`中设置如下内容。\n\n```json\n  \"scripts\": {\n    \"tauri\": \"tauri\"\n  }\n```\n\n设置完成之后就可以使用`yarn tauri`命令代替`tauri.js`。\n\n3. `yarn tauri init`\n\n初始化 tauri 项目，设置相应信息。\n\n`Where are your web assets (HTML/CSS/JS) located`指的是存放 html、css、js 文件的目录，可以设置为`../dist`。\n\n`What is the url of your dev server`指的是开发服务器的 url。所谓开发服务器，就是开发过程中使用的显示、调试等工具的集合。这里先将其设置为`http://localhost:8080`。\n\n4. `yarn tauri info`\n\n查看一下刚才设置的信息。\n\n5. `yarn tauri dev`\n\n编译项目并运行。\n\n> 如果你在上面的步骤中因为网络问题而中断操作，很有可能在这一步出现报错。最快的解决方案只需简单粗暴的重头再来。\n\n这时，你会发现项目编译完成并运行，但是显示`could not connect to server`。\n\n这是因为没有启动开发服务器。\n\n6. `yarn add webpack-dev-server`\n\n安装开发服务器。\n\n在`package.json`文件中设置如下。\n\n```json\n  \"scripts\": {\n    \"tauri\": \"tauri\",\n    \"dev\": \"webpack serve\"\n  }\n```\n\n继续安装`yarn add webpack`\n\n这时可以使用`yarn dev`来启动开发服务器。\n\n此时，你又会发现有报错。这是因为没有配置开发服务器。\n\n7. 配置开发服务器\n\n在项目根目录下新建`webpack.config.js`。写入以下内容。\n\n```javascript\nconst path = require(\"path\");\nmodule.exports = {\n  entry: path.join(__dirname, \"src/js/index.js\"),\n  output: {\n    path: path.join(__dirname, \"dist\"),\n    filename: \"bundle.js\",\n  },\n};\n```\n\n> 这里只是简单的配置。更多配置可以参考该服务器的文档。\n\n以上配置应当容易理解，只是需要注意各路径必须是绝对路径。\n\n在项目根目录下新建 src 目录，在 src 目录下新建 css、js 目录。在 src 目录下新建一个`index.html`空文件，在 js 目录下新建一个`index.js`空文件。\n\n在项目跟目录下新建 dist 目录。\n\n修改`package.json`如下。\n\n```json\n  \"scripts\": {\n    \"tauri\": \"tauri\",\n    \"dev\": \"webpack serve --config webpack.config.js --mode development\"\n  },\n```\n\n现在先使用`yarn dev`开启语言服务器。等服务器完全启动后，再使用`yarn tauri dev`编译运行项目。\n\n此时可以看到弹出窗口显示为文件浏览器。\n","source":"_posts/rust-tauri-hello-world.md","raw":"---\ntitle: Rust Tauri \"Hello World\"\ndate: 2021-05-11 20:14:05\ntags:\n\t\t- Rust\n\t\t- Tauri\ncategories:\n\t\t- Rust\n---\n\n# Rust Tauri \"Hello World\"\n\n本文介绍如何在 linux 系统上运行第一个 tauri 应用。\n\n> js 开发人员应当可以直接参考官方文档跑通程序。本文旨在为不熟悉此类开发的人士梳理开发流程。\n\n## 什么是 tauri\n\n用一句话回答：tauri 是 electron 的替代品。目前它已经可以做到比 electron 更好。\n\n## Hello World\n\n接下来，来看如何使用 tauri 框架。\n\n### 环境配置\n\n根据[官方文档](https://tauri.studio/en/docs/getting-started/setup-linux)。\n\n在 linux 下使用 tauri 需要 webkit library、nodejs runtime 以及 rust 环境的支持。\n\n> 以下默认以 yarn 作为 js 包管理器。\n\n这部分可以参考文档解决。另外记得给 yarn 和 cargo 换源。\n\n### 初始化项目\n\n1. `yarn init`\n\n一切默认即可。\n\n2. `yarn add @tauri-apps/cli`\n\n在当前项目目录添加 tauri 可执行程序及其依赖。\n\n为了方便使用，在`package.json`中设置如下内容。\n\n```json\n  \"scripts\": {\n    \"tauri\": \"tauri\"\n  }\n```\n\n设置完成之后就可以使用`yarn tauri`命令代替`tauri.js`。\n\n3. `yarn tauri init`\n\n初始化 tauri 项目，设置相应信息。\n\n`Where are your web assets (HTML/CSS/JS) located`指的是存放 html、css、js 文件的目录，可以设置为`../dist`。\n\n`What is the url of your dev server`指的是开发服务器的 url。所谓开发服务器，就是开发过程中使用的显示、调试等工具的集合。这里先将其设置为`http://localhost:8080`。\n\n4. `yarn tauri info`\n\n查看一下刚才设置的信息。\n\n5. `yarn tauri dev`\n\n编译项目并运行。\n\n> 如果你在上面的步骤中因为网络问题而中断操作，很有可能在这一步出现报错。最快的解决方案只需简单粗暴的重头再来。\n\n这时，你会发现项目编译完成并运行，但是显示`could not connect to server`。\n\n这是因为没有启动开发服务器。\n\n6. `yarn add webpack-dev-server`\n\n安装开发服务器。\n\n在`package.json`文件中设置如下。\n\n```json\n  \"scripts\": {\n    \"tauri\": \"tauri\",\n    \"dev\": \"webpack serve\"\n  }\n```\n\n继续安装`yarn add webpack`\n\n这时可以使用`yarn dev`来启动开发服务器。\n\n此时，你又会发现有报错。这是因为没有配置开发服务器。\n\n7. 配置开发服务器\n\n在项目根目录下新建`webpack.config.js`。写入以下内容。\n\n```javascript\nconst path = require(\"path\");\nmodule.exports = {\n  entry: path.join(__dirname, \"src/js/index.js\"),\n  output: {\n    path: path.join(__dirname, \"dist\"),\n    filename: \"bundle.js\",\n  },\n};\n```\n\n> 这里只是简单的配置。更多配置可以参考该服务器的文档。\n\n以上配置应当容易理解，只是需要注意各路径必须是绝对路径。\n\n在项目根目录下新建 src 目录，在 src 目录下新建 css、js 目录。在 src 目录下新建一个`index.html`空文件，在 js 目录下新建一个`index.js`空文件。\n\n在项目跟目录下新建 dist 目录。\n\n修改`package.json`如下。\n\n```json\n  \"scripts\": {\n    \"tauri\": \"tauri\",\n    \"dev\": \"webpack serve --config webpack.config.js --mode development\"\n  },\n```\n\n现在先使用`yarn dev`开启语言服务器。等服务器完全启动后，再使用`yarn tauri dev`编译运行项目。\n\n此时可以看到弹出窗口显示为文件浏览器。\n","slug":"rust-tauri-hello-world","published":1,"updated":"2021-05-11T14:25:32.263Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtms5001wrriz0at37ne0","content":"<h1 id=\"Rust-Tauri-“Hello-World”\"><a href=\"#Rust-Tauri-“Hello-World”\" class=\"headerlink\" title=\"Rust Tauri “Hello World”\"></a>Rust Tauri “Hello World”</h1><p>本文介绍如何在 linux 系统上运行第一个 tauri 应用。</p>\n<blockquote>\n<p>js 开发人员应当可以直接参考官方文档跑通程序。本文旨在为不熟悉此类开发的人士梳理开发流程。</p>\n</blockquote>\n<h2 id=\"什么是-tauri\"><a href=\"#什么是-tauri\" class=\"headerlink\" title=\"什么是 tauri\"></a>什么是 tauri</h2><p>用一句话回答：tauri 是 electron 的替代品。目前它已经可以做到比 electron 更好。</p>\n<h2 id=\"Hello-World\"><a href=\"#Hello-World\" class=\"headerlink\" title=\"Hello World\"></a>Hello World</h2><p>接下来，来看如何使用 tauri 框架。</p>\n<h3 id=\"环境配置\"><a href=\"#环境配置\" class=\"headerlink\" title=\"环境配置\"></a>环境配置</h3><p>根据<a href=\"https://tauri.studio/en/docs/getting-started/setup-linux\">官方文档</a>。</p>\n<p>在 linux 下使用 tauri 需要 webkit library、nodejs runtime 以及 rust 环境的支持。</p>\n<blockquote>\n<p>以下默认以 yarn 作为 js 包管理器。</p>\n</blockquote>\n<p>这部分可以参考文档解决。另外记得给 yarn 和 cargo 换源。</p>\n<h3 id=\"初始化项目\"><a href=\"#初始化项目\" class=\"headerlink\" title=\"初始化项目\"></a>初始化项目</h3><ol>\n<li><code>yarn init</code></li>\n</ol>\n<p>一切默认即可。</p>\n<ol start=\"2\">\n<li><code>yarn add @tauri-apps/cli</code></li>\n</ol>\n<p>在当前项目目录添加 tauri 可执行程序及其依赖。</p>\n<p>为了方便使用，在<code>package.json</code>中设置如下内容。</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"tauri\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tauri\"</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>设置完成之后就可以使用<code>yarn tauri</code>命令代替<code>tauri.js</code>。</p>\n<ol start=\"3\">\n<li><code>yarn tauri init</code></li>\n</ol>\n<p>初始化 tauri 项目，设置相应信息。</p>\n<p><code>Where are your web assets (HTML/CSS/JS) located</code>指的是存放 html、css、js 文件的目录，可以设置为<code>../dist</code>。</p>\n<p><code>What is the url of your dev server</code>指的是开发服务器的 url。所谓开发服务器，就是开发过程中使用的显示、调试等工具的集合。这里先将其设置为<code>http://localhost:8080</code>。</p>\n<ol start=\"4\">\n<li><code>yarn tauri info</code></li>\n</ol>\n<p>查看一下刚才设置的信息。</p>\n<ol start=\"5\">\n<li><code>yarn tauri dev</code></li>\n</ol>\n<p>编译项目并运行。</p>\n<blockquote>\n<p>如果你在上面的步骤中因为网络问题而中断操作，很有可能在这一步出现报错。最快的解决方案只需简单粗暴的重头再来。</p>\n</blockquote>\n<p>这时，你会发现项目编译完成并运行，但是显示<code>could not connect to server</code>。</p>\n<p>这是因为没有启动开发服务器。</p>\n<ol start=\"6\">\n<li><code>yarn add webpack-dev-server</code></li>\n</ol>\n<p>安装开发服务器。</p>\n<p>在<code>package.json</code>文件中设置如下。</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"tauri\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tauri\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"webpack serve\"</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>继续安装<code>yarn add webpack</code></p>\n<p>这时可以使用<code>yarn dev</code>来启动开发服务器。</p>\n<p>此时，你又会发现有报错。这是因为没有配置开发服务器。</p>\n<ol start=\"7\">\n<li>配置开发服务器</li>\n</ol>\n<p>在项目根目录下新建<code>webpack.config.js</code>。写入以下内容。</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"path\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n  entry<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"src/js/index.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  output<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    path<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"dist\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    filename<span class=\"token operator\">:</span> <span class=\"token string\">\"bundle.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<blockquote>\n<p>这里只是简单的配置。更多配置可以参考该服务器的文档。</p>\n</blockquote>\n<p>以上配置应当容易理解，只是需要注意各路径必须是绝对路径。</p>\n<p>在项目根目录下新建 src 目录，在 src 目录下新建 css、js 目录。在 src 目录下新建一个<code>index.html</code>空文件，在 js 目录下新建一个<code>index.js</code>空文件。</p>\n<p>在项目跟目录下新建 dist 目录。</p>\n<p>修改<code>package.json</code>如下。</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"tauri\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tauri\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"webpack serve --config webpack.config.js --mode development\"</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>现在先使用<code>yarn dev</code>开启语言服务器。等服务器完全启动后，再使用<code>yarn tauri dev</code>编译运行项目。</p>\n<p>此时可以看到弹出窗口显示为文件浏览器。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"Rust-Tauri-“Hello-World”\"><a href=\"#Rust-Tauri-“Hello-World”\" class=\"headerlink\" title=\"Rust Tauri “Hello World”\"></a>Rust Tauri “Hello World”</h1><p>本文介绍如何在 linux 系统上运行第一个 tauri 应用。</p>\n<blockquote>\n<p>js 开发人员应当可以直接参考官方文档跑通程序。本文旨在为不熟悉此类开发的人士梳理开发流程。</p>\n</blockquote>\n<h2 id=\"什么是-tauri\"><a href=\"#什么是-tauri\" class=\"headerlink\" title=\"什么是 tauri\"></a>什么是 tauri</h2><p>用一句话回答：tauri 是 electron 的替代品。目前它已经可以做到比 electron 更好。</p>\n<h2 id=\"Hello-World\"><a href=\"#Hello-World\" class=\"headerlink\" title=\"Hello World\"></a>Hello World</h2><p>接下来，来看如何使用 tauri 框架。</p>\n<h3 id=\"环境配置\"><a href=\"#环境配置\" class=\"headerlink\" title=\"环境配置\"></a>环境配置</h3><p>根据<a href=\"https://tauri.studio/en/docs/getting-started/setup-linux\">官方文档</a>。</p>\n<p>在 linux 下使用 tauri 需要 webkit library、nodejs runtime 以及 rust 环境的支持。</p>\n<blockquote>\n<p>以下默认以 yarn 作为 js 包管理器。</p>\n</blockquote>\n<p>这部分可以参考文档解决。另外记得给 yarn 和 cargo 换源。</p>\n<h3 id=\"初始化项目\"><a href=\"#初始化项目\" class=\"headerlink\" title=\"初始化项目\"></a>初始化项目</h3><ol>\n<li><code>yarn init</code></li>\n</ol>\n<p>一切默认即可。</p>\n<ol start=\"2\">\n<li><code>yarn add @tauri-apps/cli</code></li>\n</ol>\n<p>在当前项目目录添加 tauri 可执行程序及其依赖。</p>\n<p>为了方便使用，在<code>package.json</code>中设置如下内容。</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"tauri\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tauri\"</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>设置完成之后就可以使用<code>yarn tauri</code>命令代替<code>tauri.js</code>。</p>\n<ol start=\"3\">\n<li><code>yarn tauri init</code></li>\n</ol>\n<p>初始化 tauri 项目，设置相应信息。</p>\n<p><code>Where are your web assets (HTML/CSS/JS) located</code>指的是存放 html、css、js 文件的目录，可以设置为<code>../dist</code>。</p>\n<p><code>What is the url of your dev server</code>指的是开发服务器的 url。所谓开发服务器，就是开发过程中使用的显示、调试等工具的集合。这里先将其设置为<code>http://localhost:8080</code>。</p>\n<ol start=\"4\">\n<li><code>yarn tauri info</code></li>\n</ol>\n<p>查看一下刚才设置的信息。</p>\n<ol start=\"5\">\n<li><code>yarn tauri dev</code></li>\n</ol>\n<p>编译项目并运行。</p>\n<blockquote>\n<p>如果你在上面的步骤中因为网络问题而中断操作，很有可能在这一步出现报错。最快的解决方案只需简单粗暴的重头再来。</p>\n</blockquote>\n<p>这时，你会发现项目编译完成并运行，但是显示<code>could not connect to server</code>。</p>\n<p>这是因为没有启动开发服务器。</p>\n<ol start=\"6\">\n<li><code>yarn add webpack-dev-server</code></li>\n</ol>\n<p>安装开发服务器。</p>\n<p>在<code>package.json</code>文件中设置如下。</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"tauri\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tauri\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"webpack serve\"</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>继续安装<code>yarn add webpack</code></p>\n<p>这时可以使用<code>yarn dev</code>来启动开发服务器。</p>\n<p>此时，你又会发现有报错。这是因为没有配置开发服务器。</p>\n<ol start=\"7\">\n<li>配置开发服务器</li>\n</ol>\n<p>在项目根目录下新建<code>webpack.config.js</code>。写入以下内容。</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"path\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n  entry<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"src/js/index.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  output<span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    path<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"dist\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    filename<span class=\"token operator\">:</span> <span class=\"token string\">\"bundle.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<blockquote>\n<p>这里只是简单的配置。更多配置可以参考该服务器的文档。</p>\n</blockquote>\n<p>以上配置应当容易理解，只是需要注意各路径必须是绝对路径。</p>\n<p>在项目根目录下新建 src 目录，在 src 目录下新建 css、js 目录。在 src 目录下新建一个<code>index.html</code>空文件，在 js 目录下新建一个<code>index.js</code>空文件。</p>\n<p>在项目跟目录下新建 dist 目录。</p>\n<p>修改<code>package.json</code>如下。</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"tauri\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"tauri\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"webpack serve --config webpack.config.js --mode development\"</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>现在先使用<code>yarn dev</code>开启语言服务器。等服务器完全启动后，再使用<code>yarn tauri dev</code>编译运行项目。</p>\n<p>此时可以看到弹出窗口显示为文件浏览器。</p>\n"},{"title":"Basic Tutorial of Spartan Edge Accelerator Board","date":"2021-06-03T08:57:37.000Z","_content":"\n# Spartan Edge Accelerator Board 入门教程\n\n本文介绍一块 FPGA 开发板——Spartan Edge Accelerator Board。也称 Spartan-7 FPGA 开发板或 SEA-S7。\n\n![develop board](1.png)\n\n## 选择与不选择理由\n\n### 优点\n\n1. 便宜。整板价格在 200-300 元之间，且可以不需要下载器。\n2. 性能好。比起几百块级别的入门板性价比相当高。规格参数可以翻阅官方的文档。[英文](https://wiki.seeedstudio.com/Spartan-Edge-Accelerator-Board/) [中文](https://wiki.seeedstudio.com/cn/Spartan-Edge-Accelerator-Board/)\n3. 可以使用 vivado。vivado 不兼容 Spartan6（常见的入门板）但兼容 Spartan7。\n4. arduino 和 FPGA 的结合体，看起来像低配版的 FPGA ZYNQ（arm + FPGA）。\n5. 提供用封装好的 arduino 接口。方便 arduino 用户入门。\n\n### 缺点\n\n1. 没有详细的文档，更没有视频教程。绝对不适合没有任何经验的 FPGA 小白以及自学能力不够强的新手。\n2. 比一般的以教学为目的的入门板少了很多外设。\n\n## Hello World\n\n下面以一个 blink 项目为例，介绍该开发板的使用。\n\n> 官方的文档上有入门教程，不过好久没维护了，一些链接也没了，有兴趣折腾的可以搞一下。\n\n### 硬件准备\n\n1. 开发板。\n2. 一根 Type-C 数据线。\n3. [可选] Platform Cable USB II （JTAG 接口的 FPGA 下载器）。\n4. 一张 SD 卡（外加读卡器）。\n\n### 软件准备\n\n1. arduino IDE。\n2. vivado（免费的 webpack 版也支持 Spartan-7）。\n3. CP2102 USB 驱动，可以前往[这里](https://www.usb-drivers.org/cp2102-usb-to-uart-bridge-driver.html)下载。\n\n### 软硬件设置\n\n首先明确是要将开发板当作独立的 FPGA 使用，所以 arduino 的部分只是辅助。\n\n#### 硬件\n\n首先找到板子上唯一一个跳线帽。这里标有 PWR_MODE，可以设置电源模式。如果将该开发板作为 arduino 的扩展板使用，可以通过设置 PWR_MODE 为 off 来隔离系统电源，同时给两块板供电。现在只是作为独立的 FPGA 使用，暂时不用管。\n\n然后找到跳线帽旁边的一排拨码开关。新买的板子应该在上面有一层塑料膜封着，将其揭开。将 Slave 下的拨码开关向上推，也就是推向 Slave。这里是设置向 FPGA 写入比特流的方式。当前设置为 arduino 部分将 SD 卡中的比特流文件写入 FPGA。这样就不需要下载器。\n\n将 SD 卡格式化为 FAT16 或 FAT32 文件系统。\n\n#### 软件\n\n启动 arduino IDE。在`文件-首选项-附加开发板管理器网址`处设置`https://dl.espressif.com/dl/package_esp32_index.json`。\n\n在`工具-开发板-开发板管理器`中找到 esp32 并下载安装。\n\n安装完成后，在`工具-开发板`中选择`DOIT ESP32 DEVKIT V1`。\n\n现在测试一下是否可以与开发板正常通信。\n\n用 Type-C 线连接开发板与电脑。可以使用设备管理器（windows）或者(`lsusb` linux)查看是否连接上。也可以在 arduino IDE 中查看`工具-端口`，看是否连接上。\n\n> 注意开发板应上电（检查电源开关），驱动程序应安装，Type-C 线应可传数据。\n\n接下来向 arduino 部分中烧录向 FPGA 写入比特流的程序。\n\n下载[已经写好的库](https://github.com/sandrobenigno/spartan-edge-esp32-boot/archive/master.zip)。在 arduino IDE 中通过`项目-加载库-添加.ZIP库`将库导入。\n\n使用`文件-打开`打开`01LoadDefaultBitstream.ino`文件。这就是需要的程序文件。\n\n接下来，将`工具-Upload Speed`设置为 115200。使用`项目-上传`下载程序到开发板。\n\n至此，arduino 辅助下载 FPGA 比特流文件的部分已经完成。\n\n### Blink\n\n下载[官方例程库](https://gitee.com/SEA-S7/SEA)。找到其中的`Hello-World/FPGA/Verilog/HelloWorld-Verilog`。使用 vivado 打开该项目。修改以下文件内容。\n\n`Hello-World.v`\n\n```verilog\n`timescale 1ns / 1ps\n\nmodule Hello_World(\n    input clk,\n    output reg signal_2\n    );\n\n    reg [32:0] m;\n\n    always @(posedge clk) begin\n        m = m + 1;\n        if (m == 100000000) begin\n            signal_2 = signal_2 == 1 ? 0 : 1;\n            m = 0;\n        end\n    end\nendmodule\n```\n\n`system.xdc`\n\n```\nset_property -dict {PACKAGE_PIN H4 IOSTANDARD LVCMOS33} [get_ports clk]\ncreate_clock -add -name sys_clk_pin -period 10.00 -waveform {0 5} [get_ports {clk}];\n\nset_property IOSTANDARD LVCMOS33 [get_ports {signal_2}]\nset_property PACKAGE_PIN J1 [get_ports {signal_2}]\nset_property PULLDOWN true [get_ports {signal_2}]\n```\n\n直接使用`generate bitstream`生成比特流文件。将位于`HelloWorld-Verilog.runs\\impl_1`下的比特流文件`Hello_World.bit`复制到 SD 卡根目录下的`overlay`目录下，并改名为`default.bit`。\n\n断开开发板与电脑的连接，将 SD 卡插入开发板，再连接开发板与电脑。\n\n不出意外的话就可以看到位于右上角的 LED 灯闪烁。\n\n此后如果要写入新的比特流文件，还是需要按照上述操作，将文件放到 SD 卡中然后改名。\n\n这种写入方式非常麻烦。熟悉 arduino 的用户可能可以尝试通过串行通信直接把电脑上的文件传给 FPGA。\n\n鉴于`Platform Cable USB II`的价格并不高(便宜的大概 100 多)。建议嫌麻烦的还是通过`Platform Cable USB II`连接开发板右上角的 JTAG 接口直接用 vivado 下载比特流文件（注意要先把前面的 Slave 设置回来）。\n\n## 总结\n\n初步使用之后个人感觉这块板子还是挺不错的，用来玩一玩谐波分析和图像识别还是挺适合的。\n\nPCB 可以从[官方文档](https://wiki.seeedstudio.com/Spartan-Edge-Accelerator-Board/)处下载。有问题可以到他们的[论坛](https://forum.seeedstudio.com/)提问。\n","source":"_posts/spartan-edge-accelerator-board-tutorial.md","raw":"---\ntitle: Basic Tutorial of Spartan Edge Accelerator Board\ndate: 2021-06-03 16:57:37\ntags:\n\t\t- FPGA\n\t\t- Arduino\ncategories:\n\t\t- Embedded\n---\n\n# Spartan Edge Accelerator Board 入门教程\n\n本文介绍一块 FPGA 开发板——Spartan Edge Accelerator Board。也称 Spartan-7 FPGA 开发板或 SEA-S7。\n\n![develop board](1.png)\n\n## 选择与不选择理由\n\n### 优点\n\n1. 便宜。整板价格在 200-300 元之间，且可以不需要下载器。\n2. 性能好。比起几百块级别的入门板性价比相当高。规格参数可以翻阅官方的文档。[英文](https://wiki.seeedstudio.com/Spartan-Edge-Accelerator-Board/) [中文](https://wiki.seeedstudio.com/cn/Spartan-Edge-Accelerator-Board/)\n3. 可以使用 vivado。vivado 不兼容 Spartan6（常见的入门板）但兼容 Spartan7。\n4. arduino 和 FPGA 的结合体，看起来像低配版的 FPGA ZYNQ（arm + FPGA）。\n5. 提供用封装好的 arduino 接口。方便 arduino 用户入门。\n\n### 缺点\n\n1. 没有详细的文档，更没有视频教程。绝对不适合没有任何经验的 FPGA 小白以及自学能力不够强的新手。\n2. 比一般的以教学为目的的入门板少了很多外设。\n\n## Hello World\n\n下面以一个 blink 项目为例，介绍该开发板的使用。\n\n> 官方的文档上有入门教程，不过好久没维护了，一些链接也没了，有兴趣折腾的可以搞一下。\n\n### 硬件准备\n\n1. 开发板。\n2. 一根 Type-C 数据线。\n3. [可选] Platform Cable USB II （JTAG 接口的 FPGA 下载器）。\n4. 一张 SD 卡（外加读卡器）。\n\n### 软件准备\n\n1. arduino IDE。\n2. vivado（免费的 webpack 版也支持 Spartan-7）。\n3. CP2102 USB 驱动，可以前往[这里](https://www.usb-drivers.org/cp2102-usb-to-uart-bridge-driver.html)下载。\n\n### 软硬件设置\n\n首先明确是要将开发板当作独立的 FPGA 使用，所以 arduino 的部分只是辅助。\n\n#### 硬件\n\n首先找到板子上唯一一个跳线帽。这里标有 PWR_MODE，可以设置电源模式。如果将该开发板作为 arduino 的扩展板使用，可以通过设置 PWR_MODE 为 off 来隔离系统电源，同时给两块板供电。现在只是作为独立的 FPGA 使用，暂时不用管。\n\n然后找到跳线帽旁边的一排拨码开关。新买的板子应该在上面有一层塑料膜封着，将其揭开。将 Slave 下的拨码开关向上推，也就是推向 Slave。这里是设置向 FPGA 写入比特流的方式。当前设置为 arduino 部分将 SD 卡中的比特流文件写入 FPGA。这样就不需要下载器。\n\n将 SD 卡格式化为 FAT16 或 FAT32 文件系统。\n\n#### 软件\n\n启动 arduino IDE。在`文件-首选项-附加开发板管理器网址`处设置`https://dl.espressif.com/dl/package_esp32_index.json`。\n\n在`工具-开发板-开发板管理器`中找到 esp32 并下载安装。\n\n安装完成后，在`工具-开发板`中选择`DOIT ESP32 DEVKIT V1`。\n\n现在测试一下是否可以与开发板正常通信。\n\n用 Type-C 线连接开发板与电脑。可以使用设备管理器（windows）或者(`lsusb` linux)查看是否连接上。也可以在 arduino IDE 中查看`工具-端口`，看是否连接上。\n\n> 注意开发板应上电（检查电源开关），驱动程序应安装，Type-C 线应可传数据。\n\n接下来向 arduino 部分中烧录向 FPGA 写入比特流的程序。\n\n下载[已经写好的库](https://github.com/sandrobenigno/spartan-edge-esp32-boot/archive/master.zip)。在 arduino IDE 中通过`项目-加载库-添加.ZIP库`将库导入。\n\n使用`文件-打开`打开`01LoadDefaultBitstream.ino`文件。这就是需要的程序文件。\n\n接下来，将`工具-Upload Speed`设置为 115200。使用`项目-上传`下载程序到开发板。\n\n至此，arduino 辅助下载 FPGA 比特流文件的部分已经完成。\n\n### Blink\n\n下载[官方例程库](https://gitee.com/SEA-S7/SEA)。找到其中的`Hello-World/FPGA/Verilog/HelloWorld-Verilog`。使用 vivado 打开该项目。修改以下文件内容。\n\n`Hello-World.v`\n\n```verilog\n`timescale 1ns / 1ps\n\nmodule Hello_World(\n    input clk,\n    output reg signal_2\n    );\n\n    reg [32:0] m;\n\n    always @(posedge clk) begin\n        m = m + 1;\n        if (m == 100000000) begin\n            signal_2 = signal_2 == 1 ? 0 : 1;\n            m = 0;\n        end\n    end\nendmodule\n```\n\n`system.xdc`\n\n```\nset_property -dict {PACKAGE_PIN H4 IOSTANDARD LVCMOS33} [get_ports clk]\ncreate_clock -add -name sys_clk_pin -period 10.00 -waveform {0 5} [get_ports {clk}];\n\nset_property IOSTANDARD LVCMOS33 [get_ports {signal_2}]\nset_property PACKAGE_PIN J1 [get_ports {signal_2}]\nset_property PULLDOWN true [get_ports {signal_2}]\n```\n\n直接使用`generate bitstream`生成比特流文件。将位于`HelloWorld-Verilog.runs\\impl_1`下的比特流文件`Hello_World.bit`复制到 SD 卡根目录下的`overlay`目录下，并改名为`default.bit`。\n\n断开开发板与电脑的连接，将 SD 卡插入开发板，再连接开发板与电脑。\n\n不出意外的话就可以看到位于右上角的 LED 灯闪烁。\n\n此后如果要写入新的比特流文件，还是需要按照上述操作，将文件放到 SD 卡中然后改名。\n\n这种写入方式非常麻烦。熟悉 arduino 的用户可能可以尝试通过串行通信直接把电脑上的文件传给 FPGA。\n\n鉴于`Platform Cable USB II`的价格并不高(便宜的大概 100 多)。建议嫌麻烦的还是通过`Platform Cable USB II`连接开发板右上角的 JTAG 接口直接用 vivado 下载比特流文件（注意要先把前面的 Slave 设置回来）。\n\n## 总结\n\n初步使用之后个人感觉这块板子还是挺不错的，用来玩一玩谐波分析和图像识别还是挺适合的。\n\nPCB 可以从[官方文档](https://wiki.seeedstudio.com/Spartan-Edge-Accelerator-Board/)处下载。有问题可以到他们的[论坛](https://forum.seeedstudio.com/)提问。\n","slug":"spartan-edge-accelerator-board-tutorial","published":1,"updated":"2021-06-03T14:42:05.565Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtms70020rriz7o25g5fe","content":"<h1 id=\"Spartan-Edge-Accelerator-Board-入门教程\"><a href=\"#Spartan-Edge-Accelerator-Board-入门教程\" class=\"headerlink\" title=\"Spartan Edge Accelerator Board 入门教程\"></a>Spartan Edge Accelerator Board 入门教程</h1><p>本文介绍一块 FPGA 开发板——Spartan Edge Accelerator Board。也称 Spartan-7 FPGA 开发板或 SEA-S7。</p>\n<p><img src=\"1.png\" alt=\"develop board\"></p>\n<h2 id=\"选择与不选择理由\"><a href=\"#选择与不选择理由\" class=\"headerlink\" title=\"选择与不选择理由\"></a>选择与不选择理由</h2><h3 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h3><ol>\n<li>便宜。整板价格在 200-300 元之间，且可以不需要下载器。</li>\n<li>性能好。比起几百块级别的入门板性价比相当高。规格参数可以翻阅官方的文档。<a href=\"https://wiki.seeedstudio.com/Spartan-Edge-Accelerator-Board/\">英文</a> <a href=\"https://wiki.seeedstudio.com/cn/Spartan-Edge-Accelerator-Board/\">中文</a></li>\n<li>可以使用 vivado。vivado 不兼容 Spartan6（常见的入门板）但兼容 Spartan7。</li>\n<li>arduino 和 FPGA 的结合体，看起来像低配版的 FPGA ZYNQ（arm + FPGA）。</li>\n<li>提供用封装好的 arduino 接口。方便 arduino 用户入门。</li>\n</ol>\n<h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ol>\n<li>没有详细的文档，更没有视频教程。绝对不适合没有任何经验的 FPGA 小白以及自学能力不够强的新手。</li>\n<li>比一般的以教学为目的的入门板少了很多外设。</li>\n</ol>\n<h2 id=\"Hello-World\"><a href=\"#Hello-World\" class=\"headerlink\" title=\"Hello World\"></a>Hello World</h2><p>下面以一个 blink 项目为例，介绍该开发板的使用。</p>\n<blockquote>\n<p>官方的文档上有入门教程，不过好久没维护了，一些链接也没了，有兴趣折腾的可以搞一下。</p>\n</blockquote>\n<h3 id=\"硬件准备\"><a href=\"#硬件准备\" class=\"headerlink\" title=\"硬件准备\"></a>硬件准备</h3><ol>\n<li>开发板。</li>\n<li>一根 Type-C 数据线。</li>\n<li>[可选] Platform Cable USB II （JTAG 接口的 FPGA 下载器）。</li>\n<li>一张 SD 卡（外加读卡器）。</li>\n</ol>\n<h3 id=\"软件准备\"><a href=\"#软件准备\" class=\"headerlink\" title=\"软件准备\"></a>软件准备</h3><ol>\n<li>arduino IDE。</li>\n<li>vivado（免费的 webpack 版也支持 Spartan-7）。</li>\n<li>CP2102 USB 驱动，可以前往<a href=\"https://www.usb-drivers.org/cp2102-usb-to-uart-bridge-driver.html\">这里</a>下载。</li>\n</ol>\n<h3 id=\"软硬件设置\"><a href=\"#软硬件设置\" class=\"headerlink\" title=\"软硬件设置\"></a>软硬件设置</h3><p>首先明确是要将开发板当作独立的 FPGA 使用，所以 arduino 的部分只是辅助。</p>\n<h4 id=\"硬件\"><a href=\"#硬件\" class=\"headerlink\" title=\"硬件\"></a>硬件</h4><p>首先找到板子上唯一一个跳线帽。这里标有 PWR_MODE，可以设置电源模式。如果将该开发板作为 arduino 的扩展板使用，可以通过设置 PWR_MODE 为 off 来隔离系统电源，同时给两块板供电。现在只是作为独立的 FPGA 使用，暂时不用管。</p>\n<p>然后找到跳线帽旁边的一排拨码开关。新买的板子应该在上面有一层塑料膜封着，将其揭开。将 Slave 下的拨码开关向上推，也就是推向 Slave。这里是设置向 FPGA 写入比特流的方式。当前设置为 arduino 部分将 SD 卡中的比特流文件写入 FPGA。这样就不需要下载器。</p>\n<p>将 SD 卡格式化为 FAT16 或 FAT32 文件系统。</p>\n<h4 id=\"软件\"><a href=\"#软件\" class=\"headerlink\" title=\"软件\"></a>软件</h4><p>启动 arduino IDE。在<code>文件-首选项-附加开发板管理器网址</code>处设置<code>https://dl.espressif.com/dl/package_esp32_index.json</code>。</p>\n<p>在<code>工具-开发板-开发板管理器</code>中找到 esp32 并下载安装。</p>\n<p>安装完成后，在<code>工具-开发板</code>中选择<code>DOIT ESP32 DEVKIT V1</code>。</p>\n<p>现在测试一下是否可以与开发板正常通信。</p>\n<p>用 Type-C 线连接开发板与电脑。可以使用设备管理器（windows）或者(<code>lsusb</code> linux)查看是否连接上。也可以在 arduino IDE 中查看<code>工具-端口</code>，看是否连接上。</p>\n<blockquote>\n<p>注意开发板应上电（检查电源开关），驱动程序应安装，Type-C 线应可传数据。</p>\n</blockquote>\n<p>接下来向 arduino 部分中烧录向 FPGA 写入比特流的程序。</p>\n<p>下载<a href=\"https://github.com/sandrobenigno/spartan-edge-esp32-boot/archive/master.zip\">已经写好的库</a>。在 arduino IDE 中通过<code>项目-加载库-添加.ZIP库</code>将库导入。</p>\n<p>使用<code>文件-打开</code>打开<code>01LoadDefaultBitstream.ino</code>文件。这就是需要的程序文件。</p>\n<p>接下来，将<code>工具-Upload Speed</code>设置为 115200。使用<code>项目-上传</code>下载程序到开发板。</p>\n<p>至此，arduino 辅助下载 FPGA 比特流文件的部分已经完成。</p>\n<h3 id=\"Blink\"><a href=\"#Blink\" class=\"headerlink\" title=\"Blink\"></a>Blink</h3><p>下载<a href=\"https://gitee.com/SEA-S7/SEA\">官方例程库</a>。找到其中的<code>Hello-World/FPGA/Verilog/HelloWorld-Verilog</code>。使用 vivado 打开该项目。修改以下文件内容。</p>\n<p><code>Hello-World.v</code></p>\n<pre class=\"line-numbers language-verilog\" data-language=\"verilog\"><code class=\"language-verilog\"><span class=\"token constant\">`timescale</span> <span class=\"token number\">1</span>ns <span class=\"token operator\">/</span> <span class=\"token number\">1</span>ps\n\n<span class=\"token keyword\">module</span> <span class=\"token function\">Hello_World</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">input</span> clk<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">output</span> <span class=\"token keyword\">reg</span> signal_2\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">reg</span> <span class=\"token punctuation\">[</span><span class=\"token number\">32</span><span class=\"token punctuation\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> m<span class=\"token punctuation\">;</span>\n\n    <span class=\"token important\">always @</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">posedge</span> clk<span class=\"token punctuation\">)</span> <span class=\"token keyword\">begin</span>\n        m <span class=\"token operator\">=</span> m <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>m <span class=\"token operator\">==</span> <span class=\"token number\">100000000</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">begin</span>\n            signal_2 <span class=\"token operator\">=</span> signal_2 <span class=\"token operator\">==</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n            m <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">end</span>\n    <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">endmodule</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>system.xdc</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">set_property -dict &#123;PACKAGE_PIN H4 IOSTANDARD LVCMOS33&#125; [get_ports clk]\ncreate_clock -add -name sys_clk_pin -period 10.00 -waveform &#123;0 5&#125; [get_ports &#123;clk&#125;];\n\nset_property IOSTANDARD LVCMOS33 [get_ports &#123;signal_2&#125;]\nset_property PACKAGE_PIN J1 [get_ports &#123;signal_2&#125;]\nset_property PULLDOWN true [get_ports &#123;signal_2&#125;]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>直接使用<code>generate bitstream</code>生成比特流文件。将位于<code>HelloWorld-Verilog.runs\\impl_1</code>下的比特流文件<code>Hello_World.bit</code>复制到 SD 卡根目录下的<code>overlay</code>目录下，并改名为<code>default.bit</code>。</p>\n<p>断开开发板与电脑的连接，将 SD 卡插入开发板，再连接开发板与电脑。</p>\n<p>不出意外的话就可以看到位于右上角的 LED 灯闪烁。</p>\n<p>此后如果要写入新的比特流文件，还是需要按照上述操作，将文件放到 SD 卡中然后改名。</p>\n<p>这种写入方式非常麻烦。熟悉 arduino 的用户可能可以尝试通过串行通信直接把电脑上的文件传给 FPGA。</p>\n<p>鉴于<code>Platform Cable USB II</code>的价格并不高(便宜的大概 100 多)。建议嫌麻烦的还是通过<code>Platform Cable USB II</code>连接开发板右上角的 JTAG 接口直接用 vivado 下载比特流文件（注意要先把前面的 Slave 设置回来）。</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>初步使用之后个人感觉这块板子还是挺不错的，用来玩一玩谐波分析和图像识别还是挺适合的。</p>\n<p>PCB 可以从<a href=\"https://wiki.seeedstudio.com/Spartan-Edge-Accelerator-Board/\">官方文档</a>处下载。有问题可以到他们的<a href=\"https://forum.seeedstudio.com/\">论坛</a>提问。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"Spartan-Edge-Accelerator-Board-入门教程\"><a href=\"#Spartan-Edge-Accelerator-Board-入门教程\" class=\"headerlink\" title=\"Spartan Edge Accelerator Board 入门教程\"></a>Spartan Edge Accelerator Board 入门教程</h1><p>本文介绍一块 FPGA 开发板——Spartan Edge Accelerator Board。也称 Spartan-7 FPGA 开发板或 SEA-S7。</p>\n<p><img src=\"1.png\" alt=\"develop board\"></p>\n<h2 id=\"选择与不选择理由\"><a href=\"#选择与不选择理由\" class=\"headerlink\" title=\"选择与不选择理由\"></a>选择与不选择理由</h2><h3 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h3><ol>\n<li>便宜。整板价格在 200-300 元之间，且可以不需要下载器。</li>\n<li>性能好。比起几百块级别的入门板性价比相当高。规格参数可以翻阅官方的文档。<a href=\"https://wiki.seeedstudio.com/Spartan-Edge-Accelerator-Board/\">英文</a> <a href=\"https://wiki.seeedstudio.com/cn/Spartan-Edge-Accelerator-Board/\">中文</a></li>\n<li>可以使用 vivado。vivado 不兼容 Spartan6（常见的入门板）但兼容 Spartan7。</li>\n<li>arduino 和 FPGA 的结合体，看起来像低配版的 FPGA ZYNQ（arm + FPGA）。</li>\n<li>提供用封装好的 arduino 接口。方便 arduino 用户入门。</li>\n</ol>\n<h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ol>\n<li>没有详细的文档，更没有视频教程。绝对不适合没有任何经验的 FPGA 小白以及自学能力不够强的新手。</li>\n<li>比一般的以教学为目的的入门板少了很多外设。</li>\n</ol>\n<h2 id=\"Hello-World\"><a href=\"#Hello-World\" class=\"headerlink\" title=\"Hello World\"></a>Hello World</h2><p>下面以一个 blink 项目为例，介绍该开发板的使用。</p>\n<blockquote>\n<p>官方的文档上有入门教程，不过好久没维护了，一些链接也没了，有兴趣折腾的可以搞一下。</p>\n</blockquote>\n<h3 id=\"硬件准备\"><a href=\"#硬件准备\" class=\"headerlink\" title=\"硬件准备\"></a>硬件准备</h3><ol>\n<li>开发板。</li>\n<li>一根 Type-C 数据线。</li>\n<li>[可选] Platform Cable USB II （JTAG 接口的 FPGA 下载器）。</li>\n<li>一张 SD 卡（外加读卡器）。</li>\n</ol>\n<h3 id=\"软件准备\"><a href=\"#软件准备\" class=\"headerlink\" title=\"软件准备\"></a>软件准备</h3><ol>\n<li>arduino IDE。</li>\n<li>vivado（免费的 webpack 版也支持 Spartan-7）。</li>\n<li>CP2102 USB 驱动，可以前往<a href=\"https://www.usb-drivers.org/cp2102-usb-to-uart-bridge-driver.html\">这里</a>下载。</li>\n</ol>\n<h3 id=\"软硬件设置\"><a href=\"#软硬件设置\" class=\"headerlink\" title=\"软硬件设置\"></a>软硬件设置</h3><p>首先明确是要将开发板当作独立的 FPGA 使用，所以 arduino 的部分只是辅助。</p>\n<h4 id=\"硬件\"><a href=\"#硬件\" class=\"headerlink\" title=\"硬件\"></a>硬件</h4><p>首先找到板子上唯一一个跳线帽。这里标有 PWR_MODE，可以设置电源模式。如果将该开发板作为 arduino 的扩展板使用，可以通过设置 PWR_MODE 为 off 来隔离系统电源，同时给两块板供电。现在只是作为独立的 FPGA 使用，暂时不用管。</p>\n<p>然后找到跳线帽旁边的一排拨码开关。新买的板子应该在上面有一层塑料膜封着，将其揭开。将 Slave 下的拨码开关向上推，也就是推向 Slave。这里是设置向 FPGA 写入比特流的方式。当前设置为 arduino 部分将 SD 卡中的比特流文件写入 FPGA。这样就不需要下载器。</p>\n<p>将 SD 卡格式化为 FAT16 或 FAT32 文件系统。</p>\n<h4 id=\"软件\"><a href=\"#软件\" class=\"headerlink\" title=\"软件\"></a>软件</h4><p>启动 arduino IDE。在<code>文件-首选项-附加开发板管理器网址</code>处设置<code>https://dl.espressif.com/dl/package_esp32_index.json</code>。</p>\n<p>在<code>工具-开发板-开发板管理器</code>中找到 esp32 并下载安装。</p>\n<p>安装完成后，在<code>工具-开发板</code>中选择<code>DOIT ESP32 DEVKIT V1</code>。</p>\n<p>现在测试一下是否可以与开发板正常通信。</p>\n<p>用 Type-C 线连接开发板与电脑。可以使用设备管理器（windows）或者(<code>lsusb</code> linux)查看是否连接上。也可以在 arduino IDE 中查看<code>工具-端口</code>，看是否连接上。</p>\n<blockquote>\n<p>注意开发板应上电（检查电源开关），驱动程序应安装，Type-C 线应可传数据。</p>\n</blockquote>\n<p>接下来向 arduino 部分中烧录向 FPGA 写入比特流的程序。</p>\n<p>下载<a href=\"https://github.com/sandrobenigno/spartan-edge-esp32-boot/archive/master.zip\">已经写好的库</a>。在 arduino IDE 中通过<code>项目-加载库-添加.ZIP库</code>将库导入。</p>\n<p>使用<code>文件-打开</code>打开<code>01LoadDefaultBitstream.ino</code>文件。这就是需要的程序文件。</p>\n<p>接下来，将<code>工具-Upload Speed</code>设置为 115200。使用<code>项目-上传</code>下载程序到开发板。</p>\n<p>至此，arduino 辅助下载 FPGA 比特流文件的部分已经完成。</p>\n<h3 id=\"Blink\"><a href=\"#Blink\" class=\"headerlink\" title=\"Blink\"></a>Blink</h3><p>下载<a href=\"https://gitee.com/SEA-S7/SEA\">官方例程库</a>。找到其中的<code>Hello-World/FPGA/Verilog/HelloWorld-Verilog</code>。使用 vivado 打开该项目。修改以下文件内容。</p>\n<p><code>Hello-World.v</code></p>\n<pre class=\"line-numbers language-verilog\" data-language=\"verilog\"><code class=\"language-verilog\"><span class=\"token constant\">`timescale</span> <span class=\"token number\">1</span>ns <span class=\"token operator\">/</span> <span class=\"token number\">1</span>ps\n\n<span class=\"token keyword\">module</span> <span class=\"token function\">Hello_World</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">input</span> clk<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">output</span> <span class=\"token keyword\">reg</span> signal_2\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">reg</span> <span class=\"token punctuation\">[</span><span class=\"token number\">32</span><span class=\"token punctuation\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> m<span class=\"token punctuation\">;</span>\n\n    <span class=\"token important\">always @</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">posedge</span> clk<span class=\"token punctuation\">)</span> <span class=\"token keyword\">begin</span>\n        m <span class=\"token operator\">=</span> m <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>m <span class=\"token operator\">==</span> <span class=\"token number\">100000000</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">begin</span>\n            signal_2 <span class=\"token operator\">=</span> signal_2 <span class=\"token operator\">==</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n            m <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">end</span>\n    <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">endmodule</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>system.xdc</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">set_property -dict &#123;PACKAGE_PIN H4 IOSTANDARD LVCMOS33&#125; [get_ports clk]\ncreate_clock -add -name sys_clk_pin -period 10.00 -waveform &#123;0 5&#125; [get_ports &#123;clk&#125;];\n\nset_property IOSTANDARD LVCMOS33 [get_ports &#123;signal_2&#125;]\nset_property PACKAGE_PIN J1 [get_ports &#123;signal_2&#125;]\nset_property PULLDOWN true [get_ports &#123;signal_2&#125;]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>直接使用<code>generate bitstream</code>生成比特流文件。将位于<code>HelloWorld-Verilog.runs\\impl_1</code>下的比特流文件<code>Hello_World.bit</code>复制到 SD 卡根目录下的<code>overlay</code>目录下，并改名为<code>default.bit</code>。</p>\n<p>断开开发板与电脑的连接，将 SD 卡插入开发板，再连接开发板与电脑。</p>\n<p>不出意外的话就可以看到位于右上角的 LED 灯闪烁。</p>\n<p>此后如果要写入新的比特流文件，还是需要按照上述操作，将文件放到 SD 卡中然后改名。</p>\n<p>这种写入方式非常麻烦。熟悉 arduino 的用户可能可以尝试通过串行通信直接把电脑上的文件传给 FPGA。</p>\n<p>鉴于<code>Platform Cable USB II</code>的价格并不高(便宜的大概 100 多)。建议嫌麻烦的还是通过<code>Platform Cable USB II</code>连接开发板右上角的 JTAG 接口直接用 vivado 下载比特流文件（注意要先把前面的 Slave 设置回来）。</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>初步使用之后个人感觉这块板子还是挺不错的，用来玩一玩谐波分析和图像识别还是挺适合的。</p>\n<p>PCB 可以从<a href=\"https://wiki.seeedstudio.com/Spartan-Edge-Accelerator-Board/\">官方文档</a>处下载。有问题可以到他们的<a href=\"https://forum.seeedstudio.com/\">论坛</a>提问。</p>\n"},{"title":"Use Custom Snippets in Vim","date":"2021-06-05T08:18:12.000Z","_content":"\n# 在 vim 中使用自定义 snippets\n\n本文介绍如何在 vim 中使用自定义 snippets。本文不详解 snippets 语法。\n\n## 插件安装与配置\n\n首先，安装`coc-snippets`插件，该插件依赖`coc.nvim`。安装好`coc.nvim`之后，只需要使用`:CocInstall coc-snippets`命令即可安装。具体设置可以参考其[github 主页](https://github.com/neoclide/coc-snippets)。安装该插件后需要同步安装`honza/vim-snippets`来提供 snippets。`SirVer/ultisnips`需要拆卸掉，因为该插件会对自定义的 snippets 文件报错。\n\n接下来，使用`:CocConfig`打开`coc.nvim`配置文件，设置自定义 snippets 文件路径。如`\"snippets.userSnippetsDirectory\": \"/home/niuiic/.config/nvim/snippets\"`。（注意这是个 json 文件，最外层需要花括号）\n\n## 自定义 snippets 文件\n\n然后就可以在该目录下自定义 snippets 文件，文件名称保持和文件类型相同即可。snippets 语法还是比较复杂的，下面给出一个简单例子，足以实现基本功能。更高级的功能请自行学习。（coc.nvim 提供的自动补全筛选能力已经足够强大，即使是简单的设置也可以带来极佳的体验。更复杂的设置个人觉得没有必要。）\n\n`systemverilog.snippets`\n\n```\n# nomal always\nsnippet alw\n\talways @(${0}) begin\n\n\tend\n```\n\n`alw`是缩写，也就是当你打出 alw 时可以调用该 snippets。`${0}`的作用比较复杂，最简单也是对新手来说最实用的作用就是当你添加这一项后，补全 snippets 之后光标会自动停留在这个位置。\n\n如果再加一项，如下。\n\n```\n# nomal always\nsnippet alw\n\talways @(${1}) begin\n\t\t${0}\n\tend\n```\n\n此时光标会停留在`${1}`的位置。\n\n按照上述例子继续补充自己想要的 snippets 即可。注意标准写法中应当是用`endsnippet`的，不过这插件似乎不需要这个，而且加上这一句之后反而会出现在补全内容中，因此还是不加为好。\n","source":"_posts/use-custom-snippets-in-vim.md","raw":"---\ntitle: Use Custom Snippets in Vim\ndate: 2021-06-05 16:18:12\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# 在 vim 中使用自定义 snippets\n\n本文介绍如何在 vim 中使用自定义 snippets。本文不详解 snippets 语法。\n\n## 插件安装与配置\n\n首先，安装`coc-snippets`插件，该插件依赖`coc.nvim`。安装好`coc.nvim`之后，只需要使用`:CocInstall coc-snippets`命令即可安装。具体设置可以参考其[github 主页](https://github.com/neoclide/coc-snippets)。安装该插件后需要同步安装`honza/vim-snippets`来提供 snippets。`SirVer/ultisnips`需要拆卸掉，因为该插件会对自定义的 snippets 文件报错。\n\n接下来，使用`:CocConfig`打开`coc.nvim`配置文件，设置自定义 snippets 文件路径。如`\"snippets.userSnippetsDirectory\": \"/home/niuiic/.config/nvim/snippets\"`。（注意这是个 json 文件，最外层需要花括号）\n\n## 自定义 snippets 文件\n\n然后就可以在该目录下自定义 snippets 文件，文件名称保持和文件类型相同即可。snippets 语法还是比较复杂的，下面给出一个简单例子，足以实现基本功能。更高级的功能请自行学习。（coc.nvim 提供的自动补全筛选能力已经足够强大，即使是简单的设置也可以带来极佳的体验。更复杂的设置个人觉得没有必要。）\n\n`systemverilog.snippets`\n\n```\n# nomal always\nsnippet alw\n\talways @(${0}) begin\n\n\tend\n```\n\n`alw`是缩写，也就是当你打出 alw 时可以调用该 snippets。`${0}`的作用比较复杂，最简单也是对新手来说最实用的作用就是当你添加这一项后，补全 snippets 之后光标会自动停留在这个位置。\n\n如果再加一项，如下。\n\n```\n# nomal always\nsnippet alw\n\talways @(${1}) begin\n\t\t${0}\n\tend\n```\n\n此时光标会停留在`${1}`的位置。\n\n按照上述例子继续补充自己想要的 snippets 即可。注意标准写法中应当是用`endsnippet`的，不过这插件似乎不需要这个，而且加上这一句之后反而会出现在补全内容中，因此还是不加为好。\n","slug":"use-custom-snippets-in-vim","published":1,"updated":"2021-06-05T14:46:03.605Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtms80023rriz0gxs4r8w","content":"<h1 id=\"在-vim-中使用自定义-snippets\"><a href=\"#在-vim-中使用自定义-snippets\" class=\"headerlink\" title=\"在 vim 中使用自定义 snippets\"></a>在 vim 中使用自定义 snippets</h1><p>本文介绍如何在 vim 中使用自定义 snippets。本文不详解 snippets 语法。</p>\n<h2 id=\"插件安装与配置\"><a href=\"#插件安装与配置\" class=\"headerlink\" title=\"插件安装与配置\"></a>插件安装与配置</h2><p>首先，安装<code>coc-snippets</code>插件，该插件依赖<code>coc.nvim</code>。安装好<code>coc.nvim</code>之后，只需要使用<code>:CocInstall coc-snippets</code>命令即可安装。具体设置可以参考其<a href=\"https://github.com/neoclide/coc-snippets\">github 主页</a>。安装该插件后需要同步安装<code>honza/vim-snippets</code>来提供 snippets。<code>SirVer/ultisnips</code>需要拆卸掉，因为该插件会对自定义的 snippets 文件报错。</p>\n<p>接下来，使用<code>:CocConfig</code>打开<code>coc.nvim</code>配置文件，设置自定义 snippets 文件路径。如<code>&quot;snippets.userSnippetsDirectory&quot;: &quot;/home/niuiic/.config/nvim/snippets&quot;</code>。（注意这是个 json 文件，最外层需要花括号）</p>\n<h2 id=\"自定义-snippets-文件\"><a href=\"#自定义-snippets-文件\" class=\"headerlink\" title=\"自定义 snippets 文件\"></a>自定义 snippets 文件</h2><p>然后就可以在该目录下自定义 snippets 文件，文件名称保持和文件类型相同即可。snippets 语法还是比较复杂的，下面给出一个简单例子，足以实现基本功能。更高级的功能请自行学习。（coc.nvim 提供的自动补全筛选能力已经足够强大，即使是简单的设置也可以带来极佳的体验。更复杂的设置个人觉得没有必要。）</p>\n<p><code>systemverilog.snippets</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># nomal always\nsnippet alw\n\talways @($&#123;0&#125;) begin\n\n\tend<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>alw</code>是缩写，也就是当你打出 alw 时可以调用该 snippets。<code>$&#123;0&#125;</code>的作用比较复杂，最简单也是对新手来说最实用的作用就是当你添加这一项后，补全 snippets 之后光标会自动停留在这个位置。</p>\n<p>如果再加一项，如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># nomal always\nsnippet alw\n\talways @($&#123;1&#125;) begin\n\t\t$&#123;0&#125;\n\tend<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>此时光标会停留在<code>$&#123;1&#125;</code>的位置。</p>\n<p>按照上述例子继续补充自己想要的 snippets 即可。注意标准写法中应当是用<code>endsnippet</code>的，不过这插件似乎不需要这个，而且加上这一句之后反而会出现在补全内容中，因此还是不加为好。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"在-vim-中使用自定义-snippets\"><a href=\"#在-vim-中使用自定义-snippets\" class=\"headerlink\" title=\"在 vim 中使用自定义 snippets\"></a>在 vim 中使用自定义 snippets</h1><p>本文介绍如何在 vim 中使用自定义 snippets。本文不详解 snippets 语法。</p>\n<h2 id=\"插件安装与配置\"><a href=\"#插件安装与配置\" class=\"headerlink\" title=\"插件安装与配置\"></a>插件安装与配置</h2><p>首先，安装<code>coc-snippets</code>插件，该插件依赖<code>coc.nvim</code>。安装好<code>coc.nvim</code>之后，只需要使用<code>:CocInstall coc-snippets</code>命令即可安装。具体设置可以参考其<a href=\"https://github.com/neoclide/coc-snippets\">github 主页</a>。安装该插件后需要同步安装<code>honza/vim-snippets</code>来提供 snippets。<code>SirVer/ultisnips</code>需要拆卸掉，因为该插件会对自定义的 snippets 文件报错。</p>\n<p>接下来，使用<code>:CocConfig</code>打开<code>coc.nvim</code>配置文件，设置自定义 snippets 文件路径。如<code>&quot;snippets.userSnippetsDirectory&quot;: &quot;/home/niuiic/.config/nvim/snippets&quot;</code>。（注意这是个 json 文件，最外层需要花括号）</p>\n<h2 id=\"自定义-snippets-文件\"><a href=\"#自定义-snippets-文件\" class=\"headerlink\" title=\"自定义 snippets 文件\"></a>自定义 snippets 文件</h2><p>然后就可以在该目录下自定义 snippets 文件，文件名称保持和文件类型相同即可。snippets 语法还是比较复杂的，下面给出一个简单例子，足以实现基本功能。更高级的功能请自行学习。（coc.nvim 提供的自动补全筛选能力已经足够强大，即使是简单的设置也可以带来极佳的体验。更复杂的设置个人觉得没有必要。）</p>\n<p><code>systemverilog.snippets</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># nomal always\nsnippet alw\n\talways @($&#123;0&#125;) begin\n\n\tend<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>alw</code>是缩写，也就是当你打出 alw 时可以调用该 snippets。<code>$&#123;0&#125;</code>的作用比较复杂，最简单也是对新手来说最实用的作用就是当你添加这一项后，补全 snippets 之后光标会自动停留在这个位置。</p>\n<p>如果再加一项，如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># nomal always\nsnippet alw\n\talways @($&#123;1&#125;) begin\n\t\t$&#123;0&#125;\n\tend<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>此时光标会停留在<code>$&#123;1&#125;</code>的位置。</p>\n<p>按照上述例子继续补充自己想要的 snippets 即可。注意标准写法中应当是用<code>endsnippet</code>的，不过这插件似乎不需要这个，而且加上这一句之后反而会出现在补全内容中，因此还是不加为好。</p>\n"},{"title":"Use Realvnc on Manjaro on rpi4","date":"2021-05-15T13:58:56.000Z","_content":"\n# 在安装 manjaro 系统的树莓派上使用 realvnc\n\n本文主要介绍如何在树莓派 4 上的 manjaro 或 arch 系统上使用 realvnc。如果设置不成功，也可以参考我的[另一篇文章](https://www.niuiic.top/2021/05/15/install-manjaro-on-rpi4/)使用 tigervnc 代替。\n\n## 安装\n\n```\nyay -S aur/realvnc-vnc-server-aarch64\n```\n\n## 配置\n\n注意，以下步骤是我在折腾时用到的，不一定全部有用，但设置完成后应该可以达到效果。\n\n1. 设置`~/.vnc/config.d/vncserver-x11`文件，将`Authentication=SystemAuth`改为`Authentication=VncAuth`。如果原本没有，直接写上就行。\n2. 使用`sudo vncpasswd -service`设置密码。\n3. 设置开机启动 vnc。\n   `sudo systemctl enable vncserver-x11-serviced.service sudo systemctl enable vncserver-virtuald.service`\n4. 安装一个驱动。`yay -S xf86-video-dummy`\n5. 修改`/etc/X11/xorg.conf.d/10-headless.conf`为以下内容。\n\n```\nSection \"Monitor\"\n        Identifier \"dummy_monitor\"\n        HorizSync 28.0-80.0\n        VertRefresh 48.0-75.0\n        Modeline \"1920x1080\" 172.80 1920 2040 2248 2576 1080 1081 1084 1118\nEndSection\n\nSection \"Device\"\n        Identifier \"dummy_card\"\n        VideoRam 256000\n        Driver \"dummy\"\nEndSection\n\nSection \"Screen\"\n        Identifier \"dummy_screen\"\n        Device \"dummy_card\"\n        Monitor \"dummy_monitor\"\n        SubSection \"Display\"\n        EndSubSection\nEndSection\n```\n\n6. 允许用户使用`system-xorg`。`vncinitconfig -enable-system-xorg`。输出提示该发行版不支持 system-xorg。不用管他，继续设置就行。\n7. 这里是设置分辨率，是最关键的一步。熟悉 vnc 的应该知道如果 vncserver 不知道分辨率就不能显示。而通过`raspi-config`修改分辨率在这两个系统上是无效的。因此需要修改`/etc/X11/vncserver-virtual-dummy.conf`，写入`gtf 1920 1080 60`。\n","source":"_posts/use-realvnc-on-manjaro-on-rpi4.md","raw":"---\ntitle: Use Realvnc on Manjaro on rpi4\ndate: 2021-05-15 21:58:56\ntags:\n  - Raspberry Pi\n  - Manjaro\n  - Realvnc\ncategories:\n  - Raspberry Pi\n---\n\n# 在安装 manjaro 系统的树莓派上使用 realvnc\n\n本文主要介绍如何在树莓派 4 上的 manjaro 或 arch 系统上使用 realvnc。如果设置不成功，也可以参考我的[另一篇文章](https://www.niuiic.top/2021/05/15/install-manjaro-on-rpi4/)使用 tigervnc 代替。\n\n## 安装\n\n```\nyay -S aur/realvnc-vnc-server-aarch64\n```\n\n## 配置\n\n注意，以下步骤是我在折腾时用到的，不一定全部有用，但设置完成后应该可以达到效果。\n\n1. 设置`~/.vnc/config.d/vncserver-x11`文件，将`Authentication=SystemAuth`改为`Authentication=VncAuth`。如果原本没有，直接写上就行。\n2. 使用`sudo vncpasswd -service`设置密码。\n3. 设置开机启动 vnc。\n   `sudo systemctl enable vncserver-x11-serviced.service sudo systemctl enable vncserver-virtuald.service`\n4. 安装一个驱动。`yay -S xf86-video-dummy`\n5. 修改`/etc/X11/xorg.conf.d/10-headless.conf`为以下内容。\n\n```\nSection \"Monitor\"\n        Identifier \"dummy_monitor\"\n        HorizSync 28.0-80.0\n        VertRefresh 48.0-75.0\n        Modeline \"1920x1080\" 172.80 1920 2040 2248 2576 1080 1081 1084 1118\nEndSection\n\nSection \"Device\"\n        Identifier \"dummy_card\"\n        VideoRam 256000\n        Driver \"dummy\"\nEndSection\n\nSection \"Screen\"\n        Identifier \"dummy_screen\"\n        Device \"dummy_card\"\n        Monitor \"dummy_monitor\"\n        SubSection \"Display\"\n        EndSubSection\nEndSection\n```\n\n6. 允许用户使用`system-xorg`。`vncinitconfig -enable-system-xorg`。输出提示该发行版不支持 system-xorg。不用管他，继续设置就行。\n7. 这里是设置分辨率，是最关键的一步。熟悉 vnc 的应该知道如果 vncserver 不知道分辨率就不能显示。而通过`raspi-config`修改分辨率在这两个系统上是无效的。因此需要修改`/etc/X11/vncserver-virtual-dummy.conf`，写入`gtf 1920 1080 60`。\n","slug":"use-realvnc-on-manjaro-on-rpi4","published":1,"updated":"2021-05-15T14:02:27.842Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtms90026rriz4fdi1fd4","content":"<h1 id=\"在安装-manjaro-系统的树莓派上使用-realvnc\"><a href=\"#在安装-manjaro-系统的树莓派上使用-realvnc\" class=\"headerlink\" title=\"在安装 manjaro 系统的树莓派上使用 realvnc\"></a>在安装 manjaro 系统的树莓派上使用 realvnc</h1><p>本文主要介绍如何在树莓派 4 上的 manjaro 或 arch 系统上使用 realvnc。如果设置不成功，也可以参考我的<a href=\"https://www.niuiic.top/2021/05/15/install-manjaro-on-rpi4/\">另一篇文章</a>使用 tigervnc 代替。</p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">yay -S aur&#x2F;realvnc-vnc-server-aarch64<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><p>注意，以下步骤是我在折腾时用到的，不一定全部有用，但设置完成后应该可以达到效果。</p>\n<ol>\n<li>设置<code>~/.vnc/config.d/vncserver-x11</code>文件，将<code>Authentication=SystemAuth</code>改为<code>Authentication=VncAuth</code>。如果原本没有，直接写上就行。</li>\n<li>使用<code>sudo vncpasswd -service</code>设置密码。</li>\n<li>设置开机启动 vnc。<br><code>sudo systemctl enable vncserver-x11-serviced.service sudo systemctl enable vncserver-virtuald.service</code></li>\n<li>安装一个驱动。<code>yay -S xf86-video-dummy</code></li>\n<li>修改<code>/etc/X11/xorg.conf.d/10-headless.conf</code>为以下内容。</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Section &quot;Monitor&quot;\n        Identifier &quot;dummy_monitor&quot;\n        HorizSync 28.0-80.0\n        VertRefresh 48.0-75.0\n        Modeline &quot;1920x1080&quot; 172.80 1920 2040 2248 2576 1080 1081 1084 1118\nEndSection\n\nSection &quot;Device&quot;\n        Identifier &quot;dummy_card&quot;\n        VideoRam 256000\n        Driver &quot;dummy&quot;\nEndSection\n\nSection &quot;Screen&quot;\n        Identifier &quot;dummy_screen&quot;\n        Device &quot;dummy_card&quot;\n        Monitor &quot;dummy_monitor&quot;\n        SubSection &quot;Display&quot;\n        EndSubSection\nEndSection<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"6\">\n<li>允许用户使用<code>system-xorg</code>。<code>vncinitconfig -enable-system-xorg</code>。输出提示该发行版不支持 system-xorg。不用管他，继续设置就行。</li>\n<li>这里是设置分辨率，是最关键的一步。熟悉 vnc 的应该知道如果 vncserver 不知道分辨率就不能显示。而通过<code>raspi-config</code>修改分辨率在这两个系统上是无效的。因此需要修改<code>/etc/X11/vncserver-virtual-dummy.conf</code>，写入<code>gtf 1920 1080 60</code>。</li>\n</ol>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"在安装-manjaro-系统的树莓派上使用-realvnc\"><a href=\"#在安装-manjaro-系统的树莓派上使用-realvnc\" class=\"headerlink\" title=\"在安装 manjaro 系统的树莓派上使用 realvnc\"></a>在安装 manjaro 系统的树莓派上使用 realvnc</h1><p>本文主要介绍如何在树莓派 4 上的 manjaro 或 arch 系统上使用 realvnc。如果设置不成功，也可以参考我的<a href=\"https://www.niuiic.top/2021/05/15/install-manjaro-on-rpi4/\">另一篇文章</a>使用 tigervnc 代替。</p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">yay -S aur&#x2F;realvnc-vnc-server-aarch64<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><p>注意，以下步骤是我在折腾时用到的，不一定全部有用，但设置完成后应该可以达到效果。</p>\n<ol>\n<li>设置<code>~/.vnc/config.d/vncserver-x11</code>文件，将<code>Authentication=SystemAuth</code>改为<code>Authentication=VncAuth</code>。如果原本没有，直接写上就行。</li>\n<li>使用<code>sudo vncpasswd -service</code>设置密码。</li>\n<li>设置开机启动 vnc。<br><code>sudo systemctl enable vncserver-x11-serviced.service sudo systemctl enable vncserver-virtuald.service</code></li>\n<li>安装一个驱动。<code>yay -S xf86-video-dummy</code></li>\n<li>修改<code>/etc/X11/xorg.conf.d/10-headless.conf</code>为以下内容。</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Section &quot;Monitor&quot;\n        Identifier &quot;dummy_monitor&quot;\n        HorizSync 28.0-80.0\n        VertRefresh 48.0-75.0\n        Modeline &quot;1920x1080&quot; 172.80 1920 2040 2248 2576 1080 1081 1084 1118\nEndSection\n\nSection &quot;Device&quot;\n        Identifier &quot;dummy_card&quot;\n        VideoRam 256000\n        Driver &quot;dummy&quot;\nEndSection\n\nSection &quot;Screen&quot;\n        Identifier &quot;dummy_screen&quot;\n        Device &quot;dummy_card&quot;\n        Monitor &quot;dummy_monitor&quot;\n        SubSection &quot;Display&quot;\n        EndSubSection\nEndSection<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ol start=\"6\">\n<li>允许用户使用<code>system-xorg</code>。<code>vncinitconfig -enable-system-xorg</code>。输出提示该发行版不支持 system-xorg。不用管他，继续设置就行。</li>\n<li>这里是设置分辨率，是最关键的一步。熟悉 vnc 的应该知道如果 vncserver 不知道分辨率就不能显示。而通过<code>raspi-config</code>修改分辨率在这两个系统上是无效的。因此需要修改<code>/etc/X11/vncserver-virtual-dummy.conf</code>，写入<code>gtf 1920 1080 60</code>。</li>\n</ol>\n"},{"title":"Use Vim as the Editor of Systemverilog","date":"2021-03-23T08:42:41.000Z","_content":"\n# 使用 vim 作为 systemverilog 编辑器\n\n本文介绍如何使用 vim 搭建 systemverilog 编辑环境。功能包括自动补全、语法高亮、语法检查、格式化等。\n\n注意本文内容只是针对 systemverilog 提供最基本编辑体验。关于 vim 的其他功能配置，请见[vim 专栏](https://www.niuiic.top/categories/Vim/)。\n\n## 语法高亮\n\n最新版的 neovim 应该默认支持 systemverilog 语法高亮。如果你的 vim 不行的话可以尝试通过安装`vhda/verilog_systemverilog.vim`插件解决。\n\n## 自动补全与语法检查\n\n自动补全功能使用 lsp。本文选用 svls 作为 systemverilog 的语言服务器。\n\nsvls 使用 rust 语言编写，需要 rust 语言环境，使用 rust 包管理器 cargo 安装。或者可以从 snap 商店下载。\n\n选择一款管理调用 lsp 的 vim 插件。本文选用 coc.nvim。在 coc.nvim 的配置文件中添加以下内容。\n\n```json\n\"languageserver\": {\n    \"svls\": {\n        \"command\": \"svls\",\n        \"filetypes\": [\"systemverilog\"]\n    }\n}\n```\n\n注意，`filetypes`不一定正确。可以新建一个.sv 文件，查看文件类型。比如，在 neovim5 的某一版本中，文件类型为`verilog_systemverilog`。\n\n选用其他插件的可以在[svls github 主页](https://github.com/dalance/svls)找到相应配置。\n\nsvls 的配置文件为`.svls.toml`，该文件放在项目的根目录。配置文件的编写方式非常简单。\n\n```toml\n[verilog]\ninclude_paths = [\"src/header\"]\n\n[option]\nlinter = true\n```\n\n将以上`include_paths`的值修改为要编写的.sv 文件所在目录即可。\n\n关于语法检查功能，可以同时使用 ale 插件。该插件可以通过 iverilog 编译器提供错误信息，两者错误信息并不完全重合。\n\n虽然在`svls`的演示视频中存在 snippets 的补全画面，但是经过试用发现这似乎是其他插件提供的。但是`vim-snippets`插件提供的 snippets 非常不全，因此下面介绍简单的自定义 snippets。\n\n首先，需要`coc-snippets`插件，该插件依赖`coc.nvim`。安装好`coc.nvim`之后，只需要使用`:CocInstall coc-snippets`命令即可安装。具体设置可以参考其[github 主页](https://github.com/neoclide/coc-snippets)。安装该插件后需要同步安装`honza/vim-snippets`来提供 snippets。`SirVer/ultisnips`需要拆卸掉，因为该插件会对自定义的 snippets 文件报错。\n\n接下来，使用`:CocConfig`打开`coc.nvim`配置文件，设置自定义 snippets 文件路径。如`\"snippets.userSnippetsDirectory\": \"/home/niuiic/.config/nvim/snippets\"`。（注意这是个 json 文件，最外层需要花括号）\n\n然后就可以在该目录下自定义 snippets 文件，文件名称保持和文件类型相同即可。snippets 语法还是比较复杂的，下面给出一个简单例子，足以实现基本功能。更高级的功能请自行学习。（coc.nvim 提供的自动补全筛选能力已经足够强大，即使是简单的设置也可以带来极佳的体验。更复杂的设置个人觉得没有必要。）\n\n`systemverilog.snippets`\n\n```\n# nomal always\nsnippet alw\n\talways @(${0}) begin\n\n\tend\n```\n\n`alw`是缩写，也就是当你打出 alw 时可以调用该 snippets。`${0}`的作用比较复杂，最简单也是对新手来说最实用的作用就是当你添加这一项后，补全 snippets 之后光标会自动停留在这个位置。\n\n如果再加一项，如下。\n\n```\n# nomal always\nsnippet alw\n\talways @(${1}) begin\n\t\t${0}\n\tend\n```\n\n此时光标会停留在`${1}`的位置。\n\n按照上述例子继续补充自己想要的 snippets 即可。注意标准写法中应当是用`endsnippet`的，不过这插件似乎不需要这个，而且加上这一句之后反而会出现在补全内容中，因此还是不加为好。\n\n除了 snippets，svls 能提供的自动补全功能感觉还是差点意思的。继续使用`coc.nvim`定义自动补全库。\n\n新建目录`～/.config/nvim/autoload/coc/source`。在该目录下新建文件`systemverilog.vim`，文件名原则同上。\n\n内容如下。\n\n```\nfunction! coc#source#systemverilog#init() abort\n    return {\n        \\'triggerCharacters': [''],\n        \\'filetypes' : ['systemverilog'],\n        \\}\nendfunction\n\nfunction! coc#source#systemverilog#complete(opt, cb) abort\n    let items = ['reg', 'wire', 'forever', 'posedge', 'negedge', 'module', 'endmodule', 'initial', 'input', 'output', 'parameter', 'assign', 'integer']\n    call a:cb(items)\nendfunction\n```\n\n在`items`中添加需要补全的关键词即可。注意这里的补全内容不能解析任何换行字符或转译字符，所以关键词放这里，语句放之前的 snippets。\n\n至此，完成自动补全与语法检查功能的配置。\n\n## 格式化\n\nsystemverilog 的格式化需要[verible](https://github.com/google/verible)的支持。verible 为 google 为 systemverilog 开发的一套工具集，其中包含了格式化工具。\n\nverible 提供了.deb 和.rpm 的二进制包，包管理系统兼容该两种打包方式的用户可以直接安装。\n\n其他用户需要自行编译，从 github 上拉取源码后，在源码目录使用`bazel build -c opt //...`编译。注意需要支持 C++11 的 gcc 编译器（clang 暂时无法编译成功）。\n\n编译完成后，使用`bazel run -c opt :install -- path`安装到指定位置。如果安装位置需要 root 权限，则使用`bazel run -c opt :install -- -s path`，务必注意不能使用 sudo。\n\n在 vim 中调用格式化工具的插件选用 neoformat。该插件的安装过程不再赘述。调用格式化程序的配置方式在其文档中有详细说明，这里只给出一个例子。\n\n环境：neovim、linux\n\n创建`~/.local/share/nvim/site/autoload/neoformat/formatters`目录。编写`systemverilog.vim`，写入以下内容\n\n```vim\nfunction! neoformat#formatters#systemverilog#enabled() abort\n    return ['verible_format']\nendfunction\n\nfunction! neoformat#formatters#systemverilog#verible_format() abort\n    return {\n        \\ 'exe': '/opt/verible/verilog_format',\n        \\ }\nendfunction\n```\n\n注意文件名称是 vim 中 systemverilog 的文件类型。如果不是`systemverilog`则需要替换文件名及文件中所有出现`systemverilog`的地方。`exe`需要可执行，即如果格式化程序所在目录不在`$PATH`中，需要填写其绝对路径。\n\n## 总结\n\n以上方案对比 vscode 以及各类 IDE，如 vivado 等，在编辑体验上可以算是完胜。\n\nvscode 中虽然有基于 svls 的插件，以及语言格式化插件，但整体补全能力上比不上高度扩展的 vim。并且仅仅依靠 svls 的错误检查，并不能找出所有错误（语法错误，而非逻辑错误），但 vim 可以再叠加其他的检测，如 ale。\n\n各类 IDE 虽然功能非常强大，甚至可能只需使用图形界面配置就能自动生成 systemverilog 文件，但是在编辑体验上远远比不上前两者。\n","source":"_posts/use-vim-as-the-editor-of-systemverilog.md","raw":"---\ntitle: Use Vim as the Editor of Systemverilog\ndate: 2021-03-23 16:42:41\ntags:\n  - Vim\ncategories:\n  - [Vim]\n  - [Embedded]\n---\n\n# 使用 vim 作为 systemverilog 编辑器\n\n本文介绍如何使用 vim 搭建 systemverilog 编辑环境。功能包括自动补全、语法高亮、语法检查、格式化等。\n\n注意本文内容只是针对 systemverilog 提供最基本编辑体验。关于 vim 的其他功能配置，请见[vim 专栏](https://www.niuiic.top/categories/Vim/)。\n\n## 语法高亮\n\n最新版的 neovim 应该默认支持 systemverilog 语法高亮。如果你的 vim 不行的话可以尝试通过安装`vhda/verilog_systemverilog.vim`插件解决。\n\n## 自动补全与语法检查\n\n自动补全功能使用 lsp。本文选用 svls 作为 systemverilog 的语言服务器。\n\nsvls 使用 rust 语言编写，需要 rust 语言环境，使用 rust 包管理器 cargo 安装。或者可以从 snap 商店下载。\n\n选择一款管理调用 lsp 的 vim 插件。本文选用 coc.nvim。在 coc.nvim 的配置文件中添加以下内容。\n\n```json\n\"languageserver\": {\n    \"svls\": {\n        \"command\": \"svls\",\n        \"filetypes\": [\"systemverilog\"]\n    }\n}\n```\n\n注意，`filetypes`不一定正确。可以新建一个.sv 文件，查看文件类型。比如，在 neovim5 的某一版本中，文件类型为`verilog_systemverilog`。\n\n选用其他插件的可以在[svls github 主页](https://github.com/dalance/svls)找到相应配置。\n\nsvls 的配置文件为`.svls.toml`，该文件放在项目的根目录。配置文件的编写方式非常简单。\n\n```toml\n[verilog]\ninclude_paths = [\"src/header\"]\n\n[option]\nlinter = true\n```\n\n将以上`include_paths`的值修改为要编写的.sv 文件所在目录即可。\n\n关于语法检查功能，可以同时使用 ale 插件。该插件可以通过 iverilog 编译器提供错误信息，两者错误信息并不完全重合。\n\n虽然在`svls`的演示视频中存在 snippets 的补全画面，但是经过试用发现这似乎是其他插件提供的。但是`vim-snippets`插件提供的 snippets 非常不全，因此下面介绍简单的自定义 snippets。\n\n首先，需要`coc-snippets`插件，该插件依赖`coc.nvim`。安装好`coc.nvim`之后，只需要使用`:CocInstall coc-snippets`命令即可安装。具体设置可以参考其[github 主页](https://github.com/neoclide/coc-snippets)。安装该插件后需要同步安装`honza/vim-snippets`来提供 snippets。`SirVer/ultisnips`需要拆卸掉，因为该插件会对自定义的 snippets 文件报错。\n\n接下来，使用`:CocConfig`打开`coc.nvim`配置文件，设置自定义 snippets 文件路径。如`\"snippets.userSnippetsDirectory\": \"/home/niuiic/.config/nvim/snippets\"`。（注意这是个 json 文件，最外层需要花括号）\n\n然后就可以在该目录下自定义 snippets 文件，文件名称保持和文件类型相同即可。snippets 语法还是比较复杂的，下面给出一个简单例子，足以实现基本功能。更高级的功能请自行学习。（coc.nvim 提供的自动补全筛选能力已经足够强大，即使是简单的设置也可以带来极佳的体验。更复杂的设置个人觉得没有必要。）\n\n`systemverilog.snippets`\n\n```\n# nomal always\nsnippet alw\n\talways @(${0}) begin\n\n\tend\n```\n\n`alw`是缩写，也就是当你打出 alw 时可以调用该 snippets。`${0}`的作用比较复杂，最简单也是对新手来说最实用的作用就是当你添加这一项后，补全 snippets 之后光标会自动停留在这个位置。\n\n如果再加一项，如下。\n\n```\n# nomal always\nsnippet alw\n\talways @(${1}) begin\n\t\t${0}\n\tend\n```\n\n此时光标会停留在`${1}`的位置。\n\n按照上述例子继续补充自己想要的 snippets 即可。注意标准写法中应当是用`endsnippet`的，不过这插件似乎不需要这个，而且加上这一句之后反而会出现在补全内容中，因此还是不加为好。\n\n除了 snippets，svls 能提供的自动补全功能感觉还是差点意思的。继续使用`coc.nvim`定义自动补全库。\n\n新建目录`～/.config/nvim/autoload/coc/source`。在该目录下新建文件`systemverilog.vim`，文件名原则同上。\n\n内容如下。\n\n```\nfunction! coc#source#systemverilog#init() abort\n    return {\n        \\'triggerCharacters': [''],\n        \\'filetypes' : ['systemverilog'],\n        \\}\nendfunction\n\nfunction! coc#source#systemverilog#complete(opt, cb) abort\n    let items = ['reg', 'wire', 'forever', 'posedge', 'negedge', 'module', 'endmodule', 'initial', 'input', 'output', 'parameter', 'assign', 'integer']\n    call a:cb(items)\nendfunction\n```\n\n在`items`中添加需要补全的关键词即可。注意这里的补全内容不能解析任何换行字符或转译字符，所以关键词放这里，语句放之前的 snippets。\n\n至此，完成自动补全与语法检查功能的配置。\n\n## 格式化\n\nsystemverilog 的格式化需要[verible](https://github.com/google/verible)的支持。verible 为 google 为 systemverilog 开发的一套工具集，其中包含了格式化工具。\n\nverible 提供了.deb 和.rpm 的二进制包，包管理系统兼容该两种打包方式的用户可以直接安装。\n\n其他用户需要自行编译，从 github 上拉取源码后，在源码目录使用`bazel build -c opt //...`编译。注意需要支持 C++11 的 gcc 编译器（clang 暂时无法编译成功）。\n\n编译完成后，使用`bazel run -c opt :install -- path`安装到指定位置。如果安装位置需要 root 权限，则使用`bazel run -c opt :install -- -s path`，务必注意不能使用 sudo。\n\n在 vim 中调用格式化工具的插件选用 neoformat。该插件的安装过程不再赘述。调用格式化程序的配置方式在其文档中有详细说明，这里只给出一个例子。\n\n环境：neovim、linux\n\n创建`~/.local/share/nvim/site/autoload/neoformat/formatters`目录。编写`systemverilog.vim`，写入以下内容\n\n```vim\nfunction! neoformat#formatters#systemverilog#enabled() abort\n    return ['verible_format']\nendfunction\n\nfunction! neoformat#formatters#systemverilog#verible_format() abort\n    return {\n        \\ 'exe': '/opt/verible/verilog_format',\n        \\ }\nendfunction\n```\n\n注意文件名称是 vim 中 systemverilog 的文件类型。如果不是`systemverilog`则需要替换文件名及文件中所有出现`systemverilog`的地方。`exe`需要可执行，即如果格式化程序所在目录不在`$PATH`中，需要填写其绝对路径。\n\n## 总结\n\n以上方案对比 vscode 以及各类 IDE，如 vivado 等，在编辑体验上可以算是完胜。\n\nvscode 中虽然有基于 svls 的插件，以及语言格式化插件，但整体补全能力上比不上高度扩展的 vim。并且仅仅依靠 svls 的错误检查，并不能找出所有错误（语法错误，而非逻辑错误），但 vim 可以再叠加其他的检测，如 ale。\n\n各类 IDE 虽然功能非常强大，甚至可能只需使用图形界面配置就能自动生成 systemverilog 文件，但是在编辑体验上远远比不上前两者。\n","slug":"use-vim-as-the-editor-of-systemverilog","published":1,"updated":"2021-06-05T14:47:57.235Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmsa0029rrizcniy7m3o","content":"<h1 id=\"使用-vim-作为-systemverilog-编辑器\"><a href=\"#使用-vim-作为-systemverilog-编辑器\" class=\"headerlink\" title=\"使用 vim 作为 systemverilog 编辑器\"></a>使用 vim 作为 systemverilog 编辑器</h1><p>本文介绍如何使用 vim 搭建 systemverilog 编辑环境。功能包括自动补全、语法高亮、语法检查、格式化等。</p>\n<p>注意本文内容只是针对 systemverilog 提供最基本编辑体验。关于 vim 的其他功能配置，请见<a href=\"https://www.niuiic.top/categories/Vim/\">vim 专栏</a>。</p>\n<h2 id=\"语法高亮\"><a href=\"#语法高亮\" class=\"headerlink\" title=\"语法高亮\"></a>语法高亮</h2><p>最新版的 neovim 应该默认支持 systemverilog 语法高亮。如果你的 vim 不行的话可以尝试通过安装<code>vhda/verilog_systemverilog.vim</code>插件解决。</p>\n<h2 id=\"自动补全与语法检查\"><a href=\"#自动补全与语法检查\" class=\"headerlink\" title=\"自动补全与语法检查\"></a>自动补全与语法检查</h2><p>自动补全功能使用 lsp。本文选用 svls 作为 systemverilog 的语言服务器。</p>\n<p>svls 使用 rust 语言编写，需要 rust 语言环境，使用 rust 包管理器 cargo 安装。或者可以从 snap 商店下载。</p>\n<p>选择一款管理调用 lsp 的 vim 插件。本文选用 coc.nvim。在 coc.nvim 的配置文件中添加以下内容。</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"languageserver\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"svls\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token property\">\"command\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"svls\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"filetypes\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"systemverilog\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意，<code>filetypes</code>不一定正确。可以新建一个.sv 文件，查看文件类型。比如，在 neovim5 的某一版本中，文件类型为<code>verilog_systemverilog</code>。</p>\n<p>选用其他插件的可以在<a href=\"https://github.com/dalance/svls\">svls github 主页</a>找到相应配置。</p>\n<p>svls 的配置文件为<code>.svls.toml</code>，该文件放在项目的根目录。配置文件的编写方式非常简单。</p>\n<pre class=\"line-numbers language-toml\" data-language=\"toml\"><code class=\"language-toml\"><span class=\"token punctuation\">[</span><span class=\"token table class-name\">verilog</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">include_paths</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"src/header\"</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">option</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">linter</span> <span class=\"token punctuation\">=</span> <span class=\"token boolean\">true</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>将以上<code>include_paths</code>的值修改为要编写的.sv 文件所在目录即可。</p>\n<p>关于语法检查功能，可以同时使用 ale 插件。该插件可以通过 iverilog 编译器提供错误信息，两者错误信息并不完全重合。</p>\n<p>虽然在<code>svls</code>的演示视频中存在 snippets 的补全画面，但是经过试用发现这似乎是其他插件提供的。但是<code>vim-snippets</code>插件提供的 snippets 非常不全，因此下面介绍简单的自定义 snippets。</p>\n<p>首先，需要<code>coc-snippets</code>插件，该插件依赖<code>coc.nvim</code>。安装好<code>coc.nvim</code>之后，只需要使用<code>:CocInstall coc-snippets</code>命令即可安装。具体设置可以参考其<a href=\"https://github.com/neoclide/coc-snippets\">github 主页</a>。安装该插件后需要同步安装<code>honza/vim-snippets</code>来提供 snippets。<code>SirVer/ultisnips</code>需要拆卸掉，因为该插件会对自定义的 snippets 文件报错。</p>\n<p>接下来，使用<code>:CocConfig</code>打开<code>coc.nvim</code>配置文件，设置自定义 snippets 文件路径。如<code>&quot;snippets.userSnippetsDirectory&quot;: &quot;/home/niuiic/.config/nvim/snippets&quot;</code>。（注意这是个 json 文件，最外层需要花括号）</p>\n<p>然后就可以在该目录下自定义 snippets 文件，文件名称保持和文件类型相同即可。snippets 语法还是比较复杂的，下面给出一个简单例子，足以实现基本功能。更高级的功能请自行学习。（coc.nvim 提供的自动补全筛选能力已经足够强大，即使是简单的设置也可以带来极佳的体验。更复杂的设置个人觉得没有必要。）</p>\n<p><code>systemverilog.snippets</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># nomal always\nsnippet alw\n\talways @($&#123;0&#125;) begin\n\n\tend<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>alw</code>是缩写，也就是当你打出 alw 时可以调用该 snippets。<code>$&#123;0&#125;</code>的作用比较复杂，最简单也是对新手来说最实用的作用就是当你添加这一项后，补全 snippets 之后光标会自动停留在这个位置。</p>\n<p>如果再加一项，如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># nomal always\nsnippet alw\n\talways @($&#123;1&#125;) begin\n\t\t$&#123;0&#125;\n\tend<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>此时光标会停留在<code>$&#123;1&#125;</code>的位置。</p>\n<p>按照上述例子继续补充自己想要的 snippets 即可。注意标准写法中应当是用<code>endsnippet</code>的，不过这插件似乎不需要这个，而且加上这一句之后反而会出现在补全内容中，因此还是不加为好。</p>\n<p>除了 snippets，svls 能提供的自动补全功能感觉还是差点意思的。继续使用<code>coc.nvim</code>定义自动补全库。</p>\n<p>新建目录<code>～/.config/nvim/autoload/coc/source</code>。在该目录下新建文件<code>systemverilog.vim</code>，文件名原则同上。</p>\n<p>内容如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">function! coc#source#systemverilog#init() abort\n    return &#123;\n        \\&#39;triggerCharacters&#39;: [&#39;&#39;],\n        \\&#39;filetypes&#39; : [&#39;systemverilog&#39;],\n        \\&#125;\nendfunction\n\nfunction! coc#source#systemverilog#complete(opt, cb) abort\n    let items &#x3D; [&#39;reg&#39;, &#39;wire&#39;, &#39;forever&#39;, &#39;posedge&#39;, &#39;negedge&#39;, &#39;module&#39;, &#39;endmodule&#39;, &#39;initial&#39;, &#39;input&#39;, &#39;output&#39;, &#39;parameter&#39;, &#39;assign&#39;, &#39;integer&#39;]\n    call a:cb(items)\nendfunction<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>在<code>items</code>中添加需要补全的关键词即可。注意这里的补全内容不能解析任何换行字符或转译字符，所以关键词放这里，语句放之前的 snippets。</p>\n<p>至此，完成自动补全与语法检查功能的配置。</p>\n<h2 id=\"格式化\"><a href=\"#格式化\" class=\"headerlink\" title=\"格式化\"></a>格式化</h2><p>systemverilog 的格式化需要<a href=\"https://github.com/google/verible\">verible</a>的支持。verible 为 google 为 systemverilog 开发的一套工具集，其中包含了格式化工具。</p>\n<p>verible 提供了.deb 和.rpm 的二进制包，包管理系统兼容该两种打包方式的用户可以直接安装。</p>\n<p>其他用户需要自行编译，从 github 上拉取源码后，在源码目录使用<code>bazel build -c opt //...</code>编译。注意需要支持 C++11 的 gcc 编译器（clang 暂时无法编译成功）。</p>\n<p>编译完成后，使用<code>bazel run -c opt :install -- path</code>安装到指定位置。如果安装位置需要 root 权限，则使用<code>bazel run -c opt :install -- -s path</code>，务必注意不能使用 sudo。</p>\n<p>在 vim 中调用格式化工具的插件选用 neoformat。该插件的安装过程不再赘述。调用格式化程序的配置方式在其文档中有详细说明，这里只给出一个例子。</p>\n<p>环境：neovim、linux</p>\n<p>创建<code>~/.local/share/nvim/site/autoload/neoformat/formatters</code>目录。编写<code>systemverilog.vim</code>，写入以下内容</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">function</span><span class=\"token operator\">!</span> neoformat#formatters#systemverilog#<span class=\"token function\">enabled</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> abort\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'verible_format'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> neoformat#formatters#systemverilog#<span class=\"token function\">verible_format</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> abort\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span>\n        \\ <span class=\"token string\">'exe'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/opt/verible/verilog_format'</span><span class=\"token punctuation\">,</span>\n        \\ <span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">endfunction</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意文件名称是 vim 中 systemverilog 的文件类型。如果不是<code>systemverilog</code>则需要替换文件名及文件中所有出现<code>systemverilog</code>的地方。<code>exe</code>需要可执行，即如果格式化程序所在目录不在<code>$PATH</code>中，需要填写其绝对路径。</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>以上方案对比 vscode 以及各类 IDE，如 vivado 等，在编辑体验上可以算是完胜。</p>\n<p>vscode 中虽然有基于 svls 的插件，以及语言格式化插件，但整体补全能力上比不上高度扩展的 vim。并且仅仅依靠 svls 的错误检查，并不能找出所有错误（语法错误，而非逻辑错误），但 vim 可以再叠加其他的检测，如 ale。</p>\n<p>各类 IDE 虽然功能非常强大，甚至可能只需使用图形界面配置就能自动生成 systemverilog 文件，但是在编辑体验上远远比不上前两者。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"使用-vim-作为-systemverilog-编辑器\"><a href=\"#使用-vim-作为-systemverilog-编辑器\" class=\"headerlink\" title=\"使用 vim 作为 systemverilog 编辑器\"></a>使用 vim 作为 systemverilog 编辑器</h1><p>本文介绍如何使用 vim 搭建 systemverilog 编辑环境。功能包括自动补全、语法高亮、语法检查、格式化等。</p>\n<p>注意本文内容只是针对 systemverilog 提供最基本编辑体验。关于 vim 的其他功能配置，请见<a href=\"https://www.niuiic.top/categories/Vim/\">vim 专栏</a>。</p>\n<h2 id=\"语法高亮\"><a href=\"#语法高亮\" class=\"headerlink\" title=\"语法高亮\"></a>语法高亮</h2><p>最新版的 neovim 应该默认支持 systemverilog 语法高亮。如果你的 vim 不行的话可以尝试通过安装<code>vhda/verilog_systemverilog.vim</code>插件解决。</p>\n<h2 id=\"自动补全与语法检查\"><a href=\"#自动补全与语法检查\" class=\"headerlink\" title=\"自动补全与语法检查\"></a>自动补全与语法检查</h2><p>自动补全功能使用 lsp。本文选用 svls 作为 systemverilog 的语言服务器。</p>\n<p>svls 使用 rust 语言编写，需要 rust 语言环境，使用 rust 包管理器 cargo 安装。或者可以从 snap 商店下载。</p>\n<p>选择一款管理调用 lsp 的 vim 插件。本文选用 coc.nvim。在 coc.nvim 的配置文件中添加以下内容。</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token property\">\"languageserver\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"svls\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token property\">\"command\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"svls\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"filetypes\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"systemverilog\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意，<code>filetypes</code>不一定正确。可以新建一个.sv 文件，查看文件类型。比如，在 neovim5 的某一版本中，文件类型为<code>verilog_systemverilog</code>。</p>\n<p>选用其他插件的可以在<a href=\"https://github.com/dalance/svls\">svls github 主页</a>找到相应配置。</p>\n<p>svls 的配置文件为<code>.svls.toml</code>，该文件放在项目的根目录。配置文件的编写方式非常简单。</p>\n<pre class=\"line-numbers language-toml\" data-language=\"toml\"><code class=\"language-toml\"><span class=\"token punctuation\">[</span><span class=\"token table class-name\">verilog</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">include_paths</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"src/header\"</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">option</span><span class=\"token punctuation\">]</span>\n<span class=\"token key property\">linter</span> <span class=\"token punctuation\">=</span> <span class=\"token boolean\">true</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>将以上<code>include_paths</code>的值修改为要编写的.sv 文件所在目录即可。</p>\n<p>关于语法检查功能，可以同时使用 ale 插件。该插件可以通过 iverilog 编译器提供错误信息，两者错误信息并不完全重合。</p>\n<p>虽然在<code>svls</code>的演示视频中存在 snippets 的补全画面，但是经过试用发现这似乎是其他插件提供的。但是<code>vim-snippets</code>插件提供的 snippets 非常不全，因此下面介绍简单的自定义 snippets。</p>\n<p>首先，需要<code>coc-snippets</code>插件，该插件依赖<code>coc.nvim</code>。安装好<code>coc.nvim</code>之后，只需要使用<code>:CocInstall coc-snippets</code>命令即可安装。具体设置可以参考其<a href=\"https://github.com/neoclide/coc-snippets\">github 主页</a>。安装该插件后需要同步安装<code>honza/vim-snippets</code>来提供 snippets。<code>SirVer/ultisnips</code>需要拆卸掉，因为该插件会对自定义的 snippets 文件报错。</p>\n<p>接下来，使用<code>:CocConfig</code>打开<code>coc.nvim</code>配置文件，设置自定义 snippets 文件路径。如<code>&quot;snippets.userSnippetsDirectory&quot;: &quot;/home/niuiic/.config/nvim/snippets&quot;</code>。（注意这是个 json 文件，最外层需要花括号）</p>\n<p>然后就可以在该目录下自定义 snippets 文件，文件名称保持和文件类型相同即可。snippets 语法还是比较复杂的，下面给出一个简单例子，足以实现基本功能。更高级的功能请自行学习。（coc.nvim 提供的自动补全筛选能力已经足够强大，即使是简单的设置也可以带来极佳的体验。更复杂的设置个人觉得没有必要。）</p>\n<p><code>systemverilog.snippets</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># nomal always\nsnippet alw\n\talways @($&#123;0&#125;) begin\n\n\tend<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>alw</code>是缩写，也就是当你打出 alw 时可以调用该 snippets。<code>$&#123;0&#125;</code>的作用比较复杂，最简单也是对新手来说最实用的作用就是当你添加这一项后，补全 snippets 之后光标会自动停留在这个位置。</p>\n<p>如果再加一项，如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"># nomal always\nsnippet alw\n\talways @($&#123;1&#125;) begin\n\t\t$&#123;0&#125;\n\tend<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>此时光标会停留在<code>$&#123;1&#125;</code>的位置。</p>\n<p>按照上述例子继续补充自己想要的 snippets 即可。注意标准写法中应当是用<code>endsnippet</code>的，不过这插件似乎不需要这个，而且加上这一句之后反而会出现在补全内容中，因此还是不加为好。</p>\n<p>除了 snippets，svls 能提供的自动补全功能感觉还是差点意思的。继续使用<code>coc.nvim</code>定义自动补全库。</p>\n<p>新建目录<code>～/.config/nvim/autoload/coc/source</code>。在该目录下新建文件<code>systemverilog.vim</code>，文件名原则同上。</p>\n<p>内容如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">function! coc#source#systemverilog#init() abort\n    return &#123;\n        \\&#39;triggerCharacters&#39;: [&#39;&#39;],\n        \\&#39;filetypes&#39; : [&#39;systemverilog&#39;],\n        \\&#125;\nendfunction\n\nfunction! coc#source#systemverilog#complete(opt, cb) abort\n    let items &#x3D; [&#39;reg&#39;, &#39;wire&#39;, &#39;forever&#39;, &#39;posedge&#39;, &#39;negedge&#39;, &#39;module&#39;, &#39;endmodule&#39;, &#39;initial&#39;, &#39;input&#39;, &#39;output&#39;, &#39;parameter&#39;, &#39;assign&#39;, &#39;integer&#39;]\n    call a:cb(items)\nendfunction<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>在<code>items</code>中添加需要补全的关键词即可。注意这里的补全内容不能解析任何换行字符或转译字符，所以关键词放这里，语句放之前的 snippets。</p>\n<p>至此，完成自动补全与语法检查功能的配置。</p>\n<h2 id=\"格式化\"><a href=\"#格式化\" class=\"headerlink\" title=\"格式化\"></a>格式化</h2><p>systemverilog 的格式化需要<a href=\"https://github.com/google/verible\">verible</a>的支持。verible 为 google 为 systemverilog 开发的一套工具集，其中包含了格式化工具。</p>\n<p>verible 提供了.deb 和.rpm 的二进制包，包管理系统兼容该两种打包方式的用户可以直接安装。</p>\n<p>其他用户需要自行编译，从 github 上拉取源码后，在源码目录使用<code>bazel build -c opt //...</code>编译。注意需要支持 C++11 的 gcc 编译器（clang 暂时无法编译成功）。</p>\n<p>编译完成后，使用<code>bazel run -c opt :install -- path</code>安装到指定位置。如果安装位置需要 root 权限，则使用<code>bazel run -c opt :install -- -s path</code>，务必注意不能使用 sudo。</p>\n<p>在 vim 中调用格式化工具的插件选用 neoformat。该插件的安装过程不再赘述。调用格式化程序的配置方式在其文档中有详细说明，这里只给出一个例子。</p>\n<p>环境：neovim、linux</p>\n<p>创建<code>~/.local/share/nvim/site/autoload/neoformat/formatters</code>目录。编写<code>systemverilog.vim</code>，写入以下内容</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">function</span><span class=\"token operator\">!</span> neoformat#formatters#systemverilog#<span class=\"token function\">enabled</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> abort\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'verible_format'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> neoformat#formatters#systemverilog#<span class=\"token function\">verible_format</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> abort\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span>\n        \\ <span class=\"token string\">'exe'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'/opt/verible/verilog_format'</span><span class=\"token punctuation\">,</span>\n        \\ <span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">endfunction</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意文件名称是 vim 中 systemverilog 的文件类型。如果不是<code>systemverilog</code>则需要替换文件名及文件中所有出现<code>systemverilog</code>的地方。<code>exe</code>需要可执行，即如果格式化程序所在目录不在<code>$PATH</code>中，需要填写其绝对路径。</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>以上方案对比 vscode 以及各类 IDE，如 vivado 等，在编辑体验上可以算是完胜。</p>\n<p>vscode 中虽然有基于 svls 的插件，以及语言格式化插件，但整体补全能力上比不上高度扩展的 vim。并且仅仅依靠 svls 的错误检查，并不能找出所有错误（语法错误，而非逻辑错误），但 vim 可以再叠加其他的检测，如 ale。</p>\n<p>各类 IDE 虽然功能非常强大，甚至可能只需使用图形界面配置就能自动生成 systemverilog 文件，但是在编辑体验上远远比不上前两者。</p>\n"},{"title":"Vim Automatic Completion","date":"2020-10-19T02:43:22.000Z","_content":"\n本文介绍 vim 自动补全方案。主要采用更强大的 coc.nvim 插件来替代 YCM。\n\n# vim 自动补全\n\n## 前言\n\n自动补全对于任何一个试图取代 IDE 的编辑器的重要性不言而喻。想要将 vim 打造为最契合自己的 IDE，无论如何都不能少了强大的自动补全功能。\n\n## coc.nvim 介绍\n\ncoc.nvim 是针对 neovim 开发的的功能非常强大，完全可以替代 YCM，带来更加优越的补全体验。包括语义补全、片段补全、定义跳转、文档查阅、静态检查等等。\n\n同时 coc.nvim 也是一个全新的插件平台，除了其原生插件外，理论上也支持所有纯 JS 实现的 vscode 插件。拥有 coc.nvim，就拥有了一个异步插件平台。\n\n## coc.nvim 安装\n\ncoc.nvim 需要`nodejs`支持。安装`nodejs`后，用插件管理器安装 coc.nvim 即可。具体可参考其[github 主页](https://github.com/neoclide/coc.nvim)。\n\n## 使用 coc.nvim 进行补全\n\ncoc.nvim 的补全可以采用安装插件或者配置 lsp 实现。\n\n### 语义补全及静态检查\n\n以 rust 语言为例，可以直接使用`:CocInstall`安装`coc-rust-analyzer`插件（会自动安装`rust-analyzer`）。也可以在安装`rust-analyzer`后在 coc.nvim 的配置文件中配置。使用`:CocConfig`打开配置文件，写入\n\n```json\n{\n  \"languageserver\": {\n    \"rust\": {\n      \"command\": \"rust-analyzer\",\n      \"filetypes\": [\"rust\"],\n      \"rootPatterns\": [\"Cargo.toml\"]\n    }\n  }\n}\n```\n\n注意`command`必须保证可用。\n\n关于 coc 插件以及 lsp 配置的具体内容可以参考[coc.nvim wiki](https://github.com/neoclide/coc.nvim/wiki)。\n\n到此，rust 语言的自动补全已经配置完成，静态检查也同步配置完成。但仅仅如此还不可以使用。coc.nvim 的自动配置在项目工程中才能起作用。如单独编写一个`main.rs`，则不会有语义提示。必须以`cargo new demo`新建一个工程，插件检测到`Cargo.toml`后才会启动语义的自动补全。当然也有可以直接在单文件中提示的特例，如 markdown 语言，本身就不存在工程的概念。\n\n### 片段补全\n\n安装`coc-actions`插件。\n\n再在`coc-snippets`、`coc-ultisnips`中选择一个或全选即可。注意需要同步安装`honza/vim-snippets`、`SirVer/ultisnips`。\n\n### 自定义补全源\n\ncoc.nvim 默认的补全源来自当前打开的所有 buffer、插件或 lsp 等。此外也可以自定义补全源。具体可参见[coc.nvim wiki](https://github.com/neoclide/coc.nvim/wiki/Create-custom-source)\n\n下面以补全 markdown 中的 latex 语法为例，展示如何自定义补全源。\n\n创建目录`~/.config/nvim/autoload/coc/source`。这里以 linux 系统为例，其他系统的位置可以自行参考 wiki。\n\n创建`latex.vim`，写入\n\n```vim\nfunction! coc#source#latex#init() abort\n\treturn {\n\t\t\t\t\\'triggerCharacters': ['\\'],\n\t\t\t\t\\'filetypes' : ['markdown'],\n\t\t\t\t\\}\nendfunction\n\nfunction! coc#source#latex#complete(opt, cb) abort\n\tlet items = ['kappa', 'theta', 'dot{}', 'ddot{}', 'bar{}', 'hat{}', 'exp', 'sin', 'cos', 'tan', 'sec', 'csc', 'vec{}', 'cot', 'arcsin', 'arccos', 'arctan', 'sinh', 'cosh', 'tanh', 'coth', 'sh', 'ch', 'th', 'max', 'min', 'partial', 'nabla', 'prime', 'backprime', 'infty', 'eth', 'hbar', 'sqrt{}', 'sqrt[]{}', 'pm', 'mp', 'times', 'div', 'cdot', 'odot', 'bigodot' , '{ \\}', 'in', 'not', 'ni', 'cap', 'Cap', 'bigcap', 'cup', 'Cup', 'bigcup', 'subset', 'supset', 'supseteq', 'subseteq', 'subseteqq', 'supseteqq', 'subsetneq', 'supsetneq', 'supsetneqq', 'subsetneqq', 'sim', 'approx', 'leq', 'geq', 'parallel', 'nparallel', 'perp', 'angle', 'Box', 'bigtriangleup', 'bigtriangledown', 'forall', 'therefore', 'because', 'overline{}', 'Rightarrow', 'Leftarrow', 'rightarrow', 'leftarrow', 'leftrightarrow', 'nRightarrow', 'nLeftarrow', 'nleftarrow', 'nrightarrow', 'nleftrightarrow', 'overleftarrow{}', 'overrightarrow{}', 'overset{}', 'underline{}', 'sum', 'prod', 'lim', 'limits', 'int', 'iint', 'oint', 'iiint', 'frac{}{}', 'tfrac{}{}', 'dfrac{}{}', '\\begin{matrix}\\end{matrix}', '\\begin{vmatrix}\\end{vmatrix}', '\\begin{bmatrix}\\end{bmatrix}', '\\begin{Bmatrix}\\end{Bmatrix}', '\\begin{pmatrix}\\end{pmatrix}','\\begin{cases}\\end{cases}', '\\begin{aligned}\\end{aligned}', '\\begin{array}\\end{array}', 'alpha', 'psi', 'Delta', 'delta', 'beta', 'lambda', 'rho', 'varepsilon', 'Gamma', 'chi', 'mu', 'sigma', 'Lambda', 'tau', 'varphi', 'varPhi', 'phi', 'Phi', 'eta', 'omega', 'varrho', 'Pi', 'pi', 'gamma', 'xi', 'Psi', 'Sigma', 'varnothing', 'iiiint']\n\tcall a:cb(items)\nendfunction\n```\n\n简单分析一下。配置的主体框架按照 wiki 给出的例子照猫画虎即可。其中`triggerCharacters`表示触发字符，意思就是说当输入该字符时启动补全。`filetypes`表示该补全源作用的文件类型。更多选项参见 wiki。\n\n## 修复定义跳转卡住的问题\n\n使用 coc.nvim 的定义跳转到其他文件时，可能会直接卡死。原因不明，可能是文件太大加载不过来，但也存在小文件被卡住的问题。\n\n修复方案是重启语法分析。\n\n```vim\n\" 关闭\n:syn off\n\" 开启\n:syn enable\n```\n\n可以设置进入Vim时自动执行该命令，设置如下。\n\n```vim\nau VimEnter * :syn off<CR>\nau VimEnter * :syn enable<CR>\n```\n\n## 其他功能\n\ncoc.nvim 提供的其他功能还有很多，包括定义跳转、文档查询等等。感兴趣的可以自行研究。以下附上我的 coc.nvim 配置。仅供参考。其中`vim-which-key`的部分如果没有安装该插件就不必配置。\n\n```vim\n\" coc.nvim\ninoremap <expr> <C-j> pumvisible() ? \"\\<C-n>\" : \"\\<C-j>\"\ninoremap <expr> <C-k> pumvisible() ? \"\\<C-p>\" : \"\\<C-k>\"\ninoremap <expr> <cr> pumvisible() ? \"\\<C-y>\" : \"\\<C-g>u\\<CR>\"\ninoremap <silent><expr> <cr> pumvisible() ? coc#_select_confirm() : \"\\<C-g>u\\<CR>\"\ninoremap <silent><expr> <cr> pumvisible() ? coc#_select_confirm() : \"\\<C-g>u\\<CR>\\<c-r>=coc#on_enter()\\<CR>\"\nautocmd! CompleteDone * if pumvisible() == 0 | pclose | endif\n\n\" Some servers have issues with backup files, see #649.\nset nobackup\nset nowritebackup\n\n\" Give more space for displaying messages.\nset cmdheight=2\n\n\" Having longer updatetime (default is 4000 ms = 4 s) leads to noticeable\n\" delays and poor user experience.\nset updatetime=300\n\n\" Don't pass messages to |ins-completion-menu|.\nset shortmess+=c\n\n\" Always show the signcolumn, otherwise it would shift the text each time\n\" diagnostics appear/become resolved.\nif has(\"patch-8.1.1564\")\n\t\" Recently vim can merge signcolumn and number column into one\n\tset signcolumn=number\nelse\n\tset signcolumn=yes\nendif\n\n\" Use tab for trigger completion with characters ahead and navigate.\n\" NOTE: Use command ':verbose imap <tab>' to make sure tab is not mapped by\n\" other plugin before putting this into your config.\ninoremap <silent><expr> <TAB>\n\t\t\t\\ pumvisible() ? \"\\<C-n>\" :\n\t\t\t\\ <SID>check_back_space() ? \"\\<TAB>\" :\n\t\t\t\\ coc#refresh()\ninoremap <expr><S-TAB> pumvisible() ? \"\\<C-p>\" : \"\\<C-h>\"\n\nfunction! s:check_back_space() abort\n\tlet col = col('.') - 1\n\treturn !col || getline('.')[col - 1]  =~# '\\s'\nendfunction\n\n\" Use <c-space> to trigger completion.\nif has('nvim')\n\tinoremap <silent><expr> <c-space> coc#refresh()\nelse\n\tinoremap <silent><expr> <c-@> coc#refresh()\nendif\n\n\" Use <cr> to confirm completion, `<C-g>u` means break undo chain at current\n\" position. Coc only does snippet and additional edit on confirm.\n\" <cr> could be remapped by other vim plugin, try `:verbose imap <CR>`.\nif exists('*complete_info')\n\tinoremap <expr> <cr> complete_info()[\"selected\"] != \"-1\" ? \"\\<C-y>\" : \"\\<C-g>u\\<CR>\"\nelse\n\tinoremap <expr> <cr> pumvisible() ? \"\\<C-y>\" : \"\\<C-g>u\\<CR>\"\nendif\n\n\" GoTo code navigation.\nnmap <silent><nowait> <space>gy <Plug>(coc-type-definition)\nnmap <silent><nowait> <space>gi <Plug>(coc-implementation)\nnmap <silent><nowait> <space>gr <Plug>(coc-references)\nnmap <silent><nowait> <space>gd <Plug>(coc-definition)\n\nlet g:which_key_map1.g = {\n\t\t\t\\ 'name': '+coc.goto',\n\t\t\t\\ 'y' : 'go to type definition',\n\t\t\t\\ 'i' : 'go to implementation',\n\t\t\t\\ 'r' : 'go to references',\n\t\t\t\\ 'd' : 'go to definition',\n\t\t\t\\ }\n\n\" Use K to show documentation in preview window.\nnnoremap <silent> K :call <SID>show_documentation()<CR>\n\nfunction! s:show_documentation()\n\tif (index(['vim','help'], &filetype) >= 0)\n\t\texecute 'h '.expand('<cword>')\n\telse\n\t\tcall CocActionAsync('doHover')\n\tendif\nendfunction\n\n\" Highlight the symbol and its references when holding the cursor.\nautocmd CursorHold * silent call CocActionAsync('highlight')\n\n\" Symbol renaming.\nnmap <silent><nowait> <space>cr <Plug>(coc-rename)\n\n\" Formatting selected code.\nnmap <silent><nowait> <space>cm <Plug>(coc-format-selected)\nxmap <silent><nowait> <space>cm <Plug>(coc-format-selected)\n\nlet g:which_key_map1.c = {\n\t\t\t\\ 'name' : '+coc',\n\t\t\t\\ 'f' : 'automatically fix errors in current line',\n\t\t\t\\ 'm' : 'format selected code',\n\t\t\t\\ 'r' : 'rename symbol',\n\t\t\t\\ }\n\naugroup mygroup\n\tautocmd!\n\t\" Setup formatexpr specified filetype(s).\n\tautocmd FileType typescript,json setl formatexpr=CocAction('formatSelected')\n\t\" Update signature help on jump placeholder.\n\tautocmd User CocJumpPlaceholder call CocActionAsync('showSignatureHelp')\naugroup end\n\n\" Apply AutoFix to problem on the current line.\nnmap <silent><nowait> <space>cf <Plug>(coc-fix-current)\n\n\" Add `:Format` command to format current buffer.\ncommand! -nargs=0 Format :call CocAction('format')\n\n\" Add `:Fold` command to fold current buffer.\ncommand! -nargs=? Fold :call     CocAction('fold', <f-args>)\n\n\" Add `:OR` command for organize imports of the current buffer.\ncommand! -nargs=0 OR   :call     CocAction('runCommand', 'editor.action.organizeImport')\n\n\" Add (Neo)Vim's native statusline support.\n\" NOTE: Please see `:h coc-status` for integrations with external plugins that\n\" provide custom statusline: lightline.vim, vim-airline.\nset statusline^=%{coc#status()}%{get(b:,'coc_current_function','')}\n\n\" Mappings for CoCList\n\" open CocList\nnnoremap <silent><nowait> <leader>ct  :<C-u>CocList<cr>\n\" Show all diagnostics.\nnnoremap <silent><nowait> <leader>ca  :<C-u>CocList diagnostics<cr>\n\" Manage extensions.\nnnoremap <silent><nowait> <leader>ce  :<C-u>CocList extensions<cr>\n\" Show commands.\nnnoremap <silent><nowait> <leader>cc  :<C-u>CocList commands<cr>\n\" Find symbol of current document.\nnnoremap <silent><nowait> <leader>co  :<C-u>CocList outline<cr>\n\" Search workspace symbols.\nnnoremap <silent><nowait> <leader>cs  :<C-u>CocList -I symbols<cr>\n\" Do default action for next item.\nnnoremap <silent><nowait> <leader>cj  :<C-u>CocNext<CR>\n\" Do default action for previous item.\nnnoremap <silent><nowait> <leader>cz  :<C-u>CocPrev<CR>\n\" Resume latest coc list.\nnnoremap <silent><nowait> <leader>cp  :<C-u>CocListResume<CR>\n\nlet g:which_key_map2.c = {\n\t\t\t\\ 'name' : '+coc',\n\t\t\t\\ 't' : 'open coc list',\n\t\t\t\\ 'a' : 'show all diagnostics',\n\t\t\t\\ 'e' : 'manage extensions',\n\t\t\t\\ 'c' : 'show commands',\n\t\t\t\\ 'o' : 'find symbol of current document',\n\t\t\t\\ 's' : 'search workspace symbols',\n\t\t\t\\ 'j' : 'do default action for next item',\n\t\t\t\\ 'z' : 'do default action for previous item',\n\t\t\t\\ 'p' : 'resume latest coc list',\n\t\t\t\\ }\n```\n","source":"_posts/vim-automatic-completion.md","raw":"---\ntitle: Vim Automatic Completion\ndate: 2020-10-19 10:43:22\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n本文介绍 vim 自动补全方案。主要采用更强大的 coc.nvim 插件来替代 YCM。\n\n# vim 自动补全\n\n## 前言\n\n自动补全对于任何一个试图取代 IDE 的编辑器的重要性不言而喻。想要将 vim 打造为最契合自己的 IDE，无论如何都不能少了强大的自动补全功能。\n\n## coc.nvim 介绍\n\ncoc.nvim 是针对 neovim 开发的的功能非常强大，完全可以替代 YCM，带来更加优越的补全体验。包括语义补全、片段补全、定义跳转、文档查阅、静态检查等等。\n\n同时 coc.nvim 也是一个全新的插件平台，除了其原生插件外，理论上也支持所有纯 JS 实现的 vscode 插件。拥有 coc.nvim，就拥有了一个异步插件平台。\n\n## coc.nvim 安装\n\ncoc.nvim 需要`nodejs`支持。安装`nodejs`后，用插件管理器安装 coc.nvim 即可。具体可参考其[github 主页](https://github.com/neoclide/coc.nvim)。\n\n## 使用 coc.nvim 进行补全\n\ncoc.nvim 的补全可以采用安装插件或者配置 lsp 实现。\n\n### 语义补全及静态检查\n\n以 rust 语言为例，可以直接使用`:CocInstall`安装`coc-rust-analyzer`插件（会自动安装`rust-analyzer`）。也可以在安装`rust-analyzer`后在 coc.nvim 的配置文件中配置。使用`:CocConfig`打开配置文件，写入\n\n```json\n{\n  \"languageserver\": {\n    \"rust\": {\n      \"command\": \"rust-analyzer\",\n      \"filetypes\": [\"rust\"],\n      \"rootPatterns\": [\"Cargo.toml\"]\n    }\n  }\n}\n```\n\n注意`command`必须保证可用。\n\n关于 coc 插件以及 lsp 配置的具体内容可以参考[coc.nvim wiki](https://github.com/neoclide/coc.nvim/wiki)。\n\n到此，rust 语言的自动补全已经配置完成，静态检查也同步配置完成。但仅仅如此还不可以使用。coc.nvim 的自动配置在项目工程中才能起作用。如单独编写一个`main.rs`，则不会有语义提示。必须以`cargo new demo`新建一个工程，插件检测到`Cargo.toml`后才会启动语义的自动补全。当然也有可以直接在单文件中提示的特例，如 markdown 语言，本身就不存在工程的概念。\n\n### 片段补全\n\n安装`coc-actions`插件。\n\n再在`coc-snippets`、`coc-ultisnips`中选择一个或全选即可。注意需要同步安装`honza/vim-snippets`、`SirVer/ultisnips`。\n\n### 自定义补全源\n\ncoc.nvim 默认的补全源来自当前打开的所有 buffer、插件或 lsp 等。此外也可以自定义补全源。具体可参见[coc.nvim wiki](https://github.com/neoclide/coc.nvim/wiki/Create-custom-source)\n\n下面以补全 markdown 中的 latex 语法为例，展示如何自定义补全源。\n\n创建目录`~/.config/nvim/autoload/coc/source`。这里以 linux 系统为例，其他系统的位置可以自行参考 wiki。\n\n创建`latex.vim`，写入\n\n```vim\nfunction! coc#source#latex#init() abort\n\treturn {\n\t\t\t\t\\'triggerCharacters': ['\\'],\n\t\t\t\t\\'filetypes' : ['markdown'],\n\t\t\t\t\\}\nendfunction\n\nfunction! coc#source#latex#complete(opt, cb) abort\n\tlet items = ['kappa', 'theta', 'dot{}', 'ddot{}', 'bar{}', 'hat{}', 'exp', 'sin', 'cos', 'tan', 'sec', 'csc', 'vec{}', 'cot', 'arcsin', 'arccos', 'arctan', 'sinh', 'cosh', 'tanh', 'coth', 'sh', 'ch', 'th', 'max', 'min', 'partial', 'nabla', 'prime', 'backprime', 'infty', 'eth', 'hbar', 'sqrt{}', 'sqrt[]{}', 'pm', 'mp', 'times', 'div', 'cdot', 'odot', 'bigodot' , '{ \\}', 'in', 'not', 'ni', 'cap', 'Cap', 'bigcap', 'cup', 'Cup', 'bigcup', 'subset', 'supset', 'supseteq', 'subseteq', 'subseteqq', 'supseteqq', 'subsetneq', 'supsetneq', 'supsetneqq', 'subsetneqq', 'sim', 'approx', 'leq', 'geq', 'parallel', 'nparallel', 'perp', 'angle', 'Box', 'bigtriangleup', 'bigtriangledown', 'forall', 'therefore', 'because', 'overline{}', 'Rightarrow', 'Leftarrow', 'rightarrow', 'leftarrow', 'leftrightarrow', 'nRightarrow', 'nLeftarrow', 'nleftarrow', 'nrightarrow', 'nleftrightarrow', 'overleftarrow{}', 'overrightarrow{}', 'overset{}', 'underline{}', 'sum', 'prod', 'lim', 'limits', 'int', 'iint', 'oint', 'iiint', 'frac{}{}', 'tfrac{}{}', 'dfrac{}{}', '\\begin{matrix}\\end{matrix}', '\\begin{vmatrix}\\end{vmatrix}', '\\begin{bmatrix}\\end{bmatrix}', '\\begin{Bmatrix}\\end{Bmatrix}', '\\begin{pmatrix}\\end{pmatrix}','\\begin{cases}\\end{cases}', '\\begin{aligned}\\end{aligned}', '\\begin{array}\\end{array}', 'alpha', 'psi', 'Delta', 'delta', 'beta', 'lambda', 'rho', 'varepsilon', 'Gamma', 'chi', 'mu', 'sigma', 'Lambda', 'tau', 'varphi', 'varPhi', 'phi', 'Phi', 'eta', 'omega', 'varrho', 'Pi', 'pi', 'gamma', 'xi', 'Psi', 'Sigma', 'varnothing', 'iiiint']\n\tcall a:cb(items)\nendfunction\n```\n\n简单分析一下。配置的主体框架按照 wiki 给出的例子照猫画虎即可。其中`triggerCharacters`表示触发字符，意思就是说当输入该字符时启动补全。`filetypes`表示该补全源作用的文件类型。更多选项参见 wiki。\n\n## 修复定义跳转卡住的问题\n\n使用 coc.nvim 的定义跳转到其他文件时，可能会直接卡死。原因不明，可能是文件太大加载不过来，但也存在小文件被卡住的问题。\n\n修复方案是重启语法分析。\n\n```vim\n\" 关闭\n:syn off\n\" 开启\n:syn enable\n```\n\n可以设置进入Vim时自动执行该命令，设置如下。\n\n```vim\nau VimEnter * :syn off<CR>\nau VimEnter * :syn enable<CR>\n```\n\n## 其他功能\n\ncoc.nvim 提供的其他功能还有很多，包括定义跳转、文档查询等等。感兴趣的可以自行研究。以下附上我的 coc.nvim 配置。仅供参考。其中`vim-which-key`的部分如果没有安装该插件就不必配置。\n\n```vim\n\" coc.nvim\ninoremap <expr> <C-j> pumvisible() ? \"\\<C-n>\" : \"\\<C-j>\"\ninoremap <expr> <C-k> pumvisible() ? \"\\<C-p>\" : \"\\<C-k>\"\ninoremap <expr> <cr> pumvisible() ? \"\\<C-y>\" : \"\\<C-g>u\\<CR>\"\ninoremap <silent><expr> <cr> pumvisible() ? coc#_select_confirm() : \"\\<C-g>u\\<CR>\"\ninoremap <silent><expr> <cr> pumvisible() ? coc#_select_confirm() : \"\\<C-g>u\\<CR>\\<c-r>=coc#on_enter()\\<CR>\"\nautocmd! CompleteDone * if pumvisible() == 0 | pclose | endif\n\n\" Some servers have issues with backup files, see #649.\nset nobackup\nset nowritebackup\n\n\" Give more space for displaying messages.\nset cmdheight=2\n\n\" Having longer updatetime (default is 4000 ms = 4 s) leads to noticeable\n\" delays and poor user experience.\nset updatetime=300\n\n\" Don't pass messages to |ins-completion-menu|.\nset shortmess+=c\n\n\" Always show the signcolumn, otherwise it would shift the text each time\n\" diagnostics appear/become resolved.\nif has(\"patch-8.1.1564\")\n\t\" Recently vim can merge signcolumn and number column into one\n\tset signcolumn=number\nelse\n\tset signcolumn=yes\nendif\n\n\" Use tab for trigger completion with characters ahead and navigate.\n\" NOTE: Use command ':verbose imap <tab>' to make sure tab is not mapped by\n\" other plugin before putting this into your config.\ninoremap <silent><expr> <TAB>\n\t\t\t\\ pumvisible() ? \"\\<C-n>\" :\n\t\t\t\\ <SID>check_back_space() ? \"\\<TAB>\" :\n\t\t\t\\ coc#refresh()\ninoremap <expr><S-TAB> pumvisible() ? \"\\<C-p>\" : \"\\<C-h>\"\n\nfunction! s:check_back_space() abort\n\tlet col = col('.') - 1\n\treturn !col || getline('.')[col - 1]  =~# '\\s'\nendfunction\n\n\" Use <c-space> to trigger completion.\nif has('nvim')\n\tinoremap <silent><expr> <c-space> coc#refresh()\nelse\n\tinoremap <silent><expr> <c-@> coc#refresh()\nendif\n\n\" Use <cr> to confirm completion, `<C-g>u` means break undo chain at current\n\" position. Coc only does snippet and additional edit on confirm.\n\" <cr> could be remapped by other vim plugin, try `:verbose imap <CR>`.\nif exists('*complete_info')\n\tinoremap <expr> <cr> complete_info()[\"selected\"] != \"-1\" ? \"\\<C-y>\" : \"\\<C-g>u\\<CR>\"\nelse\n\tinoremap <expr> <cr> pumvisible() ? \"\\<C-y>\" : \"\\<C-g>u\\<CR>\"\nendif\n\n\" GoTo code navigation.\nnmap <silent><nowait> <space>gy <Plug>(coc-type-definition)\nnmap <silent><nowait> <space>gi <Plug>(coc-implementation)\nnmap <silent><nowait> <space>gr <Plug>(coc-references)\nnmap <silent><nowait> <space>gd <Plug>(coc-definition)\n\nlet g:which_key_map1.g = {\n\t\t\t\\ 'name': '+coc.goto',\n\t\t\t\\ 'y' : 'go to type definition',\n\t\t\t\\ 'i' : 'go to implementation',\n\t\t\t\\ 'r' : 'go to references',\n\t\t\t\\ 'd' : 'go to definition',\n\t\t\t\\ }\n\n\" Use K to show documentation in preview window.\nnnoremap <silent> K :call <SID>show_documentation()<CR>\n\nfunction! s:show_documentation()\n\tif (index(['vim','help'], &filetype) >= 0)\n\t\texecute 'h '.expand('<cword>')\n\telse\n\t\tcall CocActionAsync('doHover')\n\tendif\nendfunction\n\n\" Highlight the symbol and its references when holding the cursor.\nautocmd CursorHold * silent call CocActionAsync('highlight')\n\n\" Symbol renaming.\nnmap <silent><nowait> <space>cr <Plug>(coc-rename)\n\n\" Formatting selected code.\nnmap <silent><nowait> <space>cm <Plug>(coc-format-selected)\nxmap <silent><nowait> <space>cm <Plug>(coc-format-selected)\n\nlet g:which_key_map1.c = {\n\t\t\t\\ 'name' : '+coc',\n\t\t\t\\ 'f' : 'automatically fix errors in current line',\n\t\t\t\\ 'm' : 'format selected code',\n\t\t\t\\ 'r' : 'rename symbol',\n\t\t\t\\ }\n\naugroup mygroup\n\tautocmd!\n\t\" Setup formatexpr specified filetype(s).\n\tautocmd FileType typescript,json setl formatexpr=CocAction('formatSelected')\n\t\" Update signature help on jump placeholder.\n\tautocmd User CocJumpPlaceholder call CocActionAsync('showSignatureHelp')\naugroup end\n\n\" Apply AutoFix to problem on the current line.\nnmap <silent><nowait> <space>cf <Plug>(coc-fix-current)\n\n\" Add `:Format` command to format current buffer.\ncommand! -nargs=0 Format :call CocAction('format')\n\n\" Add `:Fold` command to fold current buffer.\ncommand! -nargs=? Fold :call     CocAction('fold', <f-args>)\n\n\" Add `:OR` command for organize imports of the current buffer.\ncommand! -nargs=0 OR   :call     CocAction('runCommand', 'editor.action.organizeImport')\n\n\" Add (Neo)Vim's native statusline support.\n\" NOTE: Please see `:h coc-status` for integrations with external plugins that\n\" provide custom statusline: lightline.vim, vim-airline.\nset statusline^=%{coc#status()}%{get(b:,'coc_current_function','')}\n\n\" Mappings for CoCList\n\" open CocList\nnnoremap <silent><nowait> <leader>ct  :<C-u>CocList<cr>\n\" Show all diagnostics.\nnnoremap <silent><nowait> <leader>ca  :<C-u>CocList diagnostics<cr>\n\" Manage extensions.\nnnoremap <silent><nowait> <leader>ce  :<C-u>CocList extensions<cr>\n\" Show commands.\nnnoremap <silent><nowait> <leader>cc  :<C-u>CocList commands<cr>\n\" Find symbol of current document.\nnnoremap <silent><nowait> <leader>co  :<C-u>CocList outline<cr>\n\" Search workspace symbols.\nnnoremap <silent><nowait> <leader>cs  :<C-u>CocList -I symbols<cr>\n\" Do default action for next item.\nnnoremap <silent><nowait> <leader>cj  :<C-u>CocNext<CR>\n\" Do default action for previous item.\nnnoremap <silent><nowait> <leader>cz  :<C-u>CocPrev<CR>\n\" Resume latest coc list.\nnnoremap <silent><nowait> <leader>cp  :<C-u>CocListResume<CR>\n\nlet g:which_key_map2.c = {\n\t\t\t\\ 'name' : '+coc',\n\t\t\t\\ 't' : 'open coc list',\n\t\t\t\\ 'a' : 'show all diagnostics',\n\t\t\t\\ 'e' : 'manage extensions',\n\t\t\t\\ 'c' : 'show commands',\n\t\t\t\\ 'o' : 'find symbol of current document',\n\t\t\t\\ 's' : 'search workspace symbols',\n\t\t\t\\ 'j' : 'do default action for next item',\n\t\t\t\\ 'z' : 'do default action for previous item',\n\t\t\t\\ 'p' : 'resume latest coc list',\n\t\t\t\\ }\n```\n","slug":"vim-automatic-completion","published":1,"updated":"2021-04-16T07:31:48.059Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmsc002crriz640p5zns","content":"<p>本文介绍 vim 自动补全方案。主要采用更强大的 coc.nvim 插件来替代 YCM。</p>\n<h1 id=\"vim-自动补全\"><a href=\"#vim-自动补全\" class=\"headerlink\" title=\"vim 自动补全\"></a>vim 自动补全</h1><h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>自动补全对于任何一个试图取代 IDE 的编辑器的重要性不言而喻。想要将 vim 打造为最契合自己的 IDE，无论如何都不能少了强大的自动补全功能。</p>\n<h2 id=\"coc-nvim-介绍\"><a href=\"#coc-nvim-介绍\" class=\"headerlink\" title=\"coc.nvim 介绍\"></a>coc.nvim 介绍</h2><p>coc.nvim 是针对 neovim 开发的的功能非常强大，完全可以替代 YCM，带来更加优越的补全体验。包括语义补全、片段补全、定义跳转、文档查阅、静态检查等等。</p>\n<p>同时 coc.nvim 也是一个全新的插件平台，除了其原生插件外，理论上也支持所有纯 JS 实现的 vscode 插件。拥有 coc.nvim，就拥有了一个异步插件平台。</p>\n<h2 id=\"coc-nvim-安装\"><a href=\"#coc-nvim-安装\" class=\"headerlink\" title=\"coc.nvim 安装\"></a>coc.nvim 安装</h2><p>coc.nvim 需要<code>nodejs</code>支持。安装<code>nodejs</code>后，用插件管理器安装 coc.nvim 即可。具体可参考其<a href=\"https://github.com/neoclide/coc.nvim\">github 主页</a>。</p>\n<h2 id=\"使用-coc-nvim-进行补全\"><a href=\"#使用-coc-nvim-进行补全\" class=\"headerlink\" title=\"使用 coc.nvim 进行补全\"></a>使用 coc.nvim 进行补全</h2><p>coc.nvim 的补全可以采用安装插件或者配置 lsp 实现。</p>\n<h3 id=\"语义补全及静态检查\"><a href=\"#语义补全及静态检查\" class=\"headerlink\" title=\"语义补全及静态检查\"></a>语义补全及静态检查</h3><p>以 rust 语言为例，可以直接使用<code>:CocInstall</code>安装<code>coc-rust-analyzer</code>插件（会自动安装<code>rust-analyzer</code>）。也可以在安装<code>rust-analyzer</code>后在 coc.nvim 的配置文件中配置。使用<code>:CocConfig</code>打开配置文件，写入</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"languageserver\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"rust\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token property\">\"command\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rust-analyzer\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"filetypes\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"rust\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"rootPatterns\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"Cargo.toml\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意<code>command</code>必须保证可用。</p>\n<p>关于 coc 插件以及 lsp 配置的具体内容可以参考<a href=\"https://github.com/neoclide/coc.nvim/wiki\">coc.nvim wiki</a>。</p>\n<p>到此，rust 语言的自动补全已经配置完成，静态检查也同步配置完成。但仅仅如此还不可以使用。coc.nvim 的自动配置在项目工程中才能起作用。如单独编写一个<code>main.rs</code>，则不会有语义提示。必须以<code>cargo new demo</code>新建一个工程，插件检测到<code>Cargo.toml</code>后才会启动语义的自动补全。当然也有可以直接在单文件中提示的特例，如 markdown 语言，本身就不存在工程的概念。</p>\n<h3 id=\"片段补全\"><a href=\"#片段补全\" class=\"headerlink\" title=\"片段补全\"></a>片段补全</h3><p>安装<code>coc-actions</code>插件。</p>\n<p>再在<code>coc-snippets</code>、<code>coc-ultisnips</code>中选择一个或全选即可。注意需要同步安装<code>honza/vim-snippets</code>、<code>SirVer/ultisnips</code>。</p>\n<h3 id=\"自定义补全源\"><a href=\"#自定义补全源\" class=\"headerlink\" title=\"自定义补全源\"></a>自定义补全源</h3><p>coc.nvim 默认的补全源来自当前打开的所有 buffer、插件或 lsp 等。此外也可以自定义补全源。具体可参见<a href=\"https://github.com/neoclide/coc.nvim/wiki/Create-custom-source\">coc.nvim wiki</a></p>\n<p>下面以补全 markdown 中的 latex 语法为例，展示如何自定义补全源。</p>\n<p>创建目录<code>~/.config/nvim/autoload/coc/source</code>。这里以 linux 系统为例，其他系统的位置可以自行参考 wiki。</p>\n<p>创建<code>latex.vim</code>，写入</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">function</span><span class=\"token operator\">!</span> coc#<span class=\"token keyword\">source</span>#latex#<span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> abort\n\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\t\\<span class=\"token string\">'triggerCharacters'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'\\'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\\<span class=\"token string\">'filetypes'</span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'markdown'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\\<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> coc#<span class=\"token keyword\">source</span>#latex#<span class=\"token function\">complete</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">opt</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">cb</span><span class=\"token punctuation\">)</span> abort\n\t<span class=\"token keyword\">let</span> items <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'kappa'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'theta'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dot&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ddot&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bar&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hat&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'exp'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sin'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cos'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tan'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sec'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'csc'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'vec&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cot'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'arcsin'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'arccos'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'arctan'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sinh'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cosh'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tanh'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'coth'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sh'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ch'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'th'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'max'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'min'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'partial'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nabla'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'prime'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'backprime'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'infty'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'eth'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hbar'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sqrt&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sqrt[]&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pm'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'mp'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'times'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'div'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cdot'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'odot'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bigodot'</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">'&#123; \\&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'in'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'not'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ni'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cap'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Cap'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bigcap'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cup'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Cup'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bigcup'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'subset'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'supset'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'supseteq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'subseteq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'subseteqq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'supseteqq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'subsetneq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'supsetneq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'supsetneqq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'subsetneqq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sim'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'approx'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'leq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'geq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'parallel'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nparallel'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'perp'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'angle'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Box'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bigtriangleup'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bigtriangledown'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'forall'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'therefore'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'because'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'overline&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Rightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Leftarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'leftarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'leftrightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nRightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nLeftarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nleftarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nrightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nleftrightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'overleftarrow&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'overrightarrow&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'overset&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'underline&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sum'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'prod'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'lim'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'limits'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'int'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'iint'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'oint'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'iiint'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'frac&#123;&#125;&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tfrac&#123;&#125;&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dfrac&#123;&#125;&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;matrix&#125;\\end&#123;matrix&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;vmatrix&#125;\\end&#123;vmatrix&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;bmatrix&#125;\\end&#123;bmatrix&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;Bmatrix&#125;\\end&#123;Bmatrix&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;pmatrix&#125;\\end&#123;pmatrix&#125;'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'\\begin&#123;cases&#125;\\end&#123;cases&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;aligned&#125;\\end&#123;aligned&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;array&#125;\\end&#123;array&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'alpha'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'psi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Delta'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'delta'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'beta'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'lambda'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rho'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'varepsilon'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Gamma'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'chi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'mu'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sigma'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Lambda'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tau'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'varphi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'varPhi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'phi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Phi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'eta'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'omega'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'varrho'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Pi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gamma'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'xi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Psi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Sigma'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'varnothing'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'iiiint'</span><span class=\"token punctuation\">]</span>\n\t<span class=\"token keyword\">call</span> a<span class=\"token punctuation\">:</span><span class=\"token function\">cb</span><span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">endfunction</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>简单分析一下。配置的主体框架按照 wiki 给出的例子照猫画虎即可。其中<code>triggerCharacters</code>表示触发字符，意思就是说当输入该字符时启动补全。<code>filetypes</code>表示该补全源作用的文件类型。更多选项参见 wiki。</p>\n<h2 id=\"修复定义跳转卡住的问题\"><a href=\"#修复定义跳转卡住的问题\" class=\"headerlink\" title=\"修复定义跳转卡住的问题\"></a>修复定义跳转卡住的问题</h2><p>使用 coc.nvim 的定义跳转到其他文件时，可能会直接卡死。原因不明，可能是文件太大加载不过来，但也存在小文件被卡住的问题。</p>\n<p>修复方案是重启语法分析。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" 关闭</span>\n<span class=\"token punctuation\">:</span><span class=\"token builtin\">syn</span> off\n<span class=\"token comment\">\" 开启</span>\n<span class=\"token punctuation\">:</span><span class=\"token builtin\">syn</span> enable<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>可以设置进入Vim时自动执行该命令，设置如下。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">au VimEnter <span class=\"token operator\">*</span> <span class=\"token punctuation\">:</span><span class=\"token builtin\">syn</span> off<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nau VimEnter <span class=\"token operator\">*</span> <span class=\"token punctuation\">:</span><span class=\"token builtin\">syn</span> enable<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"其他功能\"><a href=\"#其他功能\" class=\"headerlink\" title=\"其他功能\"></a>其他功能</h2><p>coc.nvim 提供的其他功能还有很多，包括定义跳转、文档查询等等。感兴趣的可以自行研究。以下附上我的 coc.nvim 配置。仅供参考。其中<code>vim-which-key</code>的部分如果没有安装该插件就不必配置。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" coc.nvim</span>\ninoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">j</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-n>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-j>\"</span>\ninoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">k</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-p>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-k>\"</span>\ninoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-y>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-g>u\\&lt;CR>\"</span>\ninoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> coc#<span class=\"token function\">_select_confirm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-g>u\\&lt;CR>\"</span>\ninoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> coc#<span class=\"token function\">_select_confirm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-g>u\\&lt;CR>\\&lt;c-r>=coc#on_enter()\\&lt;CR>\"</span>\n<span class=\"token builtin\">autocmd</span><span class=\"token operator\">!</span> CompleteDone <span class=\"token operator\">*</span> <span class=\"token keyword\">if</span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span> | <span class=\"token keyword\">pclose</span> | <span class=\"token keyword\">endif</span>\n\n<span class=\"token comment\">\" Some servers have issues with backup files, see #649.</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">nobackup</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">nowritebackup</span>\n\n<span class=\"token comment\">\" Give more space for displaying messages.</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">cmdheight</span><span class=\"token operator\">=</span><span class=\"token number\">2</span>\n\n<span class=\"token comment\">\" Having longer updatetime (default is 4000 ms = 4 s) leads to noticeable</span>\n<span class=\"token comment\">\" delays and poor user experience.</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">updatetime</span><span class=\"token operator\">=</span><span class=\"token number\">300</span>\n\n<span class=\"token comment\">\" Don't pass messages to |ins-completion-menu|.</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">shortmess</span><span class=\"token operator\">+=</span><span class=\"token keyword\">c</span>\n\n<span class=\"token comment\">\" Always show the signcolumn, otherwise it would shift the text each time</span>\n<span class=\"token comment\">\" diagnostics appear/become resolved.</span>\n<span class=\"token keyword\">if</span> <span class=\"token function\">has</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"patch-8.1.1564\"</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token comment\">\" Recently vim can merge signcolumn and number column into one</span>\n\t<span class=\"token keyword\">set</span> signcolumn<span class=\"token operator\">=</span><span class=\"token keyword\">number</span>\n<span class=\"token keyword\">else</span>\n\t<span class=\"token keyword\">set</span> signcolumn<span class=\"token operator\">=</span>yes\n<span class=\"token keyword\">endif</span>\n\n<span class=\"token comment\">\" Use tab for trigger completion with characters ahead and navigate.</span>\n<span class=\"token comment\">\" NOTE: Use command </span><span class=\"token string\">':verbose imap &lt;tab>'</span> <span class=\"token keyword\">to</span> <span class=\"token keyword\">make</span> sure <span class=\"token keyword\">tab</span> <span class=\"token operator\">is</span> not mapped by\n<span class=\"token comment\">\" other plugin before putting this into your config.</span>\ninoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>TAB<span class=\"token operator\">></span>\n\t\t\t\\ <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-n>\"</span> <span class=\"token punctuation\">:</span>\n\t\t\t\\ <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">check_back_space</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;TAB>\"</span> <span class=\"token punctuation\">:</span>\n\t\t\t\\ coc#<span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ninoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>S<span class=\"token operator\">-</span>TAB<span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-p>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-h>\"</span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> s<span class=\"token punctuation\">:</span><span class=\"token function\">check_back_space</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> abort\n\t<span class=\"token keyword\">let</span> <span class=\"token keyword\">col</span> <span class=\"token operator\">=</span> <span class=\"token function\">col</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token operator\">!</span><span class=\"token keyword\">col</span> <span class=\"token operator\">||</span> <span class=\"token function\">getline</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token keyword\">col</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">=~#</span> <span class=\"token string\">'\\s'</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token comment\">\" Use &lt;c-space> to trigger completion.</span>\n<span class=\"token keyword\">if</span> <span class=\"token function\">has</span><span class=\"token punctuation\">(</span><span class=\"token string\">'nvim'</span><span class=\"token punctuation\">)</span>\n\tinoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span>space<span class=\"token operator\">></span> coc#<span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span>\n\tinoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span>@<span class=\"token operator\">></span> coc#<span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">endif</span>\n\n<span class=\"token comment\">\" Use &lt;cr> to confirm completion, `&lt;C-g>u` means break undo chain at current</span>\n<span class=\"token comment\">\" position. Coc only does snippet and additional edit on confirm.</span>\n<span class=\"token comment\">\" &lt;cr> could be remapped by other vim plugin, try `:verbose imap &lt;CR>`.</span>\n<span class=\"token keyword\">if</span> <span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*complete_info'</span><span class=\"token punctuation\">)</span>\n\tinoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span> <span class=\"token function\">complete_info</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"selected\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\"-1\"</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-y>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-g>u\\&lt;CR>\"</span>\n<span class=\"token keyword\">else</span>\n\tinoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-y>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-g>u\\&lt;CR>\"</span>\n<span class=\"token keyword\">endif</span>\n\n<span class=\"token comment\">\" GoTo code navigation.</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>gy <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>type<span class=\"token operator\">-</span>definition<span class=\"token punctuation\">)</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>gi <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>implementation<span class=\"token punctuation\">)</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">gr</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>references<span class=\"token punctuation\">)</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token builtin\">gd</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>definition<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span>g <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'+coc.goto'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'y'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'go to type definition'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'i'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'go to implementation'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'go to references'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'d'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'go to definition'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token comment\">\" Use K to show documentation in preview window.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> K <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span> <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">show_documentation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> s<span class=\"token punctuation\">:</span><span class=\"token function\">show_documentation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'vim'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'help'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> &amp;<span class=\"token keyword\">filetype</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\t\texecute <span class=\"token string\">'h '</span><span class=\"token operator\">.</span><span class=\"token function\">expand</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;cword>'</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">else</span>\n\t\t<span class=\"token keyword\">call</span> <span class=\"token function\">CocActionAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'doHover'</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">endif</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token comment\">\" Highlight the symbol and its references when holding the cursor.</span>\n<span class=\"token builtin\">autocmd</span> CursorHold <span class=\"token operator\">*</span> <span class=\"token keyword\">silent</span> <span class=\"token keyword\">call</span> <span class=\"token function\">CocActionAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'highlight'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Symbol renaming.</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">cr</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>rename<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Formatting selected code.</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>cm <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>format<span class=\"token operator\">-</span>selected<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">xmap</span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>cm <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>format<span class=\"token operator\">-</span>selected<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">c</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+coc'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'automatically fix errors in current line'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'m'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'format selected code'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'rename symbol'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span>\n\naugroup mygroup\n\t<span class=\"token builtin\">autocmd</span><span class=\"token operator\">!</span>\n\t<span class=\"token comment\">\" Setup formatexpr specified filetype(s).</span>\n\t<span class=\"token builtin\">autocmd</span> FileType typescript<span class=\"token punctuation\">,</span>json <span class=\"token keyword\">setl</span> <span class=\"token builtin\">formatexpr</span><span class=\"token operator\">=</span><span class=\"token function\">CocAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'formatSelected'</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token comment\">\" Update signature help on jump placeholder.</span>\n\t<span class=\"token builtin\">autocmd</span> User CocJumpPlaceholder <span class=\"token keyword\">call</span> <span class=\"token function\">CocActionAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'showSignatureHelp'</span><span class=\"token punctuation\">)</span>\naugroup end\n\n<span class=\"token comment\">\" Apply AutoFix to problem on the current line.</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">cf</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span><span class=\"token keyword\">fix</span><span class=\"token operator\">-</span>current<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Add `:Format` command to format current buffer.</span>\ncommand<span class=\"token operator\">!</span> <span class=\"token operator\">-</span>nargs<span class=\"token operator\">=</span><span class=\"token number\">0</span> Format <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span> <span class=\"token function\">CocAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'format'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Add `:Fold` command to fold current buffer.</span>\ncommand<span class=\"token operator\">!</span> <span class=\"token operator\">-</span>nargs<span class=\"token operator\">=</span><span class=\"token operator\">?</span> Fold <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span>     <span class=\"token function\">CocAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fold'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">f</span><span class=\"token operator\">-</span><span class=\"token keyword\">args</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Add `:OR` command for organize imports of the current buffer.</span>\ncommand<span class=\"token operator\">!</span> <span class=\"token operator\">-</span>nargs<span class=\"token operator\">=</span><span class=\"token number\">0</span> OR   <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span>     <span class=\"token function\">CocAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'runCommand'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'editor.action.organizeImport'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Add (Neo)Vim's native statusline support.</span>\n<span class=\"token comment\">\" NOTE: Please see `:h coc-status` for integrations with external plugins that</span>\n<span class=\"token comment\">\" provide custom statusline: lightline.vim, vim-airline.</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">statusline</span>^<span class=\"token operator\">=</span><span class=\"token operator\">%</span><span class=\"token punctuation\">&#123;</span>coc#<span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">%</span><span class=\"token punctuation\">&#123;</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">b</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token string\">'coc_current_function'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token comment\">\" Mappings for CoCList</span>\n<span class=\"token comment\">\" open CocList</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>ct  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Show all diagnostics.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">ca</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList diagnostics<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Manage extensions.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">ce</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList extensions<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Show commands.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">cc</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList commands<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Find symbol of current document.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">co</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList outline<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Search workspace symbols.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>cs  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList <span class=\"token operator\">-</span>I symbols<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Do default action for next item.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>cj  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocNext<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n<span class=\"token comment\">\" Do default action for previous item.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>cz  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocPrev<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n<span class=\"token comment\">\" Resume latest coc list.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">cp</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocListResume<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map2<span class=\"token operator\">.</span><span class=\"token keyword\">c</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+coc'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'open coc list'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'show all diagnostics'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'manage extensions'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'show commands'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'find symbol of current document'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'search workspace symbols'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'j'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'do default action for next item'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'z'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'do default action for previous item'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'p'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'resume latest coc list'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<p>本文介绍 vim 自动补全方案。主要采用更强大的 coc.nvim 插件来替代 YCM。</p>\n<h1 id=\"vim-自动补全\"><a href=\"#vim-自动补全\" class=\"headerlink\" title=\"vim 自动补全\"></a>vim 自动补全</h1><h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>自动补全对于任何一个试图取代 IDE 的编辑器的重要性不言而喻。想要将 vim 打造为最契合自己的 IDE，无论如何都不能少了强大的自动补全功能。</p>\n<h2 id=\"coc-nvim-介绍\"><a href=\"#coc-nvim-介绍\" class=\"headerlink\" title=\"coc.nvim 介绍\"></a>coc.nvim 介绍</h2><p>coc.nvim 是针对 neovim 开发的的功能非常强大，完全可以替代 YCM，带来更加优越的补全体验。包括语义补全、片段补全、定义跳转、文档查阅、静态检查等等。</p>\n<p>同时 coc.nvim 也是一个全新的插件平台，除了其原生插件外，理论上也支持所有纯 JS 实现的 vscode 插件。拥有 coc.nvim，就拥有了一个异步插件平台。</p>\n<h2 id=\"coc-nvim-安装\"><a href=\"#coc-nvim-安装\" class=\"headerlink\" title=\"coc.nvim 安装\"></a>coc.nvim 安装</h2><p>coc.nvim 需要<code>nodejs</code>支持。安装<code>nodejs</code>后，用插件管理器安装 coc.nvim 即可。具体可参考其<a href=\"https://github.com/neoclide/coc.nvim\">github 主页</a>。</p>\n<h2 id=\"使用-coc-nvim-进行补全\"><a href=\"#使用-coc-nvim-进行补全\" class=\"headerlink\" title=\"使用 coc.nvim 进行补全\"></a>使用 coc.nvim 进行补全</h2><p>coc.nvim 的补全可以采用安装插件或者配置 lsp 实现。</p>\n<h3 id=\"语义补全及静态检查\"><a href=\"#语义补全及静态检查\" class=\"headerlink\" title=\"语义补全及静态检查\"></a>语义补全及静态检查</h3><p>以 rust 语言为例，可以直接使用<code>:CocInstall</code>安装<code>coc-rust-analyzer</code>插件（会自动安装<code>rust-analyzer</code>）。也可以在安装<code>rust-analyzer</code>后在 coc.nvim 的配置文件中配置。使用<code>:CocConfig</code>打开配置文件，写入</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"languageserver\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"rust\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token property\">\"command\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rust-analyzer\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"filetypes\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"rust\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"rootPatterns\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"Cargo.toml\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意<code>command</code>必须保证可用。</p>\n<p>关于 coc 插件以及 lsp 配置的具体内容可以参考<a href=\"https://github.com/neoclide/coc.nvim/wiki\">coc.nvim wiki</a>。</p>\n<p>到此，rust 语言的自动补全已经配置完成，静态检查也同步配置完成。但仅仅如此还不可以使用。coc.nvim 的自动配置在项目工程中才能起作用。如单独编写一个<code>main.rs</code>，则不会有语义提示。必须以<code>cargo new demo</code>新建一个工程，插件检测到<code>Cargo.toml</code>后才会启动语义的自动补全。当然也有可以直接在单文件中提示的特例，如 markdown 语言，本身就不存在工程的概念。</p>\n<h3 id=\"片段补全\"><a href=\"#片段补全\" class=\"headerlink\" title=\"片段补全\"></a>片段补全</h3><p>安装<code>coc-actions</code>插件。</p>\n<p>再在<code>coc-snippets</code>、<code>coc-ultisnips</code>中选择一个或全选即可。注意需要同步安装<code>honza/vim-snippets</code>、<code>SirVer/ultisnips</code>。</p>\n<h3 id=\"自定义补全源\"><a href=\"#自定义补全源\" class=\"headerlink\" title=\"自定义补全源\"></a>自定义补全源</h3><p>coc.nvim 默认的补全源来自当前打开的所有 buffer、插件或 lsp 等。此外也可以自定义补全源。具体可参见<a href=\"https://github.com/neoclide/coc.nvim/wiki/Create-custom-source\">coc.nvim wiki</a></p>\n<p>下面以补全 markdown 中的 latex 语法为例，展示如何自定义补全源。</p>\n<p>创建目录<code>~/.config/nvim/autoload/coc/source</code>。这里以 linux 系统为例，其他系统的位置可以自行参考 wiki。</p>\n<p>创建<code>latex.vim</code>，写入</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">function</span><span class=\"token operator\">!</span> coc#<span class=\"token keyword\">source</span>#latex#<span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> abort\n\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\t\\<span class=\"token string\">'triggerCharacters'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'\\'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\\<span class=\"token string\">'filetypes'</span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'markdown'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\\<span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> coc#<span class=\"token keyword\">source</span>#latex#<span class=\"token function\">complete</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">opt</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">cb</span><span class=\"token punctuation\">)</span> abort\n\t<span class=\"token keyword\">let</span> items <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'kappa'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'theta'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dot&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ddot&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bar&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hat&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'exp'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sin'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cos'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tan'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sec'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'csc'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'vec&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cot'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'arcsin'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'arccos'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'arctan'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sinh'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cosh'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tanh'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'coth'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sh'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ch'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'th'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'max'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'min'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'partial'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nabla'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'prime'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'backprime'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'infty'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'eth'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hbar'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sqrt&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sqrt[]&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pm'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'mp'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'times'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'div'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cdot'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'odot'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bigodot'</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">'&#123; \\&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'in'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'not'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ni'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cap'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Cap'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bigcap'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'cup'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Cup'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bigcup'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'subset'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'supset'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'supseteq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'subseteq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'subseteqq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'supseteqq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'subsetneq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'supsetneq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'supsetneqq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'subsetneqq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sim'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'approx'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'leq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'geq'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'parallel'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nparallel'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'perp'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'angle'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Box'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bigtriangleup'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'bigtriangledown'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'forall'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'therefore'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'because'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'overline&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Rightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Leftarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'leftarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'leftrightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nRightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nLeftarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nleftarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nrightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nleftrightarrow'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'overleftarrow&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'overrightarrow&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'overset&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'underline&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sum'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'prod'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'lim'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'limits'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'int'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'iint'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'oint'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'iiint'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'frac&#123;&#125;&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tfrac&#123;&#125;&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'dfrac&#123;&#125;&#123;&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;matrix&#125;\\end&#123;matrix&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;vmatrix&#125;\\end&#123;vmatrix&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;bmatrix&#125;\\end&#123;bmatrix&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;Bmatrix&#125;\\end&#123;Bmatrix&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;pmatrix&#125;\\end&#123;pmatrix&#125;'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'\\begin&#123;cases&#125;\\end&#123;cases&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;aligned&#125;\\end&#123;aligned&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'\\begin&#123;array&#125;\\end&#123;array&#125;'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'alpha'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'psi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Delta'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'delta'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'beta'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'lambda'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rho'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'varepsilon'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Gamma'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'chi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'mu'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sigma'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Lambda'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'tau'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'varphi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'varPhi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'phi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Phi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'eta'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'omega'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'varrho'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Pi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gamma'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'xi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Psi'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Sigma'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'varnothing'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'iiiint'</span><span class=\"token punctuation\">]</span>\n\t<span class=\"token keyword\">call</span> a<span class=\"token punctuation\">:</span><span class=\"token function\">cb</span><span class=\"token punctuation\">(</span>items<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">endfunction</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>简单分析一下。配置的主体框架按照 wiki 给出的例子照猫画虎即可。其中<code>triggerCharacters</code>表示触发字符，意思就是说当输入该字符时启动补全。<code>filetypes</code>表示该补全源作用的文件类型。更多选项参见 wiki。</p>\n<h2 id=\"修复定义跳转卡住的问题\"><a href=\"#修复定义跳转卡住的问题\" class=\"headerlink\" title=\"修复定义跳转卡住的问题\"></a>修复定义跳转卡住的问题</h2><p>使用 coc.nvim 的定义跳转到其他文件时，可能会直接卡死。原因不明，可能是文件太大加载不过来，但也存在小文件被卡住的问题。</p>\n<p>修复方案是重启语法分析。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" 关闭</span>\n<span class=\"token punctuation\">:</span><span class=\"token builtin\">syn</span> off\n<span class=\"token comment\">\" 开启</span>\n<span class=\"token punctuation\">:</span><span class=\"token builtin\">syn</span> enable<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>可以设置进入Vim时自动执行该命令，设置如下。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">au VimEnter <span class=\"token operator\">*</span> <span class=\"token punctuation\">:</span><span class=\"token builtin\">syn</span> off<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nau VimEnter <span class=\"token operator\">*</span> <span class=\"token punctuation\">:</span><span class=\"token builtin\">syn</span> enable<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"其他功能\"><a href=\"#其他功能\" class=\"headerlink\" title=\"其他功能\"></a>其他功能</h2><p>coc.nvim 提供的其他功能还有很多，包括定义跳转、文档查询等等。感兴趣的可以自行研究。以下附上我的 coc.nvim 配置。仅供参考。其中<code>vim-which-key</code>的部分如果没有安装该插件就不必配置。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" coc.nvim</span>\ninoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">j</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-n>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-j>\"</span>\ninoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">k</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-p>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-k>\"</span>\ninoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-y>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-g>u\\&lt;CR>\"</span>\ninoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> coc#<span class=\"token function\">_select_confirm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-g>u\\&lt;CR>\"</span>\ninoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> coc#<span class=\"token function\">_select_confirm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-g>u\\&lt;CR>\\&lt;c-r>=coc#on_enter()\\&lt;CR>\"</span>\n<span class=\"token builtin\">autocmd</span><span class=\"token operator\">!</span> CompleteDone <span class=\"token operator\">*</span> <span class=\"token keyword\">if</span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span> | <span class=\"token keyword\">pclose</span> | <span class=\"token keyword\">endif</span>\n\n<span class=\"token comment\">\" Some servers have issues with backup files, see #649.</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">nobackup</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">nowritebackup</span>\n\n<span class=\"token comment\">\" Give more space for displaying messages.</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">cmdheight</span><span class=\"token operator\">=</span><span class=\"token number\">2</span>\n\n<span class=\"token comment\">\" Having longer updatetime (default is 4000 ms = 4 s) leads to noticeable</span>\n<span class=\"token comment\">\" delays and poor user experience.</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">updatetime</span><span class=\"token operator\">=</span><span class=\"token number\">300</span>\n\n<span class=\"token comment\">\" Don't pass messages to |ins-completion-menu|.</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">shortmess</span><span class=\"token operator\">+=</span><span class=\"token keyword\">c</span>\n\n<span class=\"token comment\">\" Always show the signcolumn, otherwise it would shift the text each time</span>\n<span class=\"token comment\">\" diagnostics appear/become resolved.</span>\n<span class=\"token keyword\">if</span> <span class=\"token function\">has</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"patch-8.1.1564\"</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token comment\">\" Recently vim can merge signcolumn and number column into one</span>\n\t<span class=\"token keyword\">set</span> signcolumn<span class=\"token operator\">=</span><span class=\"token keyword\">number</span>\n<span class=\"token keyword\">else</span>\n\t<span class=\"token keyword\">set</span> signcolumn<span class=\"token operator\">=</span>yes\n<span class=\"token keyword\">endif</span>\n\n<span class=\"token comment\">\" Use tab for trigger completion with characters ahead and navigate.</span>\n<span class=\"token comment\">\" NOTE: Use command </span><span class=\"token string\">':verbose imap &lt;tab>'</span> <span class=\"token keyword\">to</span> <span class=\"token keyword\">make</span> sure <span class=\"token keyword\">tab</span> <span class=\"token operator\">is</span> not mapped by\n<span class=\"token comment\">\" other plugin before putting this into your config.</span>\ninoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>TAB<span class=\"token operator\">></span>\n\t\t\t\\ <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-n>\"</span> <span class=\"token punctuation\">:</span>\n\t\t\t\\ <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">check_back_space</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;TAB>\"</span> <span class=\"token punctuation\">:</span>\n\t\t\t\\ coc#<span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ninoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>S<span class=\"token operator\">-</span>TAB<span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-p>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-h>\"</span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> s<span class=\"token punctuation\">:</span><span class=\"token function\">check_back_space</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> abort\n\t<span class=\"token keyword\">let</span> <span class=\"token keyword\">col</span> <span class=\"token operator\">=</span> <span class=\"token function\">col</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token operator\">!</span><span class=\"token keyword\">col</span> <span class=\"token operator\">||</span> <span class=\"token function\">getline</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token keyword\">col</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">=~#</span> <span class=\"token string\">'\\s'</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token comment\">\" Use &lt;c-space> to trigger completion.</span>\n<span class=\"token keyword\">if</span> <span class=\"token function\">has</span><span class=\"token punctuation\">(</span><span class=\"token string\">'nvim'</span><span class=\"token punctuation\">)</span>\n\tinoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span>space<span class=\"token operator\">></span> coc#<span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">else</span>\n\tinoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span>@<span class=\"token operator\">></span> coc#<span class=\"token function\">refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">endif</span>\n\n<span class=\"token comment\">\" Use &lt;cr> to confirm completion, `&lt;C-g>u` means break undo chain at current</span>\n<span class=\"token comment\">\" position. Coc only does snippet and additional edit on confirm.</span>\n<span class=\"token comment\">\" &lt;cr> could be remapped by other vim plugin, try `:verbose imap &lt;CR>`.</span>\n<span class=\"token keyword\">if</span> <span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*complete_info'</span><span class=\"token punctuation\">)</span>\n\tinoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span> <span class=\"token function\">complete_info</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"selected\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token string\">\"-1\"</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-y>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-g>u\\&lt;CR>\"</span>\n<span class=\"token keyword\">else</span>\n\tinoremap <span class=\"token operator\">&lt;</span>expr<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span> <span class=\"token function\">pumvisible</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\\&lt;C-y>\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\&lt;C-g>u\\&lt;CR>\"</span>\n<span class=\"token keyword\">endif</span>\n\n<span class=\"token comment\">\" GoTo code navigation.</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>gy <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>type<span class=\"token operator\">-</span>definition<span class=\"token punctuation\">)</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>gi <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>implementation<span class=\"token punctuation\">)</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">gr</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>references<span class=\"token punctuation\">)</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token builtin\">gd</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>definition<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span>g <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'+coc.goto'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'y'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'go to type definition'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'i'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'go to implementation'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'go to references'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'d'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'go to definition'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token comment\">\" Use K to show documentation in preview window.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> K <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span> <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">show_documentation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> s<span class=\"token punctuation\">:</span><span class=\"token function\">show_documentation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'vim'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'help'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> &amp;<span class=\"token keyword\">filetype</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\t\texecute <span class=\"token string\">'h '</span><span class=\"token operator\">.</span><span class=\"token function\">expand</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;cword>'</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">else</span>\n\t\t<span class=\"token keyword\">call</span> <span class=\"token function\">CocActionAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'doHover'</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">endif</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token comment\">\" Highlight the symbol and its references when holding the cursor.</span>\n<span class=\"token builtin\">autocmd</span> CursorHold <span class=\"token operator\">*</span> <span class=\"token keyword\">silent</span> <span class=\"token keyword\">call</span> <span class=\"token function\">CocActionAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'highlight'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Symbol renaming.</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">cr</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>rename<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Formatting selected code.</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>cm <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>format<span class=\"token operator\">-</span>selected<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">xmap</span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>cm <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>format<span class=\"token operator\">-</span>selected<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">c</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+coc'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'automatically fix errors in current line'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'m'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'format selected code'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'rename symbol'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span>\n\naugroup mygroup\n\t<span class=\"token builtin\">autocmd</span><span class=\"token operator\">!</span>\n\t<span class=\"token comment\">\" Setup formatexpr specified filetype(s).</span>\n\t<span class=\"token builtin\">autocmd</span> FileType typescript<span class=\"token punctuation\">,</span>json <span class=\"token keyword\">setl</span> <span class=\"token builtin\">formatexpr</span><span class=\"token operator\">=</span><span class=\"token function\">CocAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'formatSelected'</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token comment\">\" Update signature help on jump placeholder.</span>\n\t<span class=\"token builtin\">autocmd</span> User CocJumpPlaceholder <span class=\"token keyword\">call</span> <span class=\"token function\">CocActionAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'showSignatureHelp'</span><span class=\"token punctuation\">)</span>\naugroup end\n\n<span class=\"token comment\">\" Apply AutoFix to problem on the current line.</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">cf</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span><span class=\"token keyword\">fix</span><span class=\"token operator\">-</span>current<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Add `:Format` command to format current buffer.</span>\ncommand<span class=\"token operator\">!</span> <span class=\"token operator\">-</span>nargs<span class=\"token operator\">=</span><span class=\"token number\">0</span> Format <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span> <span class=\"token function\">CocAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'format'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Add `:Fold` command to fold current buffer.</span>\ncommand<span class=\"token operator\">!</span> <span class=\"token operator\">-</span>nargs<span class=\"token operator\">=</span><span class=\"token operator\">?</span> Fold <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span>     <span class=\"token function\">CocAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fold'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&lt;</span><span class=\"token keyword\">f</span><span class=\"token operator\">-</span><span class=\"token keyword\">args</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Add `:OR` command for organize imports of the current buffer.</span>\ncommand<span class=\"token operator\">!</span> <span class=\"token operator\">-</span>nargs<span class=\"token operator\">=</span><span class=\"token number\">0</span> OR   <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span>     <span class=\"token function\">CocAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'runCommand'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'editor.action.organizeImport'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" Add (Neo)Vim's native statusline support.</span>\n<span class=\"token comment\">\" NOTE: Please see `:h coc-status` for integrations with external plugins that</span>\n<span class=\"token comment\">\" provide custom statusline: lightline.vim, vim-airline.</span>\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">statusline</span>^<span class=\"token operator\">=</span><span class=\"token operator\">%</span><span class=\"token punctuation\">&#123;</span>coc#<span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span><span class=\"token operator\">%</span><span class=\"token punctuation\">&#123;</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">b</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token string\">'coc_current_function'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token comment\">\" Mappings for CoCList</span>\n<span class=\"token comment\">\" open CocList</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>ct  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Show all diagnostics.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">ca</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList diagnostics<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Manage extensions.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">ce</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList extensions<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Show commands.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">cc</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList commands<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Find symbol of current document.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">co</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList outline<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Search workspace symbols.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>cs  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList <span class=\"token operator\">-</span>I symbols<span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token comment\">\" Do default action for next item.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>cj  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocNext<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n<span class=\"token comment\">\" Do default action for previous item.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>cz  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocPrev<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n<span class=\"token comment\">\" Resume latest coc list.</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">cp</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocListResume<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map2<span class=\"token operator\">.</span><span class=\"token keyword\">c</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+coc'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'open coc list'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'a'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'show all diagnostics'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'manage extensions'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'show commands'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'find symbol of current document'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'search workspace symbols'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'j'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'do default action for next item'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'z'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'do default action for previous item'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'p'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'resume latest coc list'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n"},{"title":"Vim Clipboard History Plugin","date":"2021-03-23T08:46:32.000Z","_content":"\n# vim剪贴板历史记录插件\n\n本文介绍 vim 剪贴板历史管理插件。\n\n## 剪贴板历史\n\nvimer 们在疯狂码字的过程中常会被一个问题打断操作。那就是多次复制与粘贴的冲突。vim 的默认规则是，粘贴的必是最后一次复制的内容。如此，当遇到像要交换两个内容时，就会遇到无法同时复制再粘贴的情况。随着 vim 提供了非常多寄存器，但是，一来，使用寄存器需要多按键，二来，时间一长，你就很难记得那个寄存器里放了什么，又需要手动查看。\n\n如果有了剪贴板历史插件，一切问题就都将迎刃而解。\n\n## 插件选择\n\n可以选择 YankRing。这算是一个比较古老的插件，很多年没有更新了，但是功能很完善，也十分稳定。只是该插件有部分命令是直接绑死快捷键的，如`<C-n>`，这意味着你不能再为该键位绑定其他命令。\n\n如果你介意这一点，且使用`coc.nvim`插件，可以采用`coc-yank`插件。该 coc 插件提供了相同的功能。此外，该插件还可以设置复制区域高亮，即高亮显示你的复制内容。插件的配置非常简单，此处不再赘述，仅给出简单的示例。\n\n```vim\n\" coc-yank\nnnoremap <silent> <space>p  :<C-u>CocList -A --normal yank<cr>\n```\n","source":"_posts/vim-clipboard-history-plugin.md","raw":"---\ntitle: Vim Clipboard History Plugin\ndate: 2021-03-23 16:46:32\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# vim剪贴板历史记录插件\n\n本文介绍 vim 剪贴板历史管理插件。\n\n## 剪贴板历史\n\nvimer 们在疯狂码字的过程中常会被一个问题打断操作。那就是多次复制与粘贴的冲突。vim 的默认规则是，粘贴的必是最后一次复制的内容。如此，当遇到像要交换两个内容时，就会遇到无法同时复制再粘贴的情况。随着 vim 提供了非常多寄存器，但是，一来，使用寄存器需要多按键，二来，时间一长，你就很难记得那个寄存器里放了什么，又需要手动查看。\n\n如果有了剪贴板历史插件，一切问题就都将迎刃而解。\n\n## 插件选择\n\n可以选择 YankRing。这算是一个比较古老的插件，很多年没有更新了，但是功能很完善，也十分稳定。只是该插件有部分命令是直接绑死快捷键的，如`<C-n>`，这意味着你不能再为该键位绑定其他命令。\n\n如果你介意这一点，且使用`coc.nvim`插件，可以采用`coc-yank`插件。该 coc 插件提供了相同的功能。此外，该插件还可以设置复制区域高亮，即高亮显示你的复制内容。插件的配置非常简单，此处不再赘述，仅给出简单的示例。\n\n```vim\n\" coc-yank\nnnoremap <silent> <space>p  :<C-u>CocList -A --normal yank<cr>\n```\n","slug":"vim-clipboard-history-plugin","published":1,"updated":"2021-03-23T11:11:18.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmsd002frrizg80j3dzc","content":"<h1 id=\"vim剪贴板历史记录插件\"><a href=\"#vim剪贴板历史记录插件\" class=\"headerlink\" title=\"vim剪贴板历史记录插件\"></a>vim剪贴板历史记录插件</h1><p>本文介绍 vim 剪贴板历史管理插件。</p>\n<h2 id=\"剪贴板历史\"><a href=\"#剪贴板历史\" class=\"headerlink\" title=\"剪贴板历史\"></a>剪贴板历史</h2><p>vimer 们在疯狂码字的过程中常会被一个问题打断操作。那就是多次复制与粘贴的冲突。vim 的默认规则是，粘贴的必是最后一次复制的内容。如此，当遇到像要交换两个内容时，就会遇到无法同时复制再粘贴的情况。随着 vim 提供了非常多寄存器，但是，一来，使用寄存器需要多按键，二来，时间一长，你就很难记得那个寄存器里放了什么，又需要手动查看。</p>\n<p>如果有了剪贴板历史插件，一切问题就都将迎刃而解。</p>\n<h2 id=\"插件选择\"><a href=\"#插件选择\" class=\"headerlink\" title=\"插件选择\"></a>插件选择</h2><p>可以选择 YankRing。这算是一个比较古老的插件，很多年没有更新了，但是功能很完善，也十分稳定。只是该插件有部分命令是直接绑死快捷键的，如<code>&lt;C-n&gt;</code>，这意味着你不能再为该键位绑定其他命令。</p>\n<p>如果你介意这一点，且使用<code>coc.nvim</code>插件，可以采用<code>coc-yank</code>插件。该 coc 插件提供了相同的功能。此外，该插件还可以设置复制区域高亮，即高亮显示你的复制内容。插件的配置非常简单，此处不再赘述，仅给出简单的示例。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" coc-yank</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">p</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList <span class=\"token operator\">-</span>A <span class=\"token operator\">-</span><span class=\"token operator\">-</span>normal <span class=\"token keyword\">yank</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"vim剪贴板历史记录插件\"><a href=\"#vim剪贴板历史记录插件\" class=\"headerlink\" title=\"vim剪贴板历史记录插件\"></a>vim剪贴板历史记录插件</h1><p>本文介绍 vim 剪贴板历史管理插件。</p>\n<h2 id=\"剪贴板历史\"><a href=\"#剪贴板历史\" class=\"headerlink\" title=\"剪贴板历史\"></a>剪贴板历史</h2><p>vimer 们在疯狂码字的过程中常会被一个问题打断操作。那就是多次复制与粘贴的冲突。vim 的默认规则是，粘贴的必是最后一次复制的内容。如此，当遇到像要交换两个内容时，就会遇到无法同时复制再粘贴的情况。随着 vim 提供了非常多寄存器，但是，一来，使用寄存器需要多按键，二来，时间一长，你就很难记得那个寄存器里放了什么，又需要手动查看。</p>\n<p>如果有了剪贴板历史插件，一切问题就都将迎刃而解。</p>\n<h2 id=\"插件选择\"><a href=\"#插件选择\" class=\"headerlink\" title=\"插件选择\"></a>插件选择</h2><p>可以选择 YankRing。这算是一个比较古老的插件，很多年没有更新了，但是功能很完善，也十分稳定。只是该插件有部分命令是直接绑死快捷键的，如<code>&lt;C-n&gt;</code>，这意味着你不能再为该键位绑定其他命令。</p>\n<p>如果你介意这一点，且使用<code>coc.nvim</code>插件，可以采用<code>coc-yank</code>插件。该 coc 插件提供了相同的功能。此外，该插件还可以设置复制区域高亮，即高亮显示你的复制内容。插件的配置非常简单，此处不再赘述，仅给出简单的示例。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" coc-yank</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">p</span>  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>CocList <span class=\"token operator\">-</span>A <span class=\"token operator\">-</span><span class=\"token operator\">-</span>normal <span class=\"token keyword\">yank</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n"},{"title":"Vim Debugging Scheme","date":"2020-10-20T02:29:48.000Z","_content":"\n# vim 调试方案\n\n本文介绍在 vim 中使用 vimspector 插件扩展 IDE 式调试功能，获取极致体验。\n\n## 调试\n\n- 为什么需要扩展调试功能？\n\n虽然传统上与 vim 更匹配的调试方案是在命令行中使用 gdb、lldb 等调试器，但这就不得不暂时离开 vim。虽然有诸如 tmux、内置 terminal 等工具可以使得命令行调试变得更加方便，但具有 ui 界面，且就在 vim 中的调试无疑会更加直观。\n\n- vimspector 插件的调试能力\n\n可以查看其[github 主页](https://github.com/puremourning/vimspector)。包括可调试的语言、调试输出的信息、调试的主要界面等等均可以看到。可以说 vimspector 是一个相当专业的调试插件。\n\n## vimspector 安装\n\n可以参考官方提供的安装方式，也可以按照以下笔者推荐的方式安装。\n\n首先，该插件需要被安装在`pack/x/opt`的目录下，如果想使用插件管理器安装，必须将安装目录修改为`xxx/pack/x/opt`。其中`xxx`是前一段的路径，可以不止一级，可以自定义，`x`是一级目录，可以为任意名称。然后在 vim 配置文件中，声明`set packpath= the_path_to_your_pack_directory`，只需要到`pack`的前一级目录即可。然后直接使用包管理器安装即可。至此，插件本身安装完毕。\n\n## vimspector 配置\n\n使用`:VimspectorInstall`来安装调试需要的适配器，如`:VimspectorInstall --enable-c`，具体参数可以在其主页找到。使用`:VimspectorUpdate`更新所有适配器。\n\n安装好所需适配器之后，可以继续配置快捷键。可以使用官方提供的两套快捷键，也可以自定义。\n\n使用官方快捷键可以设置`let g:vimspector_enable_mappings = 'HUMAN'`或者`let g:vimspector_enable_mappings = 'VISUAL_STUDIO'`。\n\n如果要自定义，以下配置仅供参考。\n\n```vim\nnmap <silent><nowait><space>dn <Plug>VimspectorStepOver\nnmap <A-n> <Plug>VimspectorStepOver\nnmap <silent><nowait><space>db <Plug>VimspectorToggleBreakpoint\nnmap <A-b> <Plug>VimspectorToggleBreakpoint\nnmap <silent><nowait><space>ds <Plug>VimspectorContinue\nnmap <silent><nowait><space>dr <Plug>VimspectorRestart\nnmap <silent><nowait><space>dp <Plug>VimspectorPause\nnmap <silent><nowait><space>dt <Plug>VimspectorStop\nnmap <silent><nowait><space>df <Plug>VimspectorAddFunctionBreakpoint\nnmap <silent><nowait><space>dc <Plug>VimspectorToggleConditionalBreakpoint\nnmap <silent><nowait><space>do <Plug>VimspectorStepOut\nnmap <A-o> <Plug>VimspectorStepOut\nnmap <silent><nowait><space>di <Plug>VimspectorStepInto\nnmap <A-i> <Plug>VimspectorStepInto\nnmap <silent><nowait><space>dq <Plug>VimspectorReset<CR>\nnmap <silent><nowait><space>dlc <Plug>VimspectorShowOutput Console<CR>\nnmap <silent><nowait><space>dld <Plug>VimspectorShowOutput stderr<CR>\nnmap <silent><nowait><space>dlo <Plug>VimspectorShowOutput Vimspector-out<CR>\nnmap <silent><nowait><space>dle <Plug>VimspectorShowOutput Vimspector-err<CR>\nnmap <silent><nowait><space>dls <Plug>VimspectorShowOutput server<CR>\nnmap <silent><nowait><space>dlt <Plug>VimspectorShowOutput Telemetry<CR>\nnmap <silent><nowait><space>de :<C-u>VimspectorEval<space>\nnmap <silent><nowait><space>dw :<C-u>VimspectorWatch<space>\nnmap <A-w> :<C-u>VimspectorWatch<space>\n\nlet g:which_key_map1.d = {\n\t\t\t\\ 'name' : '+debug',\n\t\t\t\\ 'e' : 'eval',\n\t\t\t\\ 'w' : 'variable watch',\n\t\t\t\\ 's' : 'start or continue',\n\t\t\t\\ 't' : 'stop',\n\t\t\t\\ 'r' : 'restart',\n\t\t\t\\ 'p' : 'pause',\n\t\t\t\\ 'b' : 'set breakpoint',\n\t\t\t\\ 'c' : 'set condition breakpoint',\n\t\t\t\\ 'f' : 'add function breakpoint',\n\t\t\t\\ 'n' : 'next',\n\t\t\t\\ 'i' : 'step in',\n\t\t\t\\ 'o' : 'step out',\n\t\t\t\\ 'q' : 'quit',\n\t\t\t\\ 'l' :  {\n\t\t\t\\ 'name' : '+switch_output',\n\t\t\t\\ 'c' : 'Console',\n\t\t\t\\ 'd' : 'stderr',\n\t\t\t\\ 'o' : 'Vimspector-out',\n\t\t\t\\ 'e' : 'Vimspector-err',\n\t\t\t\\ 's' : 'server',\n\t\t\t\\ 't' : 'Telemetry',\n\t\t\t\\},\n\t\t\t\\}\n```\n\n注意 vimspector 的一些功能暂不支持 neovim，这一点在主页上有说明。不过并不影响使用。以上配置中这些部分就是在 neovim 中用于切换窗口的命令和快捷键。\n\n```vim\nnmap <silent><nowait><space>dlc <Plug>VimspectorShowOutput Console<CR>\nnmap <silent><nowait><space>dld <Plug>VimspectorShowOutput stderr<CR>\nnmap <silent><nowait><space>dlo <Plug>VimspectorShowOutput Vimspector-out<CR>\nnmap <silent><nowait><space>dle <Plug>VimspectorShowOutput Vimspector-err<CR>\nnmap <silent><nowait><space>dls <Plug>VimspectorShowOutput server<CR>\nnmap <silent><nowait><space>dlt <Plug>VimspectorShowOutput Telemetry<CR>\n```\n\n到此为止，该插件仍不可以使用，还差最后一步。\n\n该插件本身的配置文件有两种，一是`.gadgets.json`，二是`.vimspector.json`。前面安装适配器的过程中已经自动产生了不少配置。关于这些配置文件的具体内容和关系可以自行研究，这里只介绍如何完成最后一步配置。\n\n在工程项目目录下新建`.vimspector.json`文件。copy 插件主页上给出的示例配置。\n\n以 rust 语言为例，给出的示例配置为\n\n```json\n{\n  \"configurations\": {\n    \"launch\": {\n      \"adapter\": \"CodeLLDB\",\n      \"configuration\": {\n        \"request\": \"launch\",\n        \"program\": \"${workspaceRoot}/target/debug/vimspector_test\"\n      }\n    }\n  }\n}\n```\n\n只需要修改`program`的值为可执行文件路径即可。至此，所有配置均已完成。\n\n最后注意一点，这个配置下插件并不会自动调用编译器编译工程。因此还需要手动编译生成可执行文件。\n\n另外，该插件也可以监听端口，调试进程，有需要的可以自行研究。\n","source":"_posts/vim-debugging-scheme.md","raw":"---\ntitle: Vim Debugging Scheme\ndate: 2020-10-20 10:29:48\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# vim 调试方案\n\n本文介绍在 vim 中使用 vimspector 插件扩展 IDE 式调试功能，获取极致体验。\n\n## 调试\n\n- 为什么需要扩展调试功能？\n\n虽然传统上与 vim 更匹配的调试方案是在命令行中使用 gdb、lldb 等调试器，但这就不得不暂时离开 vim。虽然有诸如 tmux、内置 terminal 等工具可以使得命令行调试变得更加方便，但具有 ui 界面，且就在 vim 中的调试无疑会更加直观。\n\n- vimspector 插件的调试能力\n\n可以查看其[github 主页](https://github.com/puremourning/vimspector)。包括可调试的语言、调试输出的信息、调试的主要界面等等均可以看到。可以说 vimspector 是一个相当专业的调试插件。\n\n## vimspector 安装\n\n可以参考官方提供的安装方式，也可以按照以下笔者推荐的方式安装。\n\n首先，该插件需要被安装在`pack/x/opt`的目录下，如果想使用插件管理器安装，必须将安装目录修改为`xxx/pack/x/opt`。其中`xxx`是前一段的路径，可以不止一级，可以自定义，`x`是一级目录，可以为任意名称。然后在 vim 配置文件中，声明`set packpath= the_path_to_your_pack_directory`，只需要到`pack`的前一级目录即可。然后直接使用包管理器安装即可。至此，插件本身安装完毕。\n\n## vimspector 配置\n\n使用`:VimspectorInstall`来安装调试需要的适配器，如`:VimspectorInstall --enable-c`，具体参数可以在其主页找到。使用`:VimspectorUpdate`更新所有适配器。\n\n安装好所需适配器之后，可以继续配置快捷键。可以使用官方提供的两套快捷键，也可以自定义。\n\n使用官方快捷键可以设置`let g:vimspector_enable_mappings = 'HUMAN'`或者`let g:vimspector_enable_mappings = 'VISUAL_STUDIO'`。\n\n如果要自定义，以下配置仅供参考。\n\n```vim\nnmap <silent><nowait><space>dn <Plug>VimspectorStepOver\nnmap <A-n> <Plug>VimspectorStepOver\nnmap <silent><nowait><space>db <Plug>VimspectorToggleBreakpoint\nnmap <A-b> <Plug>VimspectorToggleBreakpoint\nnmap <silent><nowait><space>ds <Plug>VimspectorContinue\nnmap <silent><nowait><space>dr <Plug>VimspectorRestart\nnmap <silent><nowait><space>dp <Plug>VimspectorPause\nnmap <silent><nowait><space>dt <Plug>VimspectorStop\nnmap <silent><nowait><space>df <Plug>VimspectorAddFunctionBreakpoint\nnmap <silent><nowait><space>dc <Plug>VimspectorToggleConditionalBreakpoint\nnmap <silent><nowait><space>do <Plug>VimspectorStepOut\nnmap <A-o> <Plug>VimspectorStepOut\nnmap <silent><nowait><space>di <Plug>VimspectorStepInto\nnmap <A-i> <Plug>VimspectorStepInto\nnmap <silent><nowait><space>dq <Plug>VimspectorReset<CR>\nnmap <silent><nowait><space>dlc <Plug>VimspectorShowOutput Console<CR>\nnmap <silent><nowait><space>dld <Plug>VimspectorShowOutput stderr<CR>\nnmap <silent><nowait><space>dlo <Plug>VimspectorShowOutput Vimspector-out<CR>\nnmap <silent><nowait><space>dle <Plug>VimspectorShowOutput Vimspector-err<CR>\nnmap <silent><nowait><space>dls <Plug>VimspectorShowOutput server<CR>\nnmap <silent><nowait><space>dlt <Plug>VimspectorShowOutput Telemetry<CR>\nnmap <silent><nowait><space>de :<C-u>VimspectorEval<space>\nnmap <silent><nowait><space>dw :<C-u>VimspectorWatch<space>\nnmap <A-w> :<C-u>VimspectorWatch<space>\n\nlet g:which_key_map1.d = {\n\t\t\t\\ 'name' : '+debug',\n\t\t\t\\ 'e' : 'eval',\n\t\t\t\\ 'w' : 'variable watch',\n\t\t\t\\ 's' : 'start or continue',\n\t\t\t\\ 't' : 'stop',\n\t\t\t\\ 'r' : 'restart',\n\t\t\t\\ 'p' : 'pause',\n\t\t\t\\ 'b' : 'set breakpoint',\n\t\t\t\\ 'c' : 'set condition breakpoint',\n\t\t\t\\ 'f' : 'add function breakpoint',\n\t\t\t\\ 'n' : 'next',\n\t\t\t\\ 'i' : 'step in',\n\t\t\t\\ 'o' : 'step out',\n\t\t\t\\ 'q' : 'quit',\n\t\t\t\\ 'l' :  {\n\t\t\t\\ 'name' : '+switch_output',\n\t\t\t\\ 'c' : 'Console',\n\t\t\t\\ 'd' : 'stderr',\n\t\t\t\\ 'o' : 'Vimspector-out',\n\t\t\t\\ 'e' : 'Vimspector-err',\n\t\t\t\\ 's' : 'server',\n\t\t\t\\ 't' : 'Telemetry',\n\t\t\t\\},\n\t\t\t\\}\n```\n\n注意 vimspector 的一些功能暂不支持 neovim，这一点在主页上有说明。不过并不影响使用。以上配置中这些部分就是在 neovim 中用于切换窗口的命令和快捷键。\n\n```vim\nnmap <silent><nowait><space>dlc <Plug>VimspectorShowOutput Console<CR>\nnmap <silent><nowait><space>dld <Plug>VimspectorShowOutput stderr<CR>\nnmap <silent><nowait><space>dlo <Plug>VimspectorShowOutput Vimspector-out<CR>\nnmap <silent><nowait><space>dle <Plug>VimspectorShowOutput Vimspector-err<CR>\nnmap <silent><nowait><space>dls <Plug>VimspectorShowOutput server<CR>\nnmap <silent><nowait><space>dlt <Plug>VimspectorShowOutput Telemetry<CR>\n```\n\n到此为止，该插件仍不可以使用，还差最后一步。\n\n该插件本身的配置文件有两种，一是`.gadgets.json`，二是`.vimspector.json`。前面安装适配器的过程中已经自动产生了不少配置。关于这些配置文件的具体内容和关系可以自行研究，这里只介绍如何完成最后一步配置。\n\n在工程项目目录下新建`.vimspector.json`文件。copy 插件主页上给出的示例配置。\n\n以 rust 语言为例，给出的示例配置为\n\n```json\n{\n  \"configurations\": {\n    \"launch\": {\n      \"adapter\": \"CodeLLDB\",\n      \"configuration\": {\n        \"request\": \"launch\",\n        \"program\": \"${workspaceRoot}/target/debug/vimspector_test\"\n      }\n    }\n  }\n}\n```\n\n只需要修改`program`的值为可执行文件路径即可。至此，所有配置均已完成。\n\n最后注意一点，这个配置下插件并不会自动调用编译器编译工程。因此还需要手动编译生成可执行文件。\n\n另外，该插件也可以监听端口，调试进程，有需要的可以自行研究。\n","slug":"vim-debugging-scheme","published":1,"updated":"2021-03-23T11:11:18.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmse002jrrizgs62cqpi","content":"<h1 id=\"vim-调试方案\"><a href=\"#vim-调试方案\" class=\"headerlink\" title=\"vim 调试方案\"></a>vim 调试方案</h1><p>本文介绍在 vim 中使用 vimspector 插件扩展 IDE 式调试功能，获取极致体验。</p>\n<h2 id=\"调试\"><a href=\"#调试\" class=\"headerlink\" title=\"调试\"></a>调试</h2><ul>\n<li>为什么需要扩展调试功能？</li>\n</ul>\n<p>虽然传统上与 vim 更匹配的调试方案是在命令行中使用 gdb、lldb 等调试器，但这就不得不暂时离开 vim。虽然有诸如 tmux、内置 terminal 等工具可以使得命令行调试变得更加方便，但具有 ui 界面，且就在 vim 中的调试无疑会更加直观。</p>\n<ul>\n<li>vimspector 插件的调试能力</li>\n</ul>\n<p>可以查看其<a href=\"https://github.com/puremourning/vimspector\">github 主页</a>。包括可调试的语言、调试输出的信息、调试的主要界面等等均可以看到。可以说 vimspector 是一个相当专业的调试插件。</p>\n<h2 id=\"vimspector-安装\"><a href=\"#vimspector-安装\" class=\"headerlink\" title=\"vimspector 安装\"></a>vimspector 安装</h2><p>可以参考官方提供的安装方式，也可以按照以下笔者推荐的方式安装。</p>\n<p>首先，该插件需要被安装在<code>pack/x/opt</code>的目录下，如果想使用插件管理器安装，必须将安装目录修改为<code>xxx/pack/x/opt</code>。其中<code>xxx</code>是前一段的路径，可以不止一级，可以自定义，<code>x</code>是一级目录，可以为任意名称。然后在 vim 配置文件中，声明<code>set packpath= the_path_to_your_pack_directory</code>，只需要到<code>pack</code>的前一级目录即可。然后直接使用包管理器安装即可。至此，插件本身安装完毕。</p>\n<h2 id=\"vimspector-配置\"><a href=\"#vimspector-配置\" class=\"headerlink\" title=\"vimspector 配置\"></a>vimspector 配置</h2><p>使用<code>:VimspectorInstall</code>来安装调试需要的适配器，如<code>:VimspectorInstall --enable-c</code>，具体参数可以在其主页找到。使用<code>:VimspectorUpdate</code>更新所有适配器。</p>\n<p>安装好所需适配器之后，可以继续配置快捷键。可以使用官方提供的两套快捷键，也可以自定义。</p>\n<p>使用官方快捷键可以设置<code>let g:vimspector_enable_mappings = &#39;HUMAN&#39;</code>或者<code>let g:vimspector_enable_mappings = &#39;VISUAL_STUDIO&#39;</code>。</p>\n<p>如果要自定义，以下配置仅供参考。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">nmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dn <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepOver\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">n</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepOver\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>db <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorToggleBreakpoint\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">b</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorToggleBreakpoint\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">ds</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorContinue\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">dr</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorRestart\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dp <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorPause\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dt <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStop\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>df <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorAddFunctionBreakpoint\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dc <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorToggleConditionalBreakpoint\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>do <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepOut\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">o</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepOut\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">di</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepInto\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span>i<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepInto\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dq <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorReset<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlc <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Console<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dld <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput stderr<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlo <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Vimspector<span class=\"token operator\">-</span>out<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dle <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Vimspector<span class=\"token operator\">-</span>err<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dls <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput server<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlt <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Telemetry<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>de <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>VimspectorEval<span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dw <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>VimspectorWatch<span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">w</span><span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>VimspectorWatch<span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">d</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+debug'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'eval'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'w'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'variable watch'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'start or continue'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'stop'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'restart'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'p'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'pause'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'set breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'set condition breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'add function breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'n'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'next'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'i'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'step in'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'step out'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'q'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'quit'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'l'</span> <span class=\"token punctuation\">:</span>  <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+switch_output'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Console'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'d'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'stderr'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Vimspector-out'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Vimspector-err'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'server'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Telemetry'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n\t\t\t\\<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意 vimspector 的一些功能暂不支持 neovim，这一点在主页上有说明。不过并不影响使用。以上配置中这些部分就是在 neovim 中用于切换窗口的命令和快捷键。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">nmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlc <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Console<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dld <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput stderr<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlo <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Vimspector<span class=\"token operator\">-</span>out<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dle <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Vimspector<span class=\"token operator\">-</span>err<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dls <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput server<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlt <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Telemetry<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>到此为止，该插件仍不可以使用，还差最后一步。</p>\n<p>该插件本身的配置文件有两种，一是<code>.gadgets.json</code>，二是<code>.vimspector.json</code>。前面安装适配器的过程中已经自动产生了不少配置。关于这些配置文件的具体内容和关系可以自行研究，这里只介绍如何完成最后一步配置。</p>\n<p>在工程项目目录下新建<code>.vimspector.json</code>文件。copy 插件主页上给出的示例配置。</p>\n<p>以 rust 语言为例，给出的示例配置为</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"configurations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"launch\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token property\">\"adapter\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"CodeLLDB\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"configuration\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token property\">\"request\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"launch\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"program\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"$&#123;workspaceRoot&#125;/target/debug/vimspector_test\"</span>\n      <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>只需要修改<code>program</code>的值为可执行文件路径即可。至此，所有配置均已完成。</p>\n<p>最后注意一点，这个配置下插件并不会自动调用编译器编译工程。因此还需要手动编译生成可执行文件。</p>\n<p>另外，该插件也可以监听端口，调试进程，有需要的可以自行研究。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"vim-调试方案\"><a href=\"#vim-调试方案\" class=\"headerlink\" title=\"vim 调试方案\"></a>vim 调试方案</h1><p>本文介绍在 vim 中使用 vimspector 插件扩展 IDE 式调试功能，获取极致体验。</p>\n<h2 id=\"调试\"><a href=\"#调试\" class=\"headerlink\" title=\"调试\"></a>调试</h2><ul>\n<li>为什么需要扩展调试功能？</li>\n</ul>\n<p>虽然传统上与 vim 更匹配的调试方案是在命令行中使用 gdb、lldb 等调试器，但这就不得不暂时离开 vim。虽然有诸如 tmux、内置 terminal 等工具可以使得命令行调试变得更加方便，但具有 ui 界面，且就在 vim 中的调试无疑会更加直观。</p>\n<ul>\n<li>vimspector 插件的调试能力</li>\n</ul>\n<p>可以查看其<a href=\"https://github.com/puremourning/vimspector\">github 主页</a>。包括可调试的语言、调试输出的信息、调试的主要界面等等均可以看到。可以说 vimspector 是一个相当专业的调试插件。</p>\n<h2 id=\"vimspector-安装\"><a href=\"#vimspector-安装\" class=\"headerlink\" title=\"vimspector 安装\"></a>vimspector 安装</h2><p>可以参考官方提供的安装方式，也可以按照以下笔者推荐的方式安装。</p>\n<p>首先，该插件需要被安装在<code>pack/x/opt</code>的目录下，如果想使用插件管理器安装，必须将安装目录修改为<code>xxx/pack/x/opt</code>。其中<code>xxx</code>是前一段的路径，可以不止一级，可以自定义，<code>x</code>是一级目录，可以为任意名称。然后在 vim 配置文件中，声明<code>set packpath= the_path_to_your_pack_directory</code>，只需要到<code>pack</code>的前一级目录即可。然后直接使用包管理器安装即可。至此，插件本身安装完毕。</p>\n<h2 id=\"vimspector-配置\"><a href=\"#vimspector-配置\" class=\"headerlink\" title=\"vimspector 配置\"></a>vimspector 配置</h2><p>使用<code>:VimspectorInstall</code>来安装调试需要的适配器，如<code>:VimspectorInstall --enable-c</code>，具体参数可以在其主页找到。使用<code>:VimspectorUpdate</code>更新所有适配器。</p>\n<p>安装好所需适配器之后，可以继续配置快捷键。可以使用官方提供的两套快捷键，也可以自定义。</p>\n<p>使用官方快捷键可以设置<code>let g:vimspector_enable_mappings = &#39;HUMAN&#39;</code>或者<code>let g:vimspector_enable_mappings = &#39;VISUAL_STUDIO&#39;</code>。</p>\n<p>如果要自定义，以下配置仅供参考。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">nmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dn <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepOver\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">n</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepOver\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>db <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorToggleBreakpoint\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">b</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorToggleBreakpoint\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">ds</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorContinue\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">dr</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorRestart\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dp <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorPause\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dt <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStop\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>df <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorAddFunctionBreakpoint\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dc <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorToggleConditionalBreakpoint\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>do <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepOut\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">o</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepOut\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">di</span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepInto\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span>i<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorStepInto\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dq <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorReset<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlc <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Console<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dld <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput stderr<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlo <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Vimspector<span class=\"token operator\">-</span>out<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dle <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Vimspector<span class=\"token operator\">-</span>err<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dls <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput server<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlt <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Telemetry<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>de <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>VimspectorEval<span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dw <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>VimspectorWatch<span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">w</span><span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>VimspectorWatch<span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">d</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+debug'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'eval'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'w'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'variable watch'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'start or continue'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'stop'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'restart'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'p'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'pause'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'set breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'set condition breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'add function breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'n'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'next'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'i'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'step in'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'step out'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'q'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'quit'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'l'</span> <span class=\"token punctuation\">:</span>  <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+switch_output'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Console'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'d'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'stderr'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Vimspector-out'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Vimspector-err'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'server'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Telemetry'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n\t\t\t\\<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>注意 vimspector 的一些功能暂不支持 neovim，这一点在主页上有说明。不过并不影响使用。以上配置中这些部分就是在 neovim 中用于切换窗口的命令和快捷键。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">nmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlc <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Console<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dld <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput stderr<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlo <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Vimspector<span class=\"token operator\">-</span>out<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dle <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Vimspector<span class=\"token operator\">-</span>err<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dls <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput server<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>dlt <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span>VimspectorShowOutput Telemetry<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>到此为止，该插件仍不可以使用，还差最后一步。</p>\n<p>该插件本身的配置文件有两种，一是<code>.gadgets.json</code>，二是<code>.vimspector.json</code>。前面安装适配器的过程中已经自动产生了不少配置。关于这些配置文件的具体内容和关系可以自行研究，这里只介绍如何完成最后一步配置。</p>\n<p>在工程项目目录下新建<code>.vimspector.json</code>文件。copy 插件主页上给出的示例配置。</p>\n<p>以 rust 语言为例，给出的示例配置为</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\"><span class=\"token punctuation\">&#123;</span>\n  <span class=\"token property\">\"configurations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token property\">\"launch\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n      <span class=\"token property\">\"adapter\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"CodeLLDB\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"configuration\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token property\">\"request\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"launch\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"program\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"$&#123;workspaceRoot&#125;/target/debug/vimspector_test\"</span>\n      <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span>\n  <span class=\"token punctuation\">&#125;</span>\n<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>只需要修改<code>program</code>的值为可执行文件路径即可。至此，所有配置均已完成。</p>\n<p>最后注意一点，这个配置下插件并不会自动调用编译器编译工程。因此还需要手动编译生成可执行文件。</p>\n<p>另外，该插件也可以监听端口，调试进程，有需要的可以自行研究。</p>\n"},{"title":"Vim File Encoding","date":"2021-04-18T08:10:41.000Z","_content":"\n# Vim 文件编码\n\n本文主要介绍 vim 文件编码，主要解决中文乱码问题。\n\n## 解决方案\n\nvim 默认打开文件的编码为 utf-8，如果是 gbk 编码的文件或者 gb2312 编码的文件，其中文一定会乱码。\n\n首先，设置 vim 打开文件的编码。\n\n在配置文件中写入`set fencs=utf-8,gbk,big5,cp936,gb18030,gb2312,utf-16`。该配置的意义是让 vim 挨个尝试列出的编码，直到不出错，然后将以该编码打开文件。\n\n至此，在文件中看到的中文已经不会乱码。但是一些插件，如 vim-clap 中搜索时显示的中文依旧是乱码的。这是因为本质上这些内容依旧不是 utf-8 格式，而这些插件也不遵从上面的配置。于是需要将文件转换为 utf-8 编码。\n\n使用`:set fenc=utf8`可以将打开的所有缓冲区修改为 utf-8 编码。如果有大量文件需要转换，可以将其绑定至一个快捷键。\n\n```vim\nnmap <silent><nowait> <leader>e :set fenc=utf8<CR>\n```\n\n需要注意的是，如果一开始没有正确打开文件，中文仍处于乱码状态，即使修改编码也是无济于事的。因此为保险起见，不建议直接用 shell 命令给所有文件切换编码，而是在用 vim 编辑时边查看是否乱码，边修改编码。如果文件量很大，可以借助其他靠谱的工具。\n","source":"_posts/vim-file-encoding.md","raw":"---\ntitle: Vim File Encoding\ndate: 2021-04-18 16:10:41\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# Vim 文件编码\n\n本文主要介绍 vim 文件编码，主要解决中文乱码问题。\n\n## 解决方案\n\nvim 默认打开文件的编码为 utf-8，如果是 gbk 编码的文件或者 gb2312 编码的文件，其中文一定会乱码。\n\n首先，设置 vim 打开文件的编码。\n\n在配置文件中写入`set fencs=utf-8,gbk,big5,cp936,gb18030,gb2312,utf-16`。该配置的意义是让 vim 挨个尝试列出的编码，直到不出错，然后将以该编码打开文件。\n\n至此，在文件中看到的中文已经不会乱码。但是一些插件，如 vim-clap 中搜索时显示的中文依旧是乱码的。这是因为本质上这些内容依旧不是 utf-8 格式，而这些插件也不遵从上面的配置。于是需要将文件转换为 utf-8 编码。\n\n使用`:set fenc=utf8`可以将打开的所有缓冲区修改为 utf-8 编码。如果有大量文件需要转换，可以将其绑定至一个快捷键。\n\n```vim\nnmap <silent><nowait> <leader>e :set fenc=utf8<CR>\n```\n\n需要注意的是，如果一开始没有正确打开文件，中文仍处于乱码状态，即使修改编码也是无济于事的。因此为保险起见，不建议直接用 shell 命令给所有文件切换编码，而是在用 vim 编辑时边查看是否乱码，边修改编码。如果文件量很大，可以借助其他靠谱的工具。\n","slug":"vim-file-encoding","published":1,"updated":"2021-04-18T08:21:20.464Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmsf002mrriz4qgeg8ce","content":"<h1 id=\"Vim-文件编码\"><a href=\"#Vim-文件编码\" class=\"headerlink\" title=\"Vim 文件编码\"></a>Vim 文件编码</h1><p>本文主要介绍 vim 文件编码，主要解决中文乱码问题。</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>vim 默认打开文件的编码为 utf-8，如果是 gbk 编码的文件或者 gb2312 编码的文件，其中文一定会乱码。</p>\n<p>首先，设置 vim 打开文件的编码。</p>\n<p>在配置文件中写入<code>set fencs=utf-8,gbk,big5,cp936,gb18030,gb2312,utf-16</code>。该配置的意义是让 vim 挨个尝试列出的编码，直到不出错，然后将以该编码打开文件。</p>\n<p>至此，在文件中看到的中文已经不会乱码。但是一些插件，如 vim-clap 中搜索时显示的中文依旧是乱码的。这是因为本质上这些内容依旧不是 utf-8 格式，而这些插件也不遵从上面的配置。于是需要将文件转换为 utf-8 编码。</p>\n<p>使用<code>:set fenc=utf8</code>可以将打开的所有缓冲区修改为 utf-8 编码。如果有大量文件需要转换，可以将其绑定至一个快捷键。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">nmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">e</span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">set</span> <span class=\"token builtin\">fenc</span><span class=\"token operator\">=</span>utf8<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>需要注意的是，如果一开始没有正确打开文件，中文仍处于乱码状态，即使修改编码也是无济于事的。因此为保险起见，不建议直接用 shell 命令给所有文件切换编码，而是在用 vim 编辑时边查看是否乱码，边修改编码。如果文件量很大，可以借助其他靠谱的工具。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"Vim-文件编码\"><a href=\"#Vim-文件编码\" class=\"headerlink\" title=\"Vim 文件编码\"></a>Vim 文件编码</h1><p>本文主要介绍 vim 文件编码，主要解决中文乱码问题。</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>vim 默认打开文件的编码为 utf-8，如果是 gbk 编码的文件或者 gb2312 编码的文件，其中文一定会乱码。</p>\n<p>首先，设置 vim 打开文件的编码。</p>\n<p>在配置文件中写入<code>set fencs=utf-8,gbk,big5,cp936,gb18030,gb2312,utf-16</code>。该配置的意义是让 vim 挨个尝试列出的编码，直到不出错，然后将以该编码打开文件。</p>\n<p>至此，在文件中看到的中文已经不会乱码。但是一些插件，如 vim-clap 中搜索时显示的中文依旧是乱码的。这是因为本质上这些内容依旧不是 utf-8 格式，而这些插件也不遵从上面的配置。于是需要将文件转换为 utf-8 编码。</p>\n<p>使用<code>:set fenc=utf8</code>可以将打开的所有缓冲区修改为 utf-8 编码。如果有大量文件需要转换，可以将其绑定至一个快捷键。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">nmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">e</span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">set</span> <span class=\"token builtin\">fenc</span><span class=\"token operator\">=</span>utf8<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>需要注意的是，如果一开始没有正确打开文件，中文仍处于乱码状态，即使修改编码也是无济于事的。因此为保险起见，不建议直接用 shell 命令给所有文件切换编码，而是在用 vim 编辑时边查看是否乱码，边修改编码。如果文件量很大，可以借助其他靠谱的工具。</p>\n"},{"title":"Vim File Tree","date":"2020-10-19T04:00:04.000Z","_content":"\n# Vim 文件树\n\n本文介绍 nerdtree 替代品，全新 vim filetree 解决方案。\n\n## coc-explorer\n\ncoc-explorer 是一个 coc 插件。运行于 coc.nvim 提供的插件平台上。相比于nerdtree，不说性能问题，直观上就将提供更多的文件信息以及更流畅的体验。同时也可以配置icons。\n\n关于coc-explorer的效果图及具体配置，请见其[github主页](https://github.com/weirongxu/coc-explorer)。\n\n嫌麻烦的话，直接`CocInstall coc-explorer`。再设置一下快捷键等就可以直接使用了。以下附上我的配置。\n\n```vim\n\" coc-explorer\nnnoremap <leader>p :CocCommand explorer<CR>\nlet which_key_map2.p ='file tree'\nfunction! s:coc_list_current_dir(args)\n\tlet node_info = CocAction('runCommand', 'explorer.getNodeInfo', 0)\n\texecute 'cd ' . fnamemodify(node_info['fullpath'], ':h')\n\texecute 'CocList ' . a:args\nendfunction\n\nfunction! s:init_explorer(bufnr)\n\tcall setbufvar(a:bufnr, '&winblend', 50)\nendfunction\n\nfunction! s:enter_explorer()\n\tif !exists('b:has_enter_coc_explorer') && &filetype == 'coc-explorer'\n\t\t\" more mappings\n\t\tnmap <buffer> <Leader>fg :call <SID>coc_list_current_dir('-I grep')<CR>\n\t\tnmap <buffer> <Leader>fG :call <SID>coc_list_current_dir('-I grep -regex')<CR>\n\t\tnmap <buffer> <C-p> :call <SID>coc_list_current_dir('files')<CR>\n\t\tlet b:has_enter_coc_explorer = v:true\n\tendif\n\t\" statusline\n\tsetl statusline=coc-explorer\nendfunction\n\naugroup CocExplorerCustom\n\tautocmd!\n\tautocmd BufEnter call <SID>enter_explorer()\naugroup END\n\n\" hook for explorer window initialized\nfunction! CocExplorerInited(filetype, bufnr)\n\t\" transparent\n\tcall setbufvar(a:bufnr, '&winblend', 10)\nendfunction\n```\n","source":"_posts/vim-file-tree.md","raw":"---\ntitle: Vim File Tree\ndate: 2020-10-19 12:00:04\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# Vim 文件树\n\n本文介绍 nerdtree 替代品，全新 vim filetree 解决方案。\n\n## coc-explorer\n\ncoc-explorer 是一个 coc 插件。运行于 coc.nvim 提供的插件平台上。相比于nerdtree，不说性能问题，直观上就将提供更多的文件信息以及更流畅的体验。同时也可以配置icons。\n\n关于coc-explorer的效果图及具体配置，请见其[github主页](https://github.com/weirongxu/coc-explorer)。\n\n嫌麻烦的话，直接`CocInstall coc-explorer`。再设置一下快捷键等就可以直接使用了。以下附上我的配置。\n\n```vim\n\" coc-explorer\nnnoremap <leader>p :CocCommand explorer<CR>\nlet which_key_map2.p ='file tree'\nfunction! s:coc_list_current_dir(args)\n\tlet node_info = CocAction('runCommand', 'explorer.getNodeInfo', 0)\n\texecute 'cd ' . fnamemodify(node_info['fullpath'], ':h')\n\texecute 'CocList ' . a:args\nendfunction\n\nfunction! s:init_explorer(bufnr)\n\tcall setbufvar(a:bufnr, '&winblend', 50)\nendfunction\n\nfunction! s:enter_explorer()\n\tif !exists('b:has_enter_coc_explorer') && &filetype == 'coc-explorer'\n\t\t\" more mappings\n\t\tnmap <buffer> <Leader>fg :call <SID>coc_list_current_dir('-I grep')<CR>\n\t\tnmap <buffer> <Leader>fG :call <SID>coc_list_current_dir('-I grep -regex')<CR>\n\t\tnmap <buffer> <C-p> :call <SID>coc_list_current_dir('files')<CR>\n\t\tlet b:has_enter_coc_explorer = v:true\n\tendif\n\t\" statusline\n\tsetl statusline=coc-explorer\nendfunction\n\naugroup CocExplorerCustom\n\tautocmd!\n\tautocmd BufEnter call <SID>enter_explorer()\naugroup END\n\n\" hook for explorer window initialized\nfunction! CocExplorerInited(filetype, bufnr)\n\t\" transparent\n\tcall setbufvar(a:bufnr, '&winblend', 10)\nendfunction\n```\n","slug":"vim-file-tree","published":1,"updated":"2021-03-23T11:11:18.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmsh002qrrizanfj13lq","content":"<h1 id=\"Vim-文件树\"><a href=\"#Vim-文件树\" class=\"headerlink\" title=\"Vim 文件树\"></a>Vim 文件树</h1><p>本文介绍 nerdtree 替代品，全新 vim filetree 解决方案。</p>\n<h2 id=\"coc-explorer\"><a href=\"#coc-explorer\" class=\"headerlink\" title=\"coc-explorer\"></a>coc-explorer</h2><p>coc-explorer 是一个 coc 插件。运行于 coc.nvim 提供的插件平台上。相比于nerdtree，不说性能问题，直观上就将提供更多的文件信息以及更流畅的体验。同时也可以配置icons。</p>\n<p>关于coc-explorer的效果图及具体配置，请见其<a href=\"https://github.com/weirongxu/coc-explorer\">github主页</a>。</p>\n<p>嫌麻烦的话，直接<code>CocInstall coc-explorer</code>。再设置一下快捷键等就可以直接使用了。以下附上我的配置。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" coc-explorer</span>\nnnoremap <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">p</span> <span class=\"token punctuation\">:</span>CocCommand explorer<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n<span class=\"token keyword\">let</span> which_key_map2<span class=\"token operator\">.</span><span class=\"token keyword\">p</span> <span class=\"token operator\">=</span><span class=\"token string\">'file tree'</span>\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> s<span class=\"token punctuation\">:</span><span class=\"token function\">coc_list_current_dir</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">args</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">let</span> node_info <span class=\"token operator\">=</span> <span class=\"token function\">CocAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'runCommand'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'explorer.getNodeInfo'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\texecute <span class=\"token string\">'cd '</span> <span class=\"token operator\">.</span> <span class=\"token function\">fnamemodify</span><span class=\"token punctuation\">(</span>node_info<span class=\"token punctuation\">[</span><span class=\"token string\">'fullpath'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">':h'</span><span class=\"token punctuation\">)</span>\n\texecute <span class=\"token string\">'CocList '</span> <span class=\"token operator\">.</span> a<span class=\"token punctuation\">:</span><span class=\"token keyword\">args</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> s<span class=\"token punctuation\">:</span><span class=\"token function\">init_explorer</span><span class=\"token punctuation\">(</span>bufnr<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">call</span> <span class=\"token function\">setbufvar</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">:</span>bufnr<span class=\"token punctuation\">,</span> <span class=\"token string\">'&amp;winblend'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> s<span class=\"token punctuation\">:</span><span class=\"token function\">enter_explorer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token operator\">!</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token string\">'b:has_enter_coc_explorer'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> &amp;<span class=\"token keyword\">filetype</span> <span class=\"token operator\">==</span> <span class=\"token string\">'coc-explorer'</span>\n\t\t<span class=\"token comment\">\" more mappings</span>\n\t\tnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">buffer</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Leader<span class=\"token operator\">></span>fg <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span> <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">coc_list_current_dir</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-I grep'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\t\tnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">buffer</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Leader<span class=\"token operator\">></span>fG <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span> <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">coc_list_current_dir</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-I grep -regex'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\t\tnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">buffer</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">p</span><span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span> <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">coc_list_current_dir</span><span class=\"token punctuation\">(</span><span class=\"token string\">'files'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\t\t<span class=\"token keyword\">let</span> <span class=\"token keyword\">b</span><span class=\"token punctuation\">:</span>has_enter_coc_explorer <span class=\"token operator\">=</span> v<span class=\"token punctuation\">:</span>true\n\t<span class=\"token keyword\">endif</span>\n\t<span class=\"token comment\">\" statusline</span>\n\t<span class=\"token keyword\">setl</span> <span class=\"token builtin\">statusline</span><span class=\"token operator\">=</span>coc<span class=\"token operator\">-</span>explorer\n<span class=\"token keyword\">endfunction</span>\n\naugroup CocExplorerCustom\n\t<span class=\"token builtin\">autocmd</span><span class=\"token operator\">!</span>\n\t<span class=\"token builtin\">autocmd</span> BufEnter <span class=\"token keyword\">call</span> <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">enter_explorer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\naugroup END\n\n<span class=\"token comment\">\" hook for explorer window initialized</span>\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> <span class=\"token function\">CocExplorerInited</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">filetype</span><span class=\"token punctuation\">,</span> bufnr<span class=\"token punctuation\">)</span>\n\t<span class=\"token comment\">\" transparent</span>\n\t<span class=\"token keyword\">call</span> <span class=\"token function\">setbufvar</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">:</span>bufnr<span class=\"token punctuation\">,</span> <span class=\"token string\">'&amp;winblend'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">endfunction</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"Vim-文件树\"><a href=\"#Vim-文件树\" class=\"headerlink\" title=\"Vim 文件树\"></a>Vim 文件树</h1><p>本文介绍 nerdtree 替代品，全新 vim filetree 解决方案。</p>\n<h2 id=\"coc-explorer\"><a href=\"#coc-explorer\" class=\"headerlink\" title=\"coc-explorer\"></a>coc-explorer</h2><p>coc-explorer 是一个 coc 插件。运行于 coc.nvim 提供的插件平台上。相比于nerdtree，不说性能问题，直观上就将提供更多的文件信息以及更流畅的体验。同时也可以配置icons。</p>\n<p>关于coc-explorer的效果图及具体配置，请见其<a href=\"https://github.com/weirongxu/coc-explorer\">github主页</a>。</p>\n<p>嫌麻烦的话，直接<code>CocInstall coc-explorer</code>。再设置一下快捷键等就可以直接使用了。以下附上我的配置。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" coc-explorer</span>\nnnoremap <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span><span class=\"token keyword\">p</span> <span class=\"token punctuation\">:</span>CocCommand explorer<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n<span class=\"token keyword\">let</span> which_key_map2<span class=\"token operator\">.</span><span class=\"token keyword\">p</span> <span class=\"token operator\">=</span><span class=\"token string\">'file tree'</span>\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> s<span class=\"token punctuation\">:</span><span class=\"token function\">coc_list_current_dir</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">args</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">let</span> node_info <span class=\"token operator\">=</span> <span class=\"token function\">CocAction</span><span class=\"token punctuation\">(</span><span class=\"token string\">'runCommand'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'explorer.getNodeInfo'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\texecute <span class=\"token string\">'cd '</span> <span class=\"token operator\">.</span> <span class=\"token function\">fnamemodify</span><span class=\"token punctuation\">(</span>node_info<span class=\"token punctuation\">[</span><span class=\"token string\">'fullpath'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">':h'</span><span class=\"token punctuation\">)</span>\n\texecute <span class=\"token string\">'CocList '</span> <span class=\"token operator\">.</span> a<span class=\"token punctuation\">:</span><span class=\"token keyword\">args</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> s<span class=\"token punctuation\">:</span><span class=\"token function\">init_explorer</span><span class=\"token punctuation\">(</span>bufnr<span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">call</span> <span class=\"token function\">setbufvar</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">:</span>bufnr<span class=\"token punctuation\">,</span> <span class=\"token string\">'&amp;winblend'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> s<span class=\"token punctuation\">:</span><span class=\"token function\">enter_explorer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token operator\">!</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token string\">'b:has_enter_coc_explorer'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> &amp;<span class=\"token keyword\">filetype</span> <span class=\"token operator\">==</span> <span class=\"token string\">'coc-explorer'</span>\n\t\t<span class=\"token comment\">\" more mappings</span>\n\t\tnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">buffer</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Leader<span class=\"token operator\">></span>fg <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span> <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">coc_list_current_dir</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-I grep'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\t\tnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">buffer</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Leader<span class=\"token operator\">></span>fG <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span> <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">coc_list_current_dir</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-I grep -regex'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\t\tnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">buffer</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">p</span><span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">call</span> <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">coc_list_current_dir</span><span class=\"token punctuation\">(</span><span class=\"token string\">'files'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\t\t<span class=\"token keyword\">let</span> <span class=\"token keyword\">b</span><span class=\"token punctuation\">:</span>has_enter_coc_explorer <span class=\"token operator\">=</span> v<span class=\"token punctuation\">:</span>true\n\t<span class=\"token keyword\">endif</span>\n\t<span class=\"token comment\">\" statusline</span>\n\t<span class=\"token keyword\">setl</span> <span class=\"token builtin\">statusline</span><span class=\"token operator\">=</span>coc<span class=\"token operator\">-</span>explorer\n<span class=\"token keyword\">endfunction</span>\n\naugroup CocExplorerCustom\n\t<span class=\"token builtin\">autocmd</span><span class=\"token operator\">!</span>\n\t<span class=\"token builtin\">autocmd</span> BufEnter <span class=\"token keyword\">call</span> <span class=\"token operator\">&lt;</span>SID<span class=\"token operator\">></span><span class=\"token function\">enter_explorer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\naugroup END\n\n<span class=\"token comment\">\" hook for explorer window initialized</span>\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> <span class=\"token function\">CocExplorerInited</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">filetype</span><span class=\"token punctuation\">,</span> bufnr<span class=\"token punctuation\">)</span>\n\t<span class=\"token comment\">\" transparent</span>\n\t<span class=\"token keyword\">call</span> <span class=\"token function\">setbufvar</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">:</span>bufnr<span class=\"token punctuation\">,</span> <span class=\"token string\">'&amp;winblend'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">endfunction</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n"},{"title":"Vim Fuzzy Search Plugin","date":"2021-03-23T08:48:00.000Z","_content":"\n# vim 模糊搜索\n\n本文主要介绍 vim 高性能模糊查找插件 vim-clap。另外也推荐尝试 coc.nvim 自带的 coc list。\n\n## 插件功能\n\n模糊查找的内容包括编辑文件历史、文件内容、mark、tags、vim 主题、buffers、windows、quickfix 等等。\n\n这些功能在一些 IDE 与 vscode 等编辑器中有直接的集成。而在 vim 中，需要自己扩展。\n\nvim-clap 的效果图可以查看其[github 主页](https://github.com/liuchengxu/vim-clap)。\n\n## vim-clap\n\nvim-clap 是一款后端用 rust 语言开发的模糊查找插件，因此速度非常快。\n\n### vim-clap 安装\n\n首先，最好先配置好 rust 语言环境（不配应该也可以）。使用 rustup 安装 rust 语言编译链及配套工具。这一部分可以参考 rust 官方文档，此处不做介绍。提示一下，官方给的安装 rustup 的链接并没有被墙，无需翻墙。\n\n安装好之后，如果嫌速度慢，可以换上中科大的源。网上教程很多，此处不再介绍。\n\n如果你已经完成了上述所有步骤，则可以按照文档给出的 vim-plug 配置安装插件。如果你没有完成上述步骤，使用`Plug 'liuchengxu/vim-clap', { 'do': { -> clap#installer#force_download() } }`来安装你的插件。vim-plug 将在下载好插件之后继续编译或者下载其 rust 依赖。\n\n### vim-clap 配置\n\n该插件的默认配置已经很完善，你完全可以直接使用。\n\n该插件的默认快捷键在官方文档中有介绍。其命令也很简单，只需要`:Clap xxx`，`xxx`表示你想要搜索的内容。可选的内容在文档中也已经列出。\n\n最后给出笔者的快捷键配置方案，仅供参考。\n\n```vim\n\" vim-clap\nnnoremap <silent><nowait> <space>op  :<C-u>Clap<CR>\nnnoremap <silent><nowait> <space>ob  :<C-u>Clap buffers<CR>\nnnoremap <silent><nowait> <space>oc  :<C-u>Clap command<CR>\nnnoremap <silent><nowait> <space>oh  :<C-u>Clap history<CR>\nnnoremap <silent><nowait> <space>of  :<C-u>Clap files ++finder=rg --ignore --hidden --files<CR>\nnnoremap <silent><nowait> <space>oq  :<C-u>Clap quickfix<CR>\nnnoremap <silent><nowait> <space>oj  :<C-u>Clap jumps<CR>\nnnoremap <silent><nowait> <space>om  :<C-u>Clap marks<CR>\nnnoremap <silent><nowait> <space>ow  :<C-u>Clap windows<CR>\nnnoremap <silent><nowait> <space>ot  :<C-u>Clap tags<CR>\nnnoremap <silent><nowait> <space>os  :<C-u>Clap colors<CR>\nnnoremap <silent><nowait> <space>og :<C-u>Clap grep2<CR>\n\nlet g:which_key_map1.o = {\n\t\\ 'name' : '+clap',\n\t\\ 'p' : 'clap',\n\t\\ 'b' : 'buffers',\n\t\\ 'c' : 'command',\n\t\\ 'h' : 'file history',\n\t\\ 'f' : 'search file',\n\t\\ 'q' : 'quickfix list',\n\t\\ 'j' : 'jumps',\n\t\\ 'm' : 'marks',\n\t\\ 'w' : 'windows',\n\t\\ 't' : 'tags',\n\t\\ 's' : 'colors',\n\t\\ 'g' : 'find word',\n\t\\ }\n```\n\n## coc list\n\ncoc list 是 coc.nvim 自带的模糊查找功能模块。它不仅可以用于控制补全源、lsp 等的开关，coc 插件的调用，也具有部分模糊查找的功能，不过功能暂时还没有那么强大，并不支持那么多内容的查找。有兴趣的可以自行研究。\n","source":"_posts/vim-fuzzy-search-plugin.md","raw":"---\ntitle: Vim Fuzzy Search Plugin\ndate: 2021-03-23 16:48:00\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# vim 模糊搜索\n\n本文主要介绍 vim 高性能模糊查找插件 vim-clap。另外也推荐尝试 coc.nvim 自带的 coc list。\n\n## 插件功能\n\n模糊查找的内容包括编辑文件历史、文件内容、mark、tags、vim 主题、buffers、windows、quickfix 等等。\n\n这些功能在一些 IDE 与 vscode 等编辑器中有直接的集成。而在 vim 中，需要自己扩展。\n\nvim-clap 的效果图可以查看其[github 主页](https://github.com/liuchengxu/vim-clap)。\n\n## vim-clap\n\nvim-clap 是一款后端用 rust 语言开发的模糊查找插件，因此速度非常快。\n\n### vim-clap 安装\n\n首先，最好先配置好 rust 语言环境（不配应该也可以）。使用 rustup 安装 rust 语言编译链及配套工具。这一部分可以参考 rust 官方文档，此处不做介绍。提示一下，官方给的安装 rustup 的链接并没有被墙，无需翻墙。\n\n安装好之后，如果嫌速度慢，可以换上中科大的源。网上教程很多，此处不再介绍。\n\n如果你已经完成了上述所有步骤，则可以按照文档给出的 vim-plug 配置安装插件。如果你没有完成上述步骤，使用`Plug 'liuchengxu/vim-clap', { 'do': { -> clap#installer#force_download() } }`来安装你的插件。vim-plug 将在下载好插件之后继续编译或者下载其 rust 依赖。\n\n### vim-clap 配置\n\n该插件的默认配置已经很完善，你完全可以直接使用。\n\n该插件的默认快捷键在官方文档中有介绍。其命令也很简单，只需要`:Clap xxx`，`xxx`表示你想要搜索的内容。可选的内容在文档中也已经列出。\n\n最后给出笔者的快捷键配置方案，仅供参考。\n\n```vim\n\" vim-clap\nnnoremap <silent><nowait> <space>op  :<C-u>Clap<CR>\nnnoremap <silent><nowait> <space>ob  :<C-u>Clap buffers<CR>\nnnoremap <silent><nowait> <space>oc  :<C-u>Clap command<CR>\nnnoremap <silent><nowait> <space>oh  :<C-u>Clap history<CR>\nnnoremap <silent><nowait> <space>of  :<C-u>Clap files ++finder=rg --ignore --hidden --files<CR>\nnnoremap <silent><nowait> <space>oq  :<C-u>Clap quickfix<CR>\nnnoremap <silent><nowait> <space>oj  :<C-u>Clap jumps<CR>\nnnoremap <silent><nowait> <space>om  :<C-u>Clap marks<CR>\nnnoremap <silent><nowait> <space>ow  :<C-u>Clap windows<CR>\nnnoremap <silent><nowait> <space>ot  :<C-u>Clap tags<CR>\nnnoremap <silent><nowait> <space>os  :<C-u>Clap colors<CR>\nnnoremap <silent><nowait> <space>og :<C-u>Clap grep2<CR>\n\nlet g:which_key_map1.o = {\n\t\\ 'name' : '+clap',\n\t\\ 'p' : 'clap',\n\t\\ 'b' : 'buffers',\n\t\\ 'c' : 'command',\n\t\\ 'h' : 'file history',\n\t\\ 'f' : 'search file',\n\t\\ 'q' : 'quickfix list',\n\t\\ 'j' : 'jumps',\n\t\\ 'm' : 'marks',\n\t\\ 'w' : 'windows',\n\t\\ 't' : 'tags',\n\t\\ 's' : 'colors',\n\t\\ 'g' : 'find word',\n\t\\ }\n```\n\n## coc list\n\ncoc list 是 coc.nvim 自带的模糊查找功能模块。它不仅可以用于控制补全源、lsp 等的开关，coc 插件的调用，也具有部分模糊查找的功能，不过功能暂时还没有那么强大，并不支持那么多内容的查找。有兴趣的可以自行研究。\n","slug":"vim-fuzzy-search-plugin","published":1,"updated":"2021-03-23T11:59:51.648Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmsj002trrizf2m2aah6","content":"<h1 id=\"vim-模糊搜索\"><a href=\"#vim-模糊搜索\" class=\"headerlink\" title=\"vim 模糊搜索\"></a>vim 模糊搜索</h1><p>本文主要介绍 vim 高性能模糊查找插件 vim-clap。另外也推荐尝试 coc.nvim 自带的 coc list。</p>\n<h2 id=\"插件功能\"><a href=\"#插件功能\" class=\"headerlink\" title=\"插件功能\"></a>插件功能</h2><p>模糊查找的内容包括编辑文件历史、文件内容、mark、tags、vim 主题、buffers、windows、quickfix 等等。</p>\n<p>这些功能在一些 IDE 与 vscode 等编辑器中有直接的集成。而在 vim 中，需要自己扩展。</p>\n<p>vim-clap 的效果图可以查看其<a href=\"https://github.com/liuchengxu/vim-clap\">github 主页</a>。</p>\n<h2 id=\"vim-clap\"><a href=\"#vim-clap\" class=\"headerlink\" title=\"vim-clap\"></a>vim-clap</h2><p>vim-clap 是一款后端用 rust 语言开发的模糊查找插件，因此速度非常快。</p>\n<h3 id=\"vim-clap-安装\"><a href=\"#vim-clap-安装\" class=\"headerlink\" title=\"vim-clap 安装\"></a>vim-clap 安装</h3><p>首先，最好先配置好 rust 语言环境（不配应该也可以）。使用 rustup 安装 rust 语言编译链及配套工具。这一部分可以参考 rust 官方文档，此处不做介绍。提示一下，官方给的安装 rustup 的链接并没有被墙，无需翻墙。</p>\n<p>安装好之后，如果嫌速度慢，可以换上中科大的源。网上教程很多，此处不再介绍。</p>\n<p>如果你已经完成了上述所有步骤，则可以按照文档给出的 vim-plug 配置安装插件。如果你没有完成上述步骤，使用<code>Plug &#39;liuchengxu/vim-clap&#39;, &#123; &#39;do&#39;: &#123; -&gt; clap#installer#force_download() &#125; &#125;</code>来安装你的插件。vim-plug 将在下载好插件之后继续编译或者下载其 rust 依赖。</p>\n<h3 id=\"vim-clap-配置\"><a href=\"#vim-clap-配置\" class=\"headerlink\" title=\"vim-clap 配置\"></a>vim-clap 配置</h3><p>该插件的默认配置已经很完善，你完全可以直接使用。</p>\n<p>该插件的默认快捷键在官方文档中有介绍。其命令也很简单，只需要<code>:Clap xxx</code>，<code>xxx</code>表示你想要搜索的内容。可选的内容在文档中也已经列出。</p>\n<p>最后给出笔者的快捷键配置方案，仅供参考。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" vim-clap</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>op  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>ob  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">buffers</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>oc  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap command<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>oh  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">history</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>of  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">files</span> <span class=\"token operator\">+</span><span class=\"token operator\">+</span>finder<span class=\"token operator\">=</span>rg <span class=\"token operator\">-</span><span class=\"token operator\">-</span>ignore <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token builtin\">hidden</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token keyword\">files</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>oq  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap quickfix<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>oj  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">jumps</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>om  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">marks</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>ow  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap windows<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>ot  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">tags</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>os  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap colors<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>og <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap grep2<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">o</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+clap'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'p'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'clap'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'buffers'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'command'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'h'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'file history'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'search file'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'q'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'quickfix list'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'j'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'jumps'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'m'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'marks'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'w'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'windows'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'tags'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'colors'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'g'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'find word'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"coc-list\"><a href=\"#coc-list\" class=\"headerlink\" title=\"coc list\"></a>coc list</h2><p>coc list 是 coc.nvim 自带的模糊查找功能模块。它不仅可以用于控制补全源、lsp 等的开关，coc 插件的调用，也具有部分模糊查找的功能，不过功能暂时还没有那么强大，并不支持那么多内容的查找。有兴趣的可以自行研究。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"vim-模糊搜索\"><a href=\"#vim-模糊搜索\" class=\"headerlink\" title=\"vim 模糊搜索\"></a>vim 模糊搜索</h1><p>本文主要介绍 vim 高性能模糊查找插件 vim-clap。另外也推荐尝试 coc.nvim 自带的 coc list。</p>\n<h2 id=\"插件功能\"><a href=\"#插件功能\" class=\"headerlink\" title=\"插件功能\"></a>插件功能</h2><p>模糊查找的内容包括编辑文件历史、文件内容、mark、tags、vim 主题、buffers、windows、quickfix 等等。</p>\n<p>这些功能在一些 IDE 与 vscode 等编辑器中有直接的集成。而在 vim 中，需要自己扩展。</p>\n<p>vim-clap 的效果图可以查看其<a href=\"https://github.com/liuchengxu/vim-clap\">github 主页</a>。</p>\n<h2 id=\"vim-clap\"><a href=\"#vim-clap\" class=\"headerlink\" title=\"vim-clap\"></a>vim-clap</h2><p>vim-clap 是一款后端用 rust 语言开发的模糊查找插件，因此速度非常快。</p>\n<h3 id=\"vim-clap-安装\"><a href=\"#vim-clap-安装\" class=\"headerlink\" title=\"vim-clap 安装\"></a>vim-clap 安装</h3><p>首先，最好先配置好 rust 语言环境（不配应该也可以）。使用 rustup 安装 rust 语言编译链及配套工具。这一部分可以参考 rust 官方文档，此处不做介绍。提示一下，官方给的安装 rustup 的链接并没有被墙，无需翻墙。</p>\n<p>安装好之后，如果嫌速度慢，可以换上中科大的源。网上教程很多，此处不再介绍。</p>\n<p>如果你已经完成了上述所有步骤，则可以按照文档给出的 vim-plug 配置安装插件。如果你没有完成上述步骤，使用<code>Plug &#39;liuchengxu/vim-clap&#39;, &#123; &#39;do&#39;: &#123; -&gt; clap#installer#force_download() &#125; &#125;</code>来安装你的插件。vim-plug 将在下载好插件之后继续编译或者下载其 rust 依赖。</p>\n<h3 id=\"vim-clap-配置\"><a href=\"#vim-clap-配置\" class=\"headerlink\" title=\"vim-clap 配置\"></a>vim-clap 配置</h3><p>该插件的默认配置已经很完善，你完全可以直接使用。</p>\n<p>该插件的默认快捷键在官方文档中有介绍。其命令也很简单，只需要<code>:Clap xxx</code>，<code>xxx</code>表示你想要搜索的内容。可选的内容在文档中也已经列出。</p>\n<p>最后给出笔者的快捷键配置方案，仅供参考。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" vim-clap</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>op  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>ob  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">buffers</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>oc  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap command<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>oh  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">history</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>of  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">files</span> <span class=\"token operator\">+</span><span class=\"token operator\">+</span>finder<span class=\"token operator\">=</span>rg <span class=\"token operator\">-</span><span class=\"token operator\">-</span>ignore <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token builtin\">hidden</span> <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token keyword\">files</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>oq  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap quickfix<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>oj  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">jumps</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>om  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">marks</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>ow  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap windows<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>ot  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap <span class=\"token keyword\">tags</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>os  <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap colors<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>og <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Clap grep2<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">o</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+clap'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'p'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'clap'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'buffers'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'command'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'h'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'file history'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'search file'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'q'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'quickfix list'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'j'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'jumps'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'m'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'marks'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'w'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'windows'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'tags'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'colors'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'g'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'find word'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"coc-list\"><a href=\"#coc-list\" class=\"headerlink\" title=\"coc list\"></a>coc list</h2><p>coc list 是 coc.nvim 自带的模糊查找功能模块。它不仅可以用于控制补全源、lsp 等的开关，coc 插件的调用，也具有部分模糊查找的功能，不过功能暂时还没有那么强大，并不支持那么多内容的查找。有兴趣的可以自行研究。</p>\n"},{"title":"Choose vim to edit markdown and latex files","date":"2020-08-04T04:41:30.000Z","_content":"\n# 使用 vim 编写 markdown 和 latex\n\n## 前言\n\n### 主要配置\n\n- 操作系统：arch linux\n- 编辑器：neovim（coc-actions 仅支持 neovim），如果使用 vim，请换用另外的补全插件\n- 预览：markdown 使用 typora，latex 用 vimtex 调用 MuPDF\n\n### 优缺点\n\n在使用 vim 之前，曾尝试了两种方案，一是 vscode + vim，配置简单，功能都还不错，问题是自动输入法切换延迟有点长，甚至使用方向键都有点卡，二是 jetbrains 系列的 ide，windows 下用来码字是体验最好的（linux 下对中文输入法不友好），但资源消耗太多，且预览不是很理想\n\n下面是这套方案的优缺点\n\n- linux 下 vim 的输入法切换体验远远好于 windows（笔者未使用 mac os，不清楚情况）\n- windows 下使用 texlive 安装 latex 相关依赖，编译 latex 文档时出现错误，暂时没能修复，linux 下比较稳定\n- neovim 以及 vim 比 vscode + vim 插件更流畅\n- 支持 latex 即时编译，缺点是无法正反向搜索，这点在 vscode 中是支持的\n- typora 对 markdown 渲染的支持比 vim 以及 vscode 的相关插件好得多，比如支持本地 mp4 视频插入等，缺点是无法正反向搜索\n\n### 注意事项\n\n- 以下步骤全靠回忆，不会有错，但可能有漏，请小心操作，避免掉坑，欢迎留言\n- 由于网页的关系，直接从本文复制的内容可能存在非法字符，复制粘贴后应当检查一下\n- arch linux 可能帮你避开许多坑，如果想了解并使用 arch，可参考 arch wiki 安装教程，若水平有限，可以在网上搜索视频安装教程，还不行的话直接装 manjaro 吧\n- 装好下面提到的软件时注意检查是否可以直接在终端调用\n\n## vim 简单配置\n\n### vim-plug\n\n[github 地址](https://github.com/junegunn/vim-plug)\n\n作者提供的安装方式应该是装不上的，似乎是这个链接本身有问题，不是 GFW 的锅\n\n#### 安装\n\n把项目克隆到本地，将项目中的 plug.vim 放到`~/.local/share/nvim/site/autoload`目录下，如果你使用 vim，可以放到`~/.vim/autoload`目录下\n\n#### 使用\n\n编辑`~/.config/nvim/init.vim`\n\n一个`Plug`对应一个插件，如果你和我一样只是想用 vim 编辑 markdown 和 latex（不包括 markdown 预览），那就直接 copy 吧（注意可以更换第一行`begin`后插件存放的路径）\n\n插件依次为自动补全、文件树、文件浏览器（需要安装 nnn，没有的话就不要它了）、snippets 补全、snippets 补全、状态栏美化、自动格式化、markdown 支持、开始界面、latex 支持\n\n部分本文未涉及的插件的具体用法请自行前往 github 查看，或者放弃使用\n\n```\ncall plug#begin('~/.vim/plugged')\nPlug 'neoclide/coc.nvim', {'branch': 'release'}\nPlug 'preservim/nerdtree'\nPlug 'mcchrish/nnn.vim'\nPlug 'SirVer/ultisnips'\nPlug 'honza/vim-snippets'\nPlug 'vim-airline/vim-airline'\nPlug 'Chiel92/vim-autoformat'\nPlug 'plasticboy/vim-markdown'\nPlug 'mhinz/vim-startify'\nPlug 'lervag/vimtex'\ncall plug#end()\n```\n\n先别急着装插件，查看[coc.nvim wiki](https://github.com/neoclide/coc.nvim/wiki/Install-coc.nvim)，先把依赖装了，主要是`nodejs`和`yarn`，作者给出的方法再次有点为难了，不过 arch linux 直接用包管理器装就行，其他的可能需要折腾一会儿\n\n另外[vim-autoformat](https://github.com/Chiel92/vim-autoformat)插件需要安装依赖，在 vim-autoformat 的 github 主页下查找，主要是`remark` for markdown 以及`latexindent.pl` for latex，arch 系 linux 可以先尝试从 aur 安装，不行的话可以按照 github 上作者给出的方式安装，大概又是一番折腾，特别注意，如果这两个软件无法在全局调用，需要在配置文件中加上`let g:formatterpath = ['/some/path/to/a/folder', '/home/superman/formatters']`，也可以选择创建符号链接使其可在全局调用（暂时有个问题，格式化 markdown 时会将其中的 latex 公式比如`$\\frac{}{}$`变为`$\\\\frac{}{}$`，不过可以手动替换`\\\\`为`\\`，或者也可以尝试其他的格式化工具，见补充部分）\n\n重新进入 neovim，执行`:PlugInstall`，等待安装结束，退出\n\n### vim 配置\n\n剩余的配置如下，重要的在下面，从`\" vim snippets##########################################`开始，前面的除了前两行都是 copy 自`coc.nvim`的基础配置，不想细看就 copy 吧，如果只想编写 markdown 或 latex，则删除对应插件的配置，顺便把前面的插件也给删了\n\n```\nset relativenumber\nset number\n\n\" TextEdit might fail if hidden is not set.\nset hidden\n\n\" Some servers have issues with backup files, see #649.\nset nobackup\nset nowritebackup\n\n\" Give more space for displaying messages.\nset cmdheight=2\n\n\" Having longer updatetime (default is 4000 ms = 4 s) leads to noticeable\n\" delays and poor user experience.\nset updatetime=300\n\n\" Don't pass messages to |ins-completion-menu|.\nset shortmess+=c\n\n\" Always show the signcolumn, otherwise it would shift the text each time\n\" diagnostics appear/become resolved.\nset signcolumn=yes\n\n\" Use tab for trigger completion with characters ahead and navigate.\n\" NOTE: Use command ':verbose imap <tab>' to make sure tab is not mapped by\n\" other plugin before putting this into your config.\ninoremap <silent><expr> <TAB>\n\t\t\t\\ pumvisible() ? \"\\<C-n>\" :\n\t\t\t\\ <SID>check_back_space() ? \"\\<TAB>\" :\n\t\t\t\\ coc#refresh()\ninoremap <expr><S-TAB> pumvisible() ? \"\\<C-p>\" : \"\\<C-h>\"\n\nfunction! s:check_back_space() abort\n\tlet col = col('.') - 1\n\treturn !col || getline('.')[col - 1]  =~# '\\s'\nendfunction\n\n\" Use <c-space> to trigger completion.\ninoremap <silent><expr> <c-space> coc#refresh()\n\n\" Use <cr> to confirm completion, `<C-g>u` means break undo chain at current\n\" position. Coc only does snippet and additional edit on confirm.\n\" <cr> could be remapped by other vim plugin, try `:verbose imap <CR>`.\nif exists('*complete_info')\n\tinoremap <expr> <cr> complete_info()[\"selected\"] != \"-1\" ? \"\\<C-y>\" : \"\\<C-g>u\\<CR>\"\nelse\n\tinoremap <expr> <cr> pumvisible() ? \"\\<C-y>\" : \"\\<C-g>u\\<CR>\"\nendif\n\n\" Use `[g` and `]g` to navigate diagnostics\nnmap <silent> [g <Plug>(coc-diagnostic-prev)\nnmap <silent> ]g <Plug>(coc-diagnostic-next)\n\n\" GoTo code navigation.\nnmap <silent> gd <Plug>(coc-definition)\nnmap <silent> gy <Plug>(coc-type-definition)\nnmap <silent> gi <Plug>(coc-implementation)\nnmap <silent> gr <Plug>(coc-references)\n\n\" Use K to show documentation in preview window.\nnnoremap <silent> K :call <SID>show_documentation()<CR>\n\nfunction! s:show_documentation()\n\tif (index(['vim','help'], &filetype) >= 0)\n\t\texecute 'h '.expand('<cword>')\n\telse\n\t\tcall CocAction('doHover')\n\tendif\nendfunction\n\n\" Highlight the symbol and its references when holding the cursor.\nautocmd CursorHold * silent call CocActionAsync('highlight')\n\n\" Symbol renaming.\nnmap <leader>rn <Plug>(coc-rename)\n\n\" Formatting selected code.\nxmap <leader>f  <Plug>(coc-format-selected)\nnmap <leader>f  <Plug>(coc-format-selected)\n\naugroup mygroup\n\tautocmd!\n\t\" Setup formatexpr specified filetype(s).\n\tautocmd FileType typescript,json setl formatexpr=CocAction('formatSelected')\n\t\" Update signature help on jump placeholder.\n\tautocmd User CocJumpPlaceholder call CocActionAsync('showSignatureHelp')\naugroup end\n\n\" Applying codeAction to the selected region.\n\" Example: `<leader>aap` for current paragraph\nxmap <leader>a  <Plug>(coc-codeaction-selected)\nnmap <leader>a  <Plug>(coc-codeaction-selected)\n\n\" Remap keys for applying codeAction to the current line.\nnmap <leader>ac  <Plug>(coc-codeaction)\n\" Apply AutoFix to problem on the current line.\nnmap <leader>qf  <Plug>(coc-fix-current)\n\n\" Map function and class text objects\n\" NOTE: Requires 'textDocument.documentSymbol' support from the language server.\nxmap if <Plug>(coc-funcobj-i)\nomap if <Plug>(coc-funcobj-i)\nxmap af <Plug>(coc-funcobj-a)\nomap af <Plug>(coc-funcobj-a)\nxmap ic <Plug>(coc-classobj-i)\nomap ic <Plug>(coc-classobj-i)\nxmap ac <Plug>(coc-classobj-a)\nomap ac <Plug>(coc-classobj-a)\n\n\" Use CTRL-S for selections ranges.\n\" Requires 'textDocument/selectionRange' support of LS, ex: coc-tsserver\nnmap <silent> <C-s> <Plug>(coc-range-select)\nxmap <silent> <C-s> <Plug>(coc-range-select)\n\n\" Add `:Format` command to format current buffer.\ncommand! -nargs=0 Format :call CocAction('format')\n\n\" Add `:Fold` command to fold current buffer.\ncommand! -nargs=? Fold :call     CocAction('fold', <f-args>)\n\n\" Add `:OR` command for organize imports of the current buffer.\ncommand! -nargs=0 OR   :call     CocAction('runCommand', 'editor.action.organizeImport')\n\n\" Add (Neo)Vim's native statusline support.\n\" NOTE: Please see `:h coc-status` for integrations with external plugins that\n\" provide custom statusline: lightline.vim, vim-airline.\nset statusline^=%{coc#status()}%{get(b:,'coc_current_function','')}\n\n\" Mappings using CoCList:\n\" Show all diagnostics.\nnnoremap <silent> <space>a  :<C-u>CocList diagnostics<cr>\n\" Manage extensions.\nnnoremap <silent> <space>e  :<C-u>CocList extensions<cr>\n\" Show commands.\nnnoremap <silent> <space>c  :<C-u>CocList commands<cr>\n\" Find symbol of current document.\nnnoremap <silent> <space>o  :<C-u>CocList outline<cr>\n\" Search workspace symbols.\nnnoremap <silent> <space>s  :<C-u>CocList -I symbols<cr>\n\" Do default action for next item.\nnnoremap <silent> <space>j  :<C-u>CocNext<CR>\n\" Do default action for previous item.\nnnoremap <silent> <space>k  :<C-u>CocPrev<CR>\n\" Resume latest coc list.\nnnoremap <silent> <space>p  :<C-u>CocListResume<CR>\n\n\" vim snippets##########################################\nlet g:UltiSnipsExpandTrigger=\"<tab>\"\nlet g:UltiSnipsJumpForwardTrigger=\"<c-b>\"\nlet g:UltiSnipsJumpBackwardTrigger=\"<c-z>\"\n\n\" autoformat##########################################\nnoremap <C-L> :Autoformat<CR>\n\n\" nerdtree##########################################\nmap <C-p> :NERDTreeToggle<CR>\n\n\" vimtex##########################################\nlet g:vimtex_view_general_viewer = 'mupdf'\nlet g:vimtex_view_general_options_latexmk = '-reuse-instance'\nlet g:vimtex_view_general_options\n\\ = '-reuse-instance -forward-search @tex @line @pdf'\n\\ . ' -inverse-search \"' . exepath(v:progpath)\n\\ . ' --servername ' . v:servername\n\\ . ' --remote-send \\\"^<C-\\^>^<C-n^>'\n\\ . ':execute ''drop '' . fnameescape(''\\%f'')^<CR^>'\n\\ . ':\\%l^<CR^>:normal\\! zzzv^<CR^>'\n\\ . ':call remote_foreground('''.v:servername.''')^<CR^>^<CR^>\\\"\"'\n\nset conceallevel=1\nlet g:tex_conceal='abdmg'\n\" Prevent that vim detect a file with the tex suffix as a plaintex\nlet g:tex_flavor='latex'\n\" Set the viewer method\nlet g:vimtex_view_method='mupdf'\n\" Never opened/closed the quickfix window automatically. The quickfix window shows the errors and/or warnings when compile, and we can open the quickfix windows use \\le\nlet g:vimtex_quickfix_mode=0\n\" 最后两行开启自动隐藏功能,开启了这个功能，除了你光标所在的那一行之外，文本里夹杂的LaTeX代码就都会隐藏或者替换成其他符号\nset conceallevel=1\n\nlet &t_SI.=\"\\e[5 q\" \"SI = INSERT mode\nlet &t_SR.=\"\\e[4 q\" \"SR = REPLACE mode\nlet &t_EI.=\"\\e[1 q\" \"EI = NORMAL mode (ELSE)\n\ninoremap <C-c> <esc>\n```\n\n说明：格式化快捷键设置成了`ctrl + l`，`coc.nvim`可以使用`ctrl + n`选择提示项（只能往下翻，对我来说足够了，需要更好地体验可以自行设置），按`ctrl + p`打开文件树\n\n### 输入法自动切换\n\n这部分很重要，极其影响体验感\n\n首先确保你使用的是 fcitx 输入法，fcitx4 和 fcitx5 都可以\n\n[下载最新版本的 fcitx.vim](https://www.vim.org/scripts/script.php?script_id=3764)\n\n解压后把 plugin 和 so 两个文件夹放到`~/.config/nvim`，或者干脆在这个目录下解压，如果是 vim，则应放到`~/.vim`\n\n这里有个坑，上面已经填了，配置文件最后一行`inoremap <C-c> <esc>`，将`ctrl + c`映射为`esc`，默认情况下两者都可以进入普通模式，但前者不会触发相关事件，这使得插件无效（不知有没有像我一样使用`ctrl + c`的 vimer）\n\n如果你的`ctrl + c`在插入模式下另有用处，请删除该行\n\n注意：作者并不是为 neovim 设计的插件，目前最新版本的 neovim 可以使用，但不意味着一直可以使用\n\n### 相关 python 依赖安装\n\ncoc.nvim 需要 python 模块支持，另外 fcitx.vim 也需要 python 的 vim 模块以使用 fcitx.py 来获取更好的体验，不过这和 neovim 就没关系了，也可以装上，还有`autoformat`插件也需要 Python 模块\n\n使用`pip`安装`python-vim`、`neovim`，并`python3 -m pip install pynvim`\n\n对于 gentoo，使用 pip 安装 python 模块需要加--usr 选项，这样安装的模块默认情况下是无法被 python 找到的，需要设置一下。如果不知如何解决，可以直接`emerge dev-python/pynvim`，其他的就无需安装\n\n如果你的 neovim 找不到 Python3，则在 neovim 配置文件中加入`let g:python3_host_prog=/path/to/python/executable/`，路径自己改\n\n### coc.nvim 配置\n\n查看[coc extensions](https://github.com/neoclide/coc.nvim/wiki/Using-coc-extensions)，找到 markdown 和 latex 的对应扩展（按需安装），使用`:CocInstall`指令安装\n\n此外，还需要安装`coc-snippets`和`coc-actions`以配合 snippets 相关插件\n\n查看[coc language servers](https://github.com/neoclide/coc.nvim/wiki/Language-servers)，找到 markdown 和 latex，按照指示完成配置，如果遇到困难，继续往下看\n\n这里使用`:CocConfig`指令打开 coc 配置文件，如果你不熟悉 json，特别注意，文件中的所有内容需要用`{}`包起来，直接 copy 作者给的配置会出现语法错误\n\n这里安装`efm-langserver`和`digestif`又有问题了，arch 直接从 aur 安装再次避坑（需要先配置 go 语言环境，GOROOT 在 arch 上为`/usr/lib/go`，如果你上网找的话，可能会被`/usr/local/go`给坑了，go 安裝完毕后 GOROOT 下是有文件的，不确定是哪个可以去查看一下，另外还需要打开`go module`，以及给`go get`设置国内代理，详见[go 语言依赖管理](https://blog.csdn.net/weixin_44690437/article/details/103571558)，试图那啥的可以省省了，`go get`不认这招，或许全系统代理可以），其他的可能需要折腾一会儿\n\n这里附上我的`coc-settings.json`，copy 的时候把两个路径换成自己的，另外特别注意`command`需要使用绝对路径\n\n```\n{\n          languageserver : {\n                   digestif : {\n                          command :  /bin/digestif ,\n                          filetypes : [ tex ,  plaintex ,  context ]\n                 },\n                  efm : {\n                          command :  /bin/efm-langserver ,\n                         args : [ -c ,  /home/yourUsername/.config/efm-langserver/config.yaml ],\n                          filetypes : [ vim ,  eruby ,  markdown ]\n                 }\n        },\n          suggest.noselect : false\n }\n\n```\n\n## markdown\n\nmarkdown 的部分上面已经完成的差不多了，现在先创建一个.md 文件，查看是否可以补全，`nvim test.md`，输入`img`，应该会有提示，如果没有，请检查`coc.nvim`以及两个关于`snippets`的插件\n\n目前还有一个至关重要的问题，markdown 中的 latex 无法补全，极其影响体验感，不过`coc.nvim`可以[自定义 sources](https://github.com/neoclide/coc.nvim/wiki/Create-custom-source)，在`~/.config/nvim/autoload/coc/source`下创建`latex.vim`，写入\n\n```\nfunction! coc#source#latex#init() abort\n\treturn {\n\t\t\t\t\\ 'triggerCharacters': ['\\'],\n\t\t\t\t\\'filetype':['markdown']\n\t\t\t\t\\}\nendfunction\n\nfunction! coc#source#latex#complete(opt, cb) abort\n\tlet items = ['dot{}', 'ddot{}', 'bar{}', 'hat{}', 'exp', 'sin', 'cos', 'tan', 'sec', 'csc', 'vec{}', 'cot', 'arcsin', 'arccos', 'arctan', 'sinh', 'cosh', 'tanh', 'coth', 'sh', 'ch', 'th', 'max', 'min', 'partial', 'nabla', 'prime', 'backprime', 'infty', 'eth', 'hbar', 'sqrt{}', 'sqrt[]{}', 'pm', 'mp', 'times', 'div', 'cdot', 'odot', 'bigodot' , '{ \\}', 'in', 'not', 'ni', 'cap', 'Cap', 'bigcap', 'cup', 'Cup', 'bigcup', 'subset', 'supset', 'supseteq', 'subseteq', 'subseteqq', 'supseteqq', 'subsetneq', 'supsetneq', 'supsetneqq', 'subsetneqq', 'sim', 'approx', 'leq', 'geq', 'parallel', 'nparallel', 'perp', 'angle', 'Box', 'bigtriangleup', 'bigtriangledown', 'forall', 'therefore', 'because', 'overline{}', 'Rightarrow', 'Leftarrow', 'rightarrow', 'leftarrow', 'leftrightarrow', 'nRightarrow', 'nLeftarrow', 'nleftarrow', 'nrightarrow', 'nleftrightarrow', 'overleftarrow{}', 'overrightarrow{}', 'overset{}', 'underline{}', 'sum', 'prod', 'lim', 'limits', 'int', 'iint', 'oint', 'iiint', 'frac{}{}', 'tfrac{}{}', 'dfrac{}{}', '\\begin{matrix}\\end{matrix}', '\\begin{vmatrix}\\end{vmatrix}', '\\begin{bmatrix}\\end{bmatrix}', '\\begin{Bmatrix}\\end{Bmatrix}', '\\begin{pmatrix}\\end{pmatrix}','\\begin{cases}\\end{cases}', '\\begin{aligned}\\end{aligned}', '\\begin{array}\\end{array}', 'alpha', 'psi', 'Delta', 'delta', 'beta', 'lambda', 'rho', 'varepsilon', 'Gamma', 'chi', 'mu', 'sigma', 'Lambda', 'tau', 'varphi', 'varPhi', 'phi', 'Phi', 'eta', 'omega', 'varrho', 'Pi', 'pi', 'gamma', 'xi', 'Psi', 'Sigma', 'varnothing', 'iiiint']\n\tcall a:cb(items)\nendfunction\n```\n\n关于自定义 source 的具体细节，请前往 github，上面给出的 source 设定在 markdown 文件下加载，使用`\\`作为触发符，这里只加入了我常用的几个命令，更多内容可以自行添加\n\n到此，markdown 部分已经完成，可以先检查一下有没有问题\n\n## latex\n\n首先安装 latex 编译环境，这里使用 texlive\n\n参考[arch wiki](<https://wiki.archlinux.org/index.php/TeX_Live_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)>)，不想折腾的话就把安装部分提到的几个包全装了，应该就问题不大了\n\n如果还有问题，或者是其他 linux 发行版，可以参考[Deepin Linux 安装和搭建 LaTex 环境](https://zhuanlan.zhihu.com/p/40053417)和[Ubuntu18.04 安装 LaTeX 并配置中文环境](https://blog.csdn.net/qq_41814939/article/details/82288145)，不过安装 texlive-full 实在太麻烦了，我装了 3 小时，最后似乎卡住了，手贱中断了，再也装不上了，这个包和前面 arch wiki 中提到的包大部分是冲突的，如果是 arch 系的就不要折腾这个了，如果是 gentoo 的话，如果坚持本地编译的话，建议备好电影小零食~~（窃以为使用 gentoo 的 linux 骨灰级玩家不需要这篇文章，强行 gentoo 的玩家可能还没从坑里爬出来）\n\n安装 MuPDF，当然你也可以选择别的，详见[github](https://github.com/lervag/vimtex)，如果换了的话需要把上面的配置也一并修改\n\n到此结束，测试一下，`nvim test.tex`，写入\n\n```\n\\documentclass{article}\n\\begin{document}\n你好，world!\n\\end{document}\n```\n\n在普通模式下按`\\ll`进行编译，再按`\\lv`预览，不要关闭预览窗口，修改成`hello world`，保存，重新编译，看看预览是否同步改变，这里还可以设置保存时自动编译\n\n## 更多\n\n- linux 下没有可以和 FastStone 媲美的截图软件，不过可以用 KolourPaint 快速编辑图片，需要更多操作可以使用 GIMP，不建议使用 Pinta，由于无法输入中文\n- markdown 中可以用 html 语法插入 mp4 视频，比起 gif 的好处就不用多说了，缺点是略显臃肿\n- 可以再为 vim 配置更多插件，比如 markdown 自动贴图、markdown 预览等等，也可以继续自定义 snippets，这些部分按个人喜好配置，这里不再介绍\n- 桌面推荐 i3，i3 配置较为麻烦，可以保留原有桌面，简单配置 i3，仅用来写 markdown 和 latex\n- 或许可以在 WSL 中配置，不过暂时折腾到此为止了\n\n## 补充\n\n### 为 markdown 添加大纲显示\n\n#### Excuberant Ctags\n\n首先安装`Excuberant Ctags`，debian 系和 redhat 系应该可以使用包管理工具直接安装，arch 这次似乎进坑了，需要编译源码\n\n访问[Excuberant Ctags 下载页面](http://ctags.sourceforge.net/)，没错，GFW 警告，这个资源可以在网上搜，文件名为 ctags-5.8，csdn 上有，本来想上传一个免费的，结果死活都重复，算了\n\n解压，cd 入目录，`./configure`，继续`make && sudo make install`，正常情况下应该没问题了，如果有问题，请参考[安装 Exuberant Ctags 及 Tag List 插件](https://blog.csdn.net/dream2009gd/article/details/44102227)\n\n#### easytags\n\n使用`vim-plug`安装\n\n```\nPlug 'xolox/vim-misc'\nPlug 'xolox/vim-easytags'\n```\n\n#### [tagbar](https://github.com/majutsushi/tagbar)\n\n```\nPlug 'majutsushi/tagbar'\n```\n\n注意使用该插件时可能有问题，详情见 github\n\n#### markdown2ctags\n\n```\nPlug 'jszakmeister/markdown2ctags'\n```\n\n#### 配置\n\n```\n\" tagbar#####################################\nnmap <C-M> :TagbarToggle<CR>\n\n\" markdown2ctags#####################################\nlet g:tagbar_type_markdown = {\n    \\ 'ctagstype': 'markdown',\n    \\ 'ctagsbin' : '/home/yourUsername/.vim/plugged/markdown2ctags/markdown2ctags.py',\n    \\ 'ctagsargs' : '-f - --sort=yes --sro=»',\n    \\ 'kinds' : [\n        \\ 's:sections',\n        \\ 'i:images'\n    \\ ],\n    \\ 'sro' : '»',\n    \\ 'kind2scope' : {\n        \\ 's' : 'section',\n    \\ },\n    \\ 'sort': 0,\n\\ }\n```\n\n这里给 tagbar 的快捷键设置为`ctrl + m`，`markdown2ctags`的配置中需要注意更换你的`markdown2ctags.py`所在路径，且注意通过`:set filetype`查看你的 markdown 文件的文件类型名称是否是 markdown，若不是，则修改`ctagstype`\n\n### 格式化插件[neoformat](https://github.com/sbdchd/neoformat)\n\n#### 插件安装\n\n```\nPlug 'sbdchd/neoformat'\n```\n\n#### 依赖安装\n\n##### [prettier](https://github.com/prettier/prettier) for markdown\n\n不要选 remark 作为格式化软件\n\narch 可以直接从 aur 安装，其他参考[install prettier](https://prettier.io/docs/en/install.html)\n\n##### [latexindent.pl](https://github.com/cmhughes/latexindent.pl) for latex\n\n将项目 clone 到本地\n\n安装`perl`，执行`sudo cpan`\n\n进入`cpan`环境后，执行\n\n```\ninstall Log::Log4perl\ninstall Log::Dispatch::File\ninstall YAML::Tiny\ninstall File::HomeDir\n```\n\n再次 GFW 警告\n\n进入项目目录，测试 latexindent.pl 是否可以正常运行，并设置为可全局调用（最简单的方式是写个 sh 文件，`cd youPathToLatexindent.pl && ./latexindent.pl`，然后将其链接到`/bin`或者`/usr/bin`）\n\n#### 插件配置\n\n只需在`init.vim`中添加\n\n```\nlet g:neoformat_latex_latexindent ={'exe':'latexindent','args':[],'stdin':1}\nlet g:neoformat_enabled_latex=['latexindent']\n```\n\n用 prettier 格式化 markdown 失败，笔者暂时未解决该错误，可以使用[vim-prettier](https://github.com/prettier/vim-prettier)插件代替，或者手动运行`prettier --wirte pathToYourFile`\n\n为不同类型的文件添加格式化快捷键\n\n```\nnnoremap <C-l> :Neoformat<CR>\nautocmd FileType markdown nnoremap <buffer> <C-l> :Prettier<CR>\n```\n","source":"_posts/vim-markdown-latex.md","raw":"---\ntitle: Choose vim to edit markdown and latex files\ndate: 2020-08-04 12:41:30\ntags:\n- Vim\n- Latex\n- Markdown\ncategories: \n- Vim \n---\n\n# 使用 vim 编写 markdown 和 latex\n\n## 前言\n\n### 主要配置\n\n- 操作系统：arch linux\n- 编辑器：neovim（coc-actions 仅支持 neovim），如果使用 vim，请换用另外的补全插件\n- 预览：markdown 使用 typora，latex 用 vimtex 调用 MuPDF\n\n### 优缺点\n\n在使用 vim 之前，曾尝试了两种方案，一是 vscode + vim，配置简单，功能都还不错，问题是自动输入法切换延迟有点长，甚至使用方向键都有点卡，二是 jetbrains 系列的 ide，windows 下用来码字是体验最好的（linux 下对中文输入法不友好），但资源消耗太多，且预览不是很理想\n\n下面是这套方案的优缺点\n\n- linux 下 vim 的输入法切换体验远远好于 windows（笔者未使用 mac os，不清楚情况）\n- windows 下使用 texlive 安装 latex 相关依赖，编译 latex 文档时出现错误，暂时没能修复，linux 下比较稳定\n- neovim 以及 vim 比 vscode + vim 插件更流畅\n- 支持 latex 即时编译，缺点是无法正反向搜索，这点在 vscode 中是支持的\n- typora 对 markdown 渲染的支持比 vim 以及 vscode 的相关插件好得多，比如支持本地 mp4 视频插入等，缺点是无法正反向搜索\n\n### 注意事项\n\n- 以下步骤全靠回忆，不会有错，但可能有漏，请小心操作，避免掉坑，欢迎留言\n- 由于网页的关系，直接从本文复制的内容可能存在非法字符，复制粘贴后应当检查一下\n- arch linux 可能帮你避开许多坑，如果想了解并使用 arch，可参考 arch wiki 安装教程，若水平有限，可以在网上搜索视频安装教程，还不行的话直接装 manjaro 吧\n- 装好下面提到的软件时注意检查是否可以直接在终端调用\n\n## vim 简单配置\n\n### vim-plug\n\n[github 地址](https://github.com/junegunn/vim-plug)\n\n作者提供的安装方式应该是装不上的，似乎是这个链接本身有问题，不是 GFW 的锅\n\n#### 安装\n\n把项目克隆到本地，将项目中的 plug.vim 放到`~/.local/share/nvim/site/autoload`目录下，如果你使用 vim，可以放到`~/.vim/autoload`目录下\n\n#### 使用\n\n编辑`~/.config/nvim/init.vim`\n\n一个`Plug`对应一个插件，如果你和我一样只是想用 vim 编辑 markdown 和 latex（不包括 markdown 预览），那就直接 copy 吧（注意可以更换第一行`begin`后插件存放的路径）\n\n插件依次为自动补全、文件树、文件浏览器（需要安装 nnn，没有的话就不要它了）、snippets 补全、snippets 补全、状态栏美化、自动格式化、markdown 支持、开始界面、latex 支持\n\n部分本文未涉及的插件的具体用法请自行前往 github 查看，或者放弃使用\n\n```\ncall plug#begin('~/.vim/plugged')\nPlug 'neoclide/coc.nvim', {'branch': 'release'}\nPlug 'preservim/nerdtree'\nPlug 'mcchrish/nnn.vim'\nPlug 'SirVer/ultisnips'\nPlug 'honza/vim-snippets'\nPlug 'vim-airline/vim-airline'\nPlug 'Chiel92/vim-autoformat'\nPlug 'plasticboy/vim-markdown'\nPlug 'mhinz/vim-startify'\nPlug 'lervag/vimtex'\ncall plug#end()\n```\n\n先别急着装插件，查看[coc.nvim wiki](https://github.com/neoclide/coc.nvim/wiki/Install-coc.nvim)，先把依赖装了，主要是`nodejs`和`yarn`，作者给出的方法再次有点为难了，不过 arch linux 直接用包管理器装就行，其他的可能需要折腾一会儿\n\n另外[vim-autoformat](https://github.com/Chiel92/vim-autoformat)插件需要安装依赖，在 vim-autoformat 的 github 主页下查找，主要是`remark` for markdown 以及`latexindent.pl` for latex，arch 系 linux 可以先尝试从 aur 安装，不行的话可以按照 github 上作者给出的方式安装，大概又是一番折腾，特别注意，如果这两个软件无法在全局调用，需要在配置文件中加上`let g:formatterpath = ['/some/path/to/a/folder', '/home/superman/formatters']`，也可以选择创建符号链接使其可在全局调用（暂时有个问题，格式化 markdown 时会将其中的 latex 公式比如`$\\frac{}{}$`变为`$\\\\frac{}{}$`，不过可以手动替换`\\\\`为`\\`，或者也可以尝试其他的格式化工具，见补充部分）\n\n重新进入 neovim，执行`:PlugInstall`，等待安装结束，退出\n\n### vim 配置\n\n剩余的配置如下，重要的在下面，从`\" vim snippets##########################################`开始，前面的除了前两行都是 copy 自`coc.nvim`的基础配置，不想细看就 copy 吧，如果只想编写 markdown 或 latex，则删除对应插件的配置，顺便把前面的插件也给删了\n\n```\nset relativenumber\nset number\n\n\" TextEdit might fail if hidden is not set.\nset hidden\n\n\" Some servers have issues with backup files, see #649.\nset nobackup\nset nowritebackup\n\n\" Give more space for displaying messages.\nset cmdheight=2\n\n\" Having longer updatetime (default is 4000 ms = 4 s) leads to noticeable\n\" delays and poor user experience.\nset updatetime=300\n\n\" Don't pass messages to |ins-completion-menu|.\nset shortmess+=c\n\n\" Always show the signcolumn, otherwise it would shift the text each time\n\" diagnostics appear/become resolved.\nset signcolumn=yes\n\n\" Use tab for trigger completion with characters ahead and navigate.\n\" NOTE: Use command ':verbose imap <tab>' to make sure tab is not mapped by\n\" other plugin before putting this into your config.\ninoremap <silent><expr> <TAB>\n\t\t\t\\ pumvisible() ? \"\\<C-n>\" :\n\t\t\t\\ <SID>check_back_space() ? \"\\<TAB>\" :\n\t\t\t\\ coc#refresh()\ninoremap <expr><S-TAB> pumvisible() ? \"\\<C-p>\" : \"\\<C-h>\"\n\nfunction! s:check_back_space() abort\n\tlet col = col('.') - 1\n\treturn !col || getline('.')[col - 1]  =~# '\\s'\nendfunction\n\n\" Use <c-space> to trigger completion.\ninoremap <silent><expr> <c-space> coc#refresh()\n\n\" Use <cr> to confirm completion, `<C-g>u` means break undo chain at current\n\" position. Coc only does snippet and additional edit on confirm.\n\" <cr> could be remapped by other vim plugin, try `:verbose imap <CR>`.\nif exists('*complete_info')\n\tinoremap <expr> <cr> complete_info()[\"selected\"] != \"-1\" ? \"\\<C-y>\" : \"\\<C-g>u\\<CR>\"\nelse\n\tinoremap <expr> <cr> pumvisible() ? \"\\<C-y>\" : \"\\<C-g>u\\<CR>\"\nendif\n\n\" Use `[g` and `]g` to navigate diagnostics\nnmap <silent> [g <Plug>(coc-diagnostic-prev)\nnmap <silent> ]g <Plug>(coc-diagnostic-next)\n\n\" GoTo code navigation.\nnmap <silent> gd <Plug>(coc-definition)\nnmap <silent> gy <Plug>(coc-type-definition)\nnmap <silent> gi <Plug>(coc-implementation)\nnmap <silent> gr <Plug>(coc-references)\n\n\" Use K to show documentation in preview window.\nnnoremap <silent> K :call <SID>show_documentation()<CR>\n\nfunction! s:show_documentation()\n\tif (index(['vim','help'], &filetype) >= 0)\n\t\texecute 'h '.expand('<cword>')\n\telse\n\t\tcall CocAction('doHover')\n\tendif\nendfunction\n\n\" Highlight the symbol and its references when holding the cursor.\nautocmd CursorHold * silent call CocActionAsync('highlight')\n\n\" Symbol renaming.\nnmap <leader>rn <Plug>(coc-rename)\n\n\" Formatting selected code.\nxmap <leader>f  <Plug>(coc-format-selected)\nnmap <leader>f  <Plug>(coc-format-selected)\n\naugroup mygroup\n\tautocmd!\n\t\" Setup formatexpr specified filetype(s).\n\tautocmd FileType typescript,json setl formatexpr=CocAction('formatSelected')\n\t\" Update signature help on jump placeholder.\n\tautocmd User CocJumpPlaceholder call CocActionAsync('showSignatureHelp')\naugroup end\n\n\" Applying codeAction to the selected region.\n\" Example: `<leader>aap` for current paragraph\nxmap <leader>a  <Plug>(coc-codeaction-selected)\nnmap <leader>a  <Plug>(coc-codeaction-selected)\n\n\" Remap keys for applying codeAction to the current line.\nnmap <leader>ac  <Plug>(coc-codeaction)\n\" Apply AutoFix to problem on the current line.\nnmap <leader>qf  <Plug>(coc-fix-current)\n\n\" Map function and class text objects\n\" NOTE: Requires 'textDocument.documentSymbol' support from the language server.\nxmap if <Plug>(coc-funcobj-i)\nomap if <Plug>(coc-funcobj-i)\nxmap af <Plug>(coc-funcobj-a)\nomap af <Plug>(coc-funcobj-a)\nxmap ic <Plug>(coc-classobj-i)\nomap ic <Plug>(coc-classobj-i)\nxmap ac <Plug>(coc-classobj-a)\nomap ac <Plug>(coc-classobj-a)\n\n\" Use CTRL-S for selections ranges.\n\" Requires 'textDocument/selectionRange' support of LS, ex: coc-tsserver\nnmap <silent> <C-s> <Plug>(coc-range-select)\nxmap <silent> <C-s> <Plug>(coc-range-select)\n\n\" Add `:Format` command to format current buffer.\ncommand! -nargs=0 Format :call CocAction('format')\n\n\" Add `:Fold` command to fold current buffer.\ncommand! -nargs=? Fold :call     CocAction('fold', <f-args>)\n\n\" Add `:OR` command for organize imports of the current buffer.\ncommand! -nargs=0 OR   :call     CocAction('runCommand', 'editor.action.organizeImport')\n\n\" Add (Neo)Vim's native statusline support.\n\" NOTE: Please see `:h coc-status` for integrations with external plugins that\n\" provide custom statusline: lightline.vim, vim-airline.\nset statusline^=%{coc#status()}%{get(b:,'coc_current_function','')}\n\n\" Mappings using CoCList:\n\" Show all diagnostics.\nnnoremap <silent> <space>a  :<C-u>CocList diagnostics<cr>\n\" Manage extensions.\nnnoremap <silent> <space>e  :<C-u>CocList extensions<cr>\n\" Show commands.\nnnoremap <silent> <space>c  :<C-u>CocList commands<cr>\n\" Find symbol of current document.\nnnoremap <silent> <space>o  :<C-u>CocList outline<cr>\n\" Search workspace symbols.\nnnoremap <silent> <space>s  :<C-u>CocList -I symbols<cr>\n\" Do default action for next item.\nnnoremap <silent> <space>j  :<C-u>CocNext<CR>\n\" Do default action for previous item.\nnnoremap <silent> <space>k  :<C-u>CocPrev<CR>\n\" Resume latest coc list.\nnnoremap <silent> <space>p  :<C-u>CocListResume<CR>\n\n\" vim snippets##########################################\nlet g:UltiSnipsExpandTrigger=\"<tab>\"\nlet g:UltiSnipsJumpForwardTrigger=\"<c-b>\"\nlet g:UltiSnipsJumpBackwardTrigger=\"<c-z>\"\n\n\" autoformat##########################################\nnoremap <C-L> :Autoformat<CR>\n\n\" nerdtree##########################################\nmap <C-p> :NERDTreeToggle<CR>\n\n\" vimtex##########################################\nlet g:vimtex_view_general_viewer = 'mupdf'\nlet g:vimtex_view_general_options_latexmk = '-reuse-instance'\nlet g:vimtex_view_general_options\n\\ = '-reuse-instance -forward-search @tex @line @pdf'\n\\ . ' -inverse-search \"' . exepath(v:progpath)\n\\ . ' --servername ' . v:servername\n\\ . ' --remote-send \\\"^<C-\\^>^<C-n^>'\n\\ . ':execute ''drop '' . fnameescape(''\\%f'')^<CR^>'\n\\ . ':\\%l^<CR^>:normal\\! zzzv^<CR^>'\n\\ . ':call remote_foreground('''.v:servername.''')^<CR^>^<CR^>\\\"\"'\n\nset conceallevel=1\nlet g:tex_conceal='abdmg'\n\" Prevent that vim detect a file with the tex suffix as a plaintex\nlet g:tex_flavor='latex'\n\" Set the viewer method\nlet g:vimtex_view_method='mupdf'\n\" Never opened/closed the quickfix window automatically. The quickfix window shows the errors and/or warnings when compile, and we can open the quickfix windows use \\le\nlet g:vimtex_quickfix_mode=0\n\" 最后两行开启自动隐藏功能,开启了这个功能，除了你光标所在的那一行之外，文本里夹杂的LaTeX代码就都会隐藏或者替换成其他符号\nset conceallevel=1\n\nlet &t_SI.=\"\\e[5 q\" \"SI = INSERT mode\nlet &t_SR.=\"\\e[4 q\" \"SR = REPLACE mode\nlet &t_EI.=\"\\e[1 q\" \"EI = NORMAL mode (ELSE)\n\ninoremap <C-c> <esc>\n```\n\n说明：格式化快捷键设置成了`ctrl + l`，`coc.nvim`可以使用`ctrl + n`选择提示项（只能往下翻，对我来说足够了，需要更好地体验可以自行设置），按`ctrl + p`打开文件树\n\n### 输入法自动切换\n\n这部分很重要，极其影响体验感\n\n首先确保你使用的是 fcitx 输入法，fcitx4 和 fcitx5 都可以\n\n[下载最新版本的 fcitx.vim](https://www.vim.org/scripts/script.php?script_id=3764)\n\n解压后把 plugin 和 so 两个文件夹放到`~/.config/nvim`，或者干脆在这个目录下解压，如果是 vim，则应放到`~/.vim`\n\n这里有个坑，上面已经填了，配置文件最后一行`inoremap <C-c> <esc>`，将`ctrl + c`映射为`esc`，默认情况下两者都可以进入普通模式，但前者不会触发相关事件，这使得插件无效（不知有没有像我一样使用`ctrl + c`的 vimer）\n\n如果你的`ctrl + c`在插入模式下另有用处，请删除该行\n\n注意：作者并不是为 neovim 设计的插件，目前最新版本的 neovim 可以使用，但不意味着一直可以使用\n\n### 相关 python 依赖安装\n\ncoc.nvim 需要 python 模块支持，另外 fcitx.vim 也需要 python 的 vim 模块以使用 fcitx.py 来获取更好的体验，不过这和 neovim 就没关系了，也可以装上，还有`autoformat`插件也需要 Python 模块\n\n使用`pip`安装`python-vim`、`neovim`，并`python3 -m pip install pynvim`\n\n对于 gentoo，使用 pip 安装 python 模块需要加--usr 选项，这样安装的模块默认情况下是无法被 python 找到的，需要设置一下。如果不知如何解决，可以直接`emerge dev-python/pynvim`，其他的就无需安装\n\n如果你的 neovim 找不到 Python3，则在 neovim 配置文件中加入`let g:python3_host_prog=/path/to/python/executable/`，路径自己改\n\n### coc.nvim 配置\n\n查看[coc extensions](https://github.com/neoclide/coc.nvim/wiki/Using-coc-extensions)，找到 markdown 和 latex 的对应扩展（按需安装），使用`:CocInstall`指令安装\n\n此外，还需要安装`coc-snippets`和`coc-actions`以配合 snippets 相关插件\n\n查看[coc language servers](https://github.com/neoclide/coc.nvim/wiki/Language-servers)，找到 markdown 和 latex，按照指示完成配置，如果遇到困难，继续往下看\n\n这里使用`:CocConfig`指令打开 coc 配置文件，如果你不熟悉 json，特别注意，文件中的所有内容需要用`{}`包起来，直接 copy 作者给的配置会出现语法错误\n\n这里安装`efm-langserver`和`digestif`又有问题了，arch 直接从 aur 安装再次避坑（需要先配置 go 语言环境，GOROOT 在 arch 上为`/usr/lib/go`，如果你上网找的话，可能会被`/usr/local/go`给坑了，go 安裝完毕后 GOROOT 下是有文件的，不确定是哪个可以去查看一下，另外还需要打开`go module`，以及给`go get`设置国内代理，详见[go 语言依赖管理](https://blog.csdn.net/weixin_44690437/article/details/103571558)，试图那啥的可以省省了，`go get`不认这招，或许全系统代理可以），其他的可能需要折腾一会儿\n\n这里附上我的`coc-settings.json`，copy 的时候把两个路径换成自己的，另外特别注意`command`需要使用绝对路径\n\n```\n{\n          languageserver : {\n                   digestif : {\n                          command :  /bin/digestif ,\n                          filetypes : [ tex ,  plaintex ,  context ]\n                 },\n                  efm : {\n                          command :  /bin/efm-langserver ,\n                         args : [ -c ,  /home/yourUsername/.config/efm-langserver/config.yaml ],\n                          filetypes : [ vim ,  eruby ,  markdown ]\n                 }\n        },\n          suggest.noselect : false\n }\n\n```\n\n## markdown\n\nmarkdown 的部分上面已经完成的差不多了，现在先创建一个.md 文件，查看是否可以补全，`nvim test.md`，输入`img`，应该会有提示，如果没有，请检查`coc.nvim`以及两个关于`snippets`的插件\n\n目前还有一个至关重要的问题，markdown 中的 latex 无法补全，极其影响体验感，不过`coc.nvim`可以[自定义 sources](https://github.com/neoclide/coc.nvim/wiki/Create-custom-source)，在`~/.config/nvim/autoload/coc/source`下创建`latex.vim`，写入\n\n```\nfunction! coc#source#latex#init() abort\n\treturn {\n\t\t\t\t\\ 'triggerCharacters': ['\\'],\n\t\t\t\t\\'filetype':['markdown']\n\t\t\t\t\\}\nendfunction\n\nfunction! coc#source#latex#complete(opt, cb) abort\n\tlet items = ['dot{}', 'ddot{}', 'bar{}', 'hat{}', 'exp', 'sin', 'cos', 'tan', 'sec', 'csc', 'vec{}', 'cot', 'arcsin', 'arccos', 'arctan', 'sinh', 'cosh', 'tanh', 'coth', 'sh', 'ch', 'th', 'max', 'min', 'partial', 'nabla', 'prime', 'backprime', 'infty', 'eth', 'hbar', 'sqrt{}', 'sqrt[]{}', 'pm', 'mp', 'times', 'div', 'cdot', 'odot', 'bigodot' , '{ \\}', 'in', 'not', 'ni', 'cap', 'Cap', 'bigcap', 'cup', 'Cup', 'bigcup', 'subset', 'supset', 'supseteq', 'subseteq', 'subseteqq', 'supseteqq', 'subsetneq', 'supsetneq', 'supsetneqq', 'subsetneqq', 'sim', 'approx', 'leq', 'geq', 'parallel', 'nparallel', 'perp', 'angle', 'Box', 'bigtriangleup', 'bigtriangledown', 'forall', 'therefore', 'because', 'overline{}', 'Rightarrow', 'Leftarrow', 'rightarrow', 'leftarrow', 'leftrightarrow', 'nRightarrow', 'nLeftarrow', 'nleftarrow', 'nrightarrow', 'nleftrightarrow', 'overleftarrow{}', 'overrightarrow{}', 'overset{}', 'underline{}', 'sum', 'prod', 'lim', 'limits', 'int', 'iint', 'oint', 'iiint', 'frac{}{}', 'tfrac{}{}', 'dfrac{}{}', '\\begin{matrix}\\end{matrix}', '\\begin{vmatrix}\\end{vmatrix}', '\\begin{bmatrix}\\end{bmatrix}', '\\begin{Bmatrix}\\end{Bmatrix}', '\\begin{pmatrix}\\end{pmatrix}','\\begin{cases}\\end{cases}', '\\begin{aligned}\\end{aligned}', '\\begin{array}\\end{array}', 'alpha', 'psi', 'Delta', 'delta', 'beta', 'lambda', 'rho', 'varepsilon', 'Gamma', 'chi', 'mu', 'sigma', 'Lambda', 'tau', 'varphi', 'varPhi', 'phi', 'Phi', 'eta', 'omega', 'varrho', 'Pi', 'pi', 'gamma', 'xi', 'Psi', 'Sigma', 'varnothing', 'iiiint']\n\tcall a:cb(items)\nendfunction\n```\n\n关于自定义 source 的具体细节，请前往 github，上面给出的 source 设定在 markdown 文件下加载，使用`\\`作为触发符，这里只加入了我常用的几个命令，更多内容可以自行添加\n\n到此，markdown 部分已经完成，可以先检查一下有没有问题\n\n## latex\n\n首先安装 latex 编译环境，这里使用 texlive\n\n参考[arch wiki](<https://wiki.archlinux.org/index.php/TeX_Live_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)>)，不想折腾的话就把安装部分提到的几个包全装了，应该就问题不大了\n\n如果还有问题，或者是其他 linux 发行版，可以参考[Deepin Linux 安装和搭建 LaTex 环境](https://zhuanlan.zhihu.com/p/40053417)和[Ubuntu18.04 安装 LaTeX 并配置中文环境](https://blog.csdn.net/qq_41814939/article/details/82288145)，不过安装 texlive-full 实在太麻烦了，我装了 3 小时，最后似乎卡住了，手贱中断了，再也装不上了，这个包和前面 arch wiki 中提到的包大部分是冲突的，如果是 arch 系的就不要折腾这个了，如果是 gentoo 的话，如果坚持本地编译的话，建议备好电影小零食~~（窃以为使用 gentoo 的 linux 骨灰级玩家不需要这篇文章，强行 gentoo 的玩家可能还没从坑里爬出来）\n\n安装 MuPDF，当然你也可以选择别的，详见[github](https://github.com/lervag/vimtex)，如果换了的话需要把上面的配置也一并修改\n\n到此结束，测试一下，`nvim test.tex`，写入\n\n```\n\\documentclass{article}\n\\begin{document}\n你好，world!\n\\end{document}\n```\n\n在普通模式下按`\\ll`进行编译，再按`\\lv`预览，不要关闭预览窗口，修改成`hello world`，保存，重新编译，看看预览是否同步改变，这里还可以设置保存时自动编译\n\n## 更多\n\n- linux 下没有可以和 FastStone 媲美的截图软件，不过可以用 KolourPaint 快速编辑图片，需要更多操作可以使用 GIMP，不建议使用 Pinta，由于无法输入中文\n- markdown 中可以用 html 语法插入 mp4 视频，比起 gif 的好处就不用多说了，缺点是略显臃肿\n- 可以再为 vim 配置更多插件，比如 markdown 自动贴图、markdown 预览等等，也可以继续自定义 snippets，这些部分按个人喜好配置，这里不再介绍\n- 桌面推荐 i3，i3 配置较为麻烦，可以保留原有桌面，简单配置 i3，仅用来写 markdown 和 latex\n- 或许可以在 WSL 中配置，不过暂时折腾到此为止了\n\n## 补充\n\n### 为 markdown 添加大纲显示\n\n#### Excuberant Ctags\n\n首先安装`Excuberant Ctags`，debian 系和 redhat 系应该可以使用包管理工具直接安装，arch 这次似乎进坑了，需要编译源码\n\n访问[Excuberant Ctags 下载页面](http://ctags.sourceforge.net/)，没错，GFW 警告，这个资源可以在网上搜，文件名为 ctags-5.8，csdn 上有，本来想上传一个免费的，结果死活都重复，算了\n\n解压，cd 入目录，`./configure`，继续`make && sudo make install`，正常情况下应该没问题了，如果有问题，请参考[安装 Exuberant Ctags 及 Tag List 插件](https://blog.csdn.net/dream2009gd/article/details/44102227)\n\n#### easytags\n\n使用`vim-plug`安装\n\n```\nPlug 'xolox/vim-misc'\nPlug 'xolox/vim-easytags'\n```\n\n#### [tagbar](https://github.com/majutsushi/tagbar)\n\n```\nPlug 'majutsushi/tagbar'\n```\n\n注意使用该插件时可能有问题，详情见 github\n\n#### markdown2ctags\n\n```\nPlug 'jszakmeister/markdown2ctags'\n```\n\n#### 配置\n\n```\n\" tagbar#####################################\nnmap <C-M> :TagbarToggle<CR>\n\n\" markdown2ctags#####################################\nlet g:tagbar_type_markdown = {\n    \\ 'ctagstype': 'markdown',\n    \\ 'ctagsbin' : '/home/yourUsername/.vim/plugged/markdown2ctags/markdown2ctags.py',\n    \\ 'ctagsargs' : '-f - --sort=yes --sro=»',\n    \\ 'kinds' : [\n        \\ 's:sections',\n        \\ 'i:images'\n    \\ ],\n    \\ 'sro' : '»',\n    \\ 'kind2scope' : {\n        \\ 's' : 'section',\n    \\ },\n    \\ 'sort': 0,\n\\ }\n```\n\n这里给 tagbar 的快捷键设置为`ctrl + m`，`markdown2ctags`的配置中需要注意更换你的`markdown2ctags.py`所在路径，且注意通过`:set filetype`查看你的 markdown 文件的文件类型名称是否是 markdown，若不是，则修改`ctagstype`\n\n### 格式化插件[neoformat](https://github.com/sbdchd/neoformat)\n\n#### 插件安装\n\n```\nPlug 'sbdchd/neoformat'\n```\n\n#### 依赖安装\n\n##### [prettier](https://github.com/prettier/prettier) for markdown\n\n不要选 remark 作为格式化软件\n\narch 可以直接从 aur 安装，其他参考[install prettier](https://prettier.io/docs/en/install.html)\n\n##### [latexindent.pl](https://github.com/cmhughes/latexindent.pl) for latex\n\n将项目 clone 到本地\n\n安装`perl`，执行`sudo cpan`\n\n进入`cpan`环境后，执行\n\n```\ninstall Log::Log4perl\ninstall Log::Dispatch::File\ninstall YAML::Tiny\ninstall File::HomeDir\n```\n\n再次 GFW 警告\n\n进入项目目录，测试 latexindent.pl 是否可以正常运行，并设置为可全局调用（最简单的方式是写个 sh 文件，`cd youPathToLatexindent.pl && ./latexindent.pl`，然后将其链接到`/bin`或者`/usr/bin`）\n\n#### 插件配置\n\n只需在`init.vim`中添加\n\n```\nlet g:neoformat_latex_latexindent ={'exe':'latexindent','args':[],'stdin':1}\nlet g:neoformat_enabled_latex=['latexindent']\n```\n\n用 prettier 格式化 markdown 失败，笔者暂时未解决该错误，可以使用[vim-prettier](https://github.com/prettier/vim-prettier)插件代替，或者手动运行`prettier --wirte pathToYourFile`\n\n为不同类型的文件添加格式化快捷键\n\n```\nnnoremap <C-l> :Neoformat<CR>\nautocmd FileType markdown nnoremap <buffer> <C-l> :Prettier<CR>\n```\n","slug":"vim-markdown-latex","published":1,"updated":"2021-03-23T11:11:18.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmsl002xrrizem78b4v8","content":"<h1 id=\"使用-vim-编写-markdown-和-latex\"><a href=\"#使用-vim-编写-markdown-和-latex\" class=\"headerlink\" title=\"使用 vim 编写 markdown 和 latex\"></a>使用 vim 编写 markdown 和 latex</h1><h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><h3 id=\"主要配置\"><a href=\"#主要配置\" class=\"headerlink\" title=\"主要配置\"></a>主要配置</h3><ul>\n<li>操作系统：arch linux</li>\n<li>编辑器：neovim（coc-actions 仅支持 neovim），如果使用 vim，请换用另外的补全插件</li>\n<li>预览：markdown 使用 typora，latex 用 vimtex 调用 MuPDF</li>\n</ul>\n<h3 id=\"优缺点\"><a href=\"#优缺点\" class=\"headerlink\" title=\"优缺点\"></a>优缺点</h3><p>在使用 vim 之前，曾尝试了两种方案，一是 vscode + vim，配置简单，功能都还不错，问题是自动输入法切换延迟有点长，甚至使用方向键都有点卡，二是 jetbrains 系列的 ide，windows 下用来码字是体验最好的（linux 下对中文输入法不友好），但资源消耗太多，且预览不是很理想</p>\n<p>下面是这套方案的优缺点</p>\n<ul>\n<li>linux 下 vim 的输入法切换体验远远好于 windows（笔者未使用 mac os，不清楚情况）</li>\n<li>windows 下使用 texlive 安装 latex 相关依赖，编译 latex 文档时出现错误，暂时没能修复，linux 下比较稳定</li>\n<li>neovim 以及 vim 比 vscode + vim 插件更流畅</li>\n<li>支持 latex 即时编译，缺点是无法正反向搜索，这点在 vscode 中是支持的</li>\n<li>typora 对 markdown 渲染的支持比 vim 以及 vscode 的相关插件好得多，比如支持本地 mp4 视频插入等，缺点是无法正反向搜索</li>\n</ul>\n<h3 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h3><ul>\n<li>以下步骤全靠回忆，不会有错，但可能有漏，请小心操作，避免掉坑，欢迎留言</li>\n<li>由于网页的关系，直接从本文复制的内容可能存在非法字符，复制粘贴后应当检查一下</li>\n<li>arch linux 可能帮你避开许多坑，如果想了解并使用 arch，可参考 arch wiki 安装教程，若水平有限，可以在网上搜索视频安装教程，还不行的话直接装 manjaro 吧</li>\n<li>装好下面提到的软件时注意检查是否可以直接在终端调用</li>\n</ul>\n<h2 id=\"vim-简单配置\"><a href=\"#vim-简单配置\" class=\"headerlink\" title=\"vim 简单配置\"></a>vim 简单配置</h2><h3 id=\"vim-plug\"><a href=\"#vim-plug\" class=\"headerlink\" title=\"vim-plug\"></a>vim-plug</h3><p><a href=\"https://github.com/junegunn/vim-plug\">github 地址</a></p>\n<p>作者提供的安装方式应该是装不上的，似乎是这个链接本身有问题，不是 GFW 的锅</p>\n<h4 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h4><p>把项目克隆到本地，将项目中的 plug.vim 放到<code>~/.local/share/nvim/site/autoload</code>目录下，如果你使用 vim，可以放到<code>~/.vim/autoload</code>目录下</p>\n<h4 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h4><p>编辑<code>~/.config/nvim/init.vim</code></p>\n<p>一个<code>Plug</code>对应一个插件，如果你和我一样只是想用 vim 编辑 markdown 和 latex（不包括 markdown 预览），那就直接 copy 吧（注意可以更换第一行<code>begin</code>后插件存放的路径）</p>\n<p>插件依次为自动补全、文件树、文件浏览器（需要安装 nnn，没有的话就不要它了）、snippets 补全、snippets 补全、状态栏美化、自动格式化、markdown 支持、开始界面、latex 支持</p>\n<p>部分本文未涉及的插件的具体用法请自行前往 github 查看，或者放弃使用</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">call plug#begin(&#39;~&#x2F;.vim&#x2F;plugged&#39;)\nPlug &#39;neoclide&#x2F;coc.nvim&#39;, &#123;&#39;branch&#39;: &#39;release&#39;&#125;\nPlug &#39;preservim&#x2F;nerdtree&#39;\nPlug &#39;mcchrish&#x2F;nnn.vim&#39;\nPlug &#39;SirVer&#x2F;ultisnips&#39;\nPlug &#39;honza&#x2F;vim-snippets&#39;\nPlug &#39;vim-airline&#x2F;vim-airline&#39;\nPlug &#39;Chiel92&#x2F;vim-autoformat&#39;\nPlug &#39;plasticboy&#x2F;vim-markdown&#39;\nPlug &#39;mhinz&#x2F;vim-startify&#39;\nPlug &#39;lervag&#x2F;vimtex&#39;\ncall plug#end()<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>先别急着装插件，查看<a href=\"https://github.com/neoclide/coc.nvim/wiki/Install-coc.nvim\">coc.nvim wiki</a>，先把依赖装了，主要是<code>nodejs</code>和<code>yarn</code>，作者给出的方法再次有点为难了，不过 arch linux 直接用包管理器装就行，其他的可能需要折腾一会儿</p>\n<p>另外<a href=\"https://github.com/Chiel92/vim-autoformat\">vim-autoformat</a>插件需要安装依赖，在 vim-autoformat 的 github 主页下查找，主要是<code>remark</code> for markdown 以及<code>latexindent.pl</code> for latex，arch 系 linux 可以先尝试从 aur 安装，不行的话可以按照 github 上作者给出的方式安装，大概又是一番折腾，特别注意，如果这两个软件无法在全局调用，需要在配置文件中加上<code>let g:formatterpath = [&#39;/some/path/to/a/folder&#39;, &#39;/home/superman/formatters&#39;]</code>，也可以选择创建符号链接使其可在全局调用（暂时有个问题，格式化 markdown 时会将其中的 latex 公式比如<code>$\\frac&#123;&#125;&#123;&#125;$</code>变为<code>$\\\\frac&#123;&#125;&#123;&#125;$</code>，不过可以手动替换<code>\\\\</code>为<code>\\</code>，或者也可以尝试其他的格式化工具，见补充部分）</p>\n<p>重新进入 neovim，执行<code>:PlugInstall</code>，等待安装结束，退出</p>\n<h3 id=\"vim-配置\"><a href=\"#vim-配置\" class=\"headerlink\" title=\"vim 配置\"></a>vim 配置</h3><p>剩余的配置如下，重要的在下面，从<code>&quot; vim snippets##########################################</code>开始，前面的除了前两行都是 copy 自<code>coc.nvim</code>的基础配置，不想细看就 copy 吧，如果只想编写 markdown 或 latex，则删除对应插件的配置，顺便把前面的插件也给删了</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">set relativenumber\nset number\n\n&quot; TextEdit might fail if hidden is not set.\nset hidden\n\n&quot; Some servers have issues with backup files, see #649.\nset nobackup\nset nowritebackup\n\n&quot; Give more space for displaying messages.\nset cmdheight&#x3D;2\n\n&quot; Having longer updatetime (default is 4000 ms &#x3D; 4 s) leads to noticeable\n&quot; delays and poor user experience.\nset updatetime&#x3D;300\n\n&quot; Don&#39;t pass messages to |ins-completion-menu|.\nset shortmess+&#x3D;c\n\n&quot; Always show the signcolumn, otherwise it would shift the text each time\n&quot; diagnostics appear&#x2F;become resolved.\nset signcolumn&#x3D;yes\n\n&quot; Use tab for trigger completion with characters ahead and navigate.\n&quot; NOTE: Use command &#39;:verbose imap &lt;tab&gt;&#39; to make sure tab is not mapped by\n&quot; other plugin before putting this into your config.\ninoremap &lt;silent&gt;&lt;expr&gt; &lt;TAB&gt;\n\t\t\t\\ pumvisible() ? &quot;\\&lt;C-n&gt;&quot; :\n\t\t\t\\ &lt;SID&gt;check_back_space() ? &quot;\\&lt;TAB&gt;&quot; :\n\t\t\t\\ coc#refresh()\ninoremap &lt;expr&gt;&lt;S-TAB&gt; pumvisible() ? &quot;\\&lt;C-p&gt;&quot; : &quot;\\&lt;C-h&gt;&quot;\n\nfunction! s:check_back_space() abort\n\tlet col &#x3D; col(&#39;.&#39;) - 1\n\treturn !col || getline(&#39;.&#39;)[col - 1]  &#x3D;~# &#39;\\s&#39;\nendfunction\n\n&quot; Use &lt;c-space&gt; to trigger completion.\ninoremap &lt;silent&gt;&lt;expr&gt; &lt;c-space&gt; coc#refresh()\n\n&quot; Use &lt;cr&gt; to confirm completion, &#96;&lt;C-g&gt;u&#96; means break undo chain at current\n&quot; position. Coc only does snippet and additional edit on confirm.\n&quot; &lt;cr&gt; could be remapped by other vim plugin, try &#96;:verbose imap &lt;CR&gt;&#96;.\nif exists(&#39;*complete_info&#39;)\n\tinoremap &lt;expr&gt; &lt;cr&gt; complete_info()[&quot;selected&quot;] !&#x3D; &quot;-1&quot; ? &quot;\\&lt;C-y&gt;&quot; : &quot;\\&lt;C-g&gt;u\\&lt;CR&gt;&quot;\nelse\n\tinoremap &lt;expr&gt; &lt;cr&gt; pumvisible() ? &quot;\\&lt;C-y&gt;&quot; : &quot;\\&lt;C-g&gt;u\\&lt;CR&gt;&quot;\nendif\n\n&quot; Use &#96;[g&#96; and &#96;]g&#96; to navigate diagnostics\nnmap &lt;silent&gt; [g &lt;Plug&gt;(coc-diagnostic-prev)\nnmap &lt;silent&gt; ]g &lt;Plug&gt;(coc-diagnostic-next)\n\n&quot; GoTo code navigation.\nnmap &lt;silent&gt; gd &lt;Plug&gt;(coc-definition)\nnmap &lt;silent&gt; gy &lt;Plug&gt;(coc-type-definition)\nnmap &lt;silent&gt; gi &lt;Plug&gt;(coc-implementation)\nnmap &lt;silent&gt; gr &lt;Plug&gt;(coc-references)\n\n&quot; Use K to show documentation in preview window.\nnnoremap &lt;silent&gt; K :call &lt;SID&gt;show_documentation()&lt;CR&gt;\n\nfunction! s:show_documentation()\n\tif (index([&#39;vim&#39;,&#39;help&#39;], &amp;filetype) &gt;&#x3D; 0)\n\t\texecute &#39;h &#39;.expand(&#39;&lt;cword&gt;&#39;)\n\telse\n\t\tcall CocAction(&#39;doHover&#39;)\n\tendif\nendfunction\n\n&quot; Highlight the symbol and its references when holding the cursor.\nautocmd CursorHold * silent call CocActionAsync(&#39;highlight&#39;)\n\n&quot; Symbol renaming.\nnmap &lt;leader&gt;rn &lt;Plug&gt;(coc-rename)\n\n&quot; Formatting selected code.\nxmap &lt;leader&gt;f  &lt;Plug&gt;(coc-format-selected)\nnmap &lt;leader&gt;f  &lt;Plug&gt;(coc-format-selected)\n\naugroup mygroup\n\tautocmd!\n\t&quot; Setup formatexpr specified filetype(s).\n\tautocmd FileType typescript,json setl formatexpr&#x3D;CocAction(&#39;formatSelected&#39;)\n\t&quot; Update signature help on jump placeholder.\n\tautocmd User CocJumpPlaceholder call CocActionAsync(&#39;showSignatureHelp&#39;)\naugroup end\n\n&quot; Applying codeAction to the selected region.\n&quot; Example: &#96;&lt;leader&gt;aap&#96; for current paragraph\nxmap &lt;leader&gt;a  &lt;Plug&gt;(coc-codeaction-selected)\nnmap &lt;leader&gt;a  &lt;Plug&gt;(coc-codeaction-selected)\n\n&quot; Remap keys for applying codeAction to the current line.\nnmap &lt;leader&gt;ac  &lt;Plug&gt;(coc-codeaction)\n&quot; Apply AutoFix to problem on the current line.\nnmap &lt;leader&gt;qf  &lt;Plug&gt;(coc-fix-current)\n\n&quot; Map function and class text objects\n&quot; NOTE: Requires &#39;textDocument.documentSymbol&#39; support from the language server.\nxmap if &lt;Plug&gt;(coc-funcobj-i)\nomap if &lt;Plug&gt;(coc-funcobj-i)\nxmap af &lt;Plug&gt;(coc-funcobj-a)\nomap af &lt;Plug&gt;(coc-funcobj-a)\nxmap ic &lt;Plug&gt;(coc-classobj-i)\nomap ic &lt;Plug&gt;(coc-classobj-i)\nxmap ac &lt;Plug&gt;(coc-classobj-a)\nomap ac &lt;Plug&gt;(coc-classobj-a)\n\n&quot; Use CTRL-S for selections ranges.\n&quot; Requires &#39;textDocument&#x2F;selectionRange&#39; support of LS, ex: coc-tsserver\nnmap &lt;silent&gt; &lt;C-s&gt; &lt;Plug&gt;(coc-range-select)\nxmap &lt;silent&gt; &lt;C-s&gt; &lt;Plug&gt;(coc-range-select)\n\n&quot; Add &#96;:Format&#96; command to format current buffer.\ncommand! -nargs&#x3D;0 Format :call CocAction(&#39;format&#39;)\n\n&quot; Add &#96;:Fold&#96; command to fold current buffer.\ncommand! -nargs&#x3D;? Fold :call     CocAction(&#39;fold&#39;, &lt;f-args&gt;)\n\n&quot; Add &#96;:OR&#96; command for organize imports of the current buffer.\ncommand! -nargs&#x3D;0 OR   :call     CocAction(&#39;runCommand&#39;, &#39;editor.action.organizeImport&#39;)\n\n&quot; Add (Neo)Vim&#39;s native statusline support.\n&quot; NOTE: Please see &#96;:h coc-status&#96; for integrations with external plugins that\n&quot; provide custom statusline: lightline.vim, vim-airline.\nset statusline^&#x3D;%&#123;coc#status()&#125;%&#123;get(b:,&#39;coc_current_function&#39;,&#39;&#39;)&#125;\n\n&quot; Mappings using CoCList:\n&quot; Show all diagnostics.\nnnoremap &lt;silent&gt; &lt;space&gt;a  :&lt;C-u&gt;CocList diagnostics&lt;cr&gt;\n&quot; Manage extensions.\nnnoremap &lt;silent&gt; &lt;space&gt;e  :&lt;C-u&gt;CocList extensions&lt;cr&gt;\n&quot; Show commands.\nnnoremap &lt;silent&gt; &lt;space&gt;c  :&lt;C-u&gt;CocList commands&lt;cr&gt;\n&quot; Find symbol of current document.\nnnoremap &lt;silent&gt; &lt;space&gt;o  :&lt;C-u&gt;CocList outline&lt;cr&gt;\n&quot; Search workspace symbols.\nnnoremap &lt;silent&gt; &lt;space&gt;s  :&lt;C-u&gt;CocList -I symbols&lt;cr&gt;\n&quot; Do default action for next item.\nnnoremap &lt;silent&gt; &lt;space&gt;j  :&lt;C-u&gt;CocNext&lt;CR&gt;\n&quot; Do default action for previous item.\nnnoremap &lt;silent&gt; &lt;space&gt;k  :&lt;C-u&gt;CocPrev&lt;CR&gt;\n&quot; Resume latest coc list.\nnnoremap &lt;silent&gt; &lt;space&gt;p  :&lt;C-u&gt;CocListResume&lt;CR&gt;\n\n&quot; vim snippets##########################################\nlet g:UltiSnipsExpandTrigger&#x3D;&quot;&lt;tab&gt;&quot;\nlet g:UltiSnipsJumpForwardTrigger&#x3D;&quot;&lt;c-b&gt;&quot;\nlet g:UltiSnipsJumpBackwardTrigger&#x3D;&quot;&lt;c-z&gt;&quot;\n\n&quot; autoformat##########################################\nnoremap &lt;C-L&gt; :Autoformat&lt;CR&gt;\n\n&quot; nerdtree##########################################\nmap &lt;C-p&gt; :NERDTreeToggle&lt;CR&gt;\n\n&quot; vimtex##########################################\nlet g:vimtex_view_general_viewer &#x3D; &#39;mupdf&#39;\nlet g:vimtex_view_general_options_latexmk &#x3D; &#39;-reuse-instance&#39;\nlet g:vimtex_view_general_options\n\\ &#x3D; &#39;-reuse-instance -forward-search @tex @line @pdf&#39;\n\\ . &#39; -inverse-search &quot;&#39; . exepath(v:progpath)\n\\ . &#39; --servername &#39; . v:servername\n\\ . &#39; --remote-send \\&quot;^&lt;C-\\^&gt;^&lt;C-n^&gt;&#39;\n\\ . &#39;:execute &#39;&#39;drop &#39;&#39; . fnameescape(&#39;&#39;\\%f&#39;&#39;)^&lt;CR^&gt;&#39;\n\\ . &#39;:\\%l^&lt;CR^&gt;:normal\\! zzzv^&lt;CR^&gt;&#39;\n\\ . &#39;:call remote_foreground(&#39;&#39;&#39;.v:servername.&#39;&#39;&#39;)^&lt;CR^&gt;^&lt;CR^&gt;\\&quot;&quot;&#39;\n\nset conceallevel&#x3D;1\nlet g:tex_conceal&#x3D;&#39;abdmg&#39;\n&quot; Prevent that vim detect a file with the tex suffix as a plaintex\nlet g:tex_flavor&#x3D;&#39;latex&#39;\n&quot; Set the viewer method\nlet g:vimtex_view_method&#x3D;&#39;mupdf&#39;\n&quot; Never opened&#x2F;closed the quickfix window automatically. The quickfix window shows the errors and&#x2F;or warnings when compile, and we can open the quickfix windows use \\le\nlet g:vimtex_quickfix_mode&#x3D;0\n&quot; 最后两行开启自动隐藏功能,开启了这个功能，除了你光标所在的那一行之外，文本里夹杂的LaTeX代码就都会隐藏或者替换成其他符号\nset conceallevel&#x3D;1\n\nlet &amp;t_SI.&#x3D;&quot;\\e[5 q&quot; &quot;SI &#x3D; INSERT mode\nlet &amp;t_SR.&#x3D;&quot;\\e[4 q&quot; &quot;SR &#x3D; REPLACE mode\nlet &amp;t_EI.&#x3D;&quot;\\e[1 q&quot; &quot;EI &#x3D; NORMAL mode (ELSE)\n\ninoremap &lt;C-c&gt; &lt;esc&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>说明：格式化快捷键设置成了<code>ctrl + l</code>，<code>coc.nvim</code>可以使用<code>ctrl + n</code>选择提示项（只能往下翻，对我来说足够了，需要更好地体验可以自行设置），按<code>ctrl + p</code>打开文件树</p>\n<h3 id=\"输入法自动切换\"><a href=\"#输入法自动切换\" class=\"headerlink\" title=\"输入法自动切换\"></a>输入法自动切换</h3><p>这部分很重要，极其影响体验感</p>\n<p>首先确保你使用的是 fcitx 输入法，fcitx4 和 fcitx5 都可以</p>\n<p><a href=\"https://www.vim.org/scripts/script.php?script_id=3764\">下载最新版本的 fcitx.vim</a></p>\n<p>解压后把 plugin 和 so 两个文件夹放到<code>~/.config/nvim</code>，或者干脆在这个目录下解压，如果是 vim，则应放到<code>~/.vim</code></p>\n<p>这里有个坑，上面已经填了，配置文件最后一行<code>inoremap &lt;C-c&gt; &lt;esc&gt;</code>，将<code>ctrl + c</code>映射为<code>esc</code>，默认情况下两者都可以进入普通模式，但前者不会触发相关事件，这使得插件无效（不知有没有像我一样使用<code>ctrl + c</code>的 vimer）</p>\n<p>如果你的<code>ctrl + c</code>在插入模式下另有用处，请删除该行</p>\n<p>注意：作者并不是为 neovim 设计的插件，目前最新版本的 neovim 可以使用，但不意味着一直可以使用</p>\n<h3 id=\"相关-python-依赖安装\"><a href=\"#相关-python-依赖安装\" class=\"headerlink\" title=\"相关 python 依赖安装\"></a>相关 python 依赖安装</h3><p>coc.nvim 需要 python 模块支持，另外 fcitx.vim 也需要 python 的 vim 模块以使用 fcitx.py 来获取更好的体验，不过这和 neovim 就没关系了，也可以装上，还有<code>autoformat</code>插件也需要 Python 模块</p>\n<p>使用<code>pip</code>安装<code>python-vim</code>、<code>neovim</code>，并<code>python3 -m pip install pynvim</code></p>\n<p>对于 gentoo，使用 pip 安装 python 模块需要加–usr 选项，这样安装的模块默认情况下是无法被 python 找到的，需要设置一下。如果不知如何解决，可以直接<code>emerge dev-python/pynvim</code>，其他的就无需安装</p>\n<p>如果你的 neovim 找不到 Python3，则在 neovim 配置文件中加入<code>let g:python3_host_prog=/path/to/python/executable/</code>，路径自己改</p>\n<h3 id=\"coc-nvim-配置\"><a href=\"#coc-nvim-配置\" class=\"headerlink\" title=\"coc.nvim 配置\"></a>coc.nvim 配置</h3><p>查看<a href=\"https://github.com/neoclide/coc.nvim/wiki/Using-coc-extensions\">coc extensions</a>，找到 markdown 和 latex 的对应扩展（按需安装），使用<code>:CocInstall</code>指令安装</p>\n<p>此外，还需要安装<code>coc-snippets</code>和<code>coc-actions</code>以配合 snippets 相关插件</p>\n<p>查看<a href=\"https://github.com/neoclide/coc.nvim/wiki/Language-servers\">coc language servers</a>，找到 markdown 和 latex，按照指示完成配置，如果遇到困难，继续往下看</p>\n<p>这里使用<code>:CocConfig</code>指令打开 coc 配置文件，如果你不熟悉 json，特别注意，文件中的所有内容需要用<code>&#123;&#125;</code>包起来，直接 copy 作者给的配置会出现语法错误</p>\n<p>这里安装<code>efm-langserver</code>和<code>digestif</code>又有问题了，arch 直接从 aur 安装再次避坑（需要先配置 go 语言环境，GOROOT 在 arch 上为<code>/usr/lib/go</code>，如果你上网找的话，可能会被<code>/usr/local/go</code>给坑了，go 安裝完毕后 GOROOT 下是有文件的，不确定是哪个可以去查看一下，另外还需要打开<code>go module</code>，以及给<code>go get</code>设置国内代理，详见<a href=\"https://blog.csdn.net/weixin_44690437/article/details/103571558\">go 语言依赖管理</a>，试图那啥的可以省省了，<code>go get</code>不认这招，或许全系统代理可以），其他的可能需要折腾一会儿</p>\n<p>这里附上我的<code>coc-settings.json</code>，copy 的时候把两个路径换成自己的，另外特别注意<code>command</code>需要使用绝对路径</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n          languageserver : &#123;\n                   digestif : &#123;\n                          command :  &#x2F;bin&#x2F;digestif ,\n                          filetypes : [ tex ,  plaintex ,  context ]\n                 &#125;,\n                  efm : &#123;\n                          command :  &#x2F;bin&#x2F;efm-langserver ,\n                         args : [ -c ,  &#x2F;home&#x2F;yourUsername&#x2F;.config&#x2F;efm-langserver&#x2F;config.yaml ],\n                          filetypes : [ vim ,  eruby ,  markdown ]\n                 &#125;\n        &#125;,\n          suggest.noselect : false\n &#125;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"markdown\"><a href=\"#markdown\" class=\"headerlink\" title=\"markdown\"></a>markdown</h2><p>markdown 的部分上面已经完成的差不多了，现在先创建一个.md 文件，查看是否可以补全，<code>nvim test.md</code>，输入<code>img</code>，应该会有提示，如果没有，请检查<code>coc.nvim</code>以及两个关于<code>snippets</code>的插件</p>\n<p>目前还有一个至关重要的问题，markdown 中的 latex 无法补全，极其影响体验感，不过<code>coc.nvim</code>可以<a href=\"https://github.com/neoclide/coc.nvim/wiki/Create-custom-source\">自定义 sources</a>，在<code>~/.config/nvim/autoload/coc/source</code>下创建<code>latex.vim</code>，写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">function! coc#source#latex#init() abort\n\treturn &#123;\n\t\t\t\t\\ &#39;triggerCharacters&#39;: [&#39;\\&#39;],\n\t\t\t\t\\&#39;filetype&#39;:[&#39;markdown&#39;]\n\t\t\t\t\\&#125;\nendfunction\n\nfunction! coc#source#latex#complete(opt, cb) abort\n\tlet items &#x3D; [&#39;dot&#123;&#125;&#39;, &#39;ddot&#123;&#125;&#39;, &#39;bar&#123;&#125;&#39;, &#39;hat&#123;&#125;&#39;, &#39;exp&#39;, &#39;sin&#39;, &#39;cos&#39;, &#39;tan&#39;, &#39;sec&#39;, &#39;csc&#39;, &#39;vec&#123;&#125;&#39;, &#39;cot&#39;, &#39;arcsin&#39;, &#39;arccos&#39;, &#39;arctan&#39;, &#39;sinh&#39;, &#39;cosh&#39;, &#39;tanh&#39;, &#39;coth&#39;, &#39;sh&#39;, &#39;ch&#39;, &#39;th&#39;, &#39;max&#39;, &#39;min&#39;, &#39;partial&#39;, &#39;nabla&#39;, &#39;prime&#39;, &#39;backprime&#39;, &#39;infty&#39;, &#39;eth&#39;, &#39;hbar&#39;, &#39;sqrt&#123;&#125;&#39;, &#39;sqrt[]&#123;&#125;&#39;, &#39;pm&#39;, &#39;mp&#39;, &#39;times&#39;, &#39;div&#39;, &#39;cdot&#39;, &#39;odot&#39;, &#39;bigodot&#39; , &#39;&#123; \\&#125;&#39;, &#39;in&#39;, &#39;not&#39;, &#39;ni&#39;, &#39;cap&#39;, &#39;Cap&#39;, &#39;bigcap&#39;, &#39;cup&#39;, &#39;Cup&#39;, &#39;bigcup&#39;, &#39;subset&#39;, &#39;supset&#39;, &#39;supseteq&#39;, &#39;subseteq&#39;, &#39;subseteqq&#39;, &#39;supseteqq&#39;, &#39;subsetneq&#39;, &#39;supsetneq&#39;, &#39;supsetneqq&#39;, &#39;subsetneqq&#39;, &#39;sim&#39;, &#39;approx&#39;, &#39;leq&#39;, &#39;geq&#39;, &#39;parallel&#39;, &#39;nparallel&#39;, &#39;perp&#39;, &#39;angle&#39;, &#39;Box&#39;, &#39;bigtriangleup&#39;, &#39;bigtriangledown&#39;, &#39;forall&#39;, &#39;therefore&#39;, &#39;because&#39;, &#39;overline&#123;&#125;&#39;, &#39;Rightarrow&#39;, &#39;Leftarrow&#39;, &#39;rightarrow&#39;, &#39;leftarrow&#39;, &#39;leftrightarrow&#39;, &#39;nRightarrow&#39;, &#39;nLeftarrow&#39;, &#39;nleftarrow&#39;, &#39;nrightarrow&#39;, &#39;nleftrightarrow&#39;, &#39;overleftarrow&#123;&#125;&#39;, &#39;overrightarrow&#123;&#125;&#39;, &#39;overset&#123;&#125;&#39;, &#39;underline&#123;&#125;&#39;, &#39;sum&#39;, &#39;prod&#39;, &#39;lim&#39;, &#39;limits&#39;, &#39;int&#39;, &#39;iint&#39;, &#39;oint&#39;, &#39;iiint&#39;, &#39;frac&#123;&#125;&#123;&#125;&#39;, &#39;tfrac&#123;&#125;&#123;&#125;&#39;, &#39;dfrac&#123;&#125;&#123;&#125;&#39;, &#39;\\begin&#123;matrix&#125;\\end&#123;matrix&#125;&#39;, &#39;\\begin&#123;vmatrix&#125;\\end&#123;vmatrix&#125;&#39;, &#39;\\begin&#123;bmatrix&#125;\\end&#123;bmatrix&#125;&#39;, &#39;\\begin&#123;Bmatrix&#125;\\end&#123;Bmatrix&#125;&#39;, &#39;\\begin&#123;pmatrix&#125;\\end&#123;pmatrix&#125;&#39;,&#39;\\begin&#123;cases&#125;\\end&#123;cases&#125;&#39;, &#39;\\begin&#123;aligned&#125;\\end&#123;aligned&#125;&#39;, &#39;\\begin&#123;array&#125;\\end&#123;array&#125;&#39;, &#39;alpha&#39;, &#39;psi&#39;, &#39;Delta&#39;, &#39;delta&#39;, &#39;beta&#39;, &#39;lambda&#39;, &#39;rho&#39;, &#39;varepsilon&#39;, &#39;Gamma&#39;, &#39;chi&#39;, &#39;mu&#39;, &#39;sigma&#39;, &#39;Lambda&#39;, &#39;tau&#39;, &#39;varphi&#39;, &#39;varPhi&#39;, &#39;phi&#39;, &#39;Phi&#39;, &#39;eta&#39;, &#39;omega&#39;, &#39;varrho&#39;, &#39;Pi&#39;, &#39;pi&#39;, &#39;gamma&#39;, &#39;xi&#39;, &#39;Psi&#39;, &#39;Sigma&#39;, &#39;varnothing&#39;, &#39;iiiint&#39;]\n\tcall a:cb(items)\nendfunction<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>关于自定义 source 的具体细节，请前往 github，上面给出的 source 设定在 markdown 文件下加载，使用<code>\\</code>作为触发符，这里只加入了我常用的几个命令，更多内容可以自行添加</p>\n<p>到此，markdown 部分已经完成，可以先检查一下有没有问题</p>\n<h2 id=\"latex\"><a href=\"#latex\" class=\"headerlink\" title=\"latex\"></a>latex</h2><p>首先安装 latex 编译环境，这里使用 texlive</p>\n<p>参考<a href=\"https://wiki.archlinux.org/index.php/TeX_Live_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)\">arch wiki</a>，不想折腾的话就把安装部分提到的几个包全装了，应该就问题不大了</p>\n<p>如果还有问题，或者是其他 linux 发行版，可以参考<a href=\"https://zhuanlan.zhihu.com/p/40053417\">Deepin Linux 安装和搭建 LaTex 环境</a>和<a href=\"https://blog.csdn.net/qq_41814939/article/details/82288145\">Ubuntu18.04 安装 LaTeX 并配置中文环境</a>，不过安装 texlive-full 实在太麻烦了，我装了 3 小时，最后似乎卡住了，手贱中断了，再也装不上了，这个包和前面 arch wiki 中提到的包大部分是冲突的，如果是 arch 系的就不要折腾这个了，如果是 gentoo 的话，如果坚持本地编译的话，建议备好电影小零食~~（窃以为使用 gentoo 的 linux 骨灰级玩家不需要这篇文章，强行 gentoo 的玩家可能还没从坑里爬出来）</p>\n<p>安装 MuPDF，当然你也可以选择别的，详见<a href=\"https://github.com/lervag/vimtex\">github</a>，如果换了的话需要把上面的配置也一并修改</p>\n<p>到此结束，测试一下，<code>nvim test.tex</code>，写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">\\documentclass&#123;article&#125;\n\\begin&#123;document&#125;\n你好，world!\n\\end&#123;document&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>在普通模式下按<code>\\ll</code>进行编译，再按<code>\\lv</code>预览，不要关闭预览窗口，修改成<code>hello world</code>，保存，重新编译，看看预览是否同步改变，这里还可以设置保存时自动编译</p>\n<h2 id=\"更多\"><a href=\"#更多\" class=\"headerlink\" title=\"更多\"></a>更多</h2><ul>\n<li>linux 下没有可以和 FastStone 媲美的截图软件，不过可以用 KolourPaint 快速编辑图片，需要更多操作可以使用 GIMP，不建议使用 Pinta，由于无法输入中文</li>\n<li>markdown 中可以用 html 语法插入 mp4 视频，比起 gif 的好处就不用多说了，缺点是略显臃肿</li>\n<li>可以再为 vim 配置更多插件，比如 markdown 自动贴图、markdown 预览等等，也可以继续自定义 snippets，这些部分按个人喜好配置，这里不再介绍</li>\n<li>桌面推荐 i3，i3 配置较为麻烦，可以保留原有桌面，简单配置 i3，仅用来写 markdown 和 latex</li>\n<li>或许可以在 WSL 中配置，不过暂时折腾到此为止了</li>\n</ul>\n<h2 id=\"补充\"><a href=\"#补充\" class=\"headerlink\" title=\"补充\"></a>补充</h2><h3 id=\"为-markdown-添加大纲显示\"><a href=\"#为-markdown-添加大纲显示\" class=\"headerlink\" title=\"为 markdown 添加大纲显示\"></a>为 markdown 添加大纲显示</h3><h4 id=\"Excuberant-Ctags\"><a href=\"#Excuberant-Ctags\" class=\"headerlink\" title=\"Excuberant Ctags\"></a>Excuberant Ctags</h4><p>首先安装<code>Excuberant Ctags</code>，debian 系和 redhat 系应该可以使用包管理工具直接安装，arch 这次似乎进坑了，需要编译源码</p>\n<p>访问<a href=\"http://ctags.sourceforge.net/\">Excuberant Ctags 下载页面</a>，没错，GFW 警告，这个资源可以在网上搜，文件名为 ctags-5.8，csdn 上有，本来想上传一个免费的，结果死活都重复，算了</p>\n<p>解压，cd 入目录，<code>./configure</code>，继续<code>make &amp;&amp; sudo make install</code>，正常情况下应该没问题了，如果有问题，请参考<a href=\"https://blog.csdn.net/dream2009gd/article/details/44102227\">安装 Exuberant Ctags 及 Tag List 插件</a></p>\n<h4 id=\"easytags\"><a href=\"#easytags\" class=\"headerlink\" title=\"easytags\"></a>easytags</h4><p>使用<code>vim-plug</code>安装</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Plug &#39;xolox&#x2F;vim-misc&#39;\nPlug &#39;xolox&#x2F;vim-easytags&#39;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"tagbar\"><a href=\"#tagbar\" class=\"headerlink\" title=\"tagbar\"></a><a href=\"https://github.com/majutsushi/tagbar\">tagbar</a></h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">Plug &#39;majutsushi&#x2F;tagbar&#39;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>注意使用该插件时可能有问题，详情见 github</p>\n<h4 id=\"markdown2ctags\"><a href=\"#markdown2ctags\" class=\"headerlink\" title=\"markdown2ctags\"></a>markdown2ctags</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">Plug &#39;jszakmeister&#x2F;markdown2ctags&#39;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">&quot; tagbar#####################################\nnmap &lt;C-M&gt; :TagbarToggle&lt;CR&gt;\n\n&quot; markdown2ctags#####################################\nlet g:tagbar_type_markdown &#x3D; &#123;\n    \\ &#39;ctagstype&#39;: &#39;markdown&#39;,\n    \\ &#39;ctagsbin&#39; : &#39;&#x2F;home&#x2F;yourUsername&#x2F;.vim&#x2F;plugged&#x2F;markdown2ctags&#x2F;markdown2ctags.py&#39;,\n    \\ &#39;ctagsargs&#39; : &#39;-f - --sort&#x3D;yes --sro&#x3D;»&#39;,\n    \\ &#39;kinds&#39; : [\n        \\ &#39;s:sections&#39;,\n        \\ &#39;i:images&#39;\n    \\ ],\n    \\ &#39;sro&#39; : &#39;»&#39;,\n    \\ &#39;kind2scope&#39; : &#123;\n        \\ &#39;s&#39; : &#39;section&#39;,\n    \\ &#125;,\n    \\ &#39;sort&#39;: 0,\n\\ &#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>这里给 tagbar 的快捷键设置为<code>ctrl + m</code>，<code>markdown2ctags</code>的配置中需要注意更换你的<code>markdown2ctags.py</code>所在路径，且注意通过<code>:set filetype</code>查看你的 markdown 文件的文件类型名称是否是 markdown，若不是，则修改<code>ctagstype</code></p>\n<h3 id=\"格式化插件neoformat\"><a href=\"#格式化插件neoformat\" class=\"headerlink\" title=\"格式化插件neoformat\"></a>格式化插件<a href=\"https://github.com/sbdchd/neoformat\">neoformat</a></h3><h4 id=\"插件安装\"><a href=\"#插件安装\" class=\"headerlink\" title=\"插件安装\"></a>插件安装</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">Plug &#39;sbdchd&#x2F;neoformat&#39;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"依赖安装\"><a href=\"#依赖安装\" class=\"headerlink\" title=\"依赖安装\"></a>依赖安装</h4><h5 id=\"prettier-for-markdown\"><a href=\"#prettier-for-markdown\" class=\"headerlink\" title=\"prettier for markdown\"></a><a href=\"https://github.com/prettier/prettier\">prettier</a> for markdown</h5><p>不要选 remark 作为格式化软件</p>\n<p>arch 可以直接从 aur 安装，其他参考<a href=\"https://prettier.io/docs/en/install.html\">install prettier</a></p>\n<h5 id=\"latexindent-pl-for-latex\"><a href=\"#latexindent-pl-for-latex\" class=\"headerlink\" title=\"latexindent.pl for latex\"></a><a href=\"https://github.com/cmhughes/latexindent.pl\">latexindent.pl</a> for latex</h5><p>将项目 clone 到本地</p>\n<p>安装<code>perl</code>，执行<code>sudo cpan</code></p>\n<p>进入<code>cpan</code>环境后，执行</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">install Log::Log4perl\ninstall Log::Dispatch::File\ninstall YAML::Tiny\ninstall File::HomeDir<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>再次 GFW 警告</p>\n<p>进入项目目录，测试 latexindent.pl 是否可以正常运行，并设置为可全局调用（最简单的方式是写个 sh 文件，<code>cd youPathToLatexindent.pl &amp;&amp; ./latexindent.pl</code>，然后将其链接到<code>/bin</code>或者<code>/usr/bin</code>）</p>\n<h4 id=\"插件配置\"><a href=\"#插件配置\" class=\"headerlink\" title=\"插件配置\"></a>插件配置</h4><p>只需在<code>init.vim</code>中添加</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">let g:neoformat_latex_latexindent &#x3D;&#123;&#39;exe&#39;:&#39;latexindent&#39;,&#39;args&#39;:[],&#39;stdin&#39;:1&#125;\nlet g:neoformat_enabled_latex&#x3D;[&#39;latexindent&#39;]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>用 prettier 格式化 markdown 失败，笔者暂时未解决该错误，可以使用<a href=\"https://github.com/prettier/vim-prettier\">vim-prettier</a>插件代替，或者手动运行<code>prettier --wirte pathToYourFile</code></p>\n<p>为不同类型的文件添加格式化快捷键</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nnoremap &lt;C-l&gt; :Neoformat&lt;CR&gt;\nautocmd FileType markdown nnoremap &lt;buffer&gt; &lt;C-l&gt; :Prettier&lt;CR&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"使用-vim-编写-markdown-和-latex\"><a href=\"#使用-vim-编写-markdown-和-latex\" class=\"headerlink\" title=\"使用 vim 编写 markdown 和 latex\"></a>使用 vim 编写 markdown 和 latex</h1><h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><h3 id=\"主要配置\"><a href=\"#主要配置\" class=\"headerlink\" title=\"主要配置\"></a>主要配置</h3><ul>\n<li>操作系统：arch linux</li>\n<li>编辑器：neovim（coc-actions 仅支持 neovim），如果使用 vim，请换用另外的补全插件</li>\n<li>预览：markdown 使用 typora，latex 用 vimtex 调用 MuPDF</li>\n</ul>\n<h3 id=\"优缺点\"><a href=\"#优缺点\" class=\"headerlink\" title=\"优缺点\"></a>优缺点</h3><p>在使用 vim 之前，曾尝试了两种方案，一是 vscode + vim，配置简单，功能都还不错，问题是自动输入法切换延迟有点长，甚至使用方向键都有点卡，二是 jetbrains 系列的 ide，windows 下用来码字是体验最好的（linux 下对中文输入法不友好），但资源消耗太多，且预览不是很理想</p>\n<p>下面是这套方案的优缺点</p>\n<ul>\n<li>linux 下 vim 的输入法切换体验远远好于 windows（笔者未使用 mac os，不清楚情况）</li>\n<li>windows 下使用 texlive 安装 latex 相关依赖，编译 latex 文档时出现错误，暂时没能修复，linux 下比较稳定</li>\n<li>neovim 以及 vim 比 vscode + vim 插件更流畅</li>\n<li>支持 latex 即时编译，缺点是无法正反向搜索，这点在 vscode 中是支持的</li>\n<li>typora 对 markdown 渲染的支持比 vim 以及 vscode 的相关插件好得多，比如支持本地 mp4 视频插入等，缺点是无法正反向搜索</li>\n</ul>\n<h3 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h3><ul>\n<li>以下步骤全靠回忆，不会有错，但可能有漏，请小心操作，避免掉坑，欢迎留言</li>\n<li>由于网页的关系，直接从本文复制的内容可能存在非法字符，复制粘贴后应当检查一下</li>\n<li>arch linux 可能帮你避开许多坑，如果想了解并使用 arch，可参考 arch wiki 安装教程，若水平有限，可以在网上搜索视频安装教程，还不行的话直接装 manjaro 吧</li>\n<li>装好下面提到的软件时注意检查是否可以直接在终端调用</li>\n</ul>\n<h2 id=\"vim-简单配置\"><a href=\"#vim-简单配置\" class=\"headerlink\" title=\"vim 简单配置\"></a>vim 简单配置</h2><h3 id=\"vim-plug\"><a href=\"#vim-plug\" class=\"headerlink\" title=\"vim-plug\"></a>vim-plug</h3><p><a href=\"https://github.com/junegunn/vim-plug\">github 地址</a></p>\n<p>作者提供的安装方式应该是装不上的，似乎是这个链接本身有问题，不是 GFW 的锅</p>\n<h4 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h4><p>把项目克隆到本地，将项目中的 plug.vim 放到<code>~/.local/share/nvim/site/autoload</code>目录下，如果你使用 vim，可以放到<code>~/.vim/autoload</code>目录下</p>\n<h4 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h4><p>编辑<code>~/.config/nvim/init.vim</code></p>\n<p>一个<code>Plug</code>对应一个插件，如果你和我一样只是想用 vim 编辑 markdown 和 latex（不包括 markdown 预览），那就直接 copy 吧（注意可以更换第一行<code>begin</code>后插件存放的路径）</p>\n<p>插件依次为自动补全、文件树、文件浏览器（需要安装 nnn，没有的话就不要它了）、snippets 补全、snippets 补全、状态栏美化、自动格式化、markdown 支持、开始界面、latex 支持</p>\n<p>部分本文未涉及的插件的具体用法请自行前往 github 查看，或者放弃使用</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">call plug#begin(&#39;~&#x2F;.vim&#x2F;plugged&#39;)\nPlug &#39;neoclide&#x2F;coc.nvim&#39;, &#123;&#39;branch&#39;: &#39;release&#39;&#125;\nPlug &#39;preservim&#x2F;nerdtree&#39;\nPlug &#39;mcchrish&#x2F;nnn.vim&#39;\nPlug &#39;SirVer&#x2F;ultisnips&#39;\nPlug &#39;honza&#x2F;vim-snippets&#39;\nPlug &#39;vim-airline&#x2F;vim-airline&#39;\nPlug &#39;Chiel92&#x2F;vim-autoformat&#39;\nPlug &#39;plasticboy&#x2F;vim-markdown&#39;\nPlug &#39;mhinz&#x2F;vim-startify&#39;\nPlug &#39;lervag&#x2F;vimtex&#39;\ncall plug#end()<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>先别急着装插件，查看<a href=\"https://github.com/neoclide/coc.nvim/wiki/Install-coc.nvim\">coc.nvim wiki</a>，先把依赖装了，主要是<code>nodejs</code>和<code>yarn</code>，作者给出的方法再次有点为难了，不过 arch linux 直接用包管理器装就行，其他的可能需要折腾一会儿</p>\n<p>另外<a href=\"https://github.com/Chiel92/vim-autoformat\">vim-autoformat</a>插件需要安装依赖，在 vim-autoformat 的 github 主页下查找，主要是<code>remark</code> for markdown 以及<code>latexindent.pl</code> for latex，arch 系 linux 可以先尝试从 aur 安装，不行的话可以按照 github 上作者给出的方式安装，大概又是一番折腾，特别注意，如果这两个软件无法在全局调用，需要在配置文件中加上<code>let g:formatterpath = [&#39;/some/path/to/a/folder&#39;, &#39;/home/superman/formatters&#39;]</code>，也可以选择创建符号链接使其可在全局调用（暂时有个问题，格式化 markdown 时会将其中的 latex 公式比如<code>$\\frac&#123;&#125;&#123;&#125;$</code>变为<code>$\\\\frac&#123;&#125;&#123;&#125;$</code>，不过可以手动替换<code>\\\\</code>为<code>\\</code>，或者也可以尝试其他的格式化工具，见补充部分）</p>\n<p>重新进入 neovim，执行<code>:PlugInstall</code>，等待安装结束，退出</p>\n<h3 id=\"vim-配置\"><a href=\"#vim-配置\" class=\"headerlink\" title=\"vim 配置\"></a>vim 配置</h3><p>剩余的配置如下，重要的在下面，从<code>&quot; vim snippets##########################################</code>开始，前面的除了前两行都是 copy 自<code>coc.nvim</code>的基础配置，不想细看就 copy 吧，如果只想编写 markdown 或 latex，则删除对应插件的配置，顺便把前面的插件也给删了</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">set relativenumber\nset number\n\n&quot; TextEdit might fail if hidden is not set.\nset hidden\n\n&quot; Some servers have issues with backup files, see #649.\nset nobackup\nset nowritebackup\n\n&quot; Give more space for displaying messages.\nset cmdheight&#x3D;2\n\n&quot; Having longer updatetime (default is 4000 ms &#x3D; 4 s) leads to noticeable\n&quot; delays and poor user experience.\nset updatetime&#x3D;300\n\n&quot; Don&#39;t pass messages to |ins-completion-menu|.\nset shortmess+&#x3D;c\n\n&quot; Always show the signcolumn, otherwise it would shift the text each time\n&quot; diagnostics appear&#x2F;become resolved.\nset signcolumn&#x3D;yes\n\n&quot; Use tab for trigger completion with characters ahead and navigate.\n&quot; NOTE: Use command &#39;:verbose imap &lt;tab&gt;&#39; to make sure tab is not mapped by\n&quot; other plugin before putting this into your config.\ninoremap &lt;silent&gt;&lt;expr&gt; &lt;TAB&gt;\n\t\t\t\\ pumvisible() ? &quot;\\&lt;C-n&gt;&quot; :\n\t\t\t\\ &lt;SID&gt;check_back_space() ? &quot;\\&lt;TAB&gt;&quot; :\n\t\t\t\\ coc#refresh()\ninoremap &lt;expr&gt;&lt;S-TAB&gt; pumvisible() ? &quot;\\&lt;C-p&gt;&quot; : &quot;\\&lt;C-h&gt;&quot;\n\nfunction! s:check_back_space() abort\n\tlet col &#x3D; col(&#39;.&#39;) - 1\n\treturn !col || getline(&#39;.&#39;)[col - 1]  &#x3D;~# &#39;\\s&#39;\nendfunction\n\n&quot; Use &lt;c-space&gt; to trigger completion.\ninoremap &lt;silent&gt;&lt;expr&gt; &lt;c-space&gt; coc#refresh()\n\n&quot; Use &lt;cr&gt; to confirm completion, &#96;&lt;C-g&gt;u&#96; means break undo chain at current\n&quot; position. Coc only does snippet and additional edit on confirm.\n&quot; &lt;cr&gt; could be remapped by other vim plugin, try &#96;:verbose imap &lt;CR&gt;&#96;.\nif exists(&#39;*complete_info&#39;)\n\tinoremap &lt;expr&gt; &lt;cr&gt; complete_info()[&quot;selected&quot;] !&#x3D; &quot;-1&quot; ? &quot;\\&lt;C-y&gt;&quot; : &quot;\\&lt;C-g&gt;u\\&lt;CR&gt;&quot;\nelse\n\tinoremap &lt;expr&gt; &lt;cr&gt; pumvisible() ? &quot;\\&lt;C-y&gt;&quot; : &quot;\\&lt;C-g&gt;u\\&lt;CR&gt;&quot;\nendif\n\n&quot; Use &#96;[g&#96; and &#96;]g&#96; to navigate diagnostics\nnmap &lt;silent&gt; [g &lt;Plug&gt;(coc-diagnostic-prev)\nnmap &lt;silent&gt; ]g &lt;Plug&gt;(coc-diagnostic-next)\n\n&quot; GoTo code navigation.\nnmap &lt;silent&gt; gd &lt;Plug&gt;(coc-definition)\nnmap &lt;silent&gt; gy &lt;Plug&gt;(coc-type-definition)\nnmap &lt;silent&gt; gi &lt;Plug&gt;(coc-implementation)\nnmap &lt;silent&gt; gr &lt;Plug&gt;(coc-references)\n\n&quot; Use K to show documentation in preview window.\nnnoremap &lt;silent&gt; K :call &lt;SID&gt;show_documentation()&lt;CR&gt;\n\nfunction! s:show_documentation()\n\tif (index([&#39;vim&#39;,&#39;help&#39;], &amp;filetype) &gt;&#x3D; 0)\n\t\texecute &#39;h &#39;.expand(&#39;&lt;cword&gt;&#39;)\n\telse\n\t\tcall CocAction(&#39;doHover&#39;)\n\tendif\nendfunction\n\n&quot; Highlight the symbol and its references when holding the cursor.\nautocmd CursorHold * silent call CocActionAsync(&#39;highlight&#39;)\n\n&quot; Symbol renaming.\nnmap &lt;leader&gt;rn &lt;Plug&gt;(coc-rename)\n\n&quot; Formatting selected code.\nxmap &lt;leader&gt;f  &lt;Plug&gt;(coc-format-selected)\nnmap &lt;leader&gt;f  &lt;Plug&gt;(coc-format-selected)\n\naugroup mygroup\n\tautocmd!\n\t&quot; Setup formatexpr specified filetype(s).\n\tautocmd FileType typescript,json setl formatexpr&#x3D;CocAction(&#39;formatSelected&#39;)\n\t&quot; Update signature help on jump placeholder.\n\tautocmd User CocJumpPlaceholder call CocActionAsync(&#39;showSignatureHelp&#39;)\naugroup end\n\n&quot; Applying codeAction to the selected region.\n&quot; Example: &#96;&lt;leader&gt;aap&#96; for current paragraph\nxmap &lt;leader&gt;a  &lt;Plug&gt;(coc-codeaction-selected)\nnmap &lt;leader&gt;a  &lt;Plug&gt;(coc-codeaction-selected)\n\n&quot; Remap keys for applying codeAction to the current line.\nnmap &lt;leader&gt;ac  &lt;Plug&gt;(coc-codeaction)\n&quot; Apply AutoFix to problem on the current line.\nnmap &lt;leader&gt;qf  &lt;Plug&gt;(coc-fix-current)\n\n&quot; Map function and class text objects\n&quot; NOTE: Requires &#39;textDocument.documentSymbol&#39; support from the language server.\nxmap if &lt;Plug&gt;(coc-funcobj-i)\nomap if &lt;Plug&gt;(coc-funcobj-i)\nxmap af &lt;Plug&gt;(coc-funcobj-a)\nomap af &lt;Plug&gt;(coc-funcobj-a)\nxmap ic &lt;Plug&gt;(coc-classobj-i)\nomap ic &lt;Plug&gt;(coc-classobj-i)\nxmap ac &lt;Plug&gt;(coc-classobj-a)\nomap ac &lt;Plug&gt;(coc-classobj-a)\n\n&quot; Use CTRL-S for selections ranges.\n&quot; Requires &#39;textDocument&#x2F;selectionRange&#39; support of LS, ex: coc-tsserver\nnmap &lt;silent&gt; &lt;C-s&gt; &lt;Plug&gt;(coc-range-select)\nxmap &lt;silent&gt; &lt;C-s&gt; &lt;Plug&gt;(coc-range-select)\n\n&quot; Add &#96;:Format&#96; command to format current buffer.\ncommand! -nargs&#x3D;0 Format :call CocAction(&#39;format&#39;)\n\n&quot; Add &#96;:Fold&#96; command to fold current buffer.\ncommand! -nargs&#x3D;? Fold :call     CocAction(&#39;fold&#39;, &lt;f-args&gt;)\n\n&quot; Add &#96;:OR&#96; command for organize imports of the current buffer.\ncommand! -nargs&#x3D;0 OR   :call     CocAction(&#39;runCommand&#39;, &#39;editor.action.organizeImport&#39;)\n\n&quot; Add (Neo)Vim&#39;s native statusline support.\n&quot; NOTE: Please see &#96;:h coc-status&#96; for integrations with external plugins that\n&quot; provide custom statusline: lightline.vim, vim-airline.\nset statusline^&#x3D;%&#123;coc#status()&#125;%&#123;get(b:,&#39;coc_current_function&#39;,&#39;&#39;)&#125;\n\n&quot; Mappings using CoCList:\n&quot; Show all diagnostics.\nnnoremap &lt;silent&gt; &lt;space&gt;a  :&lt;C-u&gt;CocList diagnostics&lt;cr&gt;\n&quot; Manage extensions.\nnnoremap &lt;silent&gt; &lt;space&gt;e  :&lt;C-u&gt;CocList extensions&lt;cr&gt;\n&quot; Show commands.\nnnoremap &lt;silent&gt; &lt;space&gt;c  :&lt;C-u&gt;CocList commands&lt;cr&gt;\n&quot; Find symbol of current document.\nnnoremap &lt;silent&gt; &lt;space&gt;o  :&lt;C-u&gt;CocList outline&lt;cr&gt;\n&quot; Search workspace symbols.\nnnoremap &lt;silent&gt; &lt;space&gt;s  :&lt;C-u&gt;CocList -I symbols&lt;cr&gt;\n&quot; Do default action for next item.\nnnoremap &lt;silent&gt; &lt;space&gt;j  :&lt;C-u&gt;CocNext&lt;CR&gt;\n&quot; Do default action for previous item.\nnnoremap &lt;silent&gt; &lt;space&gt;k  :&lt;C-u&gt;CocPrev&lt;CR&gt;\n&quot; Resume latest coc list.\nnnoremap &lt;silent&gt; &lt;space&gt;p  :&lt;C-u&gt;CocListResume&lt;CR&gt;\n\n&quot; vim snippets##########################################\nlet g:UltiSnipsExpandTrigger&#x3D;&quot;&lt;tab&gt;&quot;\nlet g:UltiSnipsJumpForwardTrigger&#x3D;&quot;&lt;c-b&gt;&quot;\nlet g:UltiSnipsJumpBackwardTrigger&#x3D;&quot;&lt;c-z&gt;&quot;\n\n&quot; autoformat##########################################\nnoremap &lt;C-L&gt; :Autoformat&lt;CR&gt;\n\n&quot; nerdtree##########################################\nmap &lt;C-p&gt; :NERDTreeToggle&lt;CR&gt;\n\n&quot; vimtex##########################################\nlet g:vimtex_view_general_viewer &#x3D; &#39;mupdf&#39;\nlet g:vimtex_view_general_options_latexmk &#x3D; &#39;-reuse-instance&#39;\nlet g:vimtex_view_general_options\n\\ &#x3D; &#39;-reuse-instance -forward-search @tex @line @pdf&#39;\n\\ . &#39; -inverse-search &quot;&#39; . exepath(v:progpath)\n\\ . &#39; --servername &#39; . v:servername\n\\ . &#39; --remote-send \\&quot;^&lt;C-\\^&gt;^&lt;C-n^&gt;&#39;\n\\ . &#39;:execute &#39;&#39;drop &#39;&#39; . fnameescape(&#39;&#39;\\%f&#39;&#39;)^&lt;CR^&gt;&#39;\n\\ . &#39;:\\%l^&lt;CR^&gt;:normal\\! zzzv^&lt;CR^&gt;&#39;\n\\ . &#39;:call remote_foreground(&#39;&#39;&#39;.v:servername.&#39;&#39;&#39;)^&lt;CR^&gt;^&lt;CR^&gt;\\&quot;&quot;&#39;\n\nset conceallevel&#x3D;1\nlet g:tex_conceal&#x3D;&#39;abdmg&#39;\n&quot; Prevent that vim detect a file with the tex suffix as a plaintex\nlet g:tex_flavor&#x3D;&#39;latex&#39;\n&quot; Set the viewer method\nlet g:vimtex_view_method&#x3D;&#39;mupdf&#39;\n&quot; Never opened&#x2F;closed the quickfix window automatically. The quickfix window shows the errors and&#x2F;or warnings when compile, and we can open the quickfix windows use \\le\nlet g:vimtex_quickfix_mode&#x3D;0\n&quot; 最后两行开启自动隐藏功能,开启了这个功能，除了你光标所在的那一行之外，文本里夹杂的LaTeX代码就都会隐藏或者替换成其他符号\nset conceallevel&#x3D;1\n\nlet &amp;t_SI.&#x3D;&quot;\\e[5 q&quot; &quot;SI &#x3D; INSERT mode\nlet &amp;t_SR.&#x3D;&quot;\\e[4 q&quot; &quot;SR &#x3D; REPLACE mode\nlet &amp;t_EI.&#x3D;&quot;\\e[1 q&quot; &quot;EI &#x3D; NORMAL mode (ELSE)\n\ninoremap &lt;C-c&gt; &lt;esc&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>说明：格式化快捷键设置成了<code>ctrl + l</code>，<code>coc.nvim</code>可以使用<code>ctrl + n</code>选择提示项（只能往下翻，对我来说足够了，需要更好地体验可以自行设置），按<code>ctrl + p</code>打开文件树</p>\n<h3 id=\"输入法自动切换\"><a href=\"#输入法自动切换\" class=\"headerlink\" title=\"输入法自动切换\"></a>输入法自动切换</h3><p>这部分很重要，极其影响体验感</p>\n<p>首先确保你使用的是 fcitx 输入法，fcitx4 和 fcitx5 都可以</p>\n<p><a href=\"https://www.vim.org/scripts/script.php?script_id=3764\">下载最新版本的 fcitx.vim</a></p>\n<p>解压后把 plugin 和 so 两个文件夹放到<code>~/.config/nvim</code>，或者干脆在这个目录下解压，如果是 vim，则应放到<code>~/.vim</code></p>\n<p>这里有个坑，上面已经填了，配置文件最后一行<code>inoremap &lt;C-c&gt; &lt;esc&gt;</code>，将<code>ctrl + c</code>映射为<code>esc</code>，默认情况下两者都可以进入普通模式，但前者不会触发相关事件，这使得插件无效（不知有没有像我一样使用<code>ctrl + c</code>的 vimer）</p>\n<p>如果你的<code>ctrl + c</code>在插入模式下另有用处，请删除该行</p>\n<p>注意：作者并不是为 neovim 设计的插件，目前最新版本的 neovim 可以使用，但不意味着一直可以使用</p>\n<h3 id=\"相关-python-依赖安装\"><a href=\"#相关-python-依赖安装\" class=\"headerlink\" title=\"相关 python 依赖安装\"></a>相关 python 依赖安装</h3><p>coc.nvim 需要 python 模块支持，另外 fcitx.vim 也需要 python 的 vim 模块以使用 fcitx.py 来获取更好的体验，不过这和 neovim 就没关系了，也可以装上，还有<code>autoformat</code>插件也需要 Python 模块</p>\n<p>使用<code>pip</code>安装<code>python-vim</code>、<code>neovim</code>，并<code>python3 -m pip install pynvim</code></p>\n<p>对于 gentoo，使用 pip 安装 python 模块需要加–usr 选项，这样安装的模块默认情况下是无法被 python 找到的，需要设置一下。如果不知如何解决，可以直接<code>emerge dev-python/pynvim</code>，其他的就无需安装</p>\n<p>如果你的 neovim 找不到 Python3，则在 neovim 配置文件中加入<code>let g:python3_host_prog=/path/to/python/executable/</code>，路径自己改</p>\n<h3 id=\"coc-nvim-配置\"><a href=\"#coc-nvim-配置\" class=\"headerlink\" title=\"coc.nvim 配置\"></a>coc.nvim 配置</h3><p>查看<a href=\"https://github.com/neoclide/coc.nvim/wiki/Using-coc-extensions\">coc extensions</a>，找到 markdown 和 latex 的对应扩展（按需安装），使用<code>:CocInstall</code>指令安装</p>\n<p>此外，还需要安装<code>coc-snippets</code>和<code>coc-actions</code>以配合 snippets 相关插件</p>\n<p>查看<a href=\"https://github.com/neoclide/coc.nvim/wiki/Language-servers\">coc language servers</a>，找到 markdown 和 latex，按照指示完成配置，如果遇到困难，继续往下看</p>\n<p>这里使用<code>:CocConfig</code>指令打开 coc 配置文件，如果你不熟悉 json，特别注意，文件中的所有内容需要用<code>&#123;&#125;</code>包起来，直接 copy 作者给的配置会出现语法错误</p>\n<p>这里安装<code>efm-langserver</code>和<code>digestif</code>又有问题了，arch 直接从 aur 安装再次避坑（需要先配置 go 语言环境，GOROOT 在 arch 上为<code>/usr/lib/go</code>，如果你上网找的话，可能会被<code>/usr/local/go</code>给坑了，go 安裝完毕后 GOROOT 下是有文件的，不确定是哪个可以去查看一下，另外还需要打开<code>go module</code>，以及给<code>go get</code>设置国内代理，详见<a href=\"https://blog.csdn.net/weixin_44690437/article/details/103571558\">go 语言依赖管理</a>，试图那啥的可以省省了，<code>go get</code>不认这招，或许全系统代理可以），其他的可能需要折腾一会儿</p>\n<p>这里附上我的<code>coc-settings.json</code>，copy 的时候把两个路径换成自己的，另外特别注意<code>command</code>需要使用绝对路径</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n          languageserver : &#123;\n                   digestif : &#123;\n                          command :  &#x2F;bin&#x2F;digestif ,\n                          filetypes : [ tex ,  plaintex ,  context ]\n                 &#125;,\n                  efm : &#123;\n                          command :  &#x2F;bin&#x2F;efm-langserver ,\n                         args : [ -c ,  &#x2F;home&#x2F;yourUsername&#x2F;.config&#x2F;efm-langserver&#x2F;config.yaml ],\n                          filetypes : [ vim ,  eruby ,  markdown ]\n                 &#125;\n        &#125;,\n          suggest.noselect : false\n &#125;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"markdown\"><a href=\"#markdown\" class=\"headerlink\" title=\"markdown\"></a>markdown</h2><p>markdown 的部分上面已经完成的差不多了，现在先创建一个.md 文件，查看是否可以补全，<code>nvim test.md</code>，输入<code>img</code>，应该会有提示，如果没有，请检查<code>coc.nvim</code>以及两个关于<code>snippets</code>的插件</p>\n<p>目前还有一个至关重要的问题，markdown 中的 latex 无法补全，极其影响体验感，不过<code>coc.nvim</code>可以<a href=\"https://github.com/neoclide/coc.nvim/wiki/Create-custom-source\">自定义 sources</a>，在<code>~/.config/nvim/autoload/coc/source</code>下创建<code>latex.vim</code>，写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">function! coc#source#latex#init() abort\n\treturn &#123;\n\t\t\t\t\\ &#39;triggerCharacters&#39;: [&#39;\\&#39;],\n\t\t\t\t\\&#39;filetype&#39;:[&#39;markdown&#39;]\n\t\t\t\t\\&#125;\nendfunction\n\nfunction! coc#source#latex#complete(opt, cb) abort\n\tlet items &#x3D; [&#39;dot&#123;&#125;&#39;, &#39;ddot&#123;&#125;&#39;, &#39;bar&#123;&#125;&#39;, &#39;hat&#123;&#125;&#39;, &#39;exp&#39;, &#39;sin&#39;, &#39;cos&#39;, &#39;tan&#39;, &#39;sec&#39;, &#39;csc&#39;, &#39;vec&#123;&#125;&#39;, &#39;cot&#39;, &#39;arcsin&#39;, &#39;arccos&#39;, &#39;arctan&#39;, &#39;sinh&#39;, &#39;cosh&#39;, &#39;tanh&#39;, &#39;coth&#39;, &#39;sh&#39;, &#39;ch&#39;, &#39;th&#39;, &#39;max&#39;, &#39;min&#39;, &#39;partial&#39;, &#39;nabla&#39;, &#39;prime&#39;, &#39;backprime&#39;, &#39;infty&#39;, &#39;eth&#39;, &#39;hbar&#39;, &#39;sqrt&#123;&#125;&#39;, &#39;sqrt[]&#123;&#125;&#39;, &#39;pm&#39;, &#39;mp&#39;, &#39;times&#39;, &#39;div&#39;, &#39;cdot&#39;, &#39;odot&#39;, &#39;bigodot&#39; , &#39;&#123; \\&#125;&#39;, &#39;in&#39;, &#39;not&#39;, &#39;ni&#39;, &#39;cap&#39;, &#39;Cap&#39;, &#39;bigcap&#39;, &#39;cup&#39;, &#39;Cup&#39;, &#39;bigcup&#39;, &#39;subset&#39;, &#39;supset&#39;, &#39;supseteq&#39;, &#39;subseteq&#39;, &#39;subseteqq&#39;, &#39;supseteqq&#39;, &#39;subsetneq&#39;, &#39;supsetneq&#39;, &#39;supsetneqq&#39;, &#39;subsetneqq&#39;, &#39;sim&#39;, &#39;approx&#39;, &#39;leq&#39;, &#39;geq&#39;, &#39;parallel&#39;, &#39;nparallel&#39;, &#39;perp&#39;, &#39;angle&#39;, &#39;Box&#39;, &#39;bigtriangleup&#39;, &#39;bigtriangledown&#39;, &#39;forall&#39;, &#39;therefore&#39;, &#39;because&#39;, &#39;overline&#123;&#125;&#39;, &#39;Rightarrow&#39;, &#39;Leftarrow&#39;, &#39;rightarrow&#39;, &#39;leftarrow&#39;, &#39;leftrightarrow&#39;, &#39;nRightarrow&#39;, &#39;nLeftarrow&#39;, &#39;nleftarrow&#39;, &#39;nrightarrow&#39;, &#39;nleftrightarrow&#39;, &#39;overleftarrow&#123;&#125;&#39;, &#39;overrightarrow&#123;&#125;&#39;, &#39;overset&#123;&#125;&#39;, &#39;underline&#123;&#125;&#39;, &#39;sum&#39;, &#39;prod&#39;, &#39;lim&#39;, &#39;limits&#39;, &#39;int&#39;, &#39;iint&#39;, &#39;oint&#39;, &#39;iiint&#39;, &#39;frac&#123;&#125;&#123;&#125;&#39;, &#39;tfrac&#123;&#125;&#123;&#125;&#39;, &#39;dfrac&#123;&#125;&#123;&#125;&#39;, &#39;\\begin&#123;matrix&#125;\\end&#123;matrix&#125;&#39;, &#39;\\begin&#123;vmatrix&#125;\\end&#123;vmatrix&#125;&#39;, &#39;\\begin&#123;bmatrix&#125;\\end&#123;bmatrix&#125;&#39;, &#39;\\begin&#123;Bmatrix&#125;\\end&#123;Bmatrix&#125;&#39;, &#39;\\begin&#123;pmatrix&#125;\\end&#123;pmatrix&#125;&#39;,&#39;\\begin&#123;cases&#125;\\end&#123;cases&#125;&#39;, &#39;\\begin&#123;aligned&#125;\\end&#123;aligned&#125;&#39;, &#39;\\begin&#123;array&#125;\\end&#123;array&#125;&#39;, &#39;alpha&#39;, &#39;psi&#39;, &#39;Delta&#39;, &#39;delta&#39;, &#39;beta&#39;, &#39;lambda&#39;, &#39;rho&#39;, &#39;varepsilon&#39;, &#39;Gamma&#39;, &#39;chi&#39;, &#39;mu&#39;, &#39;sigma&#39;, &#39;Lambda&#39;, &#39;tau&#39;, &#39;varphi&#39;, &#39;varPhi&#39;, &#39;phi&#39;, &#39;Phi&#39;, &#39;eta&#39;, &#39;omega&#39;, &#39;varrho&#39;, &#39;Pi&#39;, &#39;pi&#39;, &#39;gamma&#39;, &#39;xi&#39;, &#39;Psi&#39;, &#39;Sigma&#39;, &#39;varnothing&#39;, &#39;iiiint&#39;]\n\tcall a:cb(items)\nendfunction<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>关于自定义 source 的具体细节，请前往 github，上面给出的 source 设定在 markdown 文件下加载，使用<code>\\</code>作为触发符，这里只加入了我常用的几个命令，更多内容可以自行添加</p>\n<p>到此，markdown 部分已经完成，可以先检查一下有没有问题</p>\n<h2 id=\"latex\"><a href=\"#latex\" class=\"headerlink\" title=\"latex\"></a>latex</h2><p>首先安装 latex 编译环境，这里使用 texlive</p>\n<p>参考<a href=\"https://wiki.archlinux.org/index.php/TeX_Live_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)\">arch wiki</a>，不想折腾的话就把安装部分提到的几个包全装了，应该就问题不大了</p>\n<p>如果还有问题，或者是其他 linux 发行版，可以参考<a href=\"https://zhuanlan.zhihu.com/p/40053417\">Deepin Linux 安装和搭建 LaTex 环境</a>和<a href=\"https://blog.csdn.net/qq_41814939/article/details/82288145\">Ubuntu18.04 安装 LaTeX 并配置中文环境</a>，不过安装 texlive-full 实在太麻烦了，我装了 3 小时，最后似乎卡住了，手贱中断了，再也装不上了，这个包和前面 arch wiki 中提到的包大部分是冲突的，如果是 arch 系的就不要折腾这个了，如果是 gentoo 的话，如果坚持本地编译的话，建议备好电影小零食~~（窃以为使用 gentoo 的 linux 骨灰级玩家不需要这篇文章，强行 gentoo 的玩家可能还没从坑里爬出来）</p>\n<p>安装 MuPDF，当然你也可以选择别的，详见<a href=\"https://github.com/lervag/vimtex\">github</a>，如果换了的话需要把上面的配置也一并修改</p>\n<p>到此结束，测试一下，<code>nvim test.tex</code>，写入</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">\\documentclass&#123;article&#125;\n\\begin&#123;document&#125;\n你好，world!\n\\end&#123;document&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>在普通模式下按<code>\\ll</code>进行编译，再按<code>\\lv</code>预览，不要关闭预览窗口，修改成<code>hello world</code>，保存，重新编译，看看预览是否同步改变，这里还可以设置保存时自动编译</p>\n<h2 id=\"更多\"><a href=\"#更多\" class=\"headerlink\" title=\"更多\"></a>更多</h2><ul>\n<li>linux 下没有可以和 FastStone 媲美的截图软件，不过可以用 KolourPaint 快速编辑图片，需要更多操作可以使用 GIMP，不建议使用 Pinta，由于无法输入中文</li>\n<li>markdown 中可以用 html 语法插入 mp4 视频，比起 gif 的好处就不用多说了，缺点是略显臃肿</li>\n<li>可以再为 vim 配置更多插件，比如 markdown 自动贴图、markdown 预览等等，也可以继续自定义 snippets，这些部分按个人喜好配置，这里不再介绍</li>\n<li>桌面推荐 i3，i3 配置较为麻烦，可以保留原有桌面，简单配置 i3，仅用来写 markdown 和 latex</li>\n<li>或许可以在 WSL 中配置，不过暂时折腾到此为止了</li>\n</ul>\n<h2 id=\"补充\"><a href=\"#补充\" class=\"headerlink\" title=\"补充\"></a>补充</h2><h3 id=\"为-markdown-添加大纲显示\"><a href=\"#为-markdown-添加大纲显示\" class=\"headerlink\" title=\"为 markdown 添加大纲显示\"></a>为 markdown 添加大纲显示</h3><h4 id=\"Excuberant-Ctags\"><a href=\"#Excuberant-Ctags\" class=\"headerlink\" title=\"Excuberant Ctags\"></a>Excuberant Ctags</h4><p>首先安装<code>Excuberant Ctags</code>，debian 系和 redhat 系应该可以使用包管理工具直接安装，arch 这次似乎进坑了，需要编译源码</p>\n<p>访问<a href=\"http://ctags.sourceforge.net/\">Excuberant Ctags 下载页面</a>，没错，GFW 警告，这个资源可以在网上搜，文件名为 ctags-5.8，csdn 上有，本来想上传一个免费的，结果死活都重复，算了</p>\n<p>解压，cd 入目录，<code>./configure</code>，继续<code>make &amp;&amp; sudo make install</code>，正常情况下应该没问题了，如果有问题，请参考<a href=\"https://blog.csdn.net/dream2009gd/article/details/44102227\">安装 Exuberant Ctags 及 Tag List 插件</a></p>\n<h4 id=\"easytags\"><a href=\"#easytags\" class=\"headerlink\" title=\"easytags\"></a>easytags</h4><p>使用<code>vim-plug</code>安装</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Plug &#39;xolox&#x2F;vim-misc&#39;\nPlug &#39;xolox&#x2F;vim-easytags&#39;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"tagbar\"><a href=\"#tagbar\" class=\"headerlink\" title=\"tagbar\"></a><a href=\"https://github.com/majutsushi/tagbar\">tagbar</a></h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">Plug &#39;majutsushi&#x2F;tagbar&#39;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>注意使用该插件时可能有问题，详情见 github</p>\n<h4 id=\"markdown2ctags\"><a href=\"#markdown2ctags\" class=\"headerlink\" title=\"markdown2ctags\"></a>markdown2ctags</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">Plug &#39;jszakmeister&#x2F;markdown2ctags&#39;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">&quot; tagbar#####################################\nnmap &lt;C-M&gt; :TagbarToggle&lt;CR&gt;\n\n&quot; markdown2ctags#####################################\nlet g:tagbar_type_markdown &#x3D; &#123;\n    \\ &#39;ctagstype&#39;: &#39;markdown&#39;,\n    \\ &#39;ctagsbin&#39; : &#39;&#x2F;home&#x2F;yourUsername&#x2F;.vim&#x2F;plugged&#x2F;markdown2ctags&#x2F;markdown2ctags.py&#39;,\n    \\ &#39;ctagsargs&#39; : &#39;-f - --sort&#x3D;yes --sro&#x3D;»&#39;,\n    \\ &#39;kinds&#39; : [\n        \\ &#39;s:sections&#39;,\n        \\ &#39;i:images&#39;\n    \\ ],\n    \\ &#39;sro&#39; : &#39;»&#39;,\n    \\ &#39;kind2scope&#39; : &#123;\n        \\ &#39;s&#39; : &#39;section&#39;,\n    \\ &#125;,\n    \\ &#39;sort&#39;: 0,\n\\ &#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>这里给 tagbar 的快捷键设置为<code>ctrl + m</code>，<code>markdown2ctags</code>的配置中需要注意更换你的<code>markdown2ctags.py</code>所在路径，且注意通过<code>:set filetype</code>查看你的 markdown 文件的文件类型名称是否是 markdown，若不是，则修改<code>ctagstype</code></p>\n<h3 id=\"格式化插件neoformat\"><a href=\"#格式化插件neoformat\" class=\"headerlink\" title=\"格式化插件neoformat\"></a>格式化插件<a href=\"https://github.com/sbdchd/neoformat\">neoformat</a></h3><h4 id=\"插件安装\"><a href=\"#插件安装\" class=\"headerlink\" title=\"插件安装\"></a>插件安装</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">Plug &#39;sbdchd&#x2F;neoformat&#39;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"依赖安装\"><a href=\"#依赖安装\" class=\"headerlink\" title=\"依赖安装\"></a>依赖安装</h4><h5 id=\"prettier-for-markdown\"><a href=\"#prettier-for-markdown\" class=\"headerlink\" title=\"prettier for markdown\"></a><a href=\"https://github.com/prettier/prettier\">prettier</a> for markdown</h5><p>不要选 remark 作为格式化软件</p>\n<p>arch 可以直接从 aur 安装，其他参考<a href=\"https://prettier.io/docs/en/install.html\">install prettier</a></p>\n<h5 id=\"latexindent-pl-for-latex\"><a href=\"#latexindent-pl-for-latex\" class=\"headerlink\" title=\"latexindent.pl for latex\"></a><a href=\"https://github.com/cmhughes/latexindent.pl\">latexindent.pl</a> for latex</h5><p>将项目 clone 到本地</p>\n<p>安装<code>perl</code>，执行<code>sudo cpan</code></p>\n<p>进入<code>cpan</code>环境后，执行</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">install Log::Log4perl\ninstall Log::Dispatch::File\ninstall YAML::Tiny\ninstall File::HomeDir<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>再次 GFW 警告</p>\n<p>进入项目目录，测试 latexindent.pl 是否可以正常运行，并设置为可全局调用（最简单的方式是写个 sh 文件，<code>cd youPathToLatexindent.pl &amp;&amp; ./latexindent.pl</code>，然后将其链接到<code>/bin</code>或者<code>/usr/bin</code>）</p>\n<h4 id=\"插件配置\"><a href=\"#插件配置\" class=\"headerlink\" title=\"插件配置\"></a>插件配置</h4><p>只需在<code>init.vim</code>中添加</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">let g:neoformat_latex_latexindent &#x3D;&#123;&#39;exe&#39;:&#39;latexindent&#39;,&#39;args&#39;:[],&#39;stdin&#39;:1&#125;\nlet g:neoformat_enabled_latex&#x3D;[&#39;latexindent&#39;]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>用 prettier 格式化 markdown 失败，笔者暂时未解决该错误，可以使用<a href=\"https://github.com/prettier/vim-prettier\">vim-prettier</a>插件代替，或者手动运行<code>prettier --wirte pathToYourFile</code></p>\n<p>为不同类型的文件添加格式化快捷键</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nnoremap &lt;C-l&gt; :Neoformat&lt;CR&gt;\nautocmd FileType markdown nnoremap &lt;buffer&gt; &lt;C-l&gt; :Prettier&lt;CR&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n"},{"title":"Vim Markdown Preview Plugin","date":"2021-03-23T08:44:59.000Z","_content":"\n# vim markdown预览插件\n\n本文主要介绍 markdown 预览插件 vim-markdown-composer 以及 markdown-preview.nvim。\n\n## markdown 预览\n\nvim 没有内置 markdown 预览功能，也没有办法直接在终端预览。现有的 vim markdown 预览插件多是通过浏览器等第三方软件预览由插件渲染好的 markdown 文件。\n\n在笔者的体验中 vim-markdown-composer 以及 markdown-preview.nvim 可以算是其中最好的两款预览插件。\n\n## markdown-preview.nvim\n\n参考其[github 主页](https://github.com/iamcco/markdown-preview.nvim)的安装配置信息，很容易搞定。\n\n该插件的优点很明显。它支持很多内嵌语言的渲染，单文件渲染体验极佳。\n\n这里主要强调一些问题（仅针对本文写成时存在的问题）。\n\n- 目前尚未提供流畅的多文件预览功能。可以通过设置打开文件时预览自动开启和关闭文件时预览自动关闭勉强实现该功能。\n\n> 这里的多文件指的是当在多个 buffer 切换的时候，可以自动切换预览画面。\n\n- 判定文件开关的机制有点问题。主要表现在一旦使用自动开启和关闭预览。你在 vim 中使用的所有浮动窗口、侧边栏都会被判定为不同形式的文件关闭（经笔者试验，大概浮动窗口不会检测到文件关闭，但退出时会认为文件又一次打开，侧边栏会）。当退出这些窗口时，会再次自动渲染。这将使你的浏览器（或标签页）不断工作在开关状态，耗费资源还容易卡住，严重打击使用体验感。\n\n- 无法重新载入资源。举个例子。当你打开预览之后，新截一张图，在文件中调用，预览将无法显示该图片，需要重启预览。\n\n如果你无法忍受这些问题，可以使用下一个插件。\n\n## vim-markdown-composer\n\n该插件需要 rust 语言环境支持。关于如何配置 rust 环境，由于步骤非常简单，提倡自行解决。\n\n参考其[github 主页](https://github.com/euclio/vim-markdown-composer)的配置，使用 vim-plug 的用户可以使用以下配置安装。\n\n```vim\nfunction! BuildComposer(info)\n  if a:info.status != 'unchanged' || a:info.force\n    if has('nvim')\n      !cargo build --release --locked\n    else\n      !cargo build --release --locked --no-default-features --features json-rpc\n    endif\n  endif\nendfunction\n\nPlug 'euclio/vim-markdown-composer', { 'do': function('BuildComposer') }\n```\n\n安装后使用`:help markdown-composer`可以查看其文档。主要有几个配置参数，以及插件命令。这里给出插件提供的命令。\n\n```\n:ComposerStart              Start the preview server.\n:ComposerUpdate             Send the current buffer to the preview server.\n:ComposerOpen               Opens a new browser window containing the markdown preview.\n:ComposerJob                Echoes the channel that the plugin is listening on.\n```\n\n可以自行配置快捷键。这里给出我的配置。\n\n```vim\n\" markdown-composer\nlet g:markdown_composer_external_renderer='pandoc -f markdown -t html'\nlet g:markdown_composer_autostart = 0\n\nnmap <silent><nowait><leader>ms :<C-u>ComposerStart<CR>\nnmap <silent><nowait><leader>mu :<C-u>ComposerUpdate<CR>\nnmap <silent><nowait><leader>mo :<C-u>ComposerOpen<CR>\nnmap <silent><nowait><leader>mj :<C-u>ComposerJob<CR>\n\nlet g:which_key_map2.m = {\n      \\ 'name' : '+markdown_preview',\n      \\ 's' : 'start',\n      \\ 'u' : 'update',\n      \\ 'o' : 'open another tab',\n      \\ 'j' : 'echoes the channel that the plugin is listening on'\n      \\}\n```\n\n该插件多文件切换预览效果非常好。但是注意，该插件本身没有内置 latex 语言的渲染功能，其他语言就更不用说了。所以要想或者最佳体验，还需要使用外部渲染器。即上面给出配置中的第一行，使用 pandoc 渲染 markdown 文件。因此还必须安装 pandoc 软件，并确定可以在全局调用 pandoc 命令。\n\n另有一个注意事项。假设有目录 X，内有二级目录 A 和 B。A 中存放 markdown 文件，B 中存放图片。如果在 A 目录内打开 markdown 文件，则还是会出现上一个插件新图片无法载入的问题（如果调用时使用绝对路径可能不会出现该问题）。如果在 X 目录下打开 A 中的 markdown 文件，则不会有上述问题。其他位置打开，应该都有该问题。\n","source":"_posts/vim-markdown-preview-plugin.md","raw":"---\ntitle: Vim Markdown Preview Plugin\ndate: 2021-03-23 16:44:59\ntags:\n  - Vim\n  - Markdown\ncategories:\n  - Vim\n---\n\n# vim markdown预览插件\n\n本文主要介绍 markdown 预览插件 vim-markdown-composer 以及 markdown-preview.nvim。\n\n## markdown 预览\n\nvim 没有内置 markdown 预览功能，也没有办法直接在终端预览。现有的 vim markdown 预览插件多是通过浏览器等第三方软件预览由插件渲染好的 markdown 文件。\n\n在笔者的体验中 vim-markdown-composer 以及 markdown-preview.nvim 可以算是其中最好的两款预览插件。\n\n## markdown-preview.nvim\n\n参考其[github 主页](https://github.com/iamcco/markdown-preview.nvim)的安装配置信息，很容易搞定。\n\n该插件的优点很明显。它支持很多内嵌语言的渲染，单文件渲染体验极佳。\n\n这里主要强调一些问题（仅针对本文写成时存在的问题）。\n\n- 目前尚未提供流畅的多文件预览功能。可以通过设置打开文件时预览自动开启和关闭文件时预览自动关闭勉强实现该功能。\n\n> 这里的多文件指的是当在多个 buffer 切换的时候，可以自动切换预览画面。\n\n- 判定文件开关的机制有点问题。主要表现在一旦使用自动开启和关闭预览。你在 vim 中使用的所有浮动窗口、侧边栏都会被判定为不同形式的文件关闭（经笔者试验，大概浮动窗口不会检测到文件关闭，但退出时会认为文件又一次打开，侧边栏会）。当退出这些窗口时，会再次自动渲染。这将使你的浏览器（或标签页）不断工作在开关状态，耗费资源还容易卡住，严重打击使用体验感。\n\n- 无法重新载入资源。举个例子。当你打开预览之后，新截一张图，在文件中调用，预览将无法显示该图片，需要重启预览。\n\n如果你无法忍受这些问题，可以使用下一个插件。\n\n## vim-markdown-composer\n\n该插件需要 rust 语言环境支持。关于如何配置 rust 环境，由于步骤非常简单，提倡自行解决。\n\n参考其[github 主页](https://github.com/euclio/vim-markdown-composer)的配置，使用 vim-plug 的用户可以使用以下配置安装。\n\n```vim\nfunction! BuildComposer(info)\n  if a:info.status != 'unchanged' || a:info.force\n    if has('nvim')\n      !cargo build --release --locked\n    else\n      !cargo build --release --locked --no-default-features --features json-rpc\n    endif\n  endif\nendfunction\n\nPlug 'euclio/vim-markdown-composer', { 'do': function('BuildComposer') }\n```\n\n安装后使用`:help markdown-composer`可以查看其文档。主要有几个配置参数，以及插件命令。这里给出插件提供的命令。\n\n```\n:ComposerStart              Start the preview server.\n:ComposerUpdate             Send the current buffer to the preview server.\n:ComposerOpen               Opens a new browser window containing the markdown preview.\n:ComposerJob                Echoes the channel that the plugin is listening on.\n```\n\n可以自行配置快捷键。这里给出我的配置。\n\n```vim\n\" markdown-composer\nlet g:markdown_composer_external_renderer='pandoc -f markdown -t html'\nlet g:markdown_composer_autostart = 0\n\nnmap <silent><nowait><leader>ms :<C-u>ComposerStart<CR>\nnmap <silent><nowait><leader>mu :<C-u>ComposerUpdate<CR>\nnmap <silent><nowait><leader>mo :<C-u>ComposerOpen<CR>\nnmap <silent><nowait><leader>mj :<C-u>ComposerJob<CR>\n\nlet g:which_key_map2.m = {\n      \\ 'name' : '+markdown_preview',\n      \\ 's' : 'start',\n      \\ 'u' : 'update',\n      \\ 'o' : 'open another tab',\n      \\ 'j' : 'echoes the channel that the plugin is listening on'\n      \\}\n```\n\n该插件多文件切换预览效果非常好。但是注意，该插件本身没有内置 latex 语言的渲染功能，其他语言就更不用说了。所以要想或者最佳体验，还需要使用外部渲染器。即上面给出配置中的第一行，使用 pandoc 渲染 markdown 文件。因此还必须安装 pandoc 软件，并确定可以在全局调用 pandoc 命令。\n\n另有一个注意事项。假设有目录 X，内有二级目录 A 和 B。A 中存放 markdown 文件，B 中存放图片。如果在 A 目录内打开 markdown 文件，则还是会出现上一个插件新图片无法载入的问题（如果调用时使用绝对路径可能不会出现该问题）。如果在 X 目录下打开 A 中的 markdown 文件，则不会有上述问题。其他位置打开，应该都有该问题。\n","slug":"vim-markdown-preview-plugin","published":1,"updated":"2021-03-23T11:11:18.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmsm0030rriz18ga0ke2","content":"<h1 id=\"vim-markdown预览插件\"><a href=\"#vim-markdown预览插件\" class=\"headerlink\" title=\"vim markdown预览插件\"></a>vim markdown预览插件</h1><p>本文主要介绍 markdown 预览插件 vim-markdown-composer 以及 markdown-preview.nvim。</p>\n<h2 id=\"markdown-预览\"><a href=\"#markdown-预览\" class=\"headerlink\" title=\"markdown 预览\"></a>markdown 预览</h2><p>vim 没有内置 markdown 预览功能，也没有办法直接在终端预览。现有的 vim markdown 预览插件多是通过浏览器等第三方软件预览由插件渲染好的 markdown 文件。</p>\n<p>在笔者的体验中 vim-markdown-composer 以及 markdown-preview.nvim 可以算是其中最好的两款预览插件。</p>\n<h2 id=\"markdown-preview-nvim\"><a href=\"#markdown-preview-nvim\" class=\"headerlink\" title=\"markdown-preview.nvim\"></a>markdown-preview.nvim</h2><p>参考其<a href=\"https://github.com/iamcco/markdown-preview.nvim\">github 主页</a>的安装配置信息，很容易搞定。</p>\n<p>该插件的优点很明显。它支持很多内嵌语言的渲染，单文件渲染体验极佳。</p>\n<p>这里主要强调一些问题（仅针对本文写成时存在的问题）。</p>\n<ul>\n<li>目前尚未提供流畅的多文件预览功能。可以通过设置打开文件时预览自动开启和关闭文件时预览自动关闭勉强实现该功能。</li>\n</ul>\n<blockquote>\n<p>这里的多文件指的是当在多个 buffer 切换的时候，可以自动切换预览画面。</p>\n</blockquote>\n<ul>\n<li><p>判定文件开关的机制有点问题。主要表现在一旦使用自动开启和关闭预览。你在 vim 中使用的所有浮动窗口、侧边栏都会被判定为不同形式的文件关闭（经笔者试验，大概浮动窗口不会检测到文件关闭，但退出时会认为文件又一次打开，侧边栏会）。当退出这些窗口时，会再次自动渲染。这将使你的浏览器（或标签页）不断工作在开关状态，耗费资源还容易卡住，严重打击使用体验感。</p>\n</li>\n<li><p>无法重新载入资源。举个例子。当你打开预览之后，新截一张图，在文件中调用，预览将无法显示该图片，需要重启预览。</p>\n</li>\n</ul>\n<p>如果你无法忍受这些问题，可以使用下一个插件。</p>\n<h2 id=\"vim-markdown-composer\"><a href=\"#vim-markdown-composer\" class=\"headerlink\" title=\"vim-markdown-composer\"></a>vim-markdown-composer</h2><p>该插件需要 rust 语言环境支持。关于如何配置 rust 环境，由于步骤非常简单，提倡自行解决。</p>\n<p>参考其<a href=\"https://github.com/euclio/vim-markdown-composer\">github 主页</a>的配置，使用 vim-plug 的用户可以使用以下配置安装。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">function</span><span class=\"token operator\">!</span> <span class=\"token function\">BuildComposer</span><span class=\"token punctuation\">(</span>info<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> a<span class=\"token punctuation\">:</span>info<span class=\"token operator\">.</span>status <span class=\"token operator\">!=</span> <span class=\"token string\">'unchanged'</span> <span class=\"token operator\">||</span> a<span class=\"token punctuation\">:</span>info<span class=\"token operator\">.</span>force\n    <span class=\"token keyword\">if</span> <span class=\"token function\">has</span><span class=\"token punctuation\">(</span><span class=\"token string\">'nvim'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token operator\">!</span>cargo build <span class=\"token operator\">-</span><span class=\"token operator\">-</span>release <span class=\"token operator\">-</span><span class=\"token operator\">-</span>locked\n    <span class=\"token keyword\">else</span>\n      <span class=\"token operator\">!</span>cargo build <span class=\"token operator\">-</span><span class=\"token operator\">-</span>release <span class=\"token operator\">-</span><span class=\"token operator\">-</span>locked <span class=\"token operator\">-</span><span class=\"token operator\">-</span>no<span class=\"token operator\">-</span>default<span class=\"token operator\">-</span>features <span class=\"token operator\">-</span><span class=\"token operator\">-</span>features json<span class=\"token operator\">-</span>rpc\n    <span class=\"token keyword\">endif</span>\n  <span class=\"token keyword\">endif</span>\n<span class=\"token keyword\">endfunction</span>\n\nPlug <span class=\"token string\">'euclio/vim-markdown-composer'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token string\">'do'</span><span class=\"token punctuation\">:</span> <span class=\"token function\">function</span><span class=\"token punctuation\">(</span><span class=\"token string\">'BuildComposer'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>安装后使用<code>:help markdown-composer</code>可以查看其文档。主要有几个配置参数，以及插件命令。这里给出插件提供的命令。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">:ComposerStart              Start the preview server.\n:ComposerUpdate             Send the current buffer to the preview server.\n:ComposerOpen               Opens a new browser window containing the markdown preview.\n:ComposerJob                Echoes the channel that the plugin is listening on.<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>可以自行配置快捷键。这里给出我的配置。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" markdown-composer</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>markdown_composer_external_renderer<span class=\"token operator\">=</span><span class=\"token string\">'pandoc -f markdown -t html'</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>markdown_composer_autostart <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>ms <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>ComposerStart<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>mu <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>ComposerUpdate<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>mo <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>ComposerOpen<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>mj <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>ComposerJob<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map2<span class=\"token operator\">.</span><span class=\"token keyword\">m</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n      \\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+markdown_preview'</span><span class=\"token punctuation\">,</span>\n      \\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'start'</span><span class=\"token punctuation\">,</span>\n      \\ <span class=\"token string\">'u'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'update'</span><span class=\"token punctuation\">,</span>\n      \\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'open another tab'</span><span class=\"token punctuation\">,</span>\n      \\ <span class=\"token string\">'j'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'echoes the channel that the plugin is listening on'</span>\n      \\<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>该插件多文件切换预览效果非常好。但是注意，该插件本身没有内置 latex 语言的渲染功能，其他语言就更不用说了。所以要想或者最佳体验，还需要使用外部渲染器。即上面给出配置中的第一行，使用 pandoc 渲染 markdown 文件。因此还必须安装 pandoc 软件，并确定可以在全局调用 pandoc 命令。</p>\n<p>另有一个注意事项。假设有目录 X，内有二级目录 A 和 B。A 中存放 markdown 文件，B 中存放图片。如果在 A 目录内打开 markdown 文件，则还是会出现上一个插件新图片无法载入的问题（如果调用时使用绝对路径可能不会出现该问题）。如果在 X 目录下打开 A 中的 markdown 文件，则不会有上述问题。其他位置打开，应该都有该问题。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"vim-markdown预览插件\"><a href=\"#vim-markdown预览插件\" class=\"headerlink\" title=\"vim markdown预览插件\"></a>vim markdown预览插件</h1><p>本文主要介绍 markdown 预览插件 vim-markdown-composer 以及 markdown-preview.nvim。</p>\n<h2 id=\"markdown-预览\"><a href=\"#markdown-预览\" class=\"headerlink\" title=\"markdown 预览\"></a>markdown 预览</h2><p>vim 没有内置 markdown 预览功能，也没有办法直接在终端预览。现有的 vim markdown 预览插件多是通过浏览器等第三方软件预览由插件渲染好的 markdown 文件。</p>\n<p>在笔者的体验中 vim-markdown-composer 以及 markdown-preview.nvim 可以算是其中最好的两款预览插件。</p>\n<h2 id=\"markdown-preview-nvim\"><a href=\"#markdown-preview-nvim\" class=\"headerlink\" title=\"markdown-preview.nvim\"></a>markdown-preview.nvim</h2><p>参考其<a href=\"https://github.com/iamcco/markdown-preview.nvim\">github 主页</a>的安装配置信息，很容易搞定。</p>\n<p>该插件的优点很明显。它支持很多内嵌语言的渲染，单文件渲染体验极佳。</p>\n<p>这里主要强调一些问题（仅针对本文写成时存在的问题）。</p>\n<ul>\n<li>目前尚未提供流畅的多文件预览功能。可以通过设置打开文件时预览自动开启和关闭文件时预览自动关闭勉强实现该功能。</li>\n</ul>\n<blockquote>\n<p>这里的多文件指的是当在多个 buffer 切换的时候，可以自动切换预览画面。</p>\n</blockquote>\n<ul>\n<li><p>判定文件开关的机制有点问题。主要表现在一旦使用自动开启和关闭预览。你在 vim 中使用的所有浮动窗口、侧边栏都会被判定为不同形式的文件关闭（经笔者试验，大概浮动窗口不会检测到文件关闭，但退出时会认为文件又一次打开，侧边栏会）。当退出这些窗口时，会再次自动渲染。这将使你的浏览器（或标签页）不断工作在开关状态，耗费资源还容易卡住，严重打击使用体验感。</p>\n</li>\n<li><p>无法重新载入资源。举个例子。当你打开预览之后，新截一张图，在文件中调用，预览将无法显示该图片，需要重启预览。</p>\n</li>\n</ul>\n<p>如果你无法忍受这些问题，可以使用下一个插件。</p>\n<h2 id=\"vim-markdown-composer\"><a href=\"#vim-markdown-composer\" class=\"headerlink\" title=\"vim-markdown-composer\"></a>vim-markdown-composer</h2><p>该插件需要 rust 语言环境支持。关于如何配置 rust 环境，由于步骤非常简单，提倡自行解决。</p>\n<p>参考其<a href=\"https://github.com/euclio/vim-markdown-composer\">github 主页</a>的配置，使用 vim-plug 的用户可以使用以下配置安装。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">function</span><span class=\"token operator\">!</span> <span class=\"token function\">BuildComposer</span><span class=\"token punctuation\">(</span>info<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> a<span class=\"token punctuation\">:</span>info<span class=\"token operator\">.</span>status <span class=\"token operator\">!=</span> <span class=\"token string\">'unchanged'</span> <span class=\"token operator\">||</span> a<span class=\"token punctuation\">:</span>info<span class=\"token operator\">.</span>force\n    <span class=\"token keyword\">if</span> <span class=\"token function\">has</span><span class=\"token punctuation\">(</span><span class=\"token string\">'nvim'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token operator\">!</span>cargo build <span class=\"token operator\">-</span><span class=\"token operator\">-</span>release <span class=\"token operator\">-</span><span class=\"token operator\">-</span>locked\n    <span class=\"token keyword\">else</span>\n      <span class=\"token operator\">!</span>cargo build <span class=\"token operator\">-</span><span class=\"token operator\">-</span>release <span class=\"token operator\">-</span><span class=\"token operator\">-</span>locked <span class=\"token operator\">-</span><span class=\"token operator\">-</span>no<span class=\"token operator\">-</span>default<span class=\"token operator\">-</span>features <span class=\"token operator\">-</span><span class=\"token operator\">-</span>features json<span class=\"token operator\">-</span>rpc\n    <span class=\"token keyword\">endif</span>\n  <span class=\"token keyword\">endif</span>\n<span class=\"token keyword\">endfunction</span>\n\nPlug <span class=\"token string\">'euclio/vim-markdown-composer'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span> <span class=\"token string\">'do'</span><span class=\"token punctuation\">:</span> <span class=\"token function\">function</span><span class=\"token punctuation\">(</span><span class=\"token string\">'BuildComposer'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>安装后使用<code>:help markdown-composer</code>可以查看其文档。主要有几个配置参数，以及插件命令。这里给出插件提供的命令。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">:ComposerStart              Start the preview server.\n:ComposerUpdate             Send the current buffer to the preview server.\n:ComposerOpen               Opens a new browser window containing the markdown preview.\n:ComposerJob                Echoes the channel that the plugin is listening on.<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>可以自行配置快捷键。这里给出我的配置。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" markdown-composer</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>markdown_composer_external_renderer<span class=\"token operator\">=</span><span class=\"token string\">'pandoc -f markdown -t html'</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>markdown_composer_autostart <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>ms <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>ComposerStart<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>mu <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>ComposerUpdate<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>mo <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>ComposerOpen<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span>mj <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>ComposerJob<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map2<span class=\"token operator\">.</span><span class=\"token keyword\">m</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n      \\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+markdown_preview'</span><span class=\"token punctuation\">,</span>\n      \\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'start'</span><span class=\"token punctuation\">,</span>\n      \\ <span class=\"token string\">'u'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'update'</span><span class=\"token punctuation\">,</span>\n      \\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'open another tab'</span><span class=\"token punctuation\">,</span>\n      \\ <span class=\"token string\">'j'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'echoes the channel that the plugin is listening on'</span>\n      \\<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>该插件多文件切换预览效果非常好。但是注意，该插件本身没有内置 latex 语言的渲染功能，其他语言就更不用说了。所以要想或者最佳体验，还需要使用外部渲染器。即上面给出配置中的第一行，使用 pandoc 渲染 markdown 文件。因此还必须安装 pandoc 软件，并确定可以在全局调用 pandoc 命令。</p>\n<p>另有一个注意事项。假设有目录 X，内有二级目录 A 和 B。A 中存放 markdown 文件，B 中存放图片。如果在 A 目录内打开 markdown 文件，则还是会出现上一个插件新图片无法载入的问题（如果调用时使用绝对路径可能不会出现该问题）。如果在 X 目录下打开 A 中的 markdown 文件，则不会有上述问题。其他位置打开，应该都有该问题。</p>\n"},{"title":"Vim Plugin Management","date":"2020-10-19T13:39:32.000Z","_content":"\n# vim插件管理\n\n本文介绍vim插件管理器。主要推荐vim-plug。如果想要更多扩展功能，可以尝试dein.vim。\n\n## vim插件管理器\n\n- 为什么需要插件管理器？\n\n随着你对vim的不断扩展，为vim安装的插件将会越来越多。如果没有插件管理器，一方面，你可能无法高效地更新插件，另一方面，一些插件可能必须手动唤醒或者vim启动时启用的插件过多，导致速度大大降低。\n\n- vim插件管理器能做什么？\n\n提供统一的插件安装、升级、移除指令。调配各插件的启动时机，提高运行vim效率。\n\n## vim-plug\n\nvim-plug是继vundle后新一代的插件管理器。支持并行安装插件、支持外部管理的插件、支持按需加载等等功能。\n\n### vim-plug安装\n\n访问vim-plug [github 主页](https://github.com/junegunn/vim-plug)。下载`plug.vim`，放入`~/.vim/autoload/`或者`~/.local/share/nvim/site/autoload/`目录下。vim启动时会自动加载该目录下的插件。\n\n对于windows和macos可以自行查看说明。\n\n### vim-plug配置\n\n```\ncall plug#begin('~/.vim/plugged')\n\" 上一行中括号内的是插件存放的目录\nPlug 'junegunn/vim-easy-align'\n\" 上一行中引号内的是插件在github上的地址，前面是作者用户名，后面是插件名称\ncall plug#end()\n```\n\n### vim-plug使用\n\n配置好插件之后，使用`:PlugInstall`安装插件。使用`PlugUpdate`更新所有插件，使用`PlugClean`清理不在配置内的插件。更多命令可以自行插件`README.md`。\n\n关于按需加载，以及各种功能配置，由于vim-plug已经非常流行，一般不是很老的插件都会给出其`vim-plug`的配置。当然也可以自己根据文档研究。\n\n### dein.vim\n\n这是一个具有更强大的扩展性以及更加快速的插件管理器，但由于配置麻烦的多，且只有少数插件会给出其`dein.vim`的配置，因此笔者个人建议在插件未达到好几百的情况下，使用`vim-plug`足以。\n\n如果你非常想要尝试，也建议搭配`dein-ui.vim`使用，可以大大降低配置难度，并且提供类似`vim-plug`的ui界面。\n","source":"_posts/vim-plugin-management.md","raw":"---\ntitle: Vim Plugin Management\ndate: 2020-10-19 21:39:32\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# vim插件管理\n\n本文介绍vim插件管理器。主要推荐vim-plug。如果想要更多扩展功能，可以尝试dein.vim。\n\n## vim插件管理器\n\n- 为什么需要插件管理器？\n\n随着你对vim的不断扩展，为vim安装的插件将会越来越多。如果没有插件管理器，一方面，你可能无法高效地更新插件，另一方面，一些插件可能必须手动唤醒或者vim启动时启用的插件过多，导致速度大大降低。\n\n- vim插件管理器能做什么？\n\n提供统一的插件安装、升级、移除指令。调配各插件的启动时机，提高运行vim效率。\n\n## vim-plug\n\nvim-plug是继vundle后新一代的插件管理器。支持并行安装插件、支持外部管理的插件、支持按需加载等等功能。\n\n### vim-plug安装\n\n访问vim-plug [github 主页](https://github.com/junegunn/vim-plug)。下载`plug.vim`，放入`~/.vim/autoload/`或者`~/.local/share/nvim/site/autoload/`目录下。vim启动时会自动加载该目录下的插件。\n\n对于windows和macos可以自行查看说明。\n\n### vim-plug配置\n\n```\ncall plug#begin('~/.vim/plugged')\n\" 上一行中括号内的是插件存放的目录\nPlug 'junegunn/vim-easy-align'\n\" 上一行中引号内的是插件在github上的地址，前面是作者用户名，后面是插件名称\ncall plug#end()\n```\n\n### vim-plug使用\n\n配置好插件之后，使用`:PlugInstall`安装插件。使用`PlugUpdate`更新所有插件，使用`PlugClean`清理不在配置内的插件。更多命令可以自行插件`README.md`。\n\n关于按需加载，以及各种功能配置，由于vim-plug已经非常流行，一般不是很老的插件都会给出其`vim-plug`的配置。当然也可以自己根据文档研究。\n\n### dein.vim\n\n这是一个具有更强大的扩展性以及更加快速的插件管理器，但由于配置麻烦的多，且只有少数插件会给出其`dein.vim`的配置，因此笔者个人建议在插件未达到好几百的情况下，使用`vim-plug`足以。\n\n如果你非常想要尝试，也建议搭配`dein-ui.vim`使用，可以大大降低配置难度，并且提供类似`vim-plug`的ui界面。\n","slug":"vim-plugin-management","published":1,"updated":"2021-03-23T11:11:18.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmso0034rrizhnz23gfo","content":"<h1 id=\"vim插件管理\"><a href=\"#vim插件管理\" class=\"headerlink\" title=\"vim插件管理\"></a>vim插件管理</h1><p>本文介绍vim插件管理器。主要推荐vim-plug。如果想要更多扩展功能，可以尝试dein.vim。</p>\n<h2 id=\"vim插件管理器\"><a href=\"#vim插件管理器\" class=\"headerlink\" title=\"vim插件管理器\"></a>vim插件管理器</h2><ul>\n<li>为什么需要插件管理器？</li>\n</ul>\n<p>随着你对vim的不断扩展，为vim安装的插件将会越来越多。如果没有插件管理器，一方面，你可能无法高效地更新插件，另一方面，一些插件可能必须手动唤醒或者vim启动时启用的插件过多，导致速度大大降低。</p>\n<ul>\n<li>vim插件管理器能做什么？</li>\n</ul>\n<p>提供统一的插件安装、升级、移除指令。调配各插件的启动时机，提高运行vim效率。</p>\n<h2 id=\"vim-plug\"><a href=\"#vim-plug\" class=\"headerlink\" title=\"vim-plug\"></a>vim-plug</h2><p>vim-plug是继vundle后新一代的插件管理器。支持并行安装插件、支持外部管理的插件、支持按需加载等等功能。</p>\n<h3 id=\"vim-plug安装\"><a href=\"#vim-plug安装\" class=\"headerlink\" title=\"vim-plug安装\"></a>vim-plug安装</h3><p>访问vim-plug <a href=\"https://github.com/junegunn/vim-plug\">github 主页</a>。下载<code>plug.vim</code>，放入<code>~/.vim/autoload/</code>或者<code>~/.local/share/nvim/site/autoload/</code>目录下。vim启动时会自动加载该目录下的插件。</p>\n<p>对于windows和macos可以自行查看说明。</p>\n<h3 id=\"vim-plug配置\"><a href=\"#vim-plug配置\" class=\"headerlink\" title=\"vim-plug配置\"></a>vim-plug配置</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">call plug#begin(&#39;~&#x2F;.vim&#x2F;plugged&#39;)\n&quot; 上一行中括号内的是插件存放的目录\nPlug &#39;junegunn&#x2F;vim-easy-align&#39;\n&quot; 上一行中引号内的是插件在github上的地址，前面是作者用户名，后面是插件名称\ncall plug#end()<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"vim-plug使用\"><a href=\"#vim-plug使用\" class=\"headerlink\" title=\"vim-plug使用\"></a>vim-plug使用</h3><p>配置好插件之后，使用<code>:PlugInstall</code>安装插件。使用<code>PlugUpdate</code>更新所有插件，使用<code>PlugClean</code>清理不在配置内的插件。更多命令可以自行插件<code>README.md</code>。</p>\n<p>关于按需加载，以及各种功能配置，由于vim-plug已经非常流行，一般不是很老的插件都会给出其<code>vim-plug</code>的配置。当然也可以自己根据文档研究。</p>\n<h3 id=\"dein-vim\"><a href=\"#dein-vim\" class=\"headerlink\" title=\"dein.vim\"></a>dein.vim</h3><p>这是一个具有更强大的扩展性以及更加快速的插件管理器，但由于配置麻烦的多，且只有少数插件会给出其<code>dein.vim</code>的配置，因此笔者个人建议在插件未达到好几百的情况下，使用<code>vim-plug</code>足以。</p>\n<p>如果你非常想要尝试，也建议搭配<code>dein-ui.vim</code>使用，可以大大降低配置难度，并且提供类似<code>vim-plug</code>的ui界面。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"vim插件管理\"><a href=\"#vim插件管理\" class=\"headerlink\" title=\"vim插件管理\"></a>vim插件管理</h1><p>本文介绍vim插件管理器。主要推荐vim-plug。如果想要更多扩展功能，可以尝试dein.vim。</p>\n<h2 id=\"vim插件管理器\"><a href=\"#vim插件管理器\" class=\"headerlink\" title=\"vim插件管理器\"></a>vim插件管理器</h2><ul>\n<li>为什么需要插件管理器？</li>\n</ul>\n<p>随着你对vim的不断扩展，为vim安装的插件将会越来越多。如果没有插件管理器，一方面，你可能无法高效地更新插件，另一方面，一些插件可能必须手动唤醒或者vim启动时启用的插件过多，导致速度大大降低。</p>\n<ul>\n<li>vim插件管理器能做什么？</li>\n</ul>\n<p>提供统一的插件安装、升级、移除指令。调配各插件的启动时机，提高运行vim效率。</p>\n<h2 id=\"vim-plug\"><a href=\"#vim-plug\" class=\"headerlink\" title=\"vim-plug\"></a>vim-plug</h2><p>vim-plug是继vundle后新一代的插件管理器。支持并行安装插件、支持外部管理的插件、支持按需加载等等功能。</p>\n<h3 id=\"vim-plug安装\"><a href=\"#vim-plug安装\" class=\"headerlink\" title=\"vim-plug安装\"></a>vim-plug安装</h3><p>访问vim-plug <a href=\"https://github.com/junegunn/vim-plug\">github 主页</a>。下载<code>plug.vim</code>，放入<code>~/.vim/autoload/</code>或者<code>~/.local/share/nvim/site/autoload/</code>目录下。vim启动时会自动加载该目录下的插件。</p>\n<p>对于windows和macos可以自行查看说明。</p>\n<h3 id=\"vim-plug配置\"><a href=\"#vim-plug配置\" class=\"headerlink\" title=\"vim-plug配置\"></a>vim-plug配置</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">call plug#begin(&#39;~&#x2F;.vim&#x2F;plugged&#39;)\n&quot; 上一行中括号内的是插件存放的目录\nPlug &#39;junegunn&#x2F;vim-easy-align&#39;\n&quot; 上一行中引号内的是插件在github上的地址，前面是作者用户名，后面是插件名称\ncall plug#end()<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"vim-plug使用\"><a href=\"#vim-plug使用\" class=\"headerlink\" title=\"vim-plug使用\"></a>vim-plug使用</h3><p>配置好插件之后，使用<code>:PlugInstall</code>安装插件。使用<code>PlugUpdate</code>更新所有插件，使用<code>PlugClean</code>清理不在配置内的插件。更多命令可以自行插件<code>README.md</code>。</p>\n<p>关于按需加载，以及各种功能配置，由于vim-plug已经非常流行，一般不是很老的插件都会给出其<code>vim-plug</code>的配置。当然也可以自己根据文档研究。</p>\n<h3 id=\"dein-vim\"><a href=\"#dein-vim\" class=\"headerlink\" title=\"dein.vim\"></a>dein.vim</h3><p>这是一个具有更强大的扩展性以及更加快速的插件管理器，但由于配置麻烦的多，且只有少数插件会给出其<code>dein.vim</code>的配置，因此笔者个人建议在插件未达到好几百的情况下，使用<code>vim-plug</code>足以。</p>\n<p>如果你非常想要尝试，也建议搭配<code>dein-ui.vim</code>使用，可以大大降低配置难度，并且提供类似<code>vim-plug</code>的ui界面。</p>\n"},{"title":"Vim Preface","date":"2020-08-06T14:00:09.000Z","_content":"\n# Vim 前言\n\n#### vim 是必要的？\n\n显然，“必要”是不存在的。无数现代编辑器以及各类 IDE 都可以成为替代对象。即使是在命令行中，也有 nano 等替代品。\n\n#### 学习 vim 有什么好处？\n\n首先，尽管有那么多替代品，但vim至今仍保持着强大的生命力，送走了一代又一代所谓的“替代者”。vim的强大毋庸置疑。学习 vim 至少能让你多一件高效率工具。\n\n其次，学习vim可以分为两类。一种是仅学习vim模式，另一种在此基础上深究vim编辑器的配套设施，即无与伦比的可扩展性。作为前者，可以大幅度提高码字、查找效率。作为后者，在此基础上能够享受亲手搭建最契合自己的编辑工具的快乐，能够深入了解插件体系的奥妙，能够提升自己的搜索技巧、专业知识、动手能力，甚至品性修养。学习vim只是一个表象，你想得到什么，肯花时间细细琢磨，就有可能从中获取什么。\n\n#### 学习vim意味着放弃其他优秀编辑器？\n\n显然，这是个误区。退一万步讲，vim不仅是一个编辑器，更是一种编辑模式，一种可以并已经大量移植到其他编辑器上的模式。vim不可能永远适应所有的环境，当vim不能胜任时，不必固守，选择最适应的工具是最容易解决问题的办法。当然如果你愿意为自己的vim扩展相应的功能而去深入研究，自然是极好的。\n\n#### 给vim初学者的忠告\n\n如果你想对vim进行大幅度扩展，linux系统将是你最好的选择，这里是程序员的天堂。同时，毫不夸张地讲，windows将是你的噩梦。\n\n对学习的建议只有一步一步，坚持动手，不断尝试。从熟悉`hjkl`，到逐渐掌握各种跳转命令，查找、替换指令，学会安装第一个插件，使用插件管理器，为各种插件配置环境、指令，到深入研究vim高级功能，自己写插件等等。\n","source":"_posts/vim-preface.md","raw":"---\ntitle: Vim Preface\ndate: 2020-08-06 22:00:09\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# Vim 前言\n\n#### vim 是必要的？\n\n显然，“必要”是不存在的。无数现代编辑器以及各类 IDE 都可以成为替代对象。即使是在命令行中，也有 nano 等替代品。\n\n#### 学习 vim 有什么好处？\n\n首先，尽管有那么多替代品，但vim至今仍保持着强大的生命力，送走了一代又一代所谓的“替代者”。vim的强大毋庸置疑。学习 vim 至少能让你多一件高效率工具。\n\n其次，学习vim可以分为两类。一种是仅学习vim模式，另一种在此基础上深究vim编辑器的配套设施，即无与伦比的可扩展性。作为前者，可以大幅度提高码字、查找效率。作为后者，在此基础上能够享受亲手搭建最契合自己的编辑工具的快乐，能够深入了解插件体系的奥妙，能够提升自己的搜索技巧、专业知识、动手能力，甚至品性修养。学习vim只是一个表象，你想得到什么，肯花时间细细琢磨，就有可能从中获取什么。\n\n#### 学习vim意味着放弃其他优秀编辑器？\n\n显然，这是个误区。退一万步讲，vim不仅是一个编辑器，更是一种编辑模式，一种可以并已经大量移植到其他编辑器上的模式。vim不可能永远适应所有的环境，当vim不能胜任时，不必固守，选择最适应的工具是最容易解决问题的办法。当然如果你愿意为自己的vim扩展相应的功能而去深入研究，自然是极好的。\n\n#### 给vim初学者的忠告\n\n如果你想对vim进行大幅度扩展，linux系统将是你最好的选择，这里是程序员的天堂。同时，毫不夸张地讲，windows将是你的噩梦。\n\n对学习的建议只有一步一步，坚持动手，不断尝试。从熟悉`hjkl`，到逐渐掌握各种跳转命令，查找、替换指令，学会安装第一个插件，使用插件管理器，为各种插件配置环境、指令，到深入研究vim高级功能，自己写插件等等。\n","slug":"vim-preface","published":1,"updated":"2021-03-23T11:11:18.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmsp0037rrizgki8bybq","content":"<h1 id=\"Vim-前言\"><a href=\"#Vim-前言\" class=\"headerlink\" title=\"Vim 前言\"></a>Vim 前言</h1><h4 id=\"vim-是必要的？\"><a href=\"#vim-是必要的？\" class=\"headerlink\" title=\"vim 是必要的？\"></a>vim 是必要的？</h4><p>显然，“必要”是不存在的。无数现代编辑器以及各类 IDE 都可以成为替代对象。即使是在命令行中，也有 nano 等替代品。</p>\n<h4 id=\"学习-vim-有什么好处？\"><a href=\"#学习-vim-有什么好处？\" class=\"headerlink\" title=\"学习 vim 有什么好处？\"></a>学习 vim 有什么好处？</h4><p>首先，尽管有那么多替代品，但vim至今仍保持着强大的生命力，送走了一代又一代所谓的“替代者”。vim的强大毋庸置疑。学习 vim 至少能让你多一件高效率工具。</p>\n<p>其次，学习vim可以分为两类。一种是仅学习vim模式，另一种在此基础上深究vim编辑器的配套设施，即无与伦比的可扩展性。作为前者，可以大幅度提高码字、查找效率。作为后者，在此基础上能够享受亲手搭建最契合自己的编辑工具的快乐，能够深入了解插件体系的奥妙，能够提升自己的搜索技巧、专业知识、动手能力，甚至品性修养。学习vim只是一个表象，你想得到什么，肯花时间细细琢磨，就有可能从中获取什么。</p>\n<h4 id=\"学习vim意味着放弃其他优秀编辑器？\"><a href=\"#学习vim意味着放弃其他优秀编辑器？\" class=\"headerlink\" title=\"学习vim意味着放弃其他优秀编辑器？\"></a>学习vim意味着放弃其他优秀编辑器？</h4><p>显然，这是个误区。退一万步讲，vim不仅是一个编辑器，更是一种编辑模式，一种可以并已经大量移植到其他编辑器上的模式。vim不可能永远适应所有的环境，当vim不能胜任时，不必固守，选择最适应的工具是最容易解决问题的办法。当然如果你愿意为自己的vim扩展相应的功能而去深入研究，自然是极好的。</p>\n<h4 id=\"给vim初学者的忠告\"><a href=\"#给vim初学者的忠告\" class=\"headerlink\" title=\"给vim初学者的忠告\"></a>给vim初学者的忠告</h4><p>如果你想对vim进行大幅度扩展，linux系统将是你最好的选择，这里是程序员的天堂。同时，毫不夸张地讲，windows将是你的噩梦。</p>\n<p>对学习的建议只有一步一步，坚持动手，不断尝试。从熟悉<code>hjkl</code>，到逐渐掌握各种跳转命令，查找、替换指令，学会安装第一个插件，使用插件管理器，为各种插件配置环境、指令，到深入研究vim高级功能，自己写插件等等。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"Vim-前言\"><a href=\"#Vim-前言\" class=\"headerlink\" title=\"Vim 前言\"></a>Vim 前言</h1><h4 id=\"vim-是必要的？\"><a href=\"#vim-是必要的？\" class=\"headerlink\" title=\"vim 是必要的？\"></a>vim 是必要的？</h4><p>显然，“必要”是不存在的。无数现代编辑器以及各类 IDE 都可以成为替代对象。即使是在命令行中，也有 nano 等替代品。</p>\n<h4 id=\"学习-vim-有什么好处？\"><a href=\"#学习-vim-有什么好处？\" class=\"headerlink\" title=\"学习 vim 有什么好处？\"></a>学习 vim 有什么好处？</h4><p>首先，尽管有那么多替代品，但vim至今仍保持着强大的生命力，送走了一代又一代所谓的“替代者”。vim的强大毋庸置疑。学习 vim 至少能让你多一件高效率工具。</p>\n<p>其次，学习vim可以分为两类。一种是仅学习vim模式，另一种在此基础上深究vim编辑器的配套设施，即无与伦比的可扩展性。作为前者，可以大幅度提高码字、查找效率。作为后者，在此基础上能够享受亲手搭建最契合自己的编辑工具的快乐，能够深入了解插件体系的奥妙，能够提升自己的搜索技巧、专业知识、动手能力，甚至品性修养。学习vim只是一个表象，你想得到什么，肯花时间细细琢磨，就有可能从中获取什么。</p>\n<h4 id=\"学习vim意味着放弃其他优秀编辑器？\"><a href=\"#学习vim意味着放弃其他优秀编辑器？\" class=\"headerlink\" title=\"学习vim意味着放弃其他优秀编辑器？\"></a>学习vim意味着放弃其他优秀编辑器？</h4><p>显然，这是个误区。退一万步讲，vim不仅是一个编辑器，更是一种编辑模式，一种可以并已经大量移植到其他编辑器上的模式。vim不可能永远适应所有的环境，当vim不能胜任时，不必固守，选择最适应的工具是最容易解决问题的办法。当然如果你愿意为自己的vim扩展相应的功能而去深入研究，自然是极好的。</p>\n<h4 id=\"给vim初学者的忠告\"><a href=\"#给vim初学者的忠告\" class=\"headerlink\" title=\"给vim初学者的忠告\"></a>给vim初学者的忠告</h4><p>如果你想对vim进行大幅度扩展，linux系统将是你最好的选择，这里是程序员的天堂。同时，毫不夸张地讲，windows将是你的噩梦。</p>\n<p>对学习的建议只有一步一步，坚持动手，不断尝试。从熟悉<code>hjkl</code>，到逐渐掌握各种跳转命令，查找、替换指令，学会安装第一个插件，使用插件管理器，为各种插件配置环境、指令，到深入研究vim高级功能，自己写插件等等。</p>\n"},{"title":"Vim Quickfix","date":"2021-04-17T13:01:56.000Z","_content":"\n# Vim Quickfix\n\n本文主要介绍 vim quickfix 的使用与优化。\n\n## 什么是 quickfix\n\nquickfix 属于 vim 的高级功能，该功能在主流 IDE 或者编辑器中都有集成。\n\n简单的说，quickfix 就是搜集编译器的输出信息，然后定位错误与警告位置，提供直接跳转功能。可以说有了完善的 quickfix 功能的 vim 编辑器才是真正的编辑器之神。\n\n## 如何使用 quickfix\n\n首先来了解一下 quickfix 的工作流程。\n\n- 第一步，设定要执行的命令，也就是编译、运行程序的命令。可以在 vim 中通过命令设置。如设置命令为 make，`:set makeprg=make`。\n\n- 第二步，执行命令`:make`。注意该 make 是 vim 的命令，而不是 shell 中的 make 命令。此时，开始执行命令并且将输出送到 quickfix 窗口。\n\n- 第三步，使用`:copen`打开 quickfix 窗口。可以看到刚才的输出内容。假设输出内容如下所示。\n\n![quickfix window](1.png)\n\n可以看到，图中蓝色部分为文件名，之后的为行和列，再后面的为相关信息。\n\n- 第四步，获取信息之后，跳转到出错位置。vim 提供了`:cnext`、`:cprev`、`:cfirst`、`:clast`等命令在各个错误之间跳转。也可以借助其他插件，如 vim-clap 对 quickfix 内容进行检索跳转。也可以将光标移动到 quickfix 窗口的文件位置处，键入 enter 进行跳转。\n\n- 第五步，修改完所有错误后，关闭 quickfix 窗口，可以使用`:cclose`。\n\n## 优化 quickfix\n\n### 外观\n\n使用`:copen`打开的 quickfix 窗口较小，不利于查看，可以使用`:copexx`，如`:copen25`，指定窗口所占的行数，改变窗口大小。\n\n### 快捷键\n\n可以参考以下快捷键设置。\n\n```vim\nau VimEnter * :set makeprg=make\nnnoremap <silent><nowait> <space>qs :<C-u>set makeprg=\nnnoremap <silent><nowait> <space>qo :<C-u>cope25<CR>\nnnoremap <silent><nowait> <space>qm :<C-u>make<CR>\nnnoremap <silent><nowait> <space>qc :<C-u>cclose<CR>\n\nnmap <A-j> :cnext<CR>\nnmap <A-k> :cprev<CR>\nnmap <A-g> :cfirst<CR>\nnmap <A-G> :clast<CR>\n\nlet g:which_key_map1.q = {\n\t\\ 'name' : '+quickfix',\n\t\\ 's' : 'set compile cmd',\n\t\\ 'o' : 'open quickfix window',\n\t\\ 'm' : 'make',\n\t\\ 'c' : 'close quickfix window'\n\t\\}\n```\n\n### 异步\n\nquickfix 默认同步执行，也就是说执行`:make`后，直到任务结束，你将无法使用 vim。在任务执行时间较长的情况下，这是很不利的。因此需要做出优化。\n\n当前最好的解决方案：使用`asynctasks.vim`插件。该插件可参考的配置如下。安装请参考官方文档。\n\n```vim\nnnoremap <silent><nowait> <space>sR :<C-u>:AsyncTask project-run<CR>\nnnoremap <silent><nowait> <space>sB :<C-u>:AsyncTask project-build<CR>\nnnoremap <silent><nowait> <space>sb :<C-u>:AsyncTask file-build<CR>\nnnoremap <silent><nowait> <space>sr :<C-u>:AsyncTask file-run<CR>\nnnoremap <silent><nowait> <space>st :<C-u>:AsyncTaskList<CR>\nnnoremap <silent><nowait> <space>se :<C-u>:AsyncTaskEdit<CR>\nnnoremap <silent><nowait> <space>sE :<C-u>:AsyncTaskEdit!<CR>\nnnoremap <silent><nowait> <space>sg :<C-u>:AsyncTask git<CR>\nlet g:asyncrun_rootmarks = ['.git', '.svn', '.root', '.project', '.hg']\nlet g:asynctasks_term_pos = 'bottom'\nlet g:asynctasks_term_rows = 10    \" 设置纵向切割高度\nlet g:asynctasks_term_cols = 80    \" 设置横向切割宽度\n\nlet g:which_key_map1.s = {\n\t\\ 'name' : '+asynctasks',\n\t\\ 'R' : 'run project',\n\t\\ 'B' : 'build project',\n\t\\ 'b' : 'build file',\n\t\\ 'r' : 'run file',\n\t\\ 'e' : 'edit config',\n\t\\ 'E' : 'edit global config',\n\t\\ 't' : 'show task list',\n\t\\}\n\nlet g:asynctasks_config_name = '.git/task.ini'\n```\n\n下面说明如何使用该插件。\n\n使用`:AsyncTaskEdit`编辑配置文件，比如\n\n```\n[git]\ncommand=git add . && git commit -m $(?commit context) && proxychains git pull origin $(?merge branch) && proxychains git push -u origin $(?commit branch)\ncwd=<VIM_ROOT>\noutput=terminal\n```\n\n该文件具体编辑方法可以参考官方文档。以上配置设定了一个 git 任务，可以使用`:AsyncTask git`执行该任务，其中`$(?)`的部分是在执行时由用户输入的。将`output`设置为`quickfix`即可将内容输出到 quickfix 窗口。\n\n该插件可以实现异步的 quickfix 功能，但它的功能远不止这点，建议深入挖掘。\n\n### 修改\n\n假设一下（真实情况应当不会出现），你犯了 100 个错，辛辛苦苦修改完了 99 个，但是剩下一个居然找不到了。这事可能发生吗？是的，很有可能。因为默认情况下，quickfix 并不会因为你修改了一个错误自动把错误消除，如果你要在 100 个错误里找 1 个，那自然是很费事的。\n\n机灵的程序猿很快想出了绝妙的主意：我可以再执行一遍，重新生成信息。想法很不错，不过没准 n 个小时就过去了。\n\n目前这方面暂时没有较好的插件（在 neovim 下都无法达到预想的效果）。不过可以通过以下方案来实现。\n\n首先，可以设置快捷键。\n\n```viml\nnnoremap <silent><nowait> <space>qw :<C-u>write! build.log<CR>\nnnoremap <silent><nowait> <space>qe :<C-u>set modifiable<CR>\n```\n\n在进入 quickfix 窗口后，使用`set modifiable`，让 quickfix 可修改。修改完成后使用`write! filename`保存。这里默认了文件名为`build.log`。\n\n然后，可以在 asynctask 插件中设置一个全局的加载文件到 quickfix 的任务。\n\n```\n[load-quickfix]\ncommand=bat ./build.log\ncwd=<VIM_ROOT>\noutput=quickfix\n```\n\n这里为了方便，直接指定了文件名，如果需要更加具有通用性，可以设置在执行任务时手动输入文件路径。\n\n在以上配置下，只要从项目根目录进入 vim，就不会出现 log 文件路径出错的问题。\n\n## quickfix 进阶：骚操作\n\nvim quickfix 相比 IDE 的 quickfix 功能有更高的灵活度，关键就在于可以执行任意 shell 命令，包括 shell 脚本。\n\n于是，quickfix 有了无限可能。下面将以跨设备编译调试作为一个场景进行说明。\n\n我的个人电脑 A 为 gentoo 系统，有配置完美的 vim 编辑器，但没有特定的编译环境。另一台电脑上虚拟机 B 为 ubuntu 系统，有完整的编译环境，且已经配置好与开发板 C（Atlas 200DK）连接。首先了解一下昇腾系列的特点：指定版本的一切。我并不想在自己电脑上装一堆乱七八糟的编译器，设一堆乱七八糟的环境变量，更不想重新配置与 C 连接。事实上以上也很难做到，强行做到相当于废了这个系统。那么在 B 上配好 vim 呢？ubuntu18.04？？？这还不得累死人，而且用不了多久。于是，骚操作开始了。\n\n首先，把 B 上的头文件搞到 A 上，再搞出个`compile_commands.json`（假设是 C、CPP 项目）满足一下 lsp 的需求。\n\n然后，来理一下逻辑。在 A 上写好代码后，git 推上去（单独开一个分支用来推送），在 B 上拉下来。在 B 上完成编译，甚至可以放到 C 上试一试。把出错信息传回 A，用于 quickfix。\n\n那么，先来搞定 ssh 免密登陆，不然无法输入密码会卡住。这个可以参考网上解决方案。或者你也可以用其他语言，如 go 来实现 ssh 登陆以及交互，然后调用该程序即可。\n\n接下来，写一个 shell 脚本，实现上述逻辑。\n\n```sh\nssh niuiic@192.168.1.108 \"cd ~/AscendProjects/samples/cplusplus/level2_simple_inference/n_performance/1_multi_process_thread/face_recognition_camera && ./make.sh\"\n```\n\nA 处 git 上传未列入其中，B 处的操作已经全部包含至`make.sh`中。\n\n这样，就可以控制 B 拉取最新代码，并进行编译，然后将信息传输回来。\n\n但，此时遇到一个重大问题，B 上编译器输出的路径是 B 上项目的路径，传回来的自然也是，那如果 A 上的路径不同呢。quickfix 自然没有自动处理能力，会直接跳到空文件。\n\n一个解决方案，是两边使用同一个路径。这里介绍另一个更灵活的方案。\n\n修改上述`build.sh`。用 shell 对接收到的内容进行处理。将路径换过来。这里可以直接保存到变量修改后输出，保存到文件是为之后查看所用。\n\n```sh\nssh niuiic@192.168.1.108 \"cd ~/AscendProjects/samples/cplusplus/level2_simple_inference/n_performance/1_multi_process_thread/face_recognition_camera && ./make.sh\" > ./build.log 2>&1\n\nsed -i \"s/\\/home\\/niuiic\\/AscendProjects\\/samples\\/cplusplus\\/level2_simple_inference\\/n_performance\\/1_multi_process_thread\\/face_recognition_camera/\\/home\\/niuiic\\/Documents\\/Project\\/Cpp\\/face_recognition/g\" ./build.log\n\ncat ./build.log\n```\n\n再进一步，通过观察上文 quickfix 窗口图片可以发现，quickfix 不仅仅列出错误，也会列出警告等信息。如果没有明确的标识，就需要仔细查看才能知道是警告还是错误。所以，需要做进一步优化。\n\n为 quickfix 窗口配置关键词高亮。对于 neovim 而言，应在`~/.config/nvim/after/syntax`目录下创建`qf.vim`。当 vim 打开 quickfix 窗口时，会自动加载该配置文件并进行关键词高亮。\n\n修改文件内容如下。\n\n```\nsyn match QuickFixWarn /warning/\nsyn match QuickFixWarn /warn/\nsyn match QuickFixErr /error/\nsyn match QuickFixNote /note/\nhi def link     QuickFixErr         Function\nhi def link     QuickFixWarn         Function\nhi def link     QuickFixNote         Function\nhi QuickFixErr guifg=red\nhi QuickFixWarn guifg=yellow\nhi QuickFixNote guifg=green\n```\n\n这里分别将 warning、error、note 设置为黄色、红色、绿色。可以参考以上配置进行自定义。\n","source":"_posts/vim-quickfix.md","raw":"---\ntitle: Vim Quickfix\ndate: 2021-4-17 21:01:56\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# Vim Quickfix\n\n本文主要介绍 vim quickfix 的使用与优化。\n\n## 什么是 quickfix\n\nquickfix 属于 vim 的高级功能，该功能在主流 IDE 或者编辑器中都有集成。\n\n简单的说，quickfix 就是搜集编译器的输出信息，然后定位错误与警告位置，提供直接跳转功能。可以说有了完善的 quickfix 功能的 vim 编辑器才是真正的编辑器之神。\n\n## 如何使用 quickfix\n\n首先来了解一下 quickfix 的工作流程。\n\n- 第一步，设定要执行的命令，也就是编译、运行程序的命令。可以在 vim 中通过命令设置。如设置命令为 make，`:set makeprg=make`。\n\n- 第二步，执行命令`:make`。注意该 make 是 vim 的命令，而不是 shell 中的 make 命令。此时，开始执行命令并且将输出送到 quickfix 窗口。\n\n- 第三步，使用`:copen`打开 quickfix 窗口。可以看到刚才的输出内容。假设输出内容如下所示。\n\n![quickfix window](1.png)\n\n可以看到，图中蓝色部分为文件名，之后的为行和列，再后面的为相关信息。\n\n- 第四步，获取信息之后，跳转到出错位置。vim 提供了`:cnext`、`:cprev`、`:cfirst`、`:clast`等命令在各个错误之间跳转。也可以借助其他插件，如 vim-clap 对 quickfix 内容进行检索跳转。也可以将光标移动到 quickfix 窗口的文件位置处，键入 enter 进行跳转。\n\n- 第五步，修改完所有错误后，关闭 quickfix 窗口，可以使用`:cclose`。\n\n## 优化 quickfix\n\n### 外观\n\n使用`:copen`打开的 quickfix 窗口较小，不利于查看，可以使用`:copexx`，如`:copen25`，指定窗口所占的行数，改变窗口大小。\n\n### 快捷键\n\n可以参考以下快捷键设置。\n\n```vim\nau VimEnter * :set makeprg=make\nnnoremap <silent><nowait> <space>qs :<C-u>set makeprg=\nnnoremap <silent><nowait> <space>qo :<C-u>cope25<CR>\nnnoremap <silent><nowait> <space>qm :<C-u>make<CR>\nnnoremap <silent><nowait> <space>qc :<C-u>cclose<CR>\n\nnmap <A-j> :cnext<CR>\nnmap <A-k> :cprev<CR>\nnmap <A-g> :cfirst<CR>\nnmap <A-G> :clast<CR>\n\nlet g:which_key_map1.q = {\n\t\\ 'name' : '+quickfix',\n\t\\ 's' : 'set compile cmd',\n\t\\ 'o' : 'open quickfix window',\n\t\\ 'm' : 'make',\n\t\\ 'c' : 'close quickfix window'\n\t\\}\n```\n\n### 异步\n\nquickfix 默认同步执行，也就是说执行`:make`后，直到任务结束，你将无法使用 vim。在任务执行时间较长的情况下，这是很不利的。因此需要做出优化。\n\n当前最好的解决方案：使用`asynctasks.vim`插件。该插件可参考的配置如下。安装请参考官方文档。\n\n```vim\nnnoremap <silent><nowait> <space>sR :<C-u>:AsyncTask project-run<CR>\nnnoremap <silent><nowait> <space>sB :<C-u>:AsyncTask project-build<CR>\nnnoremap <silent><nowait> <space>sb :<C-u>:AsyncTask file-build<CR>\nnnoremap <silent><nowait> <space>sr :<C-u>:AsyncTask file-run<CR>\nnnoremap <silent><nowait> <space>st :<C-u>:AsyncTaskList<CR>\nnnoremap <silent><nowait> <space>se :<C-u>:AsyncTaskEdit<CR>\nnnoremap <silent><nowait> <space>sE :<C-u>:AsyncTaskEdit!<CR>\nnnoremap <silent><nowait> <space>sg :<C-u>:AsyncTask git<CR>\nlet g:asyncrun_rootmarks = ['.git', '.svn', '.root', '.project', '.hg']\nlet g:asynctasks_term_pos = 'bottom'\nlet g:asynctasks_term_rows = 10    \" 设置纵向切割高度\nlet g:asynctasks_term_cols = 80    \" 设置横向切割宽度\n\nlet g:which_key_map1.s = {\n\t\\ 'name' : '+asynctasks',\n\t\\ 'R' : 'run project',\n\t\\ 'B' : 'build project',\n\t\\ 'b' : 'build file',\n\t\\ 'r' : 'run file',\n\t\\ 'e' : 'edit config',\n\t\\ 'E' : 'edit global config',\n\t\\ 't' : 'show task list',\n\t\\}\n\nlet g:asynctasks_config_name = '.git/task.ini'\n```\n\n下面说明如何使用该插件。\n\n使用`:AsyncTaskEdit`编辑配置文件，比如\n\n```\n[git]\ncommand=git add . && git commit -m $(?commit context) && proxychains git pull origin $(?merge branch) && proxychains git push -u origin $(?commit branch)\ncwd=<VIM_ROOT>\noutput=terminal\n```\n\n该文件具体编辑方法可以参考官方文档。以上配置设定了一个 git 任务，可以使用`:AsyncTask git`执行该任务，其中`$(?)`的部分是在执行时由用户输入的。将`output`设置为`quickfix`即可将内容输出到 quickfix 窗口。\n\n该插件可以实现异步的 quickfix 功能，但它的功能远不止这点，建议深入挖掘。\n\n### 修改\n\n假设一下（真实情况应当不会出现），你犯了 100 个错，辛辛苦苦修改完了 99 个，但是剩下一个居然找不到了。这事可能发生吗？是的，很有可能。因为默认情况下，quickfix 并不会因为你修改了一个错误自动把错误消除，如果你要在 100 个错误里找 1 个，那自然是很费事的。\n\n机灵的程序猿很快想出了绝妙的主意：我可以再执行一遍，重新生成信息。想法很不错，不过没准 n 个小时就过去了。\n\n目前这方面暂时没有较好的插件（在 neovim 下都无法达到预想的效果）。不过可以通过以下方案来实现。\n\n首先，可以设置快捷键。\n\n```viml\nnnoremap <silent><nowait> <space>qw :<C-u>write! build.log<CR>\nnnoremap <silent><nowait> <space>qe :<C-u>set modifiable<CR>\n```\n\n在进入 quickfix 窗口后，使用`set modifiable`，让 quickfix 可修改。修改完成后使用`write! filename`保存。这里默认了文件名为`build.log`。\n\n然后，可以在 asynctask 插件中设置一个全局的加载文件到 quickfix 的任务。\n\n```\n[load-quickfix]\ncommand=bat ./build.log\ncwd=<VIM_ROOT>\noutput=quickfix\n```\n\n这里为了方便，直接指定了文件名，如果需要更加具有通用性，可以设置在执行任务时手动输入文件路径。\n\n在以上配置下，只要从项目根目录进入 vim，就不会出现 log 文件路径出错的问题。\n\n## quickfix 进阶：骚操作\n\nvim quickfix 相比 IDE 的 quickfix 功能有更高的灵活度，关键就在于可以执行任意 shell 命令，包括 shell 脚本。\n\n于是，quickfix 有了无限可能。下面将以跨设备编译调试作为一个场景进行说明。\n\n我的个人电脑 A 为 gentoo 系统，有配置完美的 vim 编辑器，但没有特定的编译环境。另一台电脑上虚拟机 B 为 ubuntu 系统，有完整的编译环境，且已经配置好与开发板 C（Atlas 200DK）连接。首先了解一下昇腾系列的特点：指定版本的一切。我并不想在自己电脑上装一堆乱七八糟的编译器，设一堆乱七八糟的环境变量，更不想重新配置与 C 连接。事实上以上也很难做到，强行做到相当于废了这个系统。那么在 B 上配好 vim 呢？ubuntu18.04？？？这还不得累死人，而且用不了多久。于是，骚操作开始了。\n\n首先，把 B 上的头文件搞到 A 上，再搞出个`compile_commands.json`（假设是 C、CPP 项目）满足一下 lsp 的需求。\n\n然后，来理一下逻辑。在 A 上写好代码后，git 推上去（单独开一个分支用来推送），在 B 上拉下来。在 B 上完成编译，甚至可以放到 C 上试一试。把出错信息传回 A，用于 quickfix。\n\n那么，先来搞定 ssh 免密登陆，不然无法输入密码会卡住。这个可以参考网上解决方案。或者你也可以用其他语言，如 go 来实现 ssh 登陆以及交互，然后调用该程序即可。\n\n接下来，写一个 shell 脚本，实现上述逻辑。\n\n```sh\nssh niuiic@192.168.1.108 \"cd ~/AscendProjects/samples/cplusplus/level2_simple_inference/n_performance/1_multi_process_thread/face_recognition_camera && ./make.sh\"\n```\n\nA 处 git 上传未列入其中，B 处的操作已经全部包含至`make.sh`中。\n\n这样，就可以控制 B 拉取最新代码，并进行编译，然后将信息传输回来。\n\n但，此时遇到一个重大问题，B 上编译器输出的路径是 B 上项目的路径，传回来的自然也是，那如果 A 上的路径不同呢。quickfix 自然没有自动处理能力，会直接跳到空文件。\n\n一个解决方案，是两边使用同一个路径。这里介绍另一个更灵活的方案。\n\n修改上述`build.sh`。用 shell 对接收到的内容进行处理。将路径换过来。这里可以直接保存到变量修改后输出，保存到文件是为之后查看所用。\n\n```sh\nssh niuiic@192.168.1.108 \"cd ~/AscendProjects/samples/cplusplus/level2_simple_inference/n_performance/1_multi_process_thread/face_recognition_camera && ./make.sh\" > ./build.log 2>&1\n\nsed -i \"s/\\/home\\/niuiic\\/AscendProjects\\/samples\\/cplusplus\\/level2_simple_inference\\/n_performance\\/1_multi_process_thread\\/face_recognition_camera/\\/home\\/niuiic\\/Documents\\/Project\\/Cpp\\/face_recognition/g\" ./build.log\n\ncat ./build.log\n```\n\n再进一步，通过观察上文 quickfix 窗口图片可以发现，quickfix 不仅仅列出错误，也会列出警告等信息。如果没有明确的标识，就需要仔细查看才能知道是警告还是错误。所以，需要做进一步优化。\n\n为 quickfix 窗口配置关键词高亮。对于 neovim 而言，应在`~/.config/nvim/after/syntax`目录下创建`qf.vim`。当 vim 打开 quickfix 窗口时，会自动加载该配置文件并进行关键词高亮。\n\n修改文件内容如下。\n\n```\nsyn match QuickFixWarn /warning/\nsyn match QuickFixWarn /warn/\nsyn match QuickFixErr /error/\nsyn match QuickFixNote /note/\nhi def link     QuickFixErr         Function\nhi def link     QuickFixWarn         Function\nhi def link     QuickFixNote         Function\nhi QuickFixErr guifg=red\nhi QuickFixWarn guifg=yellow\nhi QuickFixNote guifg=green\n```\n\n这里分别将 warning、error、note 设置为黄色、红色、绿色。可以参考以上配置进行自定义。\n","slug":"vim-quickfix","published":1,"updated":"2021-05-10T07:14:26.102Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmsq003brrizfvfkhgiu","content":"<h1 id=\"Vim-Quickfix\"><a href=\"#Vim-Quickfix\" class=\"headerlink\" title=\"Vim Quickfix\"></a>Vim Quickfix</h1><p>本文主要介绍 vim quickfix 的使用与优化。</p>\n<h2 id=\"什么是-quickfix\"><a href=\"#什么是-quickfix\" class=\"headerlink\" title=\"什么是 quickfix\"></a>什么是 quickfix</h2><p>quickfix 属于 vim 的高级功能，该功能在主流 IDE 或者编辑器中都有集成。</p>\n<p>简单的说，quickfix 就是搜集编译器的输出信息，然后定位错误与警告位置，提供直接跳转功能。可以说有了完善的 quickfix 功能的 vim 编辑器才是真正的编辑器之神。</p>\n<h2 id=\"如何使用-quickfix\"><a href=\"#如何使用-quickfix\" class=\"headerlink\" title=\"如何使用 quickfix\"></a>如何使用 quickfix</h2><p>首先来了解一下 quickfix 的工作流程。</p>\n<ul>\n<li><p>第一步，设定要执行的命令，也就是编译、运行程序的命令。可以在 vim 中通过命令设置。如设置命令为 make，<code>:set makeprg=make</code>。</p>\n</li>\n<li><p>第二步，执行命令<code>:make</code>。注意该 make 是 vim 的命令，而不是 shell 中的 make 命令。此时，开始执行命令并且将输出送到 quickfix 窗口。</p>\n</li>\n<li><p>第三步，使用<code>:copen</code>打开 quickfix 窗口。可以看到刚才的输出内容。假设输出内容如下所示。</p>\n</li>\n</ul>\n<p><img src=\"1.png\" alt=\"quickfix window\"></p>\n<p>可以看到，图中蓝色部分为文件名，之后的为行和列，再后面的为相关信息。</p>\n<ul>\n<li><p>第四步，获取信息之后，跳转到出错位置。vim 提供了<code>:cnext</code>、<code>:cprev</code>、<code>:cfirst</code>、<code>:clast</code>等命令在各个错误之间跳转。也可以借助其他插件，如 vim-clap 对 quickfix 内容进行检索跳转。也可以将光标移动到 quickfix 窗口的文件位置处，键入 enter 进行跳转。</p>\n</li>\n<li><p>第五步，修改完所有错误后，关闭 quickfix 窗口，可以使用<code>:cclose</code>。</p>\n</li>\n</ul>\n<h2 id=\"优化-quickfix\"><a href=\"#优化-quickfix\" class=\"headerlink\" title=\"优化 quickfix\"></a>优化 quickfix</h2><h3 id=\"外观\"><a href=\"#外观\" class=\"headerlink\" title=\"外观\"></a>外观</h3><p>使用<code>:copen</code>打开的 quickfix 窗口较小，不利于查看，可以使用<code>:copexx</code>，如<code>:copen25</code>，指定窗口所占的行数，改变窗口大小。</p>\n<h3 id=\"快捷键\"><a href=\"#快捷键\" class=\"headerlink\" title=\"快捷键\"></a>快捷键</h3><p>可以参考以下快捷键设置。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">au VimEnter <span class=\"token operator\">*</span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">set</span> <span class=\"token builtin\">makeprg</span><span class=\"token operator\">=</span><span class=\"token keyword\">make</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>qs <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token keyword\">set</span> <span class=\"token builtin\">makeprg</span><span class=\"token operator\">=</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>qo <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>cope25<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>qm <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token keyword\">make</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>qc <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token keyword\">cclose</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">j</span><span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">cnext</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">k</span><span class=\"token operator\">></span> <span class=\"token punctuation\">:</span>cprev<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span>g<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">cfirst</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span>G<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">clast</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">q</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+quickfix'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'set compile cmd'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'open quickfix window'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'m'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'make'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'close quickfix window'</span>\n\t\\<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"异步\"><a href=\"#异步\" class=\"headerlink\" title=\"异步\"></a>异步</h3><p>quickfix 默认同步执行，也就是说执行<code>:make</code>后，直到任务结束，你将无法使用 vim。在任务执行时间较长的情况下，这是很不利的。因此需要做出优化。</p>\n<p>当前最好的解决方案：使用<code>asynctasks.vim</code>插件。该插件可参考的配置如下。安装请参考官方文档。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">nnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>sR <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTask project<span class=\"token operator\">-</span>run<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>sB <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTask project<span class=\"token operator\">-</span>build<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">sb</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTask <span class=\"token keyword\">file</span><span class=\"token operator\">-</span>build<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token builtin\">sr</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTask <span class=\"token keyword\">file</span><span class=\"token operator\">-</span>run<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">st</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTaskList<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">se</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTaskEdit<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>sE <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTaskEdit<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>sg <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTask git<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>asyncrun_rootmarks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'.git'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.svn'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.root'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.project'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.hg'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>asynctasks_term_pos <span class=\"token operator\">=</span> <span class=\"token string\">'bottom'</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>asynctasks_term_rows <span class=\"token operator\">=</span> <span class=\"token number\">10</span>    <span class=\"token comment\">\" 设置纵向切割高度</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>asynctasks_term_cols <span class=\"token operator\">=</span> <span class=\"token number\">80</span>    <span class=\"token comment\">\" 设置横向切割宽度</span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span>s <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+asynctasks'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'R'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'run project'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'B'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'build project'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'build file'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'run file'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'edit config'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'E'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'edit global config'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'show task list'</span><span class=\"token punctuation\">,</span>\n\t\\<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>asynctasks_config_name <span class=\"token operator\">=</span> <span class=\"token string\">'.git/task.ini'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>下面说明如何使用该插件。</p>\n<p>使用<code>:AsyncTaskEdit</code>编辑配置文件，比如</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[git]\ncommand&#x3D;git add . &amp;&amp; git commit -m $(?commit context) &amp;&amp; proxychains git pull origin $(?merge branch) &amp;&amp; proxychains git push -u origin $(?commit branch)\ncwd&#x3D;&lt;VIM_ROOT&gt;\noutput&#x3D;terminal<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>该文件具体编辑方法可以参考官方文档。以上配置设定了一个 git 任务，可以使用<code>:AsyncTask git</code>执行该任务，其中<code>$(?)</code>的部分是在执行时由用户输入的。将<code>output</code>设置为<code>quickfix</code>即可将内容输出到 quickfix 窗口。</p>\n<p>该插件可以实现异步的 quickfix 功能，但它的功能远不止这点，建议深入挖掘。</p>\n<h3 id=\"修改\"><a href=\"#修改\" class=\"headerlink\" title=\"修改\"></a>修改</h3><p>假设一下（真实情况应当不会出现），你犯了 100 个错，辛辛苦苦修改完了 99 个，但是剩下一个居然找不到了。这事可能发生吗？是的，很有可能。因为默认情况下，quickfix 并不会因为你修改了一个错误自动把错误消除，如果你要在 100 个错误里找 1 个，那自然是很费事的。</p>\n<p>机灵的程序猿很快想出了绝妙的主意：我可以再执行一遍，重新生成信息。想法很不错，不过没准 n 个小时就过去了。</p>\n<p>目前这方面暂时没有较好的插件（在 neovim 下都无法达到预想的效果）。不过可以通过以下方案来实现。</p>\n<p>首先，可以设置快捷键。</p>\n<pre class=\"line-numbers language-viml\" data-language=\"viml\"><code class=\"language-viml\">nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;qw :&lt;C-u&gt;write! build.log&lt;CR&gt;\nnnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;qe :&lt;C-u&gt;set modifiable&lt;CR&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>在进入 quickfix 窗口后，使用<code>set modifiable</code>，让 quickfix 可修改。修改完成后使用<code>write! filename</code>保存。这里默认了文件名为<code>build.log</code>。</p>\n<p>然后，可以在 asynctask 插件中设置一个全局的加载文件到 quickfix 的任务。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[load-quickfix]\ncommand&#x3D;bat .&#x2F;build.log\ncwd&#x3D;&lt;VIM_ROOT&gt;\noutput&#x3D;quickfix<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>这里为了方便，直接指定了文件名，如果需要更加具有通用性，可以设置在执行任务时手动输入文件路径。</p>\n<p>在以上配置下，只要从项目根目录进入 vim，就不会出现 log 文件路径出错的问题。</p>\n<h2 id=\"quickfix-进阶：骚操作\"><a href=\"#quickfix-进阶：骚操作\" class=\"headerlink\" title=\"quickfix 进阶：骚操作\"></a>quickfix 进阶：骚操作</h2><p>vim quickfix 相比 IDE 的 quickfix 功能有更高的灵活度，关键就在于可以执行任意 shell 命令，包括 shell 脚本。</p>\n<p>于是，quickfix 有了无限可能。下面将以跨设备编译调试作为一个场景进行说明。</p>\n<p>我的个人电脑 A 为 gentoo 系统，有配置完美的 vim 编辑器，但没有特定的编译环境。另一台电脑上虚拟机 B 为 ubuntu 系统，有完整的编译环境，且已经配置好与开发板 C（Atlas 200DK）连接。首先了解一下昇腾系列的特点：指定版本的一切。我并不想在自己电脑上装一堆乱七八糟的编译器，设一堆乱七八糟的环境变量，更不想重新配置与 C 连接。事实上以上也很难做到，强行做到相当于废了这个系统。那么在 B 上配好 vim 呢？ubuntu18.04？？？这还不得累死人，而且用不了多久。于是，骚操作开始了。</p>\n<p>首先，把 B 上的头文件搞到 A 上，再搞出个<code>compile_commands.json</code>（假设是 C、CPP 项目）满足一下 lsp 的需求。</p>\n<p>然后，来理一下逻辑。在 A 上写好代码后，git 推上去（单独开一个分支用来推送），在 B 上拉下来。在 B 上完成编译，甚至可以放到 C 上试一试。把出错信息传回 A，用于 quickfix。</p>\n<p>那么，先来搞定 ssh 免密登陆，不然无法输入密码会卡住。这个可以参考网上解决方案。或者你也可以用其他语言，如 go 来实现 ssh 登陆以及交互，然后调用该程序即可。</p>\n<p>接下来，写一个 shell 脚本，实现上述逻辑。</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">ssh niuiic@192.168.1.108 &quot;cd ~&#x2F;AscendProjects&#x2F;samples&#x2F;cplusplus&#x2F;level2_simple_inference&#x2F;n_performance&#x2F;1_multi_process_thread&#x2F;face_recognition_camera &amp;&amp; .&#x2F;make.sh&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>A 处 git 上传未列入其中，B 处的操作已经全部包含至<code>make.sh</code>中。</p>\n<p>这样，就可以控制 B 拉取最新代码，并进行编译，然后将信息传输回来。</p>\n<p>但，此时遇到一个重大问题，B 上编译器输出的路径是 B 上项目的路径，传回来的自然也是，那如果 A 上的路径不同呢。quickfix 自然没有自动处理能力，会直接跳到空文件。</p>\n<p>一个解决方案，是两边使用同一个路径。这里介绍另一个更灵活的方案。</p>\n<p>修改上述<code>build.sh</code>。用 shell 对接收到的内容进行处理。将路径换过来。这里可以直接保存到变量修改后输出，保存到文件是为之后查看所用。</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">ssh niuiic@192.168.1.108 &quot;cd ~&#x2F;AscendProjects&#x2F;samples&#x2F;cplusplus&#x2F;level2_simple_inference&#x2F;n_performance&#x2F;1_multi_process_thread&#x2F;face_recognition_camera &amp;&amp; .&#x2F;make.sh&quot; &gt; .&#x2F;build.log 2&gt;&amp;1\n\nsed -i &quot;s&#x2F;\\&#x2F;home\\&#x2F;niuiic\\&#x2F;AscendProjects\\&#x2F;samples\\&#x2F;cplusplus\\&#x2F;level2_simple_inference\\&#x2F;n_performance\\&#x2F;1_multi_process_thread\\&#x2F;face_recognition_camera&#x2F;\\&#x2F;home\\&#x2F;niuiic\\&#x2F;Documents\\&#x2F;Project\\&#x2F;Cpp\\&#x2F;face_recognition&#x2F;g&quot; .&#x2F;build.log\n\ncat .&#x2F;build.log<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>再进一步，通过观察上文 quickfix 窗口图片可以发现，quickfix 不仅仅列出错误，也会列出警告等信息。如果没有明确的标识，就需要仔细查看才能知道是警告还是错误。所以，需要做进一步优化。</p>\n<p>为 quickfix 窗口配置关键词高亮。对于 neovim 而言，应在<code>~/.config/nvim/after/syntax</code>目录下创建<code>qf.vim</code>。当 vim 打开 quickfix 窗口时，会自动加载该配置文件并进行关键词高亮。</p>\n<p>修改文件内容如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">syn match QuickFixWarn &#x2F;warning&#x2F;\nsyn match QuickFixWarn &#x2F;warn&#x2F;\nsyn match QuickFixErr &#x2F;error&#x2F;\nsyn match QuickFixNote &#x2F;note&#x2F;\nhi def link     QuickFixErr         Function\nhi def link     QuickFixWarn         Function\nhi def link     QuickFixNote         Function\nhi QuickFixErr guifg&#x3D;red\nhi QuickFixWarn guifg&#x3D;yellow\nhi QuickFixNote guifg&#x3D;green<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>这里分别将 warning、error、note 设置为黄色、红色、绿色。可以参考以上配置进行自定义。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"Vim-Quickfix\"><a href=\"#Vim-Quickfix\" class=\"headerlink\" title=\"Vim Quickfix\"></a>Vim Quickfix</h1><p>本文主要介绍 vim quickfix 的使用与优化。</p>\n<h2 id=\"什么是-quickfix\"><a href=\"#什么是-quickfix\" class=\"headerlink\" title=\"什么是 quickfix\"></a>什么是 quickfix</h2><p>quickfix 属于 vim 的高级功能，该功能在主流 IDE 或者编辑器中都有集成。</p>\n<p>简单的说，quickfix 就是搜集编译器的输出信息，然后定位错误与警告位置，提供直接跳转功能。可以说有了完善的 quickfix 功能的 vim 编辑器才是真正的编辑器之神。</p>\n<h2 id=\"如何使用-quickfix\"><a href=\"#如何使用-quickfix\" class=\"headerlink\" title=\"如何使用 quickfix\"></a>如何使用 quickfix</h2><p>首先来了解一下 quickfix 的工作流程。</p>\n<ul>\n<li><p>第一步，设定要执行的命令，也就是编译、运行程序的命令。可以在 vim 中通过命令设置。如设置命令为 make，<code>:set makeprg=make</code>。</p>\n</li>\n<li><p>第二步，执行命令<code>:make</code>。注意该 make 是 vim 的命令，而不是 shell 中的 make 命令。此时，开始执行命令并且将输出送到 quickfix 窗口。</p>\n</li>\n<li><p>第三步，使用<code>:copen</code>打开 quickfix 窗口。可以看到刚才的输出内容。假设输出内容如下所示。</p>\n</li>\n</ul>\n<p><img src=\"1.png\" alt=\"quickfix window\"></p>\n<p>可以看到，图中蓝色部分为文件名，之后的为行和列，再后面的为相关信息。</p>\n<ul>\n<li><p>第四步，获取信息之后，跳转到出错位置。vim 提供了<code>:cnext</code>、<code>:cprev</code>、<code>:cfirst</code>、<code>:clast</code>等命令在各个错误之间跳转。也可以借助其他插件，如 vim-clap 对 quickfix 内容进行检索跳转。也可以将光标移动到 quickfix 窗口的文件位置处，键入 enter 进行跳转。</p>\n</li>\n<li><p>第五步，修改完所有错误后，关闭 quickfix 窗口，可以使用<code>:cclose</code>。</p>\n</li>\n</ul>\n<h2 id=\"优化-quickfix\"><a href=\"#优化-quickfix\" class=\"headerlink\" title=\"优化 quickfix\"></a>优化 quickfix</h2><h3 id=\"外观\"><a href=\"#外观\" class=\"headerlink\" title=\"外观\"></a>外观</h3><p>使用<code>:copen</code>打开的 quickfix 窗口较小，不利于查看，可以使用<code>:copexx</code>，如<code>:copen25</code>，指定窗口所占的行数，改变窗口大小。</p>\n<h3 id=\"快捷键\"><a href=\"#快捷键\" class=\"headerlink\" title=\"快捷键\"></a>快捷键</h3><p>可以参考以下快捷键设置。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">au VimEnter <span class=\"token operator\">*</span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">set</span> <span class=\"token builtin\">makeprg</span><span class=\"token operator\">=</span><span class=\"token keyword\">make</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>qs <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token keyword\">set</span> <span class=\"token builtin\">makeprg</span><span class=\"token operator\">=</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>qo <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>cope25<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>qm <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token keyword\">make</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>qc <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token keyword\">cclose</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">j</span><span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">cnext</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span><span class=\"token keyword\">k</span><span class=\"token operator\">></span> <span class=\"token punctuation\">:</span>cprev<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span>g<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">cfirst</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnmap <span class=\"token operator\">&lt;</span>A<span class=\"token operator\">-</span>G<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token keyword\">clast</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">q</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+quickfix'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'set compile cmd'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'open quickfix window'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'m'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'make'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'close quickfix window'</span>\n\t\\<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"异步\"><a href=\"#异步\" class=\"headerlink\" title=\"异步\"></a>异步</h3><p>quickfix 默认同步执行，也就是说执行<code>:make</code>后，直到任务结束，你将无法使用 vim。在任务执行时间较长的情况下，这是很不利的。因此需要做出优化。</p>\n<p>当前最好的解决方案：使用<code>asynctasks.vim</code>插件。该插件可参考的配置如下。安装请参考官方文档。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">nnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>sR <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTask project<span class=\"token operator\">-</span>run<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>sB <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTask project<span class=\"token operator\">-</span>build<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">sb</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTask <span class=\"token keyword\">file</span><span class=\"token operator\">-</span>build<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token builtin\">sr</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTask <span class=\"token keyword\">file</span><span class=\"token operator\">-</span>run<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">st</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTaskList<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">se</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTaskEdit<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>sE <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTaskEdit<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span>sg <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span><span class=\"token punctuation\">:</span>AsyncTask git<span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>asyncrun_rootmarks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'.git'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.svn'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.root'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.project'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.hg'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>asynctasks_term_pos <span class=\"token operator\">=</span> <span class=\"token string\">'bottom'</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>asynctasks_term_rows <span class=\"token operator\">=</span> <span class=\"token number\">10</span>    <span class=\"token comment\">\" 设置纵向切割高度</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>asynctasks_term_cols <span class=\"token operator\">=</span> <span class=\"token number\">80</span>    <span class=\"token comment\">\" 设置横向切割宽度</span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span>s <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+asynctasks'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'R'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'run project'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'B'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'build project'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'build file'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'run file'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'edit config'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'E'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'edit global config'</span><span class=\"token punctuation\">,</span>\n\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'show task list'</span><span class=\"token punctuation\">,</span>\n\t\\<span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>asynctasks_config_name <span class=\"token operator\">=</span> <span class=\"token string\">'.git/task.ini'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>下面说明如何使用该插件。</p>\n<p>使用<code>:AsyncTaskEdit</code>编辑配置文件，比如</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[git]\ncommand&#x3D;git add . &amp;&amp; git commit -m $(?commit context) &amp;&amp; proxychains git pull origin $(?merge branch) &amp;&amp; proxychains git push -u origin $(?commit branch)\ncwd&#x3D;&lt;VIM_ROOT&gt;\noutput&#x3D;terminal<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>该文件具体编辑方法可以参考官方文档。以上配置设定了一个 git 任务，可以使用<code>:AsyncTask git</code>执行该任务，其中<code>$(?)</code>的部分是在执行时由用户输入的。将<code>output</code>设置为<code>quickfix</code>即可将内容输出到 quickfix 窗口。</p>\n<p>该插件可以实现异步的 quickfix 功能，但它的功能远不止这点，建议深入挖掘。</p>\n<h3 id=\"修改\"><a href=\"#修改\" class=\"headerlink\" title=\"修改\"></a>修改</h3><p>假设一下（真实情况应当不会出现），你犯了 100 个错，辛辛苦苦修改完了 99 个，但是剩下一个居然找不到了。这事可能发生吗？是的，很有可能。因为默认情况下，quickfix 并不会因为你修改了一个错误自动把错误消除，如果你要在 100 个错误里找 1 个，那自然是很费事的。</p>\n<p>机灵的程序猿很快想出了绝妙的主意：我可以再执行一遍，重新生成信息。想法很不错，不过没准 n 个小时就过去了。</p>\n<p>目前这方面暂时没有较好的插件（在 neovim 下都无法达到预想的效果）。不过可以通过以下方案来实现。</p>\n<p>首先，可以设置快捷键。</p>\n<pre class=\"line-numbers language-viml\" data-language=\"viml\"><code class=\"language-viml\">nnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;qw :&lt;C-u&gt;write! build.log&lt;CR&gt;\nnnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;qe :&lt;C-u&gt;set modifiable&lt;CR&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>在进入 quickfix 窗口后，使用<code>set modifiable</code>，让 quickfix 可修改。修改完成后使用<code>write! filename</code>保存。这里默认了文件名为<code>build.log</code>。</p>\n<p>然后，可以在 asynctask 插件中设置一个全局的加载文件到 quickfix 的任务。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[load-quickfix]\ncommand&#x3D;bat .&#x2F;build.log\ncwd&#x3D;&lt;VIM_ROOT&gt;\noutput&#x3D;quickfix<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>这里为了方便，直接指定了文件名，如果需要更加具有通用性，可以设置在执行任务时手动输入文件路径。</p>\n<p>在以上配置下，只要从项目根目录进入 vim，就不会出现 log 文件路径出错的问题。</p>\n<h2 id=\"quickfix-进阶：骚操作\"><a href=\"#quickfix-进阶：骚操作\" class=\"headerlink\" title=\"quickfix 进阶：骚操作\"></a>quickfix 进阶：骚操作</h2><p>vim quickfix 相比 IDE 的 quickfix 功能有更高的灵活度，关键就在于可以执行任意 shell 命令，包括 shell 脚本。</p>\n<p>于是，quickfix 有了无限可能。下面将以跨设备编译调试作为一个场景进行说明。</p>\n<p>我的个人电脑 A 为 gentoo 系统，有配置完美的 vim 编辑器，但没有特定的编译环境。另一台电脑上虚拟机 B 为 ubuntu 系统，有完整的编译环境，且已经配置好与开发板 C（Atlas 200DK）连接。首先了解一下昇腾系列的特点：指定版本的一切。我并不想在自己电脑上装一堆乱七八糟的编译器，设一堆乱七八糟的环境变量，更不想重新配置与 C 连接。事实上以上也很难做到，强行做到相当于废了这个系统。那么在 B 上配好 vim 呢？ubuntu18.04？？？这还不得累死人，而且用不了多久。于是，骚操作开始了。</p>\n<p>首先，把 B 上的头文件搞到 A 上，再搞出个<code>compile_commands.json</code>（假设是 C、CPP 项目）满足一下 lsp 的需求。</p>\n<p>然后，来理一下逻辑。在 A 上写好代码后，git 推上去（单独开一个分支用来推送），在 B 上拉下来。在 B 上完成编译，甚至可以放到 C 上试一试。把出错信息传回 A，用于 quickfix。</p>\n<p>那么，先来搞定 ssh 免密登陆，不然无法输入密码会卡住。这个可以参考网上解决方案。或者你也可以用其他语言，如 go 来实现 ssh 登陆以及交互，然后调用该程序即可。</p>\n<p>接下来，写一个 shell 脚本，实现上述逻辑。</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">ssh niuiic@192.168.1.108 &quot;cd ~&#x2F;AscendProjects&#x2F;samples&#x2F;cplusplus&#x2F;level2_simple_inference&#x2F;n_performance&#x2F;1_multi_process_thread&#x2F;face_recognition_camera &amp;&amp; .&#x2F;make.sh&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>A 处 git 上传未列入其中，B 处的操作已经全部包含至<code>make.sh</code>中。</p>\n<p>这样，就可以控制 B 拉取最新代码，并进行编译，然后将信息传输回来。</p>\n<p>但，此时遇到一个重大问题，B 上编译器输出的路径是 B 上项目的路径，传回来的自然也是，那如果 A 上的路径不同呢。quickfix 自然没有自动处理能力，会直接跳到空文件。</p>\n<p>一个解决方案，是两边使用同一个路径。这里介绍另一个更灵活的方案。</p>\n<p>修改上述<code>build.sh</code>。用 shell 对接收到的内容进行处理。将路径换过来。这里可以直接保存到变量修改后输出，保存到文件是为之后查看所用。</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">ssh niuiic@192.168.1.108 &quot;cd ~&#x2F;AscendProjects&#x2F;samples&#x2F;cplusplus&#x2F;level2_simple_inference&#x2F;n_performance&#x2F;1_multi_process_thread&#x2F;face_recognition_camera &amp;&amp; .&#x2F;make.sh&quot; &gt; .&#x2F;build.log 2&gt;&amp;1\n\nsed -i &quot;s&#x2F;\\&#x2F;home\\&#x2F;niuiic\\&#x2F;AscendProjects\\&#x2F;samples\\&#x2F;cplusplus\\&#x2F;level2_simple_inference\\&#x2F;n_performance\\&#x2F;1_multi_process_thread\\&#x2F;face_recognition_camera&#x2F;\\&#x2F;home\\&#x2F;niuiic\\&#x2F;Documents\\&#x2F;Project\\&#x2F;Cpp\\&#x2F;face_recognition&#x2F;g&quot; .&#x2F;build.log\n\ncat .&#x2F;build.log<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>再进一步，通过观察上文 quickfix 窗口图片可以发现，quickfix 不仅仅列出错误，也会列出警告等信息。如果没有明确的标识，就需要仔细查看才能知道是警告还是错误。所以，需要做进一步优化。</p>\n<p>为 quickfix 窗口配置关键词高亮。对于 neovim 而言，应在<code>~/.config/nvim/after/syntax</code>目录下创建<code>qf.vim</code>。当 vim 打开 quickfix 窗口时，会自动加载该配置文件并进行关键词高亮。</p>\n<p>修改文件内容如下。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">syn match QuickFixWarn &#x2F;warning&#x2F;\nsyn match QuickFixWarn &#x2F;warn&#x2F;\nsyn match QuickFixErr &#x2F;error&#x2F;\nsyn match QuickFixNote &#x2F;note&#x2F;\nhi def link     QuickFixErr         Function\nhi def link     QuickFixWarn         Function\nhi def link     QuickFixNote         Function\nhi QuickFixErr guifg&#x3D;red\nhi QuickFixWarn guifg&#x3D;yellow\nhi QuickFixNote guifg&#x3D;green<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>这里分别将 warning、error、note 设置为黄色、红色、绿色。可以参考以上配置进行自定义。</p>\n"},{"title":"Vim Shortcut Key Management","date":"2020-10-19T14:01:56.000Z","_content":"\n# vim 快捷键管理\n\n本文主要介绍如何使用`vim-which-key`管理 vim 快捷键。\n\n## 快捷键管理\n\n- 什么是快捷键管理？\n\n这里的所谓快捷键管理，不是指修改快捷键，而是快捷键提示。\n\n- 为什么需要快捷键管理？\n\n当你比较熟悉 vim 之后，就会使用各种快捷键。随着 vim 的不断扩展，需要为各种插件设置快捷键。从简单的`ctrl`、`alt`、`shift`组合到`<space>`、`<leader>`的使用，你终将配置连自己都数不清的快捷键。幸运的是， vim 的一个好处在于，它可以设置无数快捷键。但不幸的是，人脑不可能记住那么多快捷键。\n\n快捷键管理的好处在于，只要你有一个印象，甚至哪怕是一点印象都没有，你终将在它的提示中找到你要的那个键。\n\n## vim-which-key\n\n### 效果图\n\n![效果图](./vim-shortcut-key-management/1.png)\n\n以上为在普通模式下按下空格键时给出的提示。\n\n### vim-which-key 安装\n\n访问其[github 主页](https://github.com/liuchengxu/vim-which-key)\n\n直接用插件管理器安装即可。\n\n### vim-which-key 配置\n\n首先给出我的部分配置，分析在配置中。\n\n```vim\n\" 定义字典变量，这将是后续为具体快捷键定义提示的基础。注意这些行必须在所有具体定义之前，否则会报错，提示变量未定义。\nlet g:which_key_map1 =  {}\nlet g:which_key_map2 =  {}\n\n\" 设置leader与localleader键位，也可以不设置，明确是哪个就好。\nlet g:mapleader = \"\\\\\"\nlet g:maplocalleader = \"\\<Space>\"\n\n\" 为具体的按键绑定字典变量。这样当按下该键一段时间后，会自动展开该键下的提示。\ncall which_key#register('<Space>', \"g:which_key_map1\")\ncall which_key#register('\\', \"g:which_key_map2\")\n\n\" 定义vim-which-key自身的快捷键，使得插件在该键按下的时候响应。\nnnoremap <silent> <localleader> :<c-u>WhichKey '<Space>'<CR>\nvnoremap <silent> <localleader> :<c-u>WhichKeyVisual '<Space>'<CR>\nnnoremap <silent> <leader> :<c-u>WhichKey '\\'<CR>\nvnoremap <silent> <leader> :<c-u>WhichKeyVisual '\\'<CR>\n\n\" 隐藏提供的提供的statusline的主题（该主题不灵活）。也可以不设置。\nautocmd! FileType which_key\nautocmd  FileType which_key set laststatus=0 noshowmode noruler\n\t\t\t\\| autocmd BufLeave <buffer> set laststatus=2 showmode ruler\n```\n\n至此，我们可以为具体快捷键配置提示信息了。\n\n### 具体提示信息配置\n\n默认情况下，即使不进行配置，vim-which-key 也会自动搜集所有插件的快捷键，但是仅显示快捷键绑定的命令，提示效果较差。\n\n为获得更好的提示体验，最好手动配置提示信息。提供以下几个案例，参考一下即可。\n\n- 案例一\n\n```vim\n\n\" coc-translator\n\" popup\nnmap <silent><nowait> <space>tp  <Plug>(coc-translator-p)\nvmap <silent><nowait> <space>tp  <Plug>(coc-translator-pv)\n\" echo\nnmap <silent><nowait> <space>te  <Plug>(coc-translator-e)\nvmap <silent><nowait> <space>te  <Plug>(coc-translator-ev)\n\" replace\nnmap <silent><nowait> <space>tr  <Plug>(coc-translator-r)\nvmap <silent><nowait> <space>tr  <Plug>(coc-translator-rv)\n\n\" 以上为其余插件的快捷键配置。以下为vim-which-key的配置。\n\nlet g:which_key_map1.t = {\n\t\t\t\\ 'name' : '+translate',\n\t\t\t\\ 'p' : 'popup',\n\t\t\t\\ 'e' : 'echo',\n\t\t\t\\ 'r' : 'replace',\n\t\t\t\\ }\n```\n\n- 案例二\n\n```vim\nlet g:which_key_map1.l = 'move to line'\n```\n\n- 案例三\n\n注意该案例中`l`处又是一层嵌套。\n\n```vim\nlet g:which_key_map1.d = {\n\t\t\t\\ 'name' : '+debug',\n\t\t\t\\ 'e' : 'eval',\n\t\t\t\\ 'w' : 'variable watch',\n\t\t\t\\ 's' : 'start or continue',\n\t\t\t\\ 't' : 'stop',\n\t\t\t\\ 'r' : 'restart',\n\t\t\t\\ 'p' : 'pause',\n\t\t\t\\ 'b' : 'set breakpoint',\n\t\t\t\\ 'c' : 'set condition breakpoint',\n\t\t\t\\ 'f' : 'add function breakpoint',\n\t\t\t\\ 'n' : 'next',\n\t\t\t\\ 'i' : 'step in',\n\t\t\t\\ 'o' : 'step out',\n\t\t\t\\ 'q' : 'quit',\n\t\t\t\\ 'l' :  {\n\t\t\t\\ 'name' : '+switch_output',\n\t\t\t\\ 'c' : 'Console',\n\t\t\t\\ 'd' : 'stderr',\n\t\t\t\\ 'o' : 'Vimspector-out',\n\t\t\t\\ 'e' : 'Vimspector-err',\n\t\t\t\\ 's' : 'server',\n\t\t\t\\ 't' : 'Telemetry',\n\t\t\t\\},\n\t\t\t\\}\n```\n\n你也可以忽略部分按键的提示，将其提示设置为`which_key_ignore`即可。比如\n\n```vim\nlet g:which_key_map2['\\'] = 'which_key_ignore'\nlet g:which_key_map2['\\A'] = 'which_key_ignore'\n````\n","source":"_posts/vim-shortcut-key-management.md","raw":"---\ntitle: Vim Shortcut Key Management\ndate: 2020-10-19 22:01:56\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# vim 快捷键管理\n\n本文主要介绍如何使用`vim-which-key`管理 vim 快捷键。\n\n## 快捷键管理\n\n- 什么是快捷键管理？\n\n这里的所谓快捷键管理，不是指修改快捷键，而是快捷键提示。\n\n- 为什么需要快捷键管理？\n\n当你比较熟悉 vim 之后，就会使用各种快捷键。随着 vim 的不断扩展，需要为各种插件设置快捷键。从简单的`ctrl`、`alt`、`shift`组合到`<space>`、`<leader>`的使用，你终将配置连自己都数不清的快捷键。幸运的是， vim 的一个好处在于，它可以设置无数快捷键。但不幸的是，人脑不可能记住那么多快捷键。\n\n快捷键管理的好处在于，只要你有一个印象，甚至哪怕是一点印象都没有，你终将在它的提示中找到你要的那个键。\n\n## vim-which-key\n\n### 效果图\n\n![效果图](./vim-shortcut-key-management/1.png)\n\n以上为在普通模式下按下空格键时给出的提示。\n\n### vim-which-key 安装\n\n访问其[github 主页](https://github.com/liuchengxu/vim-which-key)\n\n直接用插件管理器安装即可。\n\n### vim-which-key 配置\n\n首先给出我的部分配置，分析在配置中。\n\n```vim\n\" 定义字典变量，这将是后续为具体快捷键定义提示的基础。注意这些行必须在所有具体定义之前，否则会报错，提示变量未定义。\nlet g:which_key_map1 =  {}\nlet g:which_key_map2 =  {}\n\n\" 设置leader与localleader键位，也可以不设置，明确是哪个就好。\nlet g:mapleader = \"\\\\\"\nlet g:maplocalleader = \"\\<Space>\"\n\n\" 为具体的按键绑定字典变量。这样当按下该键一段时间后，会自动展开该键下的提示。\ncall which_key#register('<Space>', \"g:which_key_map1\")\ncall which_key#register('\\', \"g:which_key_map2\")\n\n\" 定义vim-which-key自身的快捷键，使得插件在该键按下的时候响应。\nnnoremap <silent> <localleader> :<c-u>WhichKey '<Space>'<CR>\nvnoremap <silent> <localleader> :<c-u>WhichKeyVisual '<Space>'<CR>\nnnoremap <silent> <leader> :<c-u>WhichKey '\\'<CR>\nvnoremap <silent> <leader> :<c-u>WhichKeyVisual '\\'<CR>\n\n\" 隐藏提供的提供的statusline的主题（该主题不灵活）。也可以不设置。\nautocmd! FileType which_key\nautocmd  FileType which_key set laststatus=0 noshowmode noruler\n\t\t\t\\| autocmd BufLeave <buffer> set laststatus=2 showmode ruler\n```\n\n至此，我们可以为具体快捷键配置提示信息了。\n\n### 具体提示信息配置\n\n默认情况下，即使不进行配置，vim-which-key 也会自动搜集所有插件的快捷键，但是仅显示快捷键绑定的命令，提示效果较差。\n\n为获得更好的提示体验，最好手动配置提示信息。提供以下几个案例，参考一下即可。\n\n- 案例一\n\n```vim\n\n\" coc-translator\n\" popup\nnmap <silent><nowait> <space>tp  <Plug>(coc-translator-p)\nvmap <silent><nowait> <space>tp  <Plug>(coc-translator-pv)\n\" echo\nnmap <silent><nowait> <space>te  <Plug>(coc-translator-e)\nvmap <silent><nowait> <space>te  <Plug>(coc-translator-ev)\n\" replace\nnmap <silent><nowait> <space>tr  <Plug>(coc-translator-r)\nvmap <silent><nowait> <space>tr  <Plug>(coc-translator-rv)\n\n\" 以上为其余插件的快捷键配置。以下为vim-which-key的配置。\n\nlet g:which_key_map1.t = {\n\t\t\t\\ 'name' : '+translate',\n\t\t\t\\ 'p' : 'popup',\n\t\t\t\\ 'e' : 'echo',\n\t\t\t\\ 'r' : 'replace',\n\t\t\t\\ }\n```\n\n- 案例二\n\n```vim\nlet g:which_key_map1.l = 'move to line'\n```\n\n- 案例三\n\n注意该案例中`l`处又是一层嵌套。\n\n```vim\nlet g:which_key_map1.d = {\n\t\t\t\\ 'name' : '+debug',\n\t\t\t\\ 'e' : 'eval',\n\t\t\t\\ 'w' : 'variable watch',\n\t\t\t\\ 's' : 'start or continue',\n\t\t\t\\ 't' : 'stop',\n\t\t\t\\ 'r' : 'restart',\n\t\t\t\\ 'p' : 'pause',\n\t\t\t\\ 'b' : 'set breakpoint',\n\t\t\t\\ 'c' : 'set condition breakpoint',\n\t\t\t\\ 'f' : 'add function breakpoint',\n\t\t\t\\ 'n' : 'next',\n\t\t\t\\ 'i' : 'step in',\n\t\t\t\\ 'o' : 'step out',\n\t\t\t\\ 'q' : 'quit',\n\t\t\t\\ 'l' :  {\n\t\t\t\\ 'name' : '+switch_output',\n\t\t\t\\ 'c' : 'Console',\n\t\t\t\\ 'd' : 'stderr',\n\t\t\t\\ 'o' : 'Vimspector-out',\n\t\t\t\\ 'e' : 'Vimspector-err',\n\t\t\t\\ 's' : 'server',\n\t\t\t\\ 't' : 'Telemetry',\n\t\t\t\\},\n\t\t\t\\}\n```\n\n你也可以忽略部分按键的提示，将其提示设置为`which_key_ignore`即可。比如\n\n```vim\nlet g:which_key_map2['\\'] = 'which_key_ignore'\nlet g:which_key_map2['\\A'] = 'which_key_ignore'\n````\n","slug":"vim-shortcut-key-management","published":1,"updated":"2021-03-23T11:11:18.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmsr003erriz1wl222dk","content":"<h1 id=\"vim-快捷键管理\"><a href=\"#vim-快捷键管理\" class=\"headerlink\" title=\"vim 快捷键管理\"></a>vim 快捷键管理</h1><p>本文主要介绍如何使用<code>vim-which-key</code>管理 vim 快捷键。</p>\n<h2 id=\"快捷键管理\"><a href=\"#快捷键管理\" class=\"headerlink\" title=\"快捷键管理\"></a>快捷键管理</h2><ul>\n<li>什么是快捷键管理？</li>\n</ul>\n<p>这里的所谓快捷键管理，不是指修改快捷键，而是快捷键提示。</p>\n<ul>\n<li>为什么需要快捷键管理？</li>\n</ul>\n<p>当你比较熟悉 vim 之后，就会使用各种快捷键。随着 vim 的不断扩展，需要为各种插件设置快捷键。从简单的<code>ctrl</code>、<code>alt</code>、<code>shift</code>组合到<code>&lt;space&gt;</code>、<code>&lt;leader&gt;</code>的使用，你终将配置连自己都数不清的快捷键。幸运的是， vim 的一个好处在于，它可以设置无数快捷键。但不幸的是，人脑不可能记住那么多快捷键。</p>\n<p>快捷键管理的好处在于，只要你有一个印象，甚至哪怕是一点印象都没有，你终将在它的提示中找到你要的那个键。</p>\n<h2 id=\"vim-which-key\"><a href=\"#vim-which-key\" class=\"headerlink\" title=\"vim-which-key\"></a>vim-which-key</h2><h3 id=\"效果图\"><a href=\"#效果图\" class=\"headerlink\" title=\"效果图\"></a>效果图</h3><p><img src=\"./vim-shortcut-key-management/1.png\" alt=\"效果图\"></p>\n<p>以上为在普通模式下按下空格键时给出的提示。</p>\n<h3 id=\"vim-which-key-安装\"><a href=\"#vim-which-key-安装\" class=\"headerlink\" title=\"vim-which-key 安装\"></a>vim-which-key 安装</h3><p>访问其<a href=\"https://github.com/liuchengxu/vim-which-key\">github 主页</a></p>\n<p>直接用插件管理器安装即可。</p>\n<h3 id=\"vim-which-key-配置\"><a href=\"#vim-which-key-配置\" class=\"headerlink\" title=\"vim-which-key 配置\"></a>vim-which-key 配置</h3><p>首先给出我的部分配置，分析在配置中。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" 定义字典变量，这将是后续为具体快捷键定义提示的基础。注意这些行必须在所有具体定义之前，否则会报错，提示变量未定义。</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1 <span class=\"token operator\">=</span>  <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map2 <span class=\"token operator\">=</span>  <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token comment\">\" 设置leader与localleader键位，也可以不设置，明确是哪个就好。</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>mapleader <span class=\"token operator\">=</span> <span class=\"token string\">\"\\\\\"</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>maplocalleader <span class=\"token operator\">=</span> <span class=\"token string\">\"\\&lt;Space>\"</span>\n\n<span class=\"token comment\">\" 为具体的按键绑定字典变量。这样当按下该键一段时间后，会自动展开该键下的提示。</span>\n<span class=\"token keyword\">call</span> which_key#<span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;Space>'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"g:which_key_map1\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">call</span> which_key#<span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"g:which_key_map2\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" 定义vim-which-key自身的快捷键，使得插件在该键按下的时候响应。</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>localleader<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>WhichKey <span class=\"token string\">'&lt;Space>'</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nvnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>localleader<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>WhichKeyVisual <span class=\"token string\">'&lt;Space>'</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>WhichKey <span class=\"token string\">'\\'</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nvnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>WhichKeyVisual <span class=\"token string\">'\\'</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token comment\">\" 隐藏提供的提供的statusline的主题（该主题不灵活）。也可以不设置。</span>\n<span class=\"token builtin\">autocmd</span><span class=\"token operator\">!</span> FileType which_key\n<span class=\"token builtin\">autocmd</span>  FileType which_key <span class=\"token keyword\">set</span> <span class=\"token builtin\">laststatus</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token builtin\">noshowmode</span> <span class=\"token builtin\">noruler</span>\n\t\t\t\\| <span class=\"token builtin\">autocmd</span> BufLeave <span class=\"token operator\">&lt;</span><span class=\"token keyword\">buffer</span><span class=\"token operator\">></span> <span class=\"token keyword\">set</span> <span class=\"token builtin\">laststatus</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token builtin\">showmode</span> <span class=\"token builtin\">ruler</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>至此，我们可以为具体快捷键配置提示信息了。</p>\n<h3 id=\"具体提示信息配置\"><a href=\"#具体提示信息配置\" class=\"headerlink\" title=\"具体提示信息配置\"></a>具体提示信息配置</h3><p>默认情况下，即使不进行配置，vim-which-key 也会自动搜集所有插件的快捷键，但是仅显示快捷键绑定的命令，提示效果较差。</p>\n<p>为获得更好的提示体验，最好手动配置提示信息。提供以下几个案例，参考一下即可。</p>\n<ul>\n<li>案例一</li>\n</ul>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">\n<span class=\"token comment\">\" coc-translator</span>\n<span class=\"token comment\">\" popup</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">tp</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span><span class=\"token keyword\">p</span><span class=\"token punctuation\">)</span>\nvmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">tp</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span>pv<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">\" echo</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">te</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span><span class=\"token keyword\">e</span><span class=\"token punctuation\">)</span>\nvmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">te</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span>ev<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">\" replace</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">tr</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span><span class=\"token keyword\">r</span><span class=\"token punctuation\">)</span>\nvmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">tr</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span><span class=\"token keyword\">rv</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" 以上为其余插件的快捷键配置。以下为vim-which-key的配置。</span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">t</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+translate'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'p'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'popup'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'echo'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'replace'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>案例二</li>\n</ul>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">l</span> <span class=\"token operator\">=</span> <span class=\"token string\">'move to line'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>案例三</li>\n</ul>\n<p>注意该案例中<code>l</code>处又是一层嵌套。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">d</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+debug'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'eval'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'w'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'variable watch'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'start or continue'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'stop'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'restart'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'p'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'pause'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'set breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'set condition breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'add function breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'n'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'next'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'i'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'step in'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'step out'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'q'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'quit'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'l'</span> <span class=\"token punctuation\">:</span>  <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+switch_output'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Console'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'d'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'stderr'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Vimspector-out'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Vimspector-err'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'server'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Telemetry'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n\t\t\t\\<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>你也可以忽略部分按键的提示，将其提示设置为<code>which_key_ignore</code>即可。比如</p>\n<pre><code class=\"vim\">let g:which_key_map2[&#39;\\&#39;] = &#39;which_key_ignore&#39;\nlet g:which_key_map2[&#39;\\A&#39;] = &#39;which_key_ignore&#39;\n</code></pre>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"vim-快捷键管理\"><a href=\"#vim-快捷键管理\" class=\"headerlink\" title=\"vim 快捷键管理\"></a>vim 快捷键管理</h1><p>本文主要介绍如何使用<code>vim-which-key</code>管理 vim 快捷键。</p>\n<h2 id=\"快捷键管理\"><a href=\"#快捷键管理\" class=\"headerlink\" title=\"快捷键管理\"></a>快捷键管理</h2><ul>\n<li>什么是快捷键管理？</li>\n</ul>\n<p>这里的所谓快捷键管理，不是指修改快捷键，而是快捷键提示。</p>\n<ul>\n<li>为什么需要快捷键管理？</li>\n</ul>\n<p>当你比较熟悉 vim 之后，就会使用各种快捷键。随着 vim 的不断扩展，需要为各种插件设置快捷键。从简单的<code>ctrl</code>、<code>alt</code>、<code>shift</code>组合到<code>&lt;space&gt;</code>、<code>&lt;leader&gt;</code>的使用，你终将配置连自己都数不清的快捷键。幸运的是， vim 的一个好处在于，它可以设置无数快捷键。但不幸的是，人脑不可能记住那么多快捷键。</p>\n<p>快捷键管理的好处在于，只要你有一个印象，甚至哪怕是一点印象都没有，你终将在它的提示中找到你要的那个键。</p>\n<h2 id=\"vim-which-key\"><a href=\"#vim-which-key\" class=\"headerlink\" title=\"vim-which-key\"></a>vim-which-key</h2><h3 id=\"效果图\"><a href=\"#效果图\" class=\"headerlink\" title=\"效果图\"></a>效果图</h3><p><img src=\"./vim-shortcut-key-management/1.png\" alt=\"效果图\"></p>\n<p>以上为在普通模式下按下空格键时给出的提示。</p>\n<h3 id=\"vim-which-key-安装\"><a href=\"#vim-which-key-安装\" class=\"headerlink\" title=\"vim-which-key 安装\"></a>vim-which-key 安装</h3><p>访问其<a href=\"https://github.com/liuchengxu/vim-which-key\">github 主页</a></p>\n<p>直接用插件管理器安装即可。</p>\n<h3 id=\"vim-which-key-配置\"><a href=\"#vim-which-key-配置\" class=\"headerlink\" title=\"vim-which-key 配置\"></a>vim-which-key 配置</h3><p>首先给出我的部分配置，分析在配置中。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" 定义字典变量，这将是后续为具体快捷键定义提示的基础。注意这些行必须在所有具体定义之前，否则会报错，提示变量未定义。</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1 <span class=\"token operator\">=</span>  <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map2 <span class=\"token operator\">=</span>  <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token comment\">\" 设置leader与localleader键位，也可以不设置，明确是哪个就好。</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>mapleader <span class=\"token operator\">=</span> <span class=\"token string\">\"\\\\\"</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>maplocalleader <span class=\"token operator\">=</span> <span class=\"token string\">\"\\&lt;Space>\"</span>\n\n<span class=\"token comment\">\" 为具体的按键绑定字典变量。这样当按下该键一段时间后，会自动展开该键下的提示。</span>\n<span class=\"token keyword\">call</span> which_key#<span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;Space>'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"g:which_key_map1\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">call</span> which_key#<span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"g:which_key_map2\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" 定义vim-which-key自身的快捷键，使得插件在该键按下的时候响应。</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>localleader<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>WhichKey <span class=\"token string\">'&lt;Space>'</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nvnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>localleader<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>WhichKeyVisual <span class=\"token string\">'&lt;Space>'</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>WhichKey <span class=\"token string\">'\\'</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\nvnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>leader<span class=\"token operator\">></span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">c</span><span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>WhichKeyVisual <span class=\"token string\">'\\'</span><span class=\"token operator\">&lt;</span>CR<span class=\"token operator\">></span>\n\n<span class=\"token comment\">\" 隐藏提供的提供的statusline的主题（该主题不灵活）。也可以不设置。</span>\n<span class=\"token builtin\">autocmd</span><span class=\"token operator\">!</span> FileType which_key\n<span class=\"token builtin\">autocmd</span>  FileType which_key <span class=\"token keyword\">set</span> <span class=\"token builtin\">laststatus</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token builtin\">noshowmode</span> <span class=\"token builtin\">noruler</span>\n\t\t\t\\| <span class=\"token builtin\">autocmd</span> BufLeave <span class=\"token operator\">&lt;</span><span class=\"token keyword\">buffer</span><span class=\"token operator\">></span> <span class=\"token keyword\">set</span> <span class=\"token builtin\">laststatus</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token builtin\">showmode</span> <span class=\"token builtin\">ruler</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>至此，我们可以为具体快捷键配置提示信息了。</p>\n<h3 id=\"具体提示信息配置\"><a href=\"#具体提示信息配置\" class=\"headerlink\" title=\"具体提示信息配置\"></a>具体提示信息配置</h3><p>默认情况下，即使不进行配置，vim-which-key 也会自动搜集所有插件的快捷键，但是仅显示快捷键绑定的命令，提示效果较差。</p>\n<p>为获得更好的提示体验，最好手动配置提示信息。提供以下几个案例，参考一下即可。</p>\n<ul>\n<li>案例一</li>\n</ul>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\">\n<span class=\"token comment\">\" coc-translator</span>\n<span class=\"token comment\">\" popup</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">tp</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span><span class=\"token keyword\">p</span><span class=\"token punctuation\">)</span>\nvmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">tp</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span>pv<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">\" echo</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">te</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span><span class=\"token keyword\">e</span><span class=\"token punctuation\">)</span>\nvmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">te</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span>ev<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">\" replace</span>\nnmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">tr</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span><span class=\"token keyword\">r</span><span class=\"token punctuation\">)</span>\nvmap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">tr</span>  <span class=\"token operator\">&lt;</span>Plug<span class=\"token operator\">></span><span class=\"token punctuation\">(</span>coc<span class=\"token operator\">-</span>translator<span class=\"token operator\">-</span><span class=\"token keyword\">rv</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">\" 以上为其余插件的快捷键配置。以下为vim-which-key的配置。</span>\n\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">t</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+translate'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'p'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'popup'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'echo'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'replace'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>案例二</li>\n</ul>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">l</span> <span class=\"token operator\">=</span> <span class=\"token string\">'move to line'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ul>\n<li>案例三</li>\n</ul>\n<p>注意该案例中<code>l</code>处又是一层嵌套。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">d</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+debug'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'eval'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'w'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'variable watch'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'start or continue'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'stop'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'r'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'restart'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'p'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'pause'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'b'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'set breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'set condition breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'f'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'add function breakpoint'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'n'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'next'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'i'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'step in'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'step out'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'q'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'quit'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'l'</span> <span class=\"token punctuation\">:</span>  <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'name'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'+switch_output'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'c'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Console'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'d'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'stderr'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'o'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Vimspector-out'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'e'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Vimspector-err'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'s'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'server'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'t'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'Telemetry'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n\t\t\t\\<span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>你也可以忽略部分按键的提示，将其提示设置为<code>which_key_ignore</code>即可。比如</p>\n<pre><code class=\"vim\">let g:which_key_map2[&#39;\\&#39;] = &#39;which_key_ignore&#39;\nlet g:which_key_map2[&#39;\\A&#39;] = &#39;which_key_ignore&#39;\n</code></pre>\n"},{"title":"Vim Tagbar","date":"2020-10-19T04:18:02.000Z","_content":"\n# vim tagbar\n\n本文介绍 vim tagbar 插件替代品，获取更好的 tags 显示体验。\n\n## vista.vim 介绍\n\nvista.vim 插件相比于 tagbar 插件的优势主要在于异步以及 lsp 支持。lsp 支持意味着有可能为各种语言提取 tags。\n\nvista.vim 显示 tags 的方式来自于 universal-ctags、ale、vim-lsp、coc.nvim、LanguageClient-neovim、vim-lsc、nvim-lspconfig 等。提取 tags 的方式来自于 fzf、skim、vim-clap 等。这就意味着该插件需要以上插件或者包的支持。这里，笔者推荐第一部分可以采用 universal-ctags、或 coc.nvim 或 ale，第二部分采用 vim-clap。\n\n## vista.vim 安装配置\n\nvista.vim 的安装很简单，参考其[github 主页](https://github.com/liuchengxu/vista.vim)即可。\n\n配置 vista.vim，可以参考我的配置。\n\n```vim\n\" vista.vim\nfunction! NearestMethodOrFunction() abort\n\treturn get(b:, 'vista_nearest_method_or_function', '')\nendfunction\n\nset statusline+=%{NearestMethodOrFunction()}\n\n\" By default vista.vim never run if you don't call it explicitly.\n\"\n\" If you want to show the nearest function in your statusline automatically,\n\" you can add the following line to your vimrc\nautocmd VimEnter * call vista#RunForNearestMethodOrFunction()\nlet g:vista_icon_indent = [\"╰─▸ \", \"├─▸ \"]\nlet g:vista_default_executive = 'ctags'\nlet g:vista_executive_for = {\n\t\t\t\\ 'cpp': 'coc',\n\t\t\t\\ 'php': 'coc',\n\t\t\t\\ }\nlet g:vista_ctags_cmd = {\n\t\t\t\\ 'haskell': 'hasktags -x -o - -c',\n\t\t\t\\ }\nlet g:vista_fzf_preview = ['right:50%']\nlet g:vista#renderer#enable_icon = 1\nlet g:vista#renderer#icons = {\n\t\t\t\\   \"function\": \"\\uf794\",\n\t\t\t\\   \"variable\": \"\\uf71b\",\n\t\t\t\\  }\nnnoremap <silent><nowait> <space>m :<C-u>Vista!!<cr>\nlet g:which_key_map1.m = 'open the file tagbar'\n```\n\n其中需要注意的有以下几行\n\n```\nlet g:vista_default_executive = 'ctags'\nlet g:vista_executive_for = {\n\t\t\t\\ 'cpp': 'coc',\n\t\t\t\\ 'php': 'coc',\n\t\t\t\\ }\nnnoremap <silent><nowait> <space>m :<C-u>Vista!!<cr>\n```\n\n第一行表示使用的默认显示 tags 工具，其实指的是提取 tags 的工具。不同工具的显示方式不同。笔者在这里使用的是`universal-ctags`，因此设置为 ctags。其余可选项可以参考其 github 主页。\n\n第二行是为特殊文件类型配置特殊工具。\n\n第三行是快捷键设置，只需要为`:Vista!!`命令配置快捷键即可。\n","source":"_posts/vim-tagbar.md","raw":"---\ntitle: Vim Tagbar\ndate: 2020-10-19 12:18:02\ntags:\n  - Vim\ncategories:\n  - Vim\n---\n\n# vim tagbar\n\n本文介绍 vim tagbar 插件替代品，获取更好的 tags 显示体验。\n\n## vista.vim 介绍\n\nvista.vim 插件相比于 tagbar 插件的优势主要在于异步以及 lsp 支持。lsp 支持意味着有可能为各种语言提取 tags。\n\nvista.vim 显示 tags 的方式来自于 universal-ctags、ale、vim-lsp、coc.nvim、LanguageClient-neovim、vim-lsc、nvim-lspconfig 等。提取 tags 的方式来自于 fzf、skim、vim-clap 等。这就意味着该插件需要以上插件或者包的支持。这里，笔者推荐第一部分可以采用 universal-ctags、或 coc.nvim 或 ale，第二部分采用 vim-clap。\n\n## vista.vim 安装配置\n\nvista.vim 的安装很简单，参考其[github 主页](https://github.com/liuchengxu/vista.vim)即可。\n\n配置 vista.vim，可以参考我的配置。\n\n```vim\n\" vista.vim\nfunction! NearestMethodOrFunction() abort\n\treturn get(b:, 'vista_nearest_method_or_function', '')\nendfunction\n\nset statusline+=%{NearestMethodOrFunction()}\n\n\" By default vista.vim never run if you don't call it explicitly.\n\"\n\" If you want to show the nearest function in your statusline automatically,\n\" you can add the following line to your vimrc\nautocmd VimEnter * call vista#RunForNearestMethodOrFunction()\nlet g:vista_icon_indent = [\"╰─▸ \", \"├─▸ \"]\nlet g:vista_default_executive = 'ctags'\nlet g:vista_executive_for = {\n\t\t\t\\ 'cpp': 'coc',\n\t\t\t\\ 'php': 'coc',\n\t\t\t\\ }\nlet g:vista_ctags_cmd = {\n\t\t\t\\ 'haskell': 'hasktags -x -o - -c',\n\t\t\t\\ }\nlet g:vista_fzf_preview = ['right:50%']\nlet g:vista#renderer#enable_icon = 1\nlet g:vista#renderer#icons = {\n\t\t\t\\   \"function\": \"\\uf794\",\n\t\t\t\\   \"variable\": \"\\uf71b\",\n\t\t\t\\  }\nnnoremap <silent><nowait> <space>m :<C-u>Vista!!<cr>\nlet g:which_key_map1.m = 'open the file tagbar'\n```\n\n其中需要注意的有以下几行\n\n```\nlet g:vista_default_executive = 'ctags'\nlet g:vista_executive_for = {\n\t\t\t\\ 'cpp': 'coc',\n\t\t\t\\ 'php': 'coc',\n\t\t\t\\ }\nnnoremap <silent><nowait> <space>m :<C-u>Vista!!<cr>\n```\n\n第一行表示使用的默认显示 tags 工具，其实指的是提取 tags 的工具。不同工具的显示方式不同。笔者在这里使用的是`universal-ctags`，因此设置为 ctags。其余可选项可以参考其 github 主页。\n\n第二行是为特殊文件类型配置特殊工具。\n\n第三行是快捷键设置，只需要为`:Vista!!`命令配置快捷键即可。\n","slug":"vim-tagbar","published":1,"updated":"2021-03-23T11:11:18.585Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckpkwtmss003hrriz4p0vg5mq","content":"<h1 id=\"vim-tagbar\"><a href=\"#vim-tagbar\" class=\"headerlink\" title=\"vim tagbar\"></a>vim tagbar</h1><p>本文介绍 vim tagbar 插件替代品，获取更好的 tags 显示体验。</p>\n<h2 id=\"vista-vim-介绍\"><a href=\"#vista-vim-介绍\" class=\"headerlink\" title=\"vista.vim 介绍\"></a>vista.vim 介绍</h2><p>vista.vim 插件相比于 tagbar 插件的优势主要在于异步以及 lsp 支持。lsp 支持意味着有可能为各种语言提取 tags。</p>\n<p>vista.vim 显示 tags 的方式来自于 universal-ctags、ale、vim-lsp、coc.nvim、LanguageClient-neovim、vim-lsc、nvim-lspconfig 等。提取 tags 的方式来自于 fzf、skim、vim-clap 等。这就意味着该插件需要以上插件或者包的支持。这里，笔者推荐第一部分可以采用 universal-ctags、或 coc.nvim 或 ale，第二部分采用 vim-clap。</p>\n<h2 id=\"vista-vim-安装配置\"><a href=\"#vista-vim-安装配置\" class=\"headerlink\" title=\"vista.vim 安装配置\"></a>vista.vim 安装配置</h2><p>vista.vim 的安装很简单，参考其<a href=\"https://github.com/liuchengxu/vista.vim\">github 主页</a>即可。</p>\n<p>配置 vista.vim，可以参考我的配置。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" vista.vim</span>\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> <span class=\"token function\">NearestMethodOrFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> abort\n\t<span class=\"token keyword\">return</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">b</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'vista_nearest_method_or_function'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">statusline</span><span class=\"token operator\">+=</span><span class=\"token operator\">%</span><span class=\"token punctuation\">&#123;</span><span class=\"token function\">NearestMethodOrFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token comment\">\" By default vista.vim never run if you don't call it explicitly.</span>\n<span class=\"token comment\">\"</span>\n<span class=\"token comment\">\" If you want to show the nearest function in your statusline automatically,</span>\n<span class=\"token comment\">\" you can add the following line to your vimrc</span>\n<span class=\"token builtin\">autocmd</span> VimEnter <span class=\"token operator\">*</span> <span class=\"token keyword\">call</span> vista#<span class=\"token function\">RunForNearestMethodOrFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista_icon_indent <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"╰─▸ \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"├─▸ \"</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista_default_executive <span class=\"token operator\">=</span> <span class=\"token string\">'ctags'</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista_executive_for <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'cpp'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'coc'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'php'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'coc'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista_ctags_cmd <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'haskell'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'hasktags -x -o - -c'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista_fzf_preview <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'right:50%'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista#renderer#enable_icon <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista#renderer#icons <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\   <span class=\"token string\">\"function\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\uf794\"</span><span class=\"token punctuation\">,</span>\n\t\t\t\\   <span class=\"token string\">\"variable\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\uf71b\"</span><span class=\"token punctuation\">,</span>\n\t\t\t\\  <span class=\"token punctuation\">&#125;</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">m</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Vista<span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">m</span> <span class=\"token operator\">=</span> <span class=\"token string\">'open the file tagbar'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>其中需要注意的有以下几行</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">let g:vista_default_executive &#x3D; &#39;ctags&#39;\nlet g:vista_executive_for &#x3D; &#123;\n\t\t\t\\ &#39;cpp&#39;: &#39;coc&#39;,\n\t\t\t\\ &#39;php&#39;: &#39;coc&#39;,\n\t\t\t\\ &#125;\nnnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;m :&lt;C-u&gt;Vista!!&lt;cr&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>第一行表示使用的默认显示 tags 工具，其实指的是提取 tags 的工具。不同工具的显示方式不同。笔者在这里使用的是<code>universal-ctags</code>，因此设置为 ctags。其余可选项可以参考其 github 主页。</p>\n<p>第二行是为特殊文件类型配置特殊工具。</p>\n<p>第三行是快捷键设置，只需要为<code>:Vista!!</code>命令配置快捷键即可。</p>\n","site":{"data":{"friends":[{"avatar":"https://draveness.me/images/draven-logo.png","name":"真没什么逻辑","introduction":"面向信仰编程","url":"https://draveness.me/","title":"前去学习"}]}},"excerpt":"","more":"<h1 id=\"vim-tagbar\"><a href=\"#vim-tagbar\" class=\"headerlink\" title=\"vim tagbar\"></a>vim tagbar</h1><p>本文介绍 vim tagbar 插件替代品，获取更好的 tags 显示体验。</p>\n<h2 id=\"vista-vim-介绍\"><a href=\"#vista-vim-介绍\" class=\"headerlink\" title=\"vista.vim 介绍\"></a>vista.vim 介绍</h2><p>vista.vim 插件相比于 tagbar 插件的优势主要在于异步以及 lsp 支持。lsp 支持意味着有可能为各种语言提取 tags。</p>\n<p>vista.vim 显示 tags 的方式来自于 universal-ctags、ale、vim-lsp、coc.nvim、LanguageClient-neovim、vim-lsc、nvim-lspconfig 等。提取 tags 的方式来自于 fzf、skim、vim-clap 等。这就意味着该插件需要以上插件或者包的支持。这里，笔者推荐第一部分可以采用 universal-ctags、或 coc.nvim 或 ale，第二部分采用 vim-clap。</p>\n<h2 id=\"vista-vim-安装配置\"><a href=\"#vista-vim-安装配置\" class=\"headerlink\" title=\"vista.vim 安装配置\"></a>vista.vim 安装配置</h2><p>vista.vim 的安装很简单，参考其<a href=\"https://github.com/liuchengxu/vista.vim\">github 主页</a>即可。</p>\n<p>配置 vista.vim，可以参考我的配置。</p>\n<pre class=\"line-numbers language-vim\" data-language=\"vim\"><code class=\"language-vim\"><span class=\"token comment\">\" vista.vim</span>\n<span class=\"token keyword\">function</span><span class=\"token operator\">!</span> <span class=\"token function\">NearestMethodOrFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> abort\n\t<span class=\"token keyword\">return</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">b</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'vista_nearest_method_or_function'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">endfunction</span>\n\n<span class=\"token keyword\">set</span> <span class=\"token builtin\">statusline</span><span class=\"token operator\">+=</span><span class=\"token operator\">%</span><span class=\"token punctuation\">&#123;</span><span class=\"token function\">NearestMethodOrFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span>\n\n<span class=\"token comment\">\" By default vista.vim never run if you don't call it explicitly.</span>\n<span class=\"token comment\">\"</span>\n<span class=\"token comment\">\" If you want to show the nearest function in your statusline automatically,</span>\n<span class=\"token comment\">\" you can add the following line to your vimrc</span>\n<span class=\"token builtin\">autocmd</span> VimEnter <span class=\"token operator\">*</span> <span class=\"token keyword\">call</span> vista#<span class=\"token function\">RunForNearestMethodOrFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista_icon_indent <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"╰─▸ \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"├─▸ \"</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista_default_executive <span class=\"token operator\">=</span> <span class=\"token string\">'ctags'</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista_executive_for <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'cpp'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'coc'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token string\">'php'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'coc'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista_ctags_cmd <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\ <span class=\"token string\">'haskell'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'hasktags -x -o - -c'</span><span class=\"token punctuation\">,</span>\n\t\t\t\\ <span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista_fzf_preview <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'right:50%'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista#renderer#enable_icon <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>vista#renderer#icons <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n\t\t\t\\   <span class=\"token string\">\"function\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\uf794\"</span><span class=\"token punctuation\">,</span>\n\t\t\t\\   <span class=\"token string\">\"variable\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\\uf71b\"</span><span class=\"token punctuation\">,</span>\n\t\t\t\\  <span class=\"token punctuation\">&#125;</span>\nnnoremap <span class=\"token operator\">&lt;</span><span class=\"token keyword\">silent</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>nowait<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>space<span class=\"token operator\">></span><span class=\"token keyword\">m</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">&lt;</span>C<span class=\"token operator\">-</span><span class=\"token keyword\">u</span><span class=\"token operator\">></span>Vista<span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">cr</span><span class=\"token operator\">></span>\n<span class=\"token keyword\">let</span> g<span class=\"token punctuation\">:</span>which_key_map1<span class=\"token operator\">.</span><span class=\"token keyword\">m</span> <span class=\"token operator\">=</span> <span class=\"token string\">'open the file tagbar'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>其中需要注意的有以下几行</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">let g:vista_default_executive &#x3D; &#39;ctags&#39;\nlet g:vista_executive_for &#x3D; &#123;\n\t\t\t\\ &#39;cpp&#39;: &#39;coc&#39;,\n\t\t\t\\ &#39;php&#39;: &#39;coc&#39;,\n\t\t\t\\ &#125;\nnnoremap &lt;silent&gt;&lt;nowait&gt; &lt;space&gt;m :&lt;C-u&gt;Vista!!&lt;cr&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>第一行表示使用的默认显示 tags 工具，其实指的是提取 tags 的工具。不同工具的显示方式不同。笔者在这里使用的是<code>universal-ctags</code>，因此设置为 ctags。其余可选项可以参考其 github 主页。</p>\n<p>第二行是为特殊文件类型配置特殊工具。</p>\n<p>第三行是快捷键设置，只需要为<code>:Vista!!</code>命令配置快捷键即可。</p>\n"}],"PostAsset":[{"_id":"source/_posts/basic-tutorial-of-vue-vite-typescript/1.png","slug":"1.png","post":"ckpkwtmr80007rrizf5is61li","modified":0,"renderable":0},{"_id":"source/_posts/gentoo-basic-system-installation/1.png","slug":"1.png","post":"ckpkwtmrm000trrizflgc2c5h","modified":0,"renderable":0},{"_id":"source/_posts/gentoo-basic-system-installation/2.png","slug":"2.png","post":"ckpkwtmrm000trrizflgc2c5h","modified":0,"renderable":0},{"_id":"source/_posts/gentoo-basic-system-installation/3.png","slug":"3.png","post":"ckpkwtmrm000trrizflgc2c5h","modified":0,"renderable":0},{"_id":"source/_posts/gentoo-package-management/1.png","slug":"1.png","post":"ckpkwtmru0018rrizd7kh4n98","modified":0,"renderable":0},{"_id":"source/_posts/gentoo-package-management/2.png","slug":"2.png","post":"ckpkwtmru0018rrizd7kh4n98","modified":0,"renderable":0},{"_id":"source/_posts/gentoo-package-management/3.png","slug":"3.png","post":"ckpkwtmru0018rrizd7kh4n98","modified":0,"renderable":0},{"_id":"source/_posts/gentoo-preface/1.png","slug":"1.png","post":"ckpkwtmrw001crrizgwrkebz7","modified":0,"renderable":0},{"_id":"source/_posts/install-manjaro-on-rpi4/1.png","slug":"1.png","post":"ckpkwtms1001lrriz6uz8ea6x","modified":0,"renderable":0},{"_id":"source/_posts/install-manjaro-on-rpi4/2.png","slug":"2.png","post":"ckpkwtms1001lrriz6uz8ea6x","modified":0,"renderable":0},{"_id":"source/_posts/install-manjaro-on-rpi4/3.png","slug":"3.png","post":"ckpkwtms1001lrriz6uz8ea6x","modified":0,"renderable":0},{"_id":"source/_posts/spartan-edge-accelerator-board-tutorial/1.png","slug":"1.png","post":"ckpkwtms70020rriz7o25g5fe","modified":0,"renderable":0},{"_id":"source/_posts/vim-quickfix/1.png","slug":"1.png","post":"ckpkwtmsq003brrizfvfkhgiu","modified":0,"renderable":0},{"_id":"source/_posts/vim-shortcut-key-management/1.png","slug":"1.png","post":"ckpkwtmsr003erriz1wl222dk","modified":0,"renderable":0}],"PostCategory":[{"post_id":"ckpkwtmra0009rrizhy1n939c","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmrg000jrrizfz4h23xd"},{"post_id":"ckpkwtmqy0001rriz0t6na5tz","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmrj000nrriza4rfbxyo"},{"post_id":"ckpkwtmr40003rrizcig78ws7","category_id":"ckpkwtmrc000crriz27ho3xfk","_id":"ckpkwtmrk000qrrize7322e4z"},{"post_id":"ckpkwtmri000mrriz486gdbrl","category_id":"ckpkwtmrc000crriz27ho3xfk","_id":"ckpkwtmrn000urriza1fq2klj"},{"post_id":"ckpkwtmr80007rrizf5is61li","category_id":"ckpkwtmrc000crriz27ho3xfk","_id":"ckpkwtmro000yrrizei31f0tx"},{"post_id":"ckpkwtmrb000brrizdeuz3kop","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtmrs0012rriz2o7j8liu"},{"post_id":"ckpkwtmrm000trrizflgc2c5h","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtmru0016rrizf1pwa4tc"},{"post_id":"ckpkwtmrn000xrrizg81ne4wp","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtmrv0019rriz7b4m1ef7"},{"post_id":"ckpkwtmrd000grrizdggf7gin","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtmrx001drriz8ncv7zbq"},{"post_id":"ckpkwtmrp0010rrizap29b69e","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtmry001frriz3kyfag65"},{"post_id":"ckpkwtmrt0015rrizbj3man27","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtms1001jrriz900y9eml"},{"post_id":"ckpkwtmru0018rrizd7kh4n98","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtms2001mrriz79zqgla5"},{"post_id":"ckpkwtmre000irriz8et28cbp","category_id":"ckpkwtmrc000crriz27ho3xfk","_id":"ckpkwtms4001qrriz9aoqg9n5"},{"post_id":"ckpkwtmre000irriz8et28cbp","category_id":"ckpkwtmrq0011rriz6ol6bdra","_id":"ckpkwtms5001urriz556l394q"},{"post_id":"ckpkwtmrw001crrizgwrkebz7","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtms6001yrriz1grldty5"},{"post_id":"ckpkwtmrx001erriz9fz43hk0","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtms80021rrizfdzl4itg"},{"post_id":"ckpkwtmrj000orriz1gav8por","category_id":"ckpkwtmrv001arriz5yfca8to","_id":"ckpkwtms90025rriz2xtae3tl"},{"post_id":"ckpkwtmrz001hrriz942n79wc","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtmsa0027rrizfy1u3syu"},{"post_id":"ckpkwtms2001orriz2o3s6hei","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtmsb002brriz2vse0jkc"},{"post_id":"ckpkwtms4001trrizcw6dgwz3","category_id":"ckpkwtmrk000prrizfobx8q3y","_id":"ckpkwtmsd002drrizefxvdetf"},{"post_id":"ckpkwtmrl000srriz8tod14sx","category_id":"ckpkwtmrv001arriz5yfca8to","_id":"ckpkwtmse002hrriz4yujdnl8"},{"post_id":"ckpkwtmrl000srriz8tod14sx","category_id":"ckpkwtmrq0011rriz6ol6bdra","_id":"ckpkwtmsf002krriz9pvmc5rk"},{"post_id":"ckpkwtms5001wrriz0at37ne0","category_id":"ckpkwtmrq0011rriz6ol6bdra","_id":"ckpkwtmsg002nrrizeiw63skb"},{"post_id":"ckpkwtms1001lrriz6uz8ea6x","category_id":"ckpkwtms4001srriz33r3fy74","_id":"ckpkwtmsj002rrriz6th66jfl"},{"post_id":"ckpkwtms70020rriz7o25g5fe","category_id":"ckpkwtmrv001arriz5yfca8to","_id":"ckpkwtmsk002urrizgzf857n6"},{"post_id":"ckpkwtms80023rriz0gxs4r8w","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsm002yrrizhyna1fro"},{"post_id":"ckpkwtms90026rriz4fdi1fd4","category_id":"ckpkwtms4001srriz33r3fy74","_id":"ckpkwtmso0031rrizc8jibyr6"},{"post_id":"ckpkwtmsc002crriz640p5zns","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsp0035rriz9h2o4dsk"},{"post_id":"ckpkwtmsd002frrizg80j3dzc","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsq0038rriz33r3dlcn"},{"post_id":"ckpkwtmsa0029rrizcniy7m3o","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsr003crriz3psj66uu"},{"post_id":"ckpkwtmsa0029rrizcniy7m3o","category_id":"ckpkwtmrv001arriz5yfca8to","_id":"ckpkwtmss003frrizbg320f5n"},{"post_id":"ckpkwtmse002jrrizgs62cqpi","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmst003jrrizg8ri70h2"},{"post_id":"ckpkwtmsf002mrriz4qgeg8ce","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsu003lrriz4kvv7ufw"},{"post_id":"ckpkwtmsh002qrrizanfj13lq","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsu003orriz6pju3y7h"},{"post_id":"ckpkwtmsj002trrizf2m2aah6","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsu003qrriz3f7kdvam"},{"post_id":"ckpkwtmsl002xrrizem78b4v8","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsu003srrizgc3h8nvr"},{"post_id":"ckpkwtmsm0030rriz18ga0ke2","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsv003vrrizfjvg5i8n"},{"post_id":"ckpkwtmso0034rrizhnz23gfo","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsv003xrriz9m1ag3b9"},{"post_id":"ckpkwtmsp0037rrizgki8bybq","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsv0040rrizely65ckr"},{"post_id":"ckpkwtmsq003brrizfvfkhgiu","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsv0042rriz07v54j17"},{"post_id":"ckpkwtmsr003erriz1wl222dk","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsw0045rriz4n0a5gjy"},{"post_id":"ckpkwtmss003hrriz4p0vg5mq","category_id":"ckpkwtmr50004rriz3unk4x3f","_id":"ckpkwtmsw0047rrizf1qzebpt"}],"PostTag":[{"post_id":"ckpkwtmra0009rrizhy1n939c","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmrd000errizdvsp0z98"},{"post_id":"ckpkwtmqy0001rriz0t6na5tz","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmre000hrriz9hsqcd1b"},{"post_id":"ckpkwtmr40003rrizcig78ws7","tag_id":"ckpkwtmrc000drrizadvv0cec","_id":"ckpkwtmrp000zrrizgfj261ig"},{"post_id":"ckpkwtmr40003rrizcig78ws7","tag_id":"ckpkwtmrg000lrriz7lcu4fkm","_id":"ckpkwtmrs0013rrizgh8da5mq"},{"post_id":"ckpkwtmr40003rrizcig78ws7","tag_id":"ckpkwtmrl000rrrizaed99b64","_id":"ckpkwtmru0017rriz6t42e7yn"},{"post_id":"ckpkwtmr80007rrizf5is61li","tag_id":"ckpkwtmrc000drrizadvv0cec","_id":"ckpkwtms1001krriz4jwffp4o"},{"post_id":"ckpkwtmr80007rrizf5is61li","tag_id":"ckpkwtmrg000lrriz7lcu4fkm","_id":"ckpkwtms2001nrriz1r79bk2e"},{"post_id":"ckpkwtmr80007rrizf5is61li","tag_id":"ckpkwtmrl000rrrizaed99b64","_id":"ckpkwtms4001rrriz1c6q7dld"},{"post_id":"ckpkwtmrb000brrizdeuz3kop","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtms5001vrrizab3g8apr"},{"post_id":"ckpkwtms4001trrizcw6dgwz3","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtms6001zrrizc0a5bekx"},{"post_id":"ckpkwtmrd000grrizdggf7gin","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtms80022rriz9ra30dlt"},{"post_id":"ckpkwtms80023rriz0gxs4r8w","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmsa0028rriz2wel100e"},{"post_id":"ckpkwtmsa0029rrizcniy7m3o","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmsd002errizd6iqf2qj"},{"post_id":"ckpkwtmsc002crriz640p5zns","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmse002irrizc1i951kk"},{"post_id":"ckpkwtmsd002frrizg80j3dzc","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmsf002lrriz9dd86cvf"},{"post_id":"ckpkwtmse002jrrizgs62cqpi","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmsg002prriz64kle2hg"},{"post_id":"ckpkwtmre000irriz8et28cbp","tag_id":"ckpkwtms6001xrrizb5ph2fm0","_id":"ckpkwtmsj002srrizacnfalc9"},{"post_id":"ckpkwtmre000irriz8et28cbp","tag_id":"ckpkwtmrc000drrizadvv0cec","_id":"ckpkwtmsl002wrriz6505gorb"},{"post_id":"ckpkwtmre000irriz8et28cbp","tag_id":"ckpkwtmrg000lrriz7lcu4fkm","_id":"ckpkwtmsm002zrrizdrcw974l"},{"post_id":"ckpkwtmre000irriz8et28cbp","tag_id":"ckpkwtmrl000rrrizaed99b64","_id":"ckpkwtmso0033rriz3ulhdgbv"},{"post_id":"ckpkwtmre000irriz8et28cbp","tag_id":"ckpkwtmse002grriz1l3b5ifj","_id":"ckpkwtmsp0036rriz52x25oyw"},{"post_id":"ckpkwtmsf002mrriz4qgeg8ce","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmsq0039rriz798m3924"},{"post_id":"ckpkwtmsh002qrrizanfj13lq","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmsr003drrizb6aq1aky"},{"post_id":"ckpkwtmsj002trrizf2m2aah6","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmss003grriz46qz7cbt"},{"post_id":"ckpkwtmri000mrriz486gdbrl","tag_id":"ckpkwtmrc000drrizadvv0cec","_id":"ckpkwtmst003krrizb6du6rjt"},{"post_id":"ckpkwtmri000mrriz486gdbrl","tag_id":"ckpkwtmrg000lrriz7lcu4fkm","_id":"ckpkwtmsu003mrriz2jmph4n6"},{"post_id":"ckpkwtmri000mrriz486gdbrl","tag_id":"ckpkwtmrl000rrrizaed99b64","_id":"ckpkwtmsu003prrizchbd64ou"},{"post_id":"ckpkwtmri000mrriz486gdbrl","tag_id":"ckpkwtmse002grriz1l3b5ifj","_id":"ckpkwtmsu003rrriz2a31e18l"},{"post_id":"ckpkwtmso0034rrizhnz23gfo","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmsu003urriz40d1ay2m"},{"post_id":"ckpkwtmsp0037rrizgki8bybq","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmsv003wrriz1ncjgstc"},{"post_id":"ckpkwtmsq003brrizfvfkhgiu","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmsv003zrrizb8iicg7w"},{"post_id":"ckpkwtmsr003erriz1wl222dk","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmsv0041rriz4hvoa98g"},{"post_id":"ckpkwtmrj000orriz1gav8por","tag_id":"ckpkwtmso0032rriz07yr8ddw","_id":"ckpkwtmsw0044rriz8nup0k3w"},{"post_id":"ckpkwtmrj000orriz1gav8por","tag_id":"ckpkwtmsq003arriz2x7x9dam","_id":"ckpkwtmsw0046rrizfke3avjq"},{"post_id":"ckpkwtmss003hrriz4p0vg5mq","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmsw0049rriz30sia6xi"},{"post_id":"ckpkwtmrl000srriz8tod14sx","tag_id":"ckpkwtmst003irrizb58pe1xe","_id":"ckpkwtmsw004arrizen3ua9g6"},{"post_id":"ckpkwtmrl000srriz8tod14sx","tag_id":"ckpkwtmsu003nrrize814ft50","_id":"ckpkwtmsx004crrizbz77h7wm"},{"post_id":"ckpkwtmrm000trrizflgc2c5h","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtmsx004drrizaazw6e6a"},{"post_id":"ckpkwtmrn000xrrizg81ne4wp","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtmsx004frriz6k7jabts"},{"post_id":"ckpkwtmrp0010rrizap29b69e","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtmsx004grriz41ud8g7j"},{"post_id":"ckpkwtmrt0015rrizbj3man27","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtmsy004irriz4l9rcmyx"},{"post_id":"ckpkwtmru0018rrizd7kh4n98","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtmsy004jrriz019fakcw"},{"post_id":"ckpkwtmrw001crrizgwrkebz7","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtmsy004lrrizge6odole"},{"post_id":"ckpkwtmrx001erriz9fz43hk0","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtmsy004mrrizgxwf4ngf"},{"post_id":"ckpkwtmrz001hrriz942n79wc","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtmsz004orrizhqco9cwz"},{"post_id":"ckpkwtms1001lrriz6uz8ea6x","tag_id":"ckpkwtmsy004nrrize7wk3mp9","_id":"ckpkwtmsz004rrriz2deg16b7"},{"post_id":"ckpkwtms1001lrriz6uz8ea6x","tag_id":"ckpkwtmsz004prrizbcdb6u4c","_id":"ckpkwtmsz004srriz6fix1msv"},{"post_id":"ckpkwtms2001orriz2o3s6hei","tag_id":"ckpkwtmrz001grrizchy60lpk","_id":"ckpkwtmt0004vrrizdjfl0ezw"},{"post_id":"ckpkwtms2001orriz2o3s6hei","tag_id":"ckpkwtmsz004qrriz1jxee0tl","_id":"ckpkwtmt0004wrriz2tux45jh"},{"post_id":"ckpkwtms2001orriz2o3s6hei","tag_id":"ckpkwtmsz004trrizgwt55v79","_id":"ckpkwtmt0004yrriz2671g0hh"},{"post_id":"ckpkwtms5001wrriz0at37ne0","tag_id":"ckpkwtmst003irrizb58pe1xe","_id":"ckpkwtmt10050rriz91672xcq"},{"post_id":"ckpkwtms5001wrriz0at37ne0","tag_id":"ckpkwtms6001xrrizb5ph2fm0","_id":"ckpkwtmt10051rriz34agd2ho"},{"post_id":"ckpkwtms70020rriz7o25g5fe","tag_id":"ckpkwtmt1004zrriz5uu312d0","_id":"ckpkwtmt10054rrizf7coel0r"},{"post_id":"ckpkwtms70020rriz7o25g5fe","tag_id":"ckpkwtmt10052rriz04y151qw","_id":"ckpkwtmt20055rriz6et91108"},{"post_id":"ckpkwtms90026rriz4fdi1fd4","tag_id":"ckpkwtmsy004nrrize7wk3mp9","_id":"ckpkwtmt20059rrizdrwx3s0m"},{"post_id":"ckpkwtms90026rriz4fdi1fd4","tag_id":"ckpkwtmsz004prrizbcdb6u4c","_id":"ckpkwtmt3005arriz40fy4lo5"},{"post_id":"ckpkwtms90026rriz4fdi1fd4","tag_id":"ckpkwtmt20057rriz2w4m9sfj","_id":"ckpkwtmt3005crriz2c0uftgm"},{"post_id":"ckpkwtmsl002xrrizem78b4v8","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmt3005erriz9miq6mtd"},{"post_id":"ckpkwtmsl002xrrizem78b4v8","tag_id":"ckpkwtmt20058rrizbmh0c93f","_id":"ckpkwtmt3005frrizhnv43cti"},{"post_id":"ckpkwtmsl002xrrizem78b4v8","tag_id":"ckpkwtmt3005brrizaty90u05","_id":"ckpkwtmt3005grriz3cg675sx"},{"post_id":"ckpkwtmsm0030rriz18ga0ke2","tag_id":"ckpkwtmr70005rriz2vbo2dn0","_id":"ckpkwtmt4005hrrizgr5pekmb"},{"post_id":"ckpkwtmsm0030rriz18ga0ke2","tag_id":"ckpkwtmt3005brrizaty90u05","_id":"ckpkwtmt4005irrizhg29agbp"}],"Tag":[{"name":"Vim","_id":"ckpkwtmr70005rriz2vbo2dn0"},{"name":"Vue","_id":"ckpkwtmrc000drrizadvv0cec"},{"name":"Vite","_id":"ckpkwtmrg000lrriz7lcu4fkm"},{"name":"Typescript","_id":"ckpkwtmrl000rrrizaed99b64"},{"name":"Gentoo","_id":"ckpkwtmrz001grrizchy60lpk"},{"name":"Tauri","_id":"ckpkwtms6001xrrizb5ph2fm0"},{"name":"Less","_id":"ckpkwtmse002grriz1l3b5ifj"},{"name":"MSP430G2","_id":"ckpkwtmso0032rriz07yr8ddw"},{"name":"Linux","_id":"ckpkwtmsq003arriz2x7x9dam"},{"name":"Rust","_id":"ckpkwtmst003irrizb58pe1xe"},{"name":"Stm32","_id":"ckpkwtmsu003nrrize814ft50"},{"name":"Raspberry Pi","_id":"ckpkwtmsy004nrrize7wk3mp9"},{"name":"Manjaro","_id":"ckpkwtmsz004prrizbcdb6u4c"},{"name":"Java","_id":"ckpkwtmsz004qrriz1jxee0tl"},{"name":"Oracle","_id":"ckpkwtmsz004trrizgwt55v79"},{"name":"FPGA","_id":"ckpkwtmt1004zrriz5uu312d0"},{"name":"Arduino","_id":"ckpkwtmt10052rriz04y151qw"},{"name":"Realvnc","_id":"ckpkwtmt20057rriz2w4m9sfj"},{"name":"Latex","_id":"ckpkwtmt20058rrizbmh0c93f"},{"name":"Markdown","_id":"ckpkwtmt3005brrizaty90u05"}]}}